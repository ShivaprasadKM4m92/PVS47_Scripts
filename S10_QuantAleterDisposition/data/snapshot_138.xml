<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="138">
  <HTTPTask id="620" hostname="10.100.22.24:8181" path="/signal/assets/app/pvs/alerts_review/agg_case_alert_details-8d806ca22a2bf202b9cc33c007f84a35.js" url="http://10.100.22.24:8181/signal/assets/app/pvs/alerts_review/agg_case_alert_details-8d806ca22a2bf202b9cc33c007f84a35.js" ip="10.100.22.24" port="8181" connectionId="17" origin="Primary" frame="1" startDateTime="2020-07-30T17:24:15.789+05:30" startTime="773189375" endTime="773191343">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Host" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTAuMTAwLjIyLjI0OjgxODE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg0LjAuNDE0Ny4xMDUgU2FmYXJpLzUzNy4zNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovLzEwLjEwMC4yMi4yNDo4MTgxL3NpZ25hbC9hZ2dyZWdhdGVDYXNlQWxlcnQvZGV0YWlscz9jYWxsaW5nU2NyZWVuPXJldmlldyZjb25maWdJZD0zMjU0</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVMsZW47cT0wLjk=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U0VTU0lPTj03NjA0ZmMyOC0zODgyLTRlZGEtODQxOS02MmQ5MjcwN2U4ZWQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9zaWduYWwvYXNzZXRzL2FwcC9wdnMvYWxlcnRzX3Jldmlldy9hZ2dfY2FzZV9hbGVydF9kZXRhaWxzLThkODA2Y2EyMmEyYmYyMDJiOWNjMzNjMDA3Zjg0YTM1LmpzIEhUVFAvMS4xDQpIb3N0OiAxMC4xMDAuMjIuMjQ6ODE4MQ0KQ29ubmVjdGlvbjoga2VlcC1hbGl2ZQ0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg0LjAuNDE0Ny4xMDUgU2FmYXJpLzUzNy4zNg0KQWNjZXB0OiAqLyoNClJlZmVyZXI6IGh0dHA6Ly8xMC4xMDAuMjIuMjQ6ODE4MS9zaWduYWwvYWdncmVnYXRlQ2FzZUFsZXJ0L2RldGFpbHM/Y2FsbGluZ1NjcmVlbj1yZXZpZXcmY29uZmlnSWQ9MzI1NA0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLVVTLGVuO3E9MC45DQpDb29raWU6IFNFU1NJT049NzYwNGZjMjgtMzg4Mi00ZWRhLTg0MTktNjJkOTI3MDdlOGVkDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="SESSION" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzYwNGZjMjgtMzg4Mi00ZWRhLTg0MTktNjJkOTI3MDdlOGVk</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>131940</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Last-Modified" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAyMiBKdWwgMjAyMCAwMzozMzo0NCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ImFwcC9wdnMvYWxlcnRzX3Jldmlldy9hZ2dfY2FzZV9hbGVydF9kZXRhaWxzLThkODA2Y2EyMmEyYmYyMDJiOWNjMzNjMDA3Zjg0YTM1LmpzIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>cHVibGljLCBtYXgtYWdlPTMxNTM2MDAw</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdDtjaGFyc2V0PVVURi04</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTMxOTQw</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAzMCBKdWwgMjAyMCAxMTozODowOCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIA0KTGFzdC1Nb2RpZmllZDogV2VkLCAyMiBKdWwgMjAyMCAwMzozMzo0NCBHTVQNCkVUYWc6ICJhcHAvcHZzL2FsZXJ0c19yZXZpZXcvYWdnX2Nhc2VfYWxlcnRfZGV0YWlscy04ZDgwNmNhMjJhMmJmMjAyYjljYzMzYzAwN2Y4NGEzNS5qcyINClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KQ2FjaGUtQ29udHJvbDogcHVibGljLCBtYXgtYWdlPTMxNTM2MDAwDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQ7Y2hhcnNldD1VVEYtOA0KQ29udGVudC1MZW5ndGg6IDEzMTk0MA0KRGF0ZTogVGh1LCAzMCBKdWwgMjAyMCAxMTozODowOCBHTVQNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>LyoNCiBIaWdoY2hhcnRzIEpTIHY1LjAuOSAoMjAxNy0wMy0wOCkNCg0KIChjKSAyMDA5LTIwMTYgVG9yc3RlaW4gSG9uc2kNCg0KIExpY2Vuc2U6IHd3dy5oaWdoY2hhcnRzLmNvbS9saWNlbnNlDQogKi8NCihmdW5jdGlvbihJLGEpeyJvYmplY3QiPT09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9SS5kb2N1bWVudD9hKEkpOmE6SS5IaWdoY2hhcnRzPWEoSSl9KSgidW5kZWZpbmVkIiE9PXR5cGVvZiB3aW5kb3c/d2luZG93OnRoaXMsZnVuY3Rpb24oSSl7ST1mdW5jdGlvbigpe3ZhciBhPXdpbmRvdyxCPWEuZG9jdW1lbnQsej1hLm5hdmlnYXRvciYmYS5uYXZpZ2F0b3IudXNlckFnZW50fHwiIixDPUImJkIuY3JlYXRlRWxlbWVudE5TJiYhIUIuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsInN2ZyIpLmNyZWF0ZVNWR1JlY3QsRT0vKGVkZ2V8bXNpZXx0cmlkZW50KS9pLnRlc3QoeikmJiF3aW5kb3cub3BlcmEsdT0hQyxoPS9GaXJlZm94Ly50ZXN0KHopLG49aCYmND5wYXJzZUludCh6LnNwbGl0KCJGaXJlZm94LyIpWzFdLDEwKTtyZXR1cm4gYS5IaWdoY2hhcnRzP2EuSGlnaGNoYXJ0cy5lcnJvcigxNiwhMCk6e3Byb2R1Y3Q6IkhpZ2hjaGFydHMiLA0KICAgICAgICB2ZXJzaW9uOiI1LjAuOSIsZGVnMnJhZDoyKk1hdGguUEkvMzYwLGRvYzpCLGhhc0JpZGlCdWc6bixoYXNUb3VjaDpCJiZ2b2lkIDAhPT1CLmRvY3VtZW50RWxlbWVudC5vbnRvdWNoc3RhcnQsaXNNUzpFLGlzV2ViS2l0Oi9BcHBsZVdlYktpdC8udGVzdCh6KSxpc0ZpcmVmb3g6aCxpc1RvdWNoRGV2aWNlOi8oTW9iaWxlfEFuZHJvaWR8V2luZG93cyBQaG9uZSkvLnRlc3QoeiksU1ZHX05TOiJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsY2hhcnRDb3VudDowLHNlcmllc1R5cGVzOnt9LHN5bWJvbFNpemVzOnt9LHN2ZzpDLHZtbDp1LHdpbjphLGNoYXJ0czpbXSxtYXJnaW5OYW1lczpbInBsb3RUb3AiLCJtYXJnaW5SaWdodCIsIm1hcmdpbkJvdHRvbSIsInBsb3RMZWZ0Il0sbm9vcDpmdW5jdGlvbigpe319fSgpOyhmdW5jdGlvbihhKXt2YXIgQj1bXSx6PWEuY2hhcnRzLEM9YS5kb2MsRT1hLndpbjthLmVycm9yPWZ1bmN0aW9uKHUsaCl7dT1hLmlzTnVtYmVyKHUpPyJIaWdoY2hhcnRzIGVycm9yICMiKw0KICAgIHUrIjogd3d3LmhpZ2hjaGFydHMuY29tL2Vycm9ycy8iK3U6dTtpZihoKXRocm93IEVycm9yKHUpO0UuY29uc29sZSYmY29uc29sZS5sb2codSl9O2EuRng9ZnVuY3Rpb24oYSxoLG4pe3RoaXMub3B0aW9ucz1oO3RoaXMuZWxlbT1hO3RoaXMucHJvcD1ufTthLkZ4LnByb3RvdHlwZT17ZFNldHRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucGF0aHNbMF0saD10aGlzLnBhdGhzWzFdLG49W10sdD10aGlzLm5vdyxsPWEubGVuZ3RoLGs7aWYoMT09PXQpbj10aGlzLnRvRDtlbHNlIGlmKGw9PT1oLmxlbmd0aCYmMT50KWZvcig7bC0tOylrPXBhcnNlRmxvYXQoYVtsXSksbltsXT1pc05hTihrKT9hW2xdOnQqcGFyc2VGbG9hdChoW2xdLWspK2s7ZWxzZSBuPWg7dGhpcy5lbGVtLmF0dHIoImQiLG4sbnVsbCwhMCl9LHVwZGF0ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZWxlbSxoPXRoaXMucHJvcCxuPXRoaXMubm93LHQ9dGhpcy5vcHRpb25zLnN0ZXA7aWYodGhpc1toKyJTZXR0ZXIiXSl0aGlzW2grDQoiU2V0dGVyIl0oKTtlbHNlIGEuYXR0cj9hLmVsZW1lbnQmJmEuYXR0cihoLG4sbnVsbCwhMCk6YS5zdHlsZVtoXT1uK3RoaXMudW5pdDt0JiZ0LmNhbGwoYSxuLHRoaXMpfSxydW46ZnVuY3Rpb24oYSxoLG4pe3ZhciB1PXRoaXMsbD1mdW5jdGlvbihhKXtyZXR1cm4gbC5zdG9wcGVkPyExOnUuc3RlcChhKX0sazt0aGlzLnN0YXJ0VGltZT0rbmV3IERhdGU7dGhpcy5zdGFydD1hO3RoaXMuZW5kPWg7dGhpcy51bml0PW47dGhpcy5ub3c9dGhpcy5zdGFydDt0aGlzLnBvcz0wO2wuZWxlbT10aGlzLmVsZW07bC5wcm9wPXRoaXMucHJvcDtsKCkmJjE9PT1CLnB1c2gobCkmJihsLnRpbWVySWQ9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtmb3Ioaz0wO2s8Qi5sZW5ndGg7aysrKUJba10oKXx8Qi5zcGxpY2Uoay0tLDEpO0IubGVuZ3RofHxjbGVhckludGVydmFsKGwudGltZXJJZCl9LDEzKSl9LHN0ZXA6ZnVuY3Rpb24oYSl7dmFyIGg9K25ldyBEYXRlLHUsdD10aGlzLm9wdGlvbnM7dT10aGlzLmVsZW07DQogICAgdmFyIGw9dC5jb21wbGV0ZSxrPXQuZHVyYXRpb24sZT10LmN1ckFuaW0sYztpZih1LmF0dHImJiF1LmVsZW1lbnQpdT0hMTtlbHNlIGlmKGF8fGg+PWsrdGhpcy5zdGFydFRpbWUpe3RoaXMubm93PXRoaXMuZW5kO3RoaXMucG9zPTE7dGhpcy51cGRhdGUoKTthPWVbdGhpcy5wcm9wXT0hMDtmb3IoYyBpbiBlKSEwIT09ZVtjXSYmKGE9ITEpO2EmJmwmJmwuY2FsbCh1KTt1PSExfWVsc2UgdGhpcy5wb3M9dC5lYXNpbmcoKGgtdGhpcy5zdGFydFRpbWUpL2spLHRoaXMubm93PXRoaXMuc3RhcnQrKHRoaXMuZW5kLXRoaXMuc3RhcnQpKnRoaXMucG9zLHRoaXMudXBkYXRlKCksdT0hMDtyZXR1cm4gdX0saW5pdFBhdGg6ZnVuY3Rpb24odSxoLG4pe2Z1bmN0aW9uIHQoYSl7dmFyIGIsZjtmb3Iocj1hLmxlbmd0aDtyLS07KWI9Ik0iPT09YVtyXXx8IkwiPT09YVtyXSxmPS9bYS16QS1aXS8udGVzdChhW3IrM10pLGImJmYmJmEuc3BsaWNlKHIrMSwwLGFbcisxXSxhW3IrMl0sYVtyKzFdLGFbcisNCjJdKX1mdW5jdGlvbiBsKGEsZil7Zm9yKDthLmxlbmd0aDxtOyl7YVswXT1mW20tYS5sZW5ndGhdO3ZhciBkPWEuc2xpY2UoMCxiKTtbXS5zcGxpY2UuYXBwbHkoYSxbMCwwXS5jb25jYXQoZCkpO0EmJihkPWEuc2xpY2UoYS5sZW5ndGgtYiksW10uc3BsaWNlLmFwcGx5KGEsW2EubGVuZ3RoLDBdLmNvbmNhdChkKSksci0tKX1hWzBdPSJNIn1mdW5jdGlvbiBrKGEsZil7Zm9yKHZhciBjPShtLWEubGVuZ3RoKS9iOzA8YyYmYy0tOylkPWEuc2xpY2UoKS5zcGxpY2UoYS5sZW5ndGgvdi1iLGIqdiksZFswXT1mW20tYi1jKmJdLEgmJihkW2ItNl09ZFtiLTJdLGRbYi01XT1kW2ItMV0pLFtdLnNwbGljZS5hcHBseShhLFthLmxlbmd0aC92LDBdLmNvbmNhdChkKSksQSYmYy0tfWg9aHx8IiI7dmFyIGUsYz11LnN0YXJ0WCxwPXUuZW5kWCxIPS0xPGguaW5kZXhPZigiQyIpLGI9SD83OjMsbSxkLHI7aD1oLnNwbGl0KCIgIik7bj1uLnNsaWNlKCk7dmFyIEE9dS5pc0FyZWEsdj1BPzI6MSxmOw0KICAgIEgmJih0KGgpLHQobikpO2lmKGMmJnApe2ZvcihyPTA7cjxjLmxlbmd0aDtyKyspaWYoY1tyXT09PXBbMF0pe2U9cjticmVha31lbHNlIGlmKGNbMF09PT1wW3AubGVuZ3RoLWMubGVuZ3RoK3JdKXtlPXI7Zj0hMDticmVha312b2lkIDA9PT1lJiYoaD1bXSl9aC5sZW5ndGgmJmEuaXNOdW1iZXIoZSkmJihtPW4ubGVuZ3RoK2UqdipiLGY/KGwoaCxuKSxrKG4saCkpOihsKG4saCksayhoLG4pKSk7cmV0dXJuW2gsbl19fTthLmV4dGVuZD1mdW5jdGlvbihhLGgpe3ZhciB1O2F8fChhPXt9KTtmb3IodSBpbiBoKWFbdV09aFt1XTtyZXR1cm4gYX07YS5tZXJnZT1mdW5jdGlvbigpe3ZhciB1LGg9YXJndW1lbnRzLG4sdD17fSxsPWZ1bmN0aW9uKGssZSl7dmFyIGMscDsib2JqZWN0IiE9PXR5cGVvZiBrJiYoaz17fSk7Zm9yKHAgaW4gZSllLmhhc093blByb3BlcnR5KHApJiYoYz1lW3BdLGEuaXNPYmplY3QoYywhMCkmJiJyZW5kZXJUbyIhPT1wJiYibnVtYmVyIiE9PXR5cGVvZiBjLm5vZGVUeXBlPw0KICAgIGtbcF09bChrW3BdfHx7fSxjKTprW3BdPWVbcF0pO3JldHVybiBrfTshMD09PWhbMF0mJih0PWhbMV0saD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChoLDIpKTtuPWgubGVuZ3RoO2Zvcih1PTA7dTxuO3UrKyl0PWwodCxoW3VdKTtyZXR1cm4gdH07YS5wSW50PWZ1bmN0aW9uKGEsaCl7cmV0dXJuIHBhcnNlSW50KGEsaHx8MTApfTthLmlzU3RyaW5nPWZ1bmN0aW9uKGEpe3JldHVybiJzdHJpbmciPT09dHlwZW9mIGF9O2EuaXNBcnJheT1mdW5jdGlvbihhKXthPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKTtyZXR1cm4iW29iamVjdCBBcnJheV0iPT09YXx8IltvYmplY3QgQXJyYXkgSXRlcmF0b3JdIj09PWF9O2EuaXNPYmplY3Q9ZnVuY3Rpb24odSxoKXtyZXR1cm4gdSYmIm9iamVjdCI9PT10eXBlb2YgdSYmKCFofHwhYS5pc0FycmF5KHUpKX07YS5pc051bWJlcj1mdW5jdGlvbihhKXtyZXR1cm4ibnVtYmVyIj09PXR5cGVvZiBhJiYhaXNOYU4oYSl9O2EuZXJhc2U9DQogICAgZnVuY3Rpb24oYSxoKXtmb3IodmFyIHU9YS5sZW5ndGg7dS0tOylpZihhW3VdPT09aCl7YS5zcGxpY2UodSwxKTticmVha319O2EuZGVmaW5lZD1mdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwIT09YSYmbnVsbCE9PWF9O2EuYXR0cj1mdW5jdGlvbih1LGgsbil7dmFyIHQsbDtpZihhLmlzU3RyaW5nKGgpKWEuZGVmaW5lZChuKT91LnNldEF0dHJpYnV0ZShoLG4pOnUmJnUuZ2V0QXR0cmlidXRlJiYobD11LmdldEF0dHJpYnV0ZShoKSk7ZWxzZSBpZihhLmRlZmluZWQoaCkmJmEuaXNPYmplY3QoaCkpZm9yKHQgaW4gaCl1LnNldEF0dHJpYnV0ZSh0LGhbdF0pO3JldHVybiBsfTthLnNwbGF0PWZ1bmN0aW9uKHUpe3JldHVybiBhLmlzQXJyYXkodSk/dTpbdV19O2Euc3luY1RpbWVvdXQ9ZnVuY3Rpb24oYSxoLG4pe2lmKGgpcmV0dXJuIHNldFRpbWVvdXQoYSxoLG4pO2EuY2FsbCgwLG4pfTthLnBpY2s9ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHMsaCxuLHQ9YS5sZW5ndGg7Zm9yKGg9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwO2g8dDtoKyspaWYobj1hW2hdLHZvaWQgMCE9PW4mJm51bGwhPT1uKXJldHVybiBufTthLmNzcz1mdW5jdGlvbih1LGgpe2EuaXNNUyYmIWEuc3ZnJiZoJiZ2b2lkIDAhPT1oLm9wYWNpdHkmJihoLmZpbHRlcj0iYWxwaGEob3BhY2l0eVx4M2QiKzEwMCpoLm9wYWNpdHkrIikiKTthLmV4dGVuZCh1LnN0eWxlLGgpfTthLmNyZWF0ZUVsZW1lbnQ9ZnVuY3Rpb24odSxoLG4sdCxsKXt1PUMuY3JlYXRlRWxlbWVudCh1KTt2YXIgaz1hLmNzcztoJiZhLmV4dGVuZCh1LGgpO2wmJmsodSx7cGFkZGluZzowLGJvcmRlcjoibm9uZSIsbWFyZ2luOjB9KTtuJiZrKHUsbik7dCYmdC5hcHBlbmRDaGlsZCh1KTtyZXR1cm4gdX07YS5leHRlbmRDbGFzcz1mdW5jdGlvbih1LGgpe3ZhciBuPWZ1bmN0aW9uKCl7fTtuLnByb3RvdHlwZT1uZXcgdTthLmV4dGVuZChuLnByb3RvdHlwZSxoKTtyZXR1cm4gbn07YS5wYWQ9ZnVuY3Rpb24oYSxoLG4pe3JldHVybiBBcnJheSgoaHx8MikrMS1TdHJpbmcoYSkubGVuZ3RoKS5qb2luKG58fA0KICAgICAgICAwKSthfTthLnJlbGF0aXZlTGVuZ3RoPWZ1bmN0aW9uKGEsaCl7cmV0dXJuLyUkLy50ZXN0KGEpP2gqcGFyc2VGbG9hdChhKS8xMDA6cGFyc2VGbG9hdChhKX07YS53cmFwPWZ1bmN0aW9uKGEsaCxuKXt2YXIgdD1hW2hdO2FbaF09ZnVuY3Rpb24oKXt2YXIgYT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLGs9YXJndW1lbnRzLGU9dGhpcztlLnByb2NlZWQ9ZnVuY3Rpb24oKXt0LmFwcGx5KGUsYXJndW1lbnRzLmxlbmd0aD9hcmd1bWVudHM6ayl9O2EudW5zaGlmdCh0KTthPW4uYXBwbHkodGhpcyxhKTtlLnByb2NlZWQ9bnVsbDtyZXR1cm4gYX19O2EuZ2V0VFpPZmZzZXQ9ZnVuY3Rpb24odSl7dmFyIGg9YS5EYXRlO3JldHVybiA2RTQqKGguaGNHZXRUaW1lem9uZU9mZnNldCYmaC5oY0dldFRpbWV6b25lT2Zmc2V0KHUpfHxoLmhjVGltZXpvbmVPZmZzZXR8fDApfTthLmRhdGVGb3JtYXQ9ZnVuY3Rpb24odSxoLG4pe2lmKCFhLmRlZmluZWQoaCl8fGlzTmFOKGgpKXJldHVybiBhLmRlZmF1bHRPcHRpb25zLmxhbmcuaW52YWxpZERhdGV8fA0KICAgICIiO3U9YS5waWNrKHUsIiVZLSVtLSVkICVIOiVNOiVTIik7dmFyIHQ9YS5EYXRlLGw9bmV3IHQoaC1hLmdldFRaT2Zmc2V0KGgpKSxrLGU9bFt0LmhjR2V0SG91cnNdKCksYz1sW3QuaGNHZXREYXldKCkscD1sW3QuaGNHZXREYXRlXSgpLEg9bFt0LmhjR2V0TW9udGhdKCksYj1sW3QuaGNHZXRGdWxsWWVhcl0oKSxtPWEuZGVmYXVsdE9wdGlvbnMubGFuZyxkPW0ud2Vla2RheXMscj1tLnNob3J0V2Vla2RheXMsQT1hLnBhZCx0PWEuZXh0ZW5kKHthOnI/cltjXTpkW2NdLnN1YnN0cigwLDMpLEE6ZFtjXSxkOkEocCksZTpBKHAsMiwiICIpLHc6YyxiOm0uc2hvcnRNb250aHNbSF0sQjptLm1vbnRoc1tIXSxtOkEoSCsxKSx5OmIudG9TdHJpbmcoKS5zdWJzdHIoMiwyKSxZOmIsSDpBKGUpLGs6ZSxJOkEoZSUxMnx8MTIpLGw6ZSUxMnx8MTIsTTpBKGxbdC5oY0dldE1pbnV0ZXNdKCkpLHA6MTI+ZT8iQU0iOiJQTSIsUDoxMj5lPyJhbSI6InBtIixTOkEobC5nZXRTZWNvbmRzKCkpLEw6QShNYXRoLnJvdW5kKGglDQogICAgMUUzKSwzKX0sYS5kYXRlRm9ybWF0cyk7Zm9yKGsgaW4gdClmb3IoOy0xIT09dS5pbmRleE9mKCIlIitrKTspdT11LnJlcGxhY2UoIiUiK2ssImZ1bmN0aW9uIj09PXR5cGVvZiB0W2tdP3Rba10oaCk6dFtrXSk7cmV0dXJuIG4/dS5zdWJzdHIoMCwxKS50b1VwcGVyQ2FzZSgpK3Uuc3Vic3RyKDEpOnV9O2EuZm9ybWF0U2luZ2xlPWZ1bmN0aW9uKHUsaCl7dmFyIG49L1wuKFswLTldKS8sdD1hLmRlZmF1bHRPcHRpb25zLmxhbmc7L2YkLy50ZXN0KHUpPyhuPShuPXUubWF0Y2gobikpP25bMV06LTEsbnVsbCE9PWgmJihoPWEubnVtYmVyRm9ybWF0KGgsbix0LmRlY2ltYWxQb2ludCwtMTx1LmluZGV4T2YoIiwiKT90LnRob3VzYW5kc1NlcDoiIikpKTpoPWEuZGF0ZUZvcm1hdCh1LGgpO3JldHVybiBofTthLmZvcm1hdD1mdW5jdGlvbih1LGgpe2Zvcih2YXIgbj0ieyIsdD0hMSxsLGssZSxjLHA9W10sSDt1Oyl7bj11LmluZGV4T2Yobik7aWYoLTE9PT1uKWJyZWFrO2w9dS5zbGljZSgwLA0KICAgIG4pO2lmKHQpe2w9bC5zcGxpdCgiOiIpO2s9bC5zaGlmdCgpLnNwbGl0KCIuIik7Yz1rLmxlbmd0aDtIPWg7Zm9yKGU9MDtlPGM7ZSsrKUg9SFtrW2VdXTtsLmxlbmd0aCYmKEg9YS5mb3JtYXRTaW5nbGUobC5qb2luKCI6IiksSCkpO3AucHVzaChIKX1lbHNlIHAucHVzaChsKTt1PXUuc2xpY2UobisxKTtuPSh0PSF0KT8ifSI6InsifXAucHVzaCh1KTtyZXR1cm4gcC5qb2luKCIiKX07YS5nZXRNYWduaXR1ZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGgucG93KDEwLE1hdGguZmxvb3IoTWF0aC5sb2coYSkvTWF0aC5MTjEwKSl9O2Eubm9ybWFsaXplVGlja0ludGVydmFsPWZ1bmN0aW9uKHUsaCxuLHQsbCl7dmFyIGssZT11O249YS5waWNrKG4sMSk7az11L247aHx8KGg9bD9bMSwxLjIsMS41LDIsMi41LDMsNCw1LDYsOCwxMF06WzEsMiwyLjUsNSwxMF0sITE9PT10JiYoMT09PW4/aD1hLmdyZXAoaCxmdW5jdGlvbihhKXtyZXR1cm4gMD09PWElMX0pOi4xPj1uJiYoaD1bMS9uXSkpKTsNCiAgICBmb3IodD0wO3Q8aC5sZW5ndGgmJiEoZT1oW3RdLGwmJmUqbj49dXx8IWwmJms8PShoW3RdKyhoW3QrMV18fGhbdF0pKS8yKTt0KyspO3JldHVybiBlPWEuY29ycmVjdEZsb2F0KGUqbiwtTWF0aC5yb3VuZChNYXRoLmxvZyguMDAxKS9NYXRoLkxOMTApKX07YS5zdGFibGVTb3J0PWZ1bmN0aW9uKGEsaCl7dmFyIG49YS5sZW5ndGgsdCxsO2ZvcihsPTA7bDxuO2wrKylhW2xdLnNhZmVJPWw7YS5zb3J0KGZ1bmN0aW9uKGEsZSl7dD1oKGEsZSk7cmV0dXJuIDA9PT10P2Euc2FmZUktZS5zYWZlSTp0fSk7Zm9yKGw9MDtsPG47bCsrKWRlbGV0ZSBhW2xdLnNhZmVJfTthLmFycmF5TWluPWZ1bmN0aW9uKGEpe2Zvcih2YXIgaD1hLmxlbmd0aCxuPWFbMF07aC0tOylhW2hdPG4mJihuPWFbaF0pO3JldHVybiBufTthLmFycmF5TWF4PWZ1bmN0aW9uKGEpe2Zvcih2YXIgaD1hLmxlbmd0aCxuPWFbMF07aC0tOylhW2hdPm4mJihuPWFbaF0pO3JldHVybiBufTthLmRlc3Ryb3lPYmplY3RQcm9wZXJ0aWVzPQ0KICAgIGZ1bmN0aW9uKGEsaCl7Zm9yKHZhciBuIGluIGEpYVtuXSYmYVtuXSE9PWgmJmFbbl0uZGVzdHJveSYmYVtuXS5kZXN0cm95KCksZGVsZXRlIGFbbl19O2EuZGlzY2FyZEVsZW1lbnQ9ZnVuY3Rpb24odSl7dmFyIGg9YS5nYXJiYWdlQmluO2h8fChoPWEuY3JlYXRlRWxlbWVudCgiZGl2IikpO3UmJmguYXBwZW5kQ2hpbGQodSk7aC5pbm5lckhUTUw9IiJ9O2EuY29ycmVjdEZsb2F0PWZ1bmN0aW9uKGEsaCl7cmV0dXJuIHBhcnNlRmxvYXQoYS50b1ByZWNpc2lvbihofHwxNCkpfTthLnNldEFuaW1hdGlvbj1mdW5jdGlvbih1LGgpe2gucmVuZGVyZXIuZ2xvYmFsQW5pbWF0aW9uPWEucGljayh1LGgub3B0aW9ucy5jaGFydC5hbmltYXRpb24sITApfTthLmFuaW1PYmplY3Q9ZnVuY3Rpb24odSl7cmV0dXJuIGEuaXNPYmplY3QodSk/YS5tZXJnZSh1KTp7ZHVyYXRpb246dT81MDA6MH19O2EudGltZVVuaXRzPXttaWxsaXNlY29uZDoxLHNlY29uZDoxRTMsbWludXRlOjZFNCxob3VyOjM2RTUsDQogICAgZGF5Ojg2NEU1LHdlZWs6NjA0OEU1LG1vbnRoOjI0MTkyRTUseWVhcjozMTQ0OTZFNX07YS5udW1iZXJGb3JtYXQ9ZnVuY3Rpb24odSxoLG4sdCl7dT0rdXx8MDtoPStoO3ZhciBsPWEuZGVmYXVsdE9wdGlvbnMubGFuZyxrPSh1LnRvU3RyaW5nKCkuc3BsaXQoIi4iKVsxXXx8IiIpLmxlbmd0aCxlLGM7LTE9PT1oP2g9TWF0aC5taW4oaywyMCk6YS5pc051bWJlcihoKXx8KGg9Mik7Yz0oTWF0aC5hYnModSkrTWF0aC5wb3coMTAsLU1hdGgubWF4KGgsayktMSkpLnRvRml4ZWQoaCk7az1TdHJpbmcoYS5wSW50KGMpKTtlPTM8ay5sZW5ndGg/ay5sZW5ndGglMzowO249YS5waWNrKG4sbC5kZWNpbWFsUG9pbnQpO3Q9YS5waWNrKHQsbC50aG91c2FuZHNTZXApO3U9KDA+dT8iLSI6IiIpKyhlP2suc3Vic3RyKDAsZSkrdDoiIik7dSs9ay5zdWJzdHIoZSkucmVwbGFjZSgvKFxkezN9KSg/PVxkKS9nLCIkMSIrdCk7aCYmKHUrPW4rYy5zbGljZSgtaCkpO3JldHVybiB1fTtNYXRoLmVhc2VJbk91dFNpbmU9DQogICAgZnVuY3Rpb24oYSl7cmV0dXJuLS41KihNYXRoLmNvcyhNYXRoLlBJKmEpLTEpfTthLmdldFN0eWxlPWZ1bmN0aW9uKHUsaCl7cmV0dXJuIndpZHRoIj09PWg/TWF0aC5taW4odS5vZmZzZXRXaWR0aCx1LnNjcm9sbFdpZHRoKS1hLmdldFN0eWxlKHUsInBhZGRpbmctbGVmdCIpLWEuZ2V0U3R5bGUodSwicGFkZGluZy1yaWdodCIpOiJoZWlnaHQiPT09aD9NYXRoLm1pbih1Lm9mZnNldEhlaWdodCx1LnNjcm9sbEhlaWdodCktYS5nZXRTdHlsZSh1LCJwYWRkaW5nLXRvcCIpLWEuZ2V0U3R5bGUodSwicGFkZGluZy1ib3R0b20iKToodT1FLmdldENvbXB1dGVkU3R5bGUodSx2b2lkIDApKSYmYS5wSW50KHUuZ2V0UHJvcGVydHlWYWx1ZShoKSl9O2EuaW5BcnJheT1mdW5jdGlvbihhLGgpe3JldHVybiBoLmluZGV4T2Y/aC5pbmRleE9mKGEpOltdLmluZGV4T2YuY2FsbChoLGEpfTthLmdyZXA9ZnVuY3Rpb24oYSxoKXtyZXR1cm5bXS5maWx0ZXIuY2FsbChhLGgpfTthLmZpbmQ9ZnVuY3Rpb24oYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoKXtyZXR1cm5bXS5maW5kLmNhbGwoYSxoKX07YS5tYXA9ZnVuY3Rpb24oYSxoKXtmb3IodmFyIG49W10sdD0wLGw9YS5sZW5ndGg7dDxsO3QrKyluW3RdPWguY2FsbChhW3RdLGFbdF0sdCxhKTtyZXR1cm4gbn07YS5vZmZzZXQ9ZnVuY3Rpb24oYSl7dmFyIGg9Qy5kb2N1bWVudEVsZW1lbnQ7YT1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybnt0b3A6YS50b3ArKEUucGFnZVlPZmZzZXR8fGguc2Nyb2xsVG9wKS0oaC5jbGllbnRUb3B8fDApLGxlZnQ6YS5sZWZ0KyhFLnBhZ2VYT2Zmc2V0fHxoLnNjcm9sbExlZnQpLShoLmNsaWVudExlZnR8fDApfX07YS5zdG9wPWZ1bmN0aW9uKGEsaCl7Zm9yKHZhciBuPUIubGVuZ3RoO24tLTspQltuXS5lbGVtIT09YXx8aCYmaCE9PUJbbl0ucHJvcHx8KEJbbl0uc3RvcHBlZD0hMCl9O2EuZWFjaD1mdW5jdGlvbihhLGgsbil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYSxoLG4pfTthLmFkZEV2ZW50PWZ1bmN0aW9uKHUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLG4pe2Z1bmN0aW9uIHQoYSl7YS50YXJnZXQ9YS5zcmNFbGVtZW50fHxFO24uY2FsbCh1LGEpfXZhciBsPXUuaGNFdmVudHM9dS5oY0V2ZW50c3x8e307dS5hZGRFdmVudExpc3RlbmVyP3UuYWRkRXZlbnRMaXN0ZW5lcihoLG4sITEpOnUuYXR0YWNoRXZlbnQmJih1LmhjRXZlbnRzSUV8fCh1LmhjRXZlbnRzSUU9e30pLHUuaGNFdmVudHNJRVtuLnRvU3RyaW5nKCldPXQsdS5hdHRhY2hFdmVudCgib24iK2gsdCkpO2xbaF18fChsW2hdPVtdKTtsW2hdLnB1c2gobik7cmV0dXJuIGZ1bmN0aW9uKCl7YS5yZW1vdmVFdmVudCh1LGgsbil9fTthLnJlbW92ZUV2ZW50PWZ1bmN0aW9uKHUsaCxuKXtmdW5jdGlvbiB0KGEsYyl7dS5yZW1vdmVFdmVudExpc3RlbmVyP3UucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGMsITEpOnUuYXR0YWNoRXZlbnQmJihjPXUuaGNFdmVudHNJRVtjLnRvU3RyaW5nKCldLHUuZGV0YWNoRXZlbnQoIm9uIithLGMpKX1mdW5jdGlvbiBsKCl7dmFyIGEsYztpZih1Lm5vZGVOYW1lKWZvcihjIGluIGg/DQogICAgKGE9e30sYVtoXT0hMCk6YT1lLGEpaWYoZVtjXSlmb3IoYT1lW2NdLmxlbmd0aDthLS07KXQoYyxlW2NdW2FdKX12YXIgayxlPXUuaGNFdmVudHMsYztlJiYoaD8oaz1lW2hdfHxbXSxuPyhjPWEuaW5BcnJheShuLGspLC0xPGMmJihrLnNwbGljZShjLDEpLGVbaF09ayksdChoLG4pKToobCgpLGVbaF09W10pKToobCgpLHUuaGNFdmVudHM9e30pKX07YS5maXJlRXZlbnQ9ZnVuY3Rpb24odSxoLG4sdCl7dmFyIGw7bD11LmhjRXZlbnRzO3ZhciBrLGU7bj1ufHx7fTtpZihDLmNyZWF0ZUV2ZW50JiYodS5kaXNwYXRjaEV2ZW50fHx1LmZpcmVFdmVudCkpbD1DLmNyZWF0ZUV2ZW50KCJFdmVudHMiKSxsLmluaXRFdmVudChoLCEwLCEwKSxhLmV4dGVuZChsLG4pLHUuZGlzcGF0Y2hFdmVudD91LmRpc3BhdGNoRXZlbnQobCk6dS5maXJlRXZlbnQoaCxsKTtlbHNlIGlmKGwpZm9yKGw9bFtoXXx8W10saz1sLmxlbmd0aCxuLnRhcmdldHx8YS5leHRlbmQobix7cHJldmVudERlZmF1bHQ6ZnVuY3Rpb24oKXtuLmRlZmF1bHRQcmV2ZW50ZWQ9DQogICAgITB9LHRhcmdldDp1LHR5cGU6aH0pLGg9MDtoPGs7aCsrKShlPWxbaF0pJiYhMT09PWUuY2FsbCh1LG4pJiZuLnByZXZlbnREZWZhdWx0KCk7dCYmIW4uZGVmYXVsdFByZXZlbnRlZCYmdChuKX07YS5hbmltYXRlPWZ1bmN0aW9uKHUsaCxuKXt2YXIgdCxsPSIiLGssZSxjO2EuaXNPYmplY3Qobil8fCh0PWFyZ3VtZW50cyxuPXtkdXJhdGlvbjp0WzJdLGVhc2luZzp0WzNdLGNvbXBsZXRlOnRbNF19KTthLmlzTnVtYmVyKG4uZHVyYXRpb24pfHwobi5kdXJhdGlvbj00MDApO24uZWFzaW5nPSJmdW5jdGlvbiI9PT10eXBlb2Ygbi5lYXNpbmc/bi5lYXNpbmc6TWF0aFtuLmVhc2luZ118fE1hdGguZWFzZUluT3V0U2luZTtuLmN1ckFuaW09YS5tZXJnZShoKTtmb3IoYyBpbiBoKWEuc3RvcCh1LGMpLGU9bmV3IGEuRngodSxuLGMpLGs9bnVsbCwiZCI9PT1jPyhlLnBhdGhzPWUuaW5pdFBhdGgodSx1LmQsaC5kKSxlLnRvRD1oLmQsdD0wLGs9MSk6dS5hdHRyP3Q9dS5hdHRyKGMpOih0PXBhcnNlRmxvYXQoYS5nZXRTdHlsZSh1LA0KICAgICAgICAgICAgICAgIGMpKXx8MCwib3BhY2l0eSIhPT1jJiYobD0icHgiKSksa3x8KGs9aFtjXSksayYmay5tYXRjaCYmay5tYXRjaCgicHgiKSYmKGs9ay5yZXBsYWNlKC9weC9nLCIiKSksZS5ydW4odCxrLGwpfTthLnNlcmllc1R5cGU9ZnVuY3Rpb24odSxoLG4sdCxsKXt2YXIgaz1hLmdldE9wdGlvbnMoKSxlPWEuc2VyaWVzVHlwZXM7ay5wbG90T3B0aW9uc1t1XT1hLm1lcmdlKGsucGxvdE9wdGlvbnNbaF0sbik7ZVt1XT1hLmV4dGVuZENsYXNzKGVbaF18fGZ1bmN0aW9uKCl7fSx0KTtlW3VdLnByb3RvdHlwZS50eXBlPXU7bCYmKGVbdV0ucHJvdG90eXBlLnBvaW50Q2xhc3M9YS5leHRlbmRDbGFzcyhhLlBvaW50LGwpKTtyZXR1cm4gZVt1XX07YS51bmlxdWVLZXk9ZnVuY3Rpb24oKXt2YXIgYT1NYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiw5KSxoPTA7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuImhpZ2hjaGFydHMtIithKyItIitoKyt9fSgpO0UualF1ZXJ5JiYoRS5qUXVlcnkuZm4uaGlnaGNoYXJ0cz0NCiAgICBmdW5jdGlvbigpe3ZhciB1PVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtpZih0aGlzWzBdKXJldHVybiB1WzBdPyhuZXcgKGFbYS5pc1N0cmluZyh1WzBdKT91LnNoaWZ0KCk6IkNoYXJ0Il0pKHRoaXNbMF0sdVswXSx1WzFdKSx0aGlzKTp6W2EuYXR0cih0aGlzWzBdLCJkYXRhLWhpZ2hjaGFydHMtY2hhcnQiKV19KTtDJiYhQy5kZWZhdWx0VmlldyYmKGEuZ2V0U3R5bGU9ZnVuY3Rpb24odSxoKXt2YXIgbj17d2lkdGg6ImNsaWVudFdpZHRoIixoZWlnaHQ6ImNsaWVudEhlaWdodCJ9W2hdO2lmKHUuc3R5bGVbaF0pcmV0dXJuIGEucEludCh1LnN0eWxlW2hdKTsib3BhY2l0eSI9PT1oJiYoaD0iZmlsdGVyIik7aWYobilyZXR1cm4gdS5zdHlsZS56b29tPTEsTWF0aC5tYXgodVtuXS0yKmEuZ2V0U3R5bGUodSwicGFkZGluZyIpLDApO3U9dS5jdXJyZW50U3R5bGVbaC5yZXBsYWNlKC9cLShcdykvZyxmdW5jdGlvbihhLGwpe3JldHVybiBsLnRvVXBwZXJDYXNlKCl9KV07ImZpbHRlciI9PT0NCmgmJih1PXUucmVwbGFjZSgvYWxwaGFcKG9wYWNpdHk9KFswLTldKylcKS8sZnVuY3Rpb24oYSxsKXtyZXR1cm4gbC8xMDB9KSk7cmV0dXJuIiI9PT11PzE6YS5wSW50KHUpfSk7QXJyYXkucHJvdG90eXBlLmZvckVhY2h8fChhLmVhY2g9ZnVuY3Rpb24oYSxoLG4pe2Zvcih2YXIgdD0wLGw9YS5sZW5ndGg7dDxsO3QrKylpZighMT09PWguY2FsbChuLGFbdF0sdCxhKSlyZXR1cm4gdH0pO0FycmF5LnByb3RvdHlwZS5pbmRleE9mfHwoYS5pbkFycmF5PWZ1bmN0aW9uKGEsaCl7dmFyIG4sdD0wO2lmKGgpZm9yKG49aC5sZW5ndGg7dDxuO3QrKylpZihoW3RdPT09YSlyZXR1cm4gdDtyZXR1cm4tMX0pO0FycmF5LnByb3RvdHlwZS5maWx0ZXJ8fChhLmdyZXA9ZnVuY3Rpb24oYSxoKXtmb3IodmFyIG49W10sdD0wLGw9YS5sZW5ndGg7dDxsO3QrKyloKGFbdF0sdCkmJm4ucHVzaChhW3RdKTtyZXR1cm4gbn0pO0FycmF5LnByb3RvdHlwZS5maW5kfHwoYS5maW5kPWZ1bmN0aW9uKGEsaCl7dmFyIG4sDQogICAgdD1hLmxlbmd0aDtmb3Iobj0wO248dDtuKyspaWYoaChhW25dLG4pKXJldHVybiBhW25dfSl9KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5lYWNoLHo9YS5pc051bWJlcixDPWEubWFwLEU9YS5tZXJnZSx1PWEucEludDthLkNvbG9yPWZ1bmN0aW9uKGgpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGEuQ29sb3IpKXJldHVybiBuZXcgYS5Db2xvcihoKTt0aGlzLmluaXQoaCl9O2EuQ29sb3IucHJvdG90eXBlPXtwYXJzZXJzOlt7cmVnZXg6L3JnYmFcKFxzKihbMC05XXsxLDN9KVxzKixccyooWzAtOV17MSwzfSlccyosXHMqKFswLTldezEsM30pXHMqLFxzKihbMC05XT8oPzpcLlswLTldKyk/KVxzKlwpLyxwYXJzZTpmdW5jdGlvbihhKXtyZXR1cm5bdShhWzFdKSx1KGFbMl0pLHUoYVszXSkscGFyc2VGbG9hdChhWzRdLDEwKV19fSx7cmVnZXg6L3JnYlwoXHMqKFswLTldezEsM30pXHMqLFxzKihbMC05XXsxLDN9KVxzKixccyooWzAtOV17MSwzfSlccypcKS8scGFyc2U6ZnVuY3Rpb24oYSl7cmV0dXJuW3UoYVsxXSksDQogICAgdShhWzJdKSx1KGFbM10pLDFdfX1dLG5hbWVzOnt3aGl0ZToiI2ZmZmZmZiIsYmxhY2s6IiMwMDAwMDAifSxpbml0OmZ1bmN0aW9uKGgpe3ZhciBuLHQsbCxrO2lmKCh0aGlzLmlucHV0PWg9dGhpcy5uYW1lc1toXXx8aCkmJmguc3RvcHMpdGhpcy5zdG9wcz1DKGguc3RvcHMsZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBhLkNvbG9yKGVbMV0pfSk7ZWxzZSBpZihoJiYiIyI9PT1oWzBdJiYobj1oLmxlbmd0aCxoPXBhcnNlSW50KGguc3Vic3RyKDEpLDE2KSw3PT09bj90PVsoaCYxNjcxMTY4MCk+PjE2LChoJjY1MjgwKT4+OCxoJjI1NSwxXTo0PT09biYmKHQ9WyhoJjM4NDApPj40fChoJjM4NDApPj44LChoJjI0MCk+PjR8aCYyNDAsKGgmMTUpPDw0fGgmMTUsMV0pKSwhdClmb3IobD10aGlzLnBhcnNlcnMubGVuZ3RoO2wtLSYmIXQ7KWs9dGhpcy5wYXJzZXJzW2xdLChuPWsucmVnZXguZXhlYyhoKSkmJih0PWsucGFyc2UobikpO3RoaXMucmdiYT10fHxbXX0sZ2V0OmZ1bmN0aW9uKGEpe3ZhciBoPQ0KICAgIHRoaXMuaW5wdXQsdD10aGlzLnJnYmEsbDt0aGlzLnN0b3BzPyhsPUUoaCksbC5zdG9wcz1bXS5jb25jYXQobC5zdG9wcyksQih0aGlzLnN0b3BzLGZ1bmN0aW9uKGssZSl7bC5zdG9wc1tlXT1bbC5zdG9wc1tlXVswXSxrLmdldChhKV19KSk6bD10JiZ6KHRbMF0pPyJyZ2IiPT09YXx8IWEmJjE9PT10WzNdPyJyZ2IoIit0WzBdKyIsIit0WzFdKyIsIit0WzJdKyIpIjoiYSI9PT1hP3RbM106InJnYmEoIit0LmpvaW4oIiwiKSsiKSI6aDtyZXR1cm4gbH0sYnJpZ2h0ZW46ZnVuY3Rpb24oYSl7dmFyIGgsdD10aGlzLnJnYmE7aWYodGhpcy5zdG9wcylCKHRoaXMuc3RvcHMsZnVuY3Rpb24obCl7bC5icmlnaHRlbihhKX0pO2Vsc2UgaWYoeihhKSYmMCE9PWEpZm9yKGg9MDszPmg7aCsrKXRbaF0rPXUoMjU1KmEpLDA+dFtoXSYmKHRbaF09MCksMjU1PHRbaF0mJih0W2hdPTI1NSk7cmV0dXJuIHRoaXN9LHNldE9wYWNpdHk6ZnVuY3Rpb24oYSl7dGhpcy5yZ2JhWzNdPWE7cmV0dXJuIHRoaXN9fTsNCiAgICBhLmNvbG9yPWZ1bmN0aW9uKGgpe3JldHVybiBuZXcgYS5Db2xvcihoKX19KShJKTsoZnVuY3Rpb24oYSl7dmFyIEIseixDPWEuYWRkRXZlbnQsRT1hLmFuaW1hdGUsdT1hLmF0dHIsaD1hLmNoYXJ0cyxuPWEuY29sb3IsdD1hLmNzcyxsPWEuY3JlYXRlRWxlbWVudCxrPWEuZGVmaW5lZCxlPWEuZGVnMnJhZCxjPWEuZGVzdHJveU9iamVjdFByb3BlcnRpZXMscD1hLmRvYyxIPWEuZWFjaCxiPWEuZXh0ZW5kLG09YS5lcmFzZSxkPWEuZ3JlcCxyPWEuaGFzVG91Y2gsQT1hLmluQXJyYXksdj1hLmlzQXJyYXksZj1hLmlzRmlyZWZveCx5PWEuaXNNUyxHPWEuaXNPYmplY3QsRj1hLmlzU3RyaW5nLHE9YS5pc1dlYktpdCx4PWEubWVyZ2UsSj1hLm5vb3AsSz1hLnBpY2ssTD1hLnBJbnQsZz1hLnJlbW92ZUV2ZW50LEQ9YS5zdG9wLFM9YS5zdmcsTT1hLlNWR19OUyxSPWEuc3ltYm9sU2l6ZXMsTj1hLndpbjtCPWEuU1ZHRWxlbWVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtCLnByb3RvdHlwZT0NCiAgICB7b3BhY2l0eToxLFNWR19OUzpNLHRleHRQcm9wczoiZGlyZWN0aW9uIGZvbnRTaXplIGZvbnRXZWlnaHQgZm9udEZhbWlseSBmb250U3R5bGUgY29sb3IgbGluZUhlaWdodCB3aWR0aCB0ZXh0QWxpZ24gdGV4dERlY29yYXRpb24gdGV4dE92ZXJmbG93IHRleHRPdXRsaW5lIi5zcGxpdCgiICIpLGluaXQ6ZnVuY3Rpb24oYSxnKXt0aGlzLmVsZW1lbnQ9InNwYW4iPT09Zz9sKGcpOnAuY3JlYXRlRWxlbWVudE5TKHRoaXMuU1ZHX05TLGcpO3RoaXMucmVuZGVyZXI9YX0sYW5pbWF0ZTpmdW5jdGlvbih3LGcsYil7Zz1hLmFuaW1PYmplY3QoSyhnLHRoaXMucmVuZGVyZXIuZ2xvYmFsQW5pbWF0aW9uLCEwKSk7MCE9PWcuZHVyYXRpb24/KGImJihnLmNvbXBsZXRlPWIpLEUodGhpcyx3LGcpKToodGhpcy5hdHRyKHcsbnVsbCxiKSxnLnN0ZXAmJmcuc3RlcC5jYWxsKHRoaXMpKTtyZXR1cm4gdGhpc30sY29sb3JHcmFkaWVudDpmdW5jdGlvbih3LGcsYil7dmFyIGY9dGhpcy5yZW5kZXJlciwNCiAgICAgICAgZCxjLHEsRCxPLHkscixHLGUsbSxwLGw9W10sUTt3LmxpbmVhckdyYWRpZW50P2M9ImxpbmVhckdyYWRpZW50Ijp3LnJhZGlhbEdyYWRpZW50JiYoYz0icmFkaWFsR3JhZGllbnQiKTtpZihjKXtxPXdbY107Tz1mLmdyYWRpZW50cztyPXcuc3RvcHM7bT1iLnJhZGlhbFJlZmVyZW5jZTt2KHEpJiYod1tjXT1xPXt4MTpxWzBdLHkxOnFbMV0seDI6cVsyXSx5MjpxWzNdLGdyYWRpZW50VW5pdHM6InVzZXJTcGFjZU9uVXNlIn0pOyJyYWRpYWxHcmFkaWVudCI9PT1jJiZtJiYhayhxLmdyYWRpZW50VW5pdHMpJiYoRD1xLHE9eChxLGYuZ2V0UmFkaWFsQXR0cihtLEQpLHtncmFkaWVudFVuaXRzOiJ1c2VyU3BhY2VPblVzZSJ9KSk7Zm9yKHAgaW4gcSkiaWQiIT09cCYmbC5wdXNoKHAscVtwXSk7Zm9yKHAgaW4gcilsLnB1c2gocltwXSk7bD1sLmpvaW4oIiwiKTtPW2xdP209T1tsXS5hdHRyKCJpZCIpOihxLmlkPW09YS51bmlxdWVLZXkoKSxPW2xdPXk9Zi5jcmVhdGVFbGVtZW50KGMpLmF0dHIocSkuYWRkKGYuZGVmcyksDQogICAgICAgICAgICB5LnJhZEF0dHI9RCx5LnN0b3BzPVtdLEgocixmdW5jdGlvbih3KXswPT09d1sxXS5pbmRleE9mKCJyZ2JhIik/KGQ9YS5jb2xvcih3WzFdKSxHPWQuZ2V0KCJyZ2IiKSxlPWQuZ2V0KCJhIikpOihHPXdbMV0sZT0xKTt3PWYuY3JlYXRlRWxlbWVudCgic3RvcCIpLmF0dHIoe29mZnNldDp3WzBdLCJzdG9wLWNvbG9yIjpHLCJzdG9wLW9wYWNpdHkiOmV9KS5hZGQoeSk7eS5zdG9wcy5wdXNoKHcpfSkpO1E9InVybCgiK2YudXJsKyIjIittKyIpIjtiLnNldEF0dHJpYnV0ZShnLFEpO2IuZ3JhZGllbnQ9bDt3LnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIFF9fX0sYXBwbHlUZXh0T3V0bGluZTpmdW5jdGlvbihhKXt2YXIgdz10aGlzLmVsZW1lbnQsZyxiLGYsZDstMSE9PWEuaW5kZXhPZigiY29udHJhc3QiKSYmKGE9YS5yZXBsYWNlKC9jb250cmFzdC9nLHRoaXMucmVuZGVyZXIuZ2V0Q29udHJhc3Qody5zdHlsZS5maWxsKSkpO3RoaXMuZmFrZVRTPSEwO3RoaXMueVNldHRlcj10aGlzLnhTZXR0ZXI7DQogICAgICAgIGc9W10uc2xpY2UuY2FsbCh3LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0c3BhbiIpKTthPWEuc3BsaXQoIiAiKTtiPWFbYS5sZW5ndGgtMV07KGY9YVswXSkmJiJub25lIiE9PWYmJihmPWYucmVwbGFjZSgvKF5bXGRcLl0rKSguKj8pJC9nLGZ1bmN0aW9uKGEsdyxnKXtyZXR1cm4gMip3K2d9KSxIKGcsZnVuY3Rpb24oYSl7ImhpZ2hjaGFydHMtdGV4dC1vdXRsaW5lIj09PWEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpJiZtKGcsdy5yZW1vdmVDaGlsZChhKSl9KSxkPXcuZmlyc3RDaGlsZCxIKGcsZnVuY3Rpb24oYSxnKXswPT09ZyYmKGEuc2V0QXR0cmlidXRlKCJ4Iix3LmdldEF0dHJpYnV0ZSgieCIpKSxnPXcuZ2V0QXR0cmlidXRlKCJ5IiksYS5zZXRBdHRyaWJ1dGUoInkiLGd8fDApLG51bGw9PT1nJiZ3LnNldEF0dHJpYnV0ZSgieSIsMCkpO2E9YS5jbG9uZU5vZGUoMSk7dShhLHsiY2xhc3MiOiJoaWdoY2hhcnRzLXRleHQtb3V0bGluZSIsZmlsbDpiLHN0cm9rZTpiLCJzdHJva2Utd2lkdGgiOmYsDQogICAgICAgICAgICAic3Ryb2tlLWxpbmVqb2luIjoicm91bmQifSk7dy5pbnNlcnRCZWZvcmUoYSxkKX0pKX0sYXR0cjpmdW5jdGlvbihhLGcsYixmKXt2YXIgdyxkPXRoaXMuZWxlbWVudCxxLGM9dGhpcyx5OyJzdHJpbmciPT09dHlwZW9mIGEmJnZvaWQgMCE9PWcmJih3PWEsYT17fSxhW3ddPWcpO2lmKCJzdHJpbmciPT09dHlwZW9mIGEpYz0odGhpc1thKyJHZXR0ZXIiXXx8dGhpcy5fZGVmYXVsdEdldHRlcikuY2FsbCh0aGlzLGEsZCk7ZWxzZXtmb3IodyBpbiBhKWc9YVt3XSx5PSExLGZ8fEQodGhpcyx3KSx0aGlzLnN5bWJvbE5hbWUmJi9eKHh8eXx3aWR0aHxoZWlnaHR8cnxzdGFydHxlbmR8aW5uZXJSfGFuY2hvclh8YW5jaG9yWSkvLnRlc3QodykmJihxfHwodGhpcy5zeW1ib2xBdHRyKGEpLHE9ITApLHk9ITApLCF0aGlzLnJvdGF0aW9ufHwieCIhPT13JiYieSIhPT13fHwodGhpcy5kb1RyYW5zZm9ybT0hMCkseXx8KHk9dGhpc1t3KyJTZXR0ZXIiXXx8dGhpcy5fZGVmYXVsdFNldHRlcix5LmNhbGwodGhpcywNCiAgICAgICAgZyx3LGQpLHRoaXMuc2hhZG93cyYmL14od2lkdGh8aGVpZ2h0fHZpc2liaWxpdHl8eHx5fGR8dHJhbnNmb3JtfGN4fGN5fHIpJC8udGVzdCh3KSYmdGhpcy51cGRhdGVTaGFkb3dzKHcsZyx5KSk7dGhpcy5kb1RyYW5zZm9ybSYmKHRoaXMudXBkYXRlVHJhbnNmb3JtKCksdGhpcy5kb1RyYW5zZm9ybT0hMSl9YiYmYigpO3JldHVybiBjfSx1cGRhdGVTaGFkb3dzOmZ1bmN0aW9uKGEsZyxiKXtmb3IodmFyIHc9dGhpcy5zaGFkb3dzLGY9dy5sZW5ndGg7Zi0tOyliLmNhbGwod1tmXSwiaGVpZ2h0Ij09PWE/TWF0aC5tYXgoZy0od1tmXS5jdXRIZWlnaHR8fDApLDApOiJkIj09PWE/dGhpcy5kOmcsYSx3W2ZdKX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYSxnKXt2YXIgdz10aGlzLmF0dHIoImNsYXNzIil8fCIiOy0xPT09dy5pbmRleE9mKGEpJiYoZ3x8KGE9KHcrKHc/IiAiOiIiKSthKS5yZXBsYWNlKCIgICIsIiAiKSksdGhpcy5hdHRyKCJjbGFzcyIsYSkpO3JldHVybiB0aGlzfSxoYXNDbGFzczpmdW5jdGlvbihhKXtyZXR1cm4tMSE9PQ0KICAgICAgICB1KHRoaXMuZWxlbWVudCwiY2xhc3MiKS5pbmRleE9mKGEpfSxyZW1vdmVDbGFzczpmdW5jdGlvbihhKXt1KHRoaXMuZWxlbWVudCwiY2xhc3MiLCh1KHRoaXMuZWxlbWVudCwiY2xhc3MiKXx8IiIpLnJlcGxhY2UoYSwiIikpO3JldHVybiB0aGlzfSxzeW1ib2xBdHRyOmZ1bmN0aW9uKGEpe3ZhciB3PXRoaXM7SCgieCB5IHIgc3RhcnQgZW5kIHdpZHRoIGhlaWdodCBpbm5lclIgYW5jaG9yWCBhbmNob3JZIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGcpe3dbZ109SyhhW2ddLHdbZ10pfSk7dy5hdHRyKHtkOncucmVuZGVyZXIuc3ltYm9sc1t3LnN5bWJvbE5hbWVdKHcueCx3Lnksdy53aWR0aCx3LmhlaWdodCx3KX0pfSxjbGlwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmF0dHIoImNsaXAtcGF0aCIsYT8idXJsKCIrdGhpcy5yZW5kZXJlci51cmwrIiMiK2EuaWQrIikiOiJub25lIil9LGNyaXNwOmZ1bmN0aW9uKGEsZyl7dmFyIHcsZj17fSxiO2c9Z3x8YS5zdHJva2VXaWR0aHx8MDtiPU1hdGgucm91bmQoZyklDQogICAgICAgIDIvMjthLng9TWF0aC5mbG9vcihhLnh8fHRoaXMueHx8MCkrYjthLnk9TWF0aC5mbG9vcihhLnl8fHRoaXMueXx8MCkrYjthLndpZHRoPU1hdGguZmxvb3IoKGEud2lkdGh8fHRoaXMud2lkdGh8fDApLTIqYik7YS5oZWlnaHQ9TWF0aC5mbG9vcigoYS5oZWlnaHR8fHRoaXMuaGVpZ2h0fHwwKS0yKmIpO2soYS5zdHJva2VXaWR0aCkmJihhLnN0cm9rZVdpZHRoPWcpO2Zvcih3IGluIGEpdGhpc1t3XSE9PWFbd10mJih0aGlzW3ddPWZbd109YVt3XSk7cmV0dXJuIGZ9LGNzczpmdW5jdGlvbihhKXt2YXIgdz10aGlzLnN0eWxlcyxnPXt9LGY9dGhpcy5lbGVtZW50LGQscT0iIixjPSF3LEQ9WyJ0ZXh0T3ZlcmZsb3ciLCJ3aWR0aCJdO2EmJmEuY29sb3ImJihhLmZpbGw9YS5jb2xvcik7aWYodylmb3IoZCBpbiBhKWFbZF0hPT13W2RdJiYoZ1tkXT1hW2RdLGM9ITApO2lmKGMpe3cmJihhPWIodyxnKSk7dz10aGlzLnRleHRXaWR0aD1hJiZhLndpZHRoJiYiYXV0byIhPT1hLndpZHRoJiYidGV4dCI9PT0NCiAgICAgICAgZi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiZMKGEud2lkdGgpO3RoaXMuc3R5bGVzPWE7dyYmIVMmJnRoaXMucmVuZGVyZXIuZm9yRXhwb3J0JiZkZWxldGUgYS53aWR0aDtpZih5JiYhUyl0KHRoaXMuZWxlbWVudCxhKTtlbHNle3c9ZnVuY3Rpb24oYSx3KXtyZXR1cm4iLSIrdy50b0xvd2VyQ2FzZSgpfTtmb3IoZCBpbiBhKS0xPT09QShkLEQpJiYocSs9ZC5yZXBsYWNlKC8oW0EtWl0pL2csdykrIjoiK2FbZF0rIjsiKTtxJiZ1KGYsInN0eWxlIixxKX10aGlzLmFkZGVkJiYoInRleHQiPT09dGhpcy5lbGVtZW50Lm5vZGVOYW1lJiZ0aGlzLnJlbmRlcmVyLmJ1aWxkVGV4dCh0aGlzKSxhJiZhLnRleHRPdXRsaW5lJiZ0aGlzLmFwcGx5VGV4dE91dGxpbmUoYS50ZXh0T3V0bGluZSkpfXJldHVybiB0aGlzfSxzdHJva2VXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzWyJzdHJva2Utd2lkdGgiXXx8MH0sb246ZnVuY3Rpb24oYSxnKXt2YXIgdz10aGlzLGY9dy5lbGVtZW50O3ImJiJjbGljayI9PT0NCiAgICBhPyhmLm9udG91Y2hzdGFydD1mdW5jdGlvbihhKXt3LnRvdWNoRXZlbnRGaXJlZD1EYXRlLm5vdygpO2EucHJldmVudERlZmF1bHQoKTtnLmNhbGwoZixhKX0sZi5vbmNsaWNrPWZ1bmN0aW9uKGEpeygtMT09PU4ubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJBbmRyb2lkIil8fDExMDA8RGF0ZS5ub3coKS0ody50b3VjaEV2ZW50RmlyZWR8fDApKSYmZy5jYWxsKGYsYSl9KTpmWyJvbiIrYV09ZztyZXR1cm4gdGhpc30sc2V0UmFkaWFsUmVmZXJlbmNlOmZ1bmN0aW9uKGEpe3ZhciB3PXRoaXMucmVuZGVyZXIuZ3JhZGllbnRzW3RoaXMuZWxlbWVudC5ncmFkaWVudF07dGhpcy5lbGVtZW50LnJhZGlhbFJlZmVyZW5jZT1hO3cmJncucmFkQXR0ciYmdy5hbmltYXRlKHRoaXMucmVuZGVyZXIuZ2V0UmFkaWFsQXR0cihhLHcucmFkQXR0cikpO3JldHVybiB0aGlzfSx0cmFuc2xhdGU6ZnVuY3Rpb24oYSxnKXtyZXR1cm4gdGhpcy5hdHRyKHt0cmFuc2xhdGVYOmEsdHJhbnNsYXRlWTpnfSl9LA0KICAgICAgICBpbnZlcnQ6ZnVuY3Rpb24oYSl7dGhpcy5pbnZlcnRlZD1hO3RoaXMudXBkYXRlVHJhbnNmb3JtKCk7cmV0dXJuIHRoaXN9LHVwZGF0ZVRyYW5zZm9ybTpmdW5jdGlvbigpe3ZhciBhPXRoaXMudHJhbnNsYXRlWHx8MCxnPXRoaXMudHJhbnNsYXRlWXx8MCxmPXRoaXMuc2NhbGVYLGI9dGhpcy5zY2FsZVksZD10aGlzLmludmVydGVkLHE9dGhpcy5yb3RhdGlvbixjPXRoaXMuZWxlbWVudDtkJiYoYSs9dGhpcy53aWR0aCxnKz10aGlzLmhlaWdodCk7YT1bInRyYW5zbGF0ZSgiK2ErIiwiK2crIikiXTtkP2EucHVzaCgicm90YXRlKDkwKSBzY2FsZSgtMSwxKSIpOnEmJmEucHVzaCgicm90YXRlKCIrcSsiICIrKGMuZ2V0QXR0cmlidXRlKCJ4Iil8fDApKyIgIisoYy5nZXRBdHRyaWJ1dGUoInkiKXx8MCkrIikiKTsoayhmKXx8ayhiKSkmJmEucHVzaCgic2NhbGUoIitLKGYsMSkrIiAiK0soYiwxKSsiKSIpO2EubGVuZ3RoJiZjLnNldEF0dHJpYnV0ZSgidHJhbnNmb3JtIixhLmpvaW4oIiAiKSl9LA0KICAgICAgICB0b0Zyb250OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5lbGVtZW50O2EucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChhKTtyZXR1cm4gdGhpc30sYWxpZ246ZnVuY3Rpb24oYSxnLGYpe3ZhciB3LGIsZCxxLGM9e307Yj10aGlzLnJlbmRlcmVyO2Q9Yi5hbGlnbmVkT2JqZWN0czt2YXIgRCx5O2lmKGEpe2lmKHRoaXMuYWxpZ25PcHRpb25zPWEsdGhpcy5hbGlnbkJ5VHJhbnNsYXRlPWcsIWZ8fEYoZikpdGhpcy5hbGlnblRvPXc9Znx8InJlbmRlcmVyIixtKGQsdGhpcyksZC5wdXNoKHRoaXMpLGY9bnVsbH1lbHNlIGE9dGhpcy5hbGlnbk9wdGlvbnMsZz10aGlzLmFsaWduQnlUcmFuc2xhdGUsdz10aGlzLmFsaWduVG87Zj1LKGYsYlt3XSxiKTt3PWEuYWxpZ247Yj1hLnZlcnRpY2FsQWxpZ247ZD0oZi54fHwwKSsoYS54fHwwKTtxPShmLnl8fDApKyhhLnl8fDApOyJyaWdodCI9PT13P0Q9MToiY2VudGVyIj09PXcmJihEPTIpO0QmJihkKz0oZi53aWR0aC0oYS53aWR0aHx8MCkpL0QpO2NbZz8NCiAgICAgICAgInRyYW5zbGF0ZVgiOiJ4Il09TWF0aC5yb3VuZChkKTsiYm90dG9tIj09PWI/eT0xOiJtaWRkbGUiPT09YiYmKHk9Mik7eSYmKHErPShmLmhlaWdodC0oYS5oZWlnaHR8fDApKS95KTtjW2c/InRyYW5zbGF0ZVkiOiJ5Il09TWF0aC5yb3VuZChxKTt0aGlzW3RoaXMucGxhY2VkPyJhbmltYXRlIjoiYXR0ciJdKGMpO3RoaXMucGxhY2VkPSEwO3RoaXMuYWxpZ25BdHRyPWM7cmV0dXJuIHRoaXN9LGdldEJCb3g6ZnVuY3Rpb24oYSxnKXt2YXIgdyxmPXRoaXMucmVuZGVyZXIsZCxxPXRoaXMuZWxlbWVudCxjPXRoaXMuc3R5bGVzLEQseT10aGlzLnRleHRTdHIseCxyPWYuY2FjaGUsRz1mLmNhY2hlS2V5cyxtO2c9SyhnLHRoaXMucm90YXRpb24pO2Q9ZyplO0Q9YyYmYy5mb250U2l6ZTt2b2lkIDAhPT15JiYobT15LnRvU3RyaW5nKCksLTE9PT1tLmluZGV4T2YoIlx4M2MiKSYmKG09bS5yZXBsYWNlKC9bMC05XS9nLCIwIikpLG0rPVsiIixnfHwwLEQsYyYmYy53aWR0aCxjJiZjLnRleHRPdmVyZmxvd10uam9pbigpKTsNCiAgICAgICAgbSYmIWEmJih3PXJbbV0pO2lmKCF3KXtpZihxLm5hbWVzcGFjZVVSST09PXRoaXMuU1ZHX05TfHxmLmZvckV4cG9ydCl7dHJ5eyh4PXRoaXMuZmFrZVRTJiZmdW5jdGlvbihhKXtIKHEucXVlcnlTZWxlY3RvckFsbCgiLmhpZ2hjaGFydHMtdGV4dC1vdXRsaW5lIiksZnVuY3Rpb24odyl7dy5zdHlsZS5kaXNwbGF5PWF9KX0pJiZ4KCJub25lIiksdz1xLmdldEJCb3g/Yih7fSxxLmdldEJCb3goKSk6e3dpZHRoOnEub2Zmc2V0V2lkdGgsaGVpZ2h0OnEub2Zmc2V0SGVpZ2h0fSx4JiZ4KCIiKX1jYXRjaChYKXt9aWYoIXd8fDA+dy53aWR0aCl3PXt3aWR0aDowLGhlaWdodDowfX1lbHNlIHc9dGhpcy5odG1sR2V0QkJveCgpO2YuaXNTVkcmJihhPXcud2lkdGgsZj13LmhlaWdodCxjJiYiMTFweCI9PT1jLmZvbnRTaXplJiYxNz09PU1hdGgucm91bmQoZikmJih3LmhlaWdodD1mPTE0KSxnJiYody53aWR0aD1NYXRoLmFicyhmKk1hdGguc2luKGQpKStNYXRoLmFicyhhKk1hdGguY29zKGQpKSwNCiAgICAgICAgICAgIHcuaGVpZ2h0PU1hdGguYWJzKGYqTWF0aC5jb3MoZCkpK01hdGguYWJzKGEqTWF0aC5zaW4oZCkpKSk7aWYobSYmMDx3LmhlaWdodCl7Zm9yKDsyNTA8Ry5sZW5ndGg7KWRlbGV0ZSByW0cuc2hpZnQoKV07clttXXx8Ry5wdXNoKG0pO3JbbV09d319cmV0dXJuIHd9LHNob3c6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYXR0cih7dmlzaWJpbGl0eTphPyJpbmhlcml0IjoidmlzaWJsZSJ9KX0saGlkZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmF0dHIoe3Zpc2liaWxpdHk6ImhpZGRlbiJ9KX0sZmFkZU91dDpmdW5jdGlvbihhKXt2YXIgdz10aGlzO3cuYW5pbWF0ZSh7b3BhY2l0eTowfSx7ZHVyYXRpb246YXx8MTUwLGNvbXBsZXRlOmZ1bmN0aW9uKCl7dy5hdHRyKHt5Oi05OTk5fSl9fSl9LGFkZDpmdW5jdGlvbihhKXt2YXIgdz10aGlzLnJlbmRlcmVyLGc9dGhpcy5lbGVtZW50LGY7YSYmKHRoaXMucGFyZW50R3JvdXA9YSk7dGhpcy5wYXJlbnRJbnZlcnRlZD1hJiZhLmludmVydGVkOw0KICAgICAgICB2b2lkIDAhPT10aGlzLnRleHRTdHImJncuYnVpbGRUZXh0KHRoaXMpO3RoaXMuYWRkZWQ9ITA7aWYoIWF8fGEuaGFuZGxlWnx8dGhpcy56SW5kZXgpZj10aGlzLnpJbmRleFNldHRlcigpO2Z8fChhP2EuZWxlbWVudDp3LmJveCkuYXBwZW5kQ2hpbGQoZyk7aWYodGhpcy5vbkFkZCl0aGlzLm9uQWRkKCk7cmV0dXJuIHRoaXN9LHNhZmVSZW1vdmVDaGlsZDpmdW5jdGlvbihhKXt2YXIgdz1hLnBhcmVudE5vZGU7dyYmdy5yZW1vdmVDaGlsZChhKX0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZWxlbWVudHx8e30sZz10aGlzLnJlbmRlcmVyLmlzU1ZHJiYiU1BBTiI9PT1hLm5vZGVOYW1lJiZ0aGlzLnBhcmVudEdyb3VwLGYsYjthLm9uY2xpY2s9YS5vbm1vdXNlb3V0PWEub25tb3VzZW92ZXI9YS5vbm1vdXNlbW92ZT1hLnBvaW50PW51bGw7RCh0aGlzKTt0aGlzLmNsaXBQYXRoJiYodGhpcy5jbGlwUGF0aD10aGlzLmNsaXBQYXRoLmRlc3Ryb3koKSk7aWYodGhpcy5zdG9wcyl7Zm9yKGI9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDA7Yjx0aGlzLnN0b3BzLmxlbmd0aDtiKyspdGhpcy5zdG9wc1tiXT10aGlzLnN0b3BzW2JdLmRlc3Ryb3koKTt0aGlzLnN0b3BzPW51bGx9dGhpcy5zYWZlUmVtb3ZlQ2hpbGQoYSk7Zm9yKHRoaXMuZGVzdHJveVNoYWRvd3MoKTtnJiZnLmRpdiYmMD09PWcuZGl2LmNoaWxkTm9kZXMubGVuZ3RoOylhPWcucGFyZW50R3JvdXAsdGhpcy5zYWZlUmVtb3ZlQ2hpbGQoZy5kaXYpLGRlbGV0ZSBnLmRpdixnPWE7dGhpcy5hbGlnblRvJiZtKHRoaXMucmVuZGVyZXIuYWxpZ25lZE9iamVjdHMsdGhpcyk7Zm9yKGYgaW4gdGhpcylkZWxldGUgdGhpc1tmXTtyZXR1cm4gbnVsbH0sc2hhZG93OmZ1bmN0aW9uKGEsZyxmKXt2YXIgdz1bXSxiLGQsYz10aGlzLmVsZW1lbnQscSxELHkseDtpZighYSl0aGlzLmRlc3Ryb3lTaGFkb3dzKCk7ZWxzZSBpZighdGhpcy5zaGFkb3dzKXtEPUsoYS53aWR0aCwzKTt5PShhLm9wYWNpdHl8fC4xNSkvRDt4PXRoaXMucGFyZW50SW52ZXJ0ZWQ/IigtMSwtMSkiOg0KICAgICAgICAiKCIrSyhhLm9mZnNldFgsMSkrIiwgIitLKGEub2Zmc2V0WSwxKSsiKSI7Zm9yKGI9MTtiPD1EO2IrKylkPWMuY2xvbmVOb2RlKDApLHE9MipEKzEtMipiLHUoZCx7aXNTaGFkb3c6InRydWUiLHN0cm9rZTphLmNvbG9yfHwiIzAwMDAwMCIsInN0cm9rZS1vcGFjaXR5Ijp5KmIsInN0cm9rZS13aWR0aCI6cSx0cmFuc2Zvcm06InRyYW5zbGF0ZSIreCxmaWxsOiJub25lIn0pLGYmJih1KGQsImhlaWdodCIsTWF0aC5tYXgodShkLCJoZWlnaHQiKS1xLDApKSxkLmN1dEhlaWdodD1xKSxnP2cuZWxlbWVudC5hcHBlbmRDaGlsZChkKTpjLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGQsYyksdy5wdXNoKGQpO3RoaXMuc2hhZG93cz13fXJldHVybiB0aGlzfSxkZXN0cm95U2hhZG93czpmdW5jdGlvbigpe0godGhpcy5zaGFkb3dzfHxbXSxmdW5jdGlvbihhKXt0aGlzLnNhZmVSZW1vdmVDaGlsZChhKX0sdGhpcyk7dGhpcy5zaGFkb3dzPXZvaWQgMH0seEdldHRlcjpmdW5jdGlvbihhKXsiY2lyY2xlIj09PQ0KICAgIHRoaXMuZWxlbWVudC5ub2RlTmFtZSYmKCJ4Ij09PWE/YT0iY3giOiJ5Ij09PWEmJihhPSJjeSIpKTtyZXR1cm4gdGhpcy5fZGVmYXVsdEdldHRlcihhKX0sX2RlZmF1bHRHZXR0ZXI6ZnVuY3Rpb24oYSl7YT1LKHRoaXNbYV0sdGhpcy5lbGVtZW50P3RoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYSk6bnVsbCwwKTsvXltcLTAtOVwuXSskLy50ZXN0KGEpJiYoYT1wYXJzZUZsb2F0KGEpKTtyZXR1cm4gYX0sZFNldHRlcjpmdW5jdGlvbihhLGcsZil7YSYmYS5qb2luJiYoYT1hLmpvaW4oIiAiKSk7LyhOYU58IHsyfXxeJCkvLnRlc3QoYSkmJihhPSJNIDAgMCIpO2Yuc2V0QXR0cmlidXRlKGcsYSk7dGhpc1tnXT1hfSxkYXNoc3R5bGVTZXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIHcsZz10aGlzWyJzdHJva2Utd2lkdGgiXTsiaW5oZXJpdCI9PT1nJiYoZz0xKTtpZihhPWEmJmEudG9Mb3dlckNhc2UoKSl7YT1hLnJlcGxhY2UoInNob3J0ZGFzaGRvdGRvdCIsIjMsMSwxLDEsMSwxLCIpLnJlcGxhY2UoInNob3J0ZGFzaGRvdCIsDQogICAgICAgICIzLDEsMSwxIikucmVwbGFjZSgic2hvcnRkb3QiLCIxLDEsIikucmVwbGFjZSgic2hvcnRkYXNoIiwiMywxLCIpLnJlcGxhY2UoImxvbmdkYXNoIiwiOCwzLCIpLnJlcGxhY2UoL2RvdC9nLCIxLDMsIikucmVwbGFjZSgiZGFzaCIsIjQsMywiKS5yZXBsYWNlKC8sJC8sIiIpLnNwbGl0KCIsIik7Zm9yKHc9YS5sZW5ndGg7dy0tOylhW3ddPUwoYVt3XSkqZzthPWEuam9pbigiLCIpLnJlcGxhY2UoL05hTi9nLCJub25lIik7dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgic3Ryb2tlLWRhc2hhcnJheSIsYSl9fSxhbGlnblNldHRlcjpmdW5jdGlvbihhKXt0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCJ0ZXh0LWFuY2hvciIse2xlZnQ6InN0YXJ0IixjZW50ZXI6Im1pZGRsZSIscmlnaHQ6ImVuZCJ9W2FdKX0sb3BhY2l0eVNldHRlcjpmdW5jdGlvbihhLGcsZil7dGhpc1tnXT1hO2Yuc2V0QXR0cmlidXRlKGcsYSl9LHRpdGxlU2V0dGVyOmZ1bmN0aW9uKGEpe3ZhciB3PXRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGl0bGUiKVswXTsNCiAgICAgICAgd3x8KHc9cC5jcmVhdGVFbGVtZW50TlModGhpcy5TVkdfTlMsInRpdGxlIiksdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHcpKTt3LmZpcnN0Q2hpbGQmJncucmVtb3ZlQ2hpbGQody5maXJzdENoaWxkKTt3LmFwcGVuZENoaWxkKHAuY3JlYXRlVGV4dE5vZGUoU3RyaW5nKEsoYSksIiIpLnJlcGxhY2UoLzxbXj5dKj4vZywiIikpKX0sdGV4dFNldHRlcjpmdW5jdGlvbihhKXthIT09dGhpcy50ZXh0U3RyJiYoZGVsZXRlIHRoaXMuYkJveCx0aGlzLnRleHRTdHI9YSx0aGlzLmFkZGVkJiZ0aGlzLnJlbmRlcmVyLmJ1aWxkVGV4dCh0aGlzKSl9LGZpbGxTZXR0ZXI6ZnVuY3Rpb24oYSxnLGYpeyJzdHJpbmciPT09dHlwZW9mIGE/Zi5zZXRBdHRyaWJ1dGUoZyxhKTphJiZ0aGlzLmNvbG9yR3JhZGllbnQoYSxnLGYpfSx2aXNpYmlsaXR5U2V0dGVyOmZ1bmN0aW9uKGEsZyxmKXsiaW5oZXJpdCI9PT1hP2YucmVtb3ZlQXR0cmlidXRlKGcpOmYuc2V0QXR0cmlidXRlKGcsYSl9LHpJbmRleFNldHRlcjpmdW5jdGlvbihhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcpe3ZhciB3PXRoaXMucmVuZGVyZXIsZj10aGlzLnBhcmVudEdyb3VwLGI9KGZ8fHcpLmVsZW1lbnR8fHcuYm94LGQsYz10aGlzLmVsZW1lbnQscTtkPXRoaXMuYWRkZWQ7dmFyIEQ7ayhhKSYmKGMuekluZGV4PWEsYT0rYSx0aGlzW2ddPT09YSYmKGQ9ITEpLHRoaXNbZ109YSk7aWYoZCl7KGE9dGhpcy56SW5kZXgpJiZmJiYoZi5oYW5kbGVaPSEwKTtnPWIuY2hpbGROb2Rlcztmb3IoRD0wO0Q8Zy5sZW5ndGgmJiFxO0QrKylmPWdbRF0sZD1mLnpJbmRleCxmIT09YyYmKEwoZCk+YXx8IWsoYSkmJmsoZCl8fDA+YSYmIWsoZCkmJmIhPT13LmJveCkmJihiLmluc2VydEJlZm9yZShjLGYpLHE9ITApO3F8fGIuYXBwZW5kQ2hpbGQoYyl9cmV0dXJuIHF9LF9kZWZhdWx0U2V0dGVyOmZ1bmN0aW9uKGEsZyxmKXtmLnNldEF0dHJpYnV0ZShnLGEpfX07Qi5wcm90b3R5cGUueUdldHRlcj1CLnByb3RvdHlwZS54R2V0dGVyO0IucHJvdG90eXBlLnRyYW5zbGF0ZVhTZXR0ZXI9Qi5wcm90b3R5cGUudHJhbnNsYXRlWVNldHRlcj0NCiAgICBCLnByb3RvdHlwZS5yb3RhdGlvblNldHRlcj1CLnByb3RvdHlwZS52ZXJ0aWNhbEFsaWduU2V0dGVyPUIucHJvdG90eXBlLnNjYWxlWFNldHRlcj1CLnByb3RvdHlwZS5zY2FsZVlTZXR0ZXI9ZnVuY3Rpb24oYSxnKXt0aGlzW2ddPWE7dGhpcy5kb1RyYW5zZm9ybT0hMH07Qi5wcm90b3R5cGVbInN0cm9rZS13aWR0aFNldHRlciJdPUIucHJvdG90eXBlLnN0cm9rZVNldHRlcj1mdW5jdGlvbihhLGcsZil7dGhpc1tnXT1hO3RoaXMuc3Ryb2tlJiZ0aGlzWyJzdHJva2Utd2lkdGgiXT8oQi5wcm90b3R5cGUuZmlsbFNldHRlci5jYWxsKHRoaXMsdGhpcy5zdHJva2UsInN0cm9rZSIsZiksZi5zZXRBdHRyaWJ1dGUoInN0cm9rZS13aWR0aCIsdGhpc1sic3Ryb2tlLXdpZHRoIl0pLHRoaXMuaGFzU3Ryb2tlPSEwKToic3Ryb2tlLXdpZHRoIj09PWcmJjA9PT1hJiZ0aGlzLmhhc1N0cm9rZSYmKGYucmVtb3ZlQXR0cmlidXRlKCJzdHJva2UiKSx0aGlzLmhhc1N0cm9rZT0hMSl9O3o9YS5TVkdSZW5kZXJlcj0NCiAgICBmdW5jdGlvbigpe3RoaXMuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3oucHJvdG90eXBlPXtFbGVtZW50OkIsU1ZHX05TOk0saW5pdDpmdW5jdGlvbihhLGcsYixkLGMsRCl7dmFyIHc7ZD10aGlzLmNyZWF0ZUVsZW1lbnQoInN2ZyIpLmF0dHIoe3ZlcnNpb246IjEuMSIsImNsYXNzIjoiaGlnaGNoYXJ0cy1yb290In0pLmNzcyh0aGlzLmdldFN0eWxlKGQpKTt3PWQuZWxlbWVudDthLmFwcGVuZENoaWxkKHcpOy0xPT09YS5pbm5lckhUTUwuaW5kZXhPZigieG1sbnMiKSYmdSh3LCJ4bWxucyIsdGhpcy5TVkdfTlMpO3RoaXMuaXNTVkc9ITA7dGhpcy5ib3g9dzt0aGlzLmJveFdyYXBwZXI9ZDt0aGlzLmFsaWduZWRPYmplY3RzPVtdO3RoaXMudXJsPShmfHxxKSYmcC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYmFzZSIpLmxlbmd0aD9OLmxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qPyQvLCIiKS5yZXBsYWNlKC88W14+XSo+L2csIiIpLnJlcGxhY2UoLyhbXCgnXCldKS9nLCJcXCQxIikucmVwbGFjZSgvIC9nLA0KICAgICAgICAiJTIwIik6IiI7dGhpcy5jcmVhdGVFbGVtZW50KCJkZXNjIikuYWRkKCkuZWxlbWVudC5hcHBlbmRDaGlsZChwLmNyZWF0ZVRleHROb2RlKCJDcmVhdGVkIHdpdGggSGlnaGNoYXJ0cyA1LjAuOSIpKTt0aGlzLmRlZnM9dGhpcy5jcmVhdGVFbGVtZW50KCJkZWZzIikuYWRkKCk7dGhpcy5hbGxvd0hUTUw9RDt0aGlzLmZvckV4cG9ydD1jO3RoaXMuZ3JhZGllbnRzPXt9O3RoaXMuY2FjaGU9e307dGhpcy5jYWNoZUtleXM9W107dGhpcy5pbWdDb3VudD0wO3RoaXMuc2V0U2l6ZShnLGIsITEpO3ZhciB5O2YmJmEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0JiYoZz1mdW5jdGlvbigpe3QoYSx7bGVmdDowLHRvcDowfSk7eT1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3QoYSx7bGVmdDpNYXRoLmNlaWwoeS5sZWZ0KS15LmxlZnQrInB4Iix0b3A6TWF0aC5jZWlsKHkudG9wKS15LnRvcCsicHgifSl9LGcoKSx0aGlzLnVuU3ViUGl4ZWxGaXg9QyhOLCJyZXNpemUiLGcpKX0sZ2V0U3R5bGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc3R5bGU9DQogICAgYih7Zm9udEZhbWlseTonIkx1Y2lkYSBHcmFuZGUiLCAiTHVjaWRhIFNhbnMgVW5pY29kZSIsIEFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWYnLGZvbnRTaXplOiIxMnB4In0sYSl9LHNldFN0eWxlOmZ1bmN0aW9uKGEpe3RoaXMuYm94V3JhcHBlci5jc3ModGhpcy5nZXRTdHlsZShhKSl9LGlzSGlkZGVuOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuYm94V3JhcHBlci5nZXRCQm94KCkud2lkdGh9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmRlZnM7dGhpcy5ib3g9bnVsbDt0aGlzLmJveFdyYXBwZXI9dGhpcy5ib3hXcmFwcGVyLmRlc3Ryb3koKTtjKHRoaXMuZ3JhZGllbnRzfHx7fSk7dGhpcy5ncmFkaWVudHM9bnVsbDthJiYodGhpcy5kZWZzPWEuZGVzdHJveSgpKTt0aGlzLnVuU3ViUGl4ZWxGaXgmJnRoaXMudW5TdWJQaXhlbEZpeCgpO3JldHVybiB0aGlzLmFsaWduZWRPYmplY3RzPW51bGx9LGNyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24oYSl7dmFyIGc9bmV3IHRoaXMuRWxlbWVudDsNCiAgICBnLmluaXQodGhpcyxhKTtyZXR1cm4gZ30sZHJhdzpKLGdldFJhZGlhbEF0dHI6ZnVuY3Rpb24oYSxnKXtyZXR1cm57Y3g6YVswXS1hWzJdLzIrZy5jeCphWzJdLGN5OmFbMV0tYVsyXS8yK2cuY3kqYVsyXSxyOmcuciphWzJdfX0sYnVpbGRUZXh0OmZ1bmN0aW9uKGEpe3ZhciBnPWEuZWxlbWVudCxmPXRoaXMsdz1mLmZvckV4cG9ydCxiPUsoYS50ZXh0U3RyLCIiKS50b1N0cmluZygpLGM9LTEhPT1iLmluZGV4T2YoIlx4M2MiKSxxPWcuY2hpbGROb2RlcyxELHkseCxyLEc9dShnLCJ4IiksbT1hLnN0eWxlcyxlPWEudGV4dFdpZHRoLGw9bSYmbS5saW5lSGVpZ2h0LHY9bSYmbS50ZXh0T3V0bGluZSxrPW0mJiJlbGxpcHNpcyI9PT1tLnRleHRPdmVyZmxvdyxoPW0mJiJub3dyYXAiPT09bS53aGl0ZVNwYWNlLEY9bSYmbS5mb250U2l6ZSxBLEo9cS5sZW5ndGgsbT1lJiYhYS5hZGRlZCYmdGhpcy5ib3gsbj1mdW5jdGlvbihhKXt2YXIgdzt3PS8ocHh8ZW0pJC8udGVzdChhJiZhLnN0eWxlLmZvbnRTaXplKT8NCiAgICBhLnN0eWxlLmZvbnRTaXplOkZ8fGYuc3R5bGUuZm9udFNpemV8fDEyO3JldHVybiBsP0wobCk6Zi5mb250TWV0cmljcyh3LGEuZ2V0QXR0cmlidXRlKCJzdHlsZSIpP2E6ZykuaH07QT1bYixrLGgsbCx2LEYsZV0uam9pbigpO2lmKEEhPT1hLnRleHRDYWNoZSl7Zm9yKGEudGV4dENhY2hlPUE7Si0tOylnLnJlbW92ZUNoaWxkKHFbSl0pO2N8fHZ8fGt8fGV8fC0xIT09Yi5pbmRleE9mKCIgIik/KEQ9LzwuKmNsYXNzPSIoW14iXSspIi4qPi8seT0vPC4qc3R5bGU9IihbXiJdKykiLio+Lyx4PS88LipocmVmPSIoaHR0cFteIl0rKSIuKj4vLG0mJm0uYXBwZW5kQ2hpbGQoZyksYj1jP2IucmVwbGFjZSgvPChifHN0cm9uZyk+L2csJ1x4M2NzcGFuIHN0eWxlXHgzZCJmb250LXdlaWdodDpib2xkIlx4M2UnKS5yZXBsYWNlKC88KGl8ZW0pPi9nLCdceDNjc3BhbiBzdHlsZVx4M2QiZm9udC1zdHlsZTppdGFsaWMiXHgzZScpLnJlcGxhY2UoLzxhL2csIlx4M2NzcGFuIikucmVwbGFjZSgvPFwvKGJ8c3Ryb25nfGl8ZW18YSk+L2csDQogICAgICAgICAgICAiXHgzYy9zcGFuXHgzZSIpLnNwbGl0KC88YnIuKj8+L2cpOltiXSxiPWQoYixmdW5jdGlvbihhKXtyZXR1cm4iIiE9PWF9KSxIKGIsZnVuY3Rpb24oYixkKXt2YXIgYyxxPTA7Yj1iLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKS5yZXBsYWNlKC88c3Bhbi9nLCJ8fHxceDNjc3BhbiIpLnJlcGxhY2UoLzxcL3NwYW4+L2csIlx4M2Mvc3Bhblx4M2V8fHwiKTtjPWIuc3BsaXQoInx8fCIpO0goYyxmdW5jdGlvbihiKXtpZigiIiE9PWJ8fDE9PT1jLmxlbmd0aCl7dmFyIG09e30sdj1wLmNyZWF0ZUVsZW1lbnROUyhmLlNWR19OUywidHNwYW4iKSxsLEY7RC50ZXN0KGIpJiYobD1iLm1hdGNoKEQpWzFdLHUodiwiY2xhc3MiLGwpKTt5LnRlc3QoYikmJihGPWIubWF0Y2goeSlbMV0ucmVwbGFjZSgvKDt8IHxeKWNvbG9yKFsgOl0pLywiJDFmaWxsJDIiKSx1KHYsInN0eWxlIixGKSk7eC50ZXN0KGIpJiYhdyYmKHUodiwib25jbGljayIsJ2xvY2F0aW9uLmhyZWZceDNkIicrYi5tYXRjaCh4KVsxXSsNCiAgICAgICAgJyInKSx0KHYse2N1cnNvcjoicG9pbnRlciJ9KSk7Yj0oYi5yZXBsYWNlKC88KC58XG4pKj8+L2csIiIpfHwiICIpLnJlcGxhY2UoLyZsdDsvZywiXHgzYyIpLnJlcGxhY2UoLyZndDsvZywiXHgzZSIpO2lmKCIgIiE9PWIpe3YuYXBwZW5kQ2hpbGQocC5jcmVhdGVUZXh0Tm9kZShiKSk7cT9tLmR4PTA6ZCYmbnVsbCE9PUcmJihtLng9Ryk7dSh2LG0pO2cuYXBwZW5kQ2hpbGQodik7IXEmJmQmJighUyYmdyYmdCh2LHtkaXNwbGF5OiJibG9jayJ9KSx1KHYsImR5IixuKHYpKSk7aWYoZSl7bT1iLnJlcGxhY2UoLyhbXlxeXSktL2csIiQxLSAiKS5zcGxpdCgiICIpO2w9MTxjLmxlbmd0aHx8ZHx8MTxtLmxlbmd0aCYmIWg7Zm9yKHZhciBBLEgsTz1bXSxKPW4odiksSz1hLnJvdGF0aW9uLEw9YixQPUwubGVuZ3RoOyhsfHxrKSYmKG0ubGVuZ3RofHxPLmxlbmd0aCk7KWEucm90YXRpb249MCxBPWEuZ2V0QkJveCghMCksSD1BLndpZHRoLCFTJiZmLmZvckV4cG9ydCYmKEg9Zi5tZWFzdXJlU3BhbldpZHRoKHYuZmlyc3RDaGlsZC5kYXRhLA0KICAgICAgICBhLnN0eWxlcykpLEE9SD5lLHZvaWQgMD09PXImJihyPUEpLGsmJnI/KFAvPTIsIiI9PT1MfHwhQSYmLjU+UD9tPVtdOihMPWIuc3Vic3RyaW5nKDAsTC5sZW5ndGgrKEE/LTE6MSkqTWF0aC5jZWlsKFApKSxtPVtMKygzPGU/Ilx1MjAyNiI6IiIpXSx2LnJlbW92ZUNoaWxkKHYuZmlyc3RDaGlsZCkpKTpBJiYxIT09bS5sZW5ndGg/KHYucmVtb3ZlQ2hpbGQodi5maXJzdENoaWxkKSxPLnVuc2hpZnQobS5wb3AoKSkpOihtPU8sTz1bXSxtLmxlbmd0aCYmIWgmJih2PXAuY3JlYXRlRWxlbWVudE5TKE0sInRzcGFuIiksdSh2LHtkeTpKLHg6R30pLEYmJnUodiwic3R5bGUiLEYpLGcuYXBwZW5kQ2hpbGQodikpLEg+ZSYmKGU9SCkpLG0ubGVuZ3RoJiZ2LmFwcGVuZENoaWxkKHAuY3JlYXRlVGV4dE5vZGUobS5qb2luKCIgIikucmVwbGFjZSgvLSAvZywiLSIpKSk7YS5yb3RhdGlvbj1LfXErK319fSl9KSxyJiZhLmF0dHIoInRpdGxlIixhLnRleHRTdHIpLG0mJm0ucmVtb3ZlQ2hpbGQoZyksDQogICAgdiYmYS5hcHBseVRleHRPdXRsaW5lJiZhLmFwcGx5VGV4dE91dGxpbmUodikpOmcuYXBwZW5kQ2hpbGQocC5jcmVhdGVUZXh0Tm9kZShiLnJlcGxhY2UoLyZsdDsvZywiXHgzYyIpLnJlcGxhY2UoLyZndDsvZywiXHgzZSIpKSl9fSxnZXRDb250cmFzdDpmdW5jdGlvbihhKXthPW4oYSkucmdiYTtyZXR1cm4gNTEwPGFbMF0rYVsxXSthWzJdPyIjMDAwMDAwIjoiI0ZGRkZGRiJ9LGJ1dHRvbjpmdW5jdGlvbihhLGcsZixkLGMscSxELG0scil7dmFyIHc9dGhpcy5sYWJlbChhLGcsZixyLG51bGwsbnVsbCxudWxsLG51bGwsImJ1dHRvbiIpLEc9MDt3LmF0dHIoeCh7cGFkZGluZzo4LHI6Mn0sYykpO3ZhciBlLHYscCxsO2M9eCh7ZmlsbDoiI2Y3ZjdmNyIsc3Ryb2tlOiIjY2NjY2NjIiwic3Ryb2tlLXdpZHRoIjoxLHN0eWxlOntjb2xvcjoiIzMzMzMzMyIsY3Vyc29yOiJwb2ludGVyIixmb250V2VpZ2h0OiJub3JtYWwifX0sYyk7ZT1jLnN0eWxlO2RlbGV0ZSBjLnN0eWxlO3E9eChjLHtmaWxsOiIjZTZlNmU2In0sDQogICAgcSk7dj1xLnN0eWxlO2RlbGV0ZSBxLnN0eWxlO0Q9eChjLHtmaWxsOiIjZTZlYmY1IixzdHlsZTp7Y29sb3I6IiMwMDAwMDAiLGZvbnRXZWlnaHQ6ImJvbGQifX0sRCk7cD1ELnN0eWxlO2RlbGV0ZSBELnN0eWxlO209eChjLHtzdHlsZTp7Y29sb3I6IiNjY2NjY2MifX0sbSk7bD1tLnN0eWxlO2RlbGV0ZSBtLnN0eWxlO0Mody5lbGVtZW50LHk/Im1vdXNlb3ZlciI6Im1vdXNlZW50ZXIiLGZ1bmN0aW9uKCl7MyE9PUcmJncuc2V0U3RhdGUoMSl9KTtDKHcuZWxlbWVudCx5PyJtb3VzZW91dCI6Im1vdXNlbGVhdmUiLGZ1bmN0aW9uKCl7MyE9PUcmJncuc2V0U3RhdGUoRyl9KTt3LnNldFN0YXRlPWZ1bmN0aW9uKGEpezEhPT1hJiYody5zdGF0ZT1HPWEpO3cucmVtb3ZlQ2xhc3MoL2hpZ2hjaGFydHMtYnV0dG9uLShub3JtYWx8aG92ZXJ8cHJlc3NlZHxkaXNhYmxlZCkvKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1idXR0b24tIitbIm5vcm1hbCIsImhvdmVyIiwicHJlc3NlZCIsImRpc2FibGVkIl1bYXx8DQogICAgMF0pO3cuYXR0cihbYyxxLEQsbV1bYXx8MF0pLmNzcyhbZSx2LHAsbF1bYXx8MF0pfTt3LmF0dHIoYykuY3NzKGIoe2N1cnNvcjoiZGVmYXVsdCJ9LGUpKTtyZXR1cm4gdy5vbigiY2xpY2siLGZ1bmN0aW9uKGEpezMhPT1HJiZkLmNhbGwodyxhKX0pfSxjcmlzcExpbmU6ZnVuY3Rpb24oYSxnKXthWzFdPT09YVs0XSYmKGFbMV09YVs0XT1NYXRoLnJvdW5kKGFbMV0pLWclMi8yKTthWzJdPT09YVs1XSYmKGFbMl09YVs1XT1NYXRoLnJvdW5kKGFbMl0pK2clMi8yKTtyZXR1cm4gYX0scGF0aDpmdW5jdGlvbihhKXt2YXIgZz17ZmlsbDoibm9uZSJ9O3YoYSk/Zy5kPWE6RyhhKSYmYihnLGEpO3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnQoInBhdGgiKS5hdHRyKGcpfSxjaXJjbGU6ZnVuY3Rpb24oYSxnLGYpe2E9RyhhKT9hOnt4OmEseTpnLHI6Zn07Zz10aGlzLmNyZWF0ZUVsZW1lbnQoImNpcmNsZSIpO2cueFNldHRlcj1nLnlTZXR0ZXI9ZnVuY3Rpb24oYSxnLGYpe2Yuc2V0QXR0cmlidXRlKCJjIisNCiAgICBnLGEpfTtyZXR1cm4gZy5hdHRyKGEpfSxhcmM6ZnVuY3Rpb24oYSxnLGYsYixkLGMpe0coYSk/KGI9YSxnPWIueSxmPWIucixhPWIueCk6Yj17aW5uZXJSOmIsc3RhcnQ6ZCxlbmQ6Y307YT10aGlzLnN5bWJvbCgiYXJjIixhLGcsZixmLGIpO2Eucj1mO3JldHVybiBhfSxyZWN0OmZ1bmN0aW9uKGEsZyxmLGIsZCxjKXtkPUcoYSk/YS5yOmQ7dmFyIHc9dGhpcy5jcmVhdGVFbGVtZW50KCJyZWN0Iik7YT1HKGEpP2E6dm9pZCAwPT09YT97fTp7eDphLHk6Zyx3aWR0aDpNYXRoLm1heChmLDApLGhlaWdodDpNYXRoLm1heChiLDApfTt2b2lkIDAhPT1jJiYoYS5zdHJva2VXaWR0aD1jLGE9dy5jcmlzcChhKSk7YS5maWxsPSJub25lIjtkJiYoYS5yPWQpO3cuclNldHRlcj1mdW5jdGlvbihhLGcsZil7dShmLHtyeDphLHJ5OmF9KX07cmV0dXJuIHcuYXR0cihhKX0sc2V0U2l6ZTpmdW5jdGlvbihhLGcsZil7dmFyIGI9dGhpcy5hbGlnbmVkT2JqZWN0cyxkPWIubGVuZ3RoO3RoaXMud2lkdGg9DQogICAgYTt0aGlzLmhlaWdodD1nO2Zvcih0aGlzLmJveFdyYXBwZXIuYW5pbWF0ZSh7d2lkdGg6YSxoZWlnaHQ6Z30se3N0ZXA6ZnVuY3Rpb24oKXt0aGlzLmF0dHIoe3ZpZXdCb3g6IjAgMCAiK3RoaXMuYXR0cigid2lkdGgiKSsiICIrdGhpcy5hdHRyKCJoZWlnaHQiKX0pfSxkdXJhdGlvbjpLKGYsITApP3ZvaWQgMDowfSk7ZC0tOyliW2RdLmFsaWduKCl9LGc6ZnVuY3Rpb24oYSl7dmFyIGc9dGhpcy5jcmVhdGVFbGVtZW50KCJnIik7cmV0dXJuIGE/Zy5hdHRyKHsiY2xhc3MiOiJoaWdoY2hhcnRzLSIrYX0pOmd9LGltYWdlOmZ1bmN0aW9uKGEsZyxmLGQsYyl7dmFyIHc9e3ByZXNlcnZlQXNwZWN0UmF0aW86Im5vbmUifTsxPGFyZ3VtZW50cy5sZW5ndGgmJmIodyx7eDpnLHk6Zix3aWR0aDpkLGhlaWdodDpjfSk7dz10aGlzLmNyZWF0ZUVsZW1lbnQoImltYWdlIikuYXR0cih3KTt3LmVsZW1lbnQuc2V0QXR0cmlidXRlTlM/dy5lbGVtZW50LnNldEF0dHJpYnV0ZU5TKCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiwNCiAgICAgICAgImhyZWYiLGEpOncuZWxlbWVudC5zZXRBdHRyaWJ1dGUoImhjLXN2Zy1ocmVmIixhKTtyZXR1cm4gd30sc3ltYm9sOmZ1bmN0aW9uKGEsZyxmLGQsYyxxKXt2YXIgdz10aGlzLEQseT10aGlzLnN5bWJvbHNbYV0sbT1rKGcpJiZ5JiZ0aGlzLnN5bWJvbHNbYV0oTWF0aC5yb3VuZChnKSxNYXRoLnJvdW5kKGYpLGQsYyxxKSx4PS9edXJsXCgoLio/KVwpJC8sRyxyO3k/KEQ9dGhpcy5wYXRoKG0pLEQuYXR0cigiZmlsbCIsIm5vbmUiKSxiKEQse3N5bWJvbE5hbWU6YSx4OmcseTpmLHdpZHRoOmQsaGVpZ2h0OmN9KSxxJiZiKEQscSkpOngudGVzdChhKSYmKEc9YS5tYXRjaCh4KVsxXSxEPXRoaXMuaW1hZ2UoRyksRC5pbWd3aWR0aD1LKFJbR10mJlJbR10ud2lkdGgscSYmcS53aWR0aCksRC5pbWdoZWlnaHQ9SyhSW0ddJiZSW0ddLmhlaWdodCxxJiZxLmhlaWdodCkscj1mdW5jdGlvbigpe0QuYXR0cih7d2lkdGg6RC53aWR0aCxoZWlnaHQ6RC5oZWlnaHR9KX0sSChbIndpZHRoIiwiaGVpZ2h0Il0sDQogICAgICAgIGZ1bmN0aW9uKGEpe0RbYSsiU2V0dGVyIl09ZnVuY3Rpb24oYSxnKXt2YXIgZj17fSxiPXRoaXNbImltZyIrZ10sZD0id2lkdGgiPT09Zz8idHJhbnNsYXRlWCI6InRyYW5zbGF0ZVkiO3RoaXNbZ109YTtrKGIpJiYodGhpcy5lbGVtZW50JiZ0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGcsYiksdGhpcy5hbGlnbkJ5VHJhbnNsYXRlfHwoZltkXT0oKHRoaXNbZ118fDApLWIpLzIsdGhpcy5hdHRyKGYpKSl9fSksayhnKSYmRC5hdHRyKHt4OmcseTpmfSksRC5pc0ltZz0hMCxrKEQuaW1nd2lkdGgpJiZrKEQuaW1naGVpZ2h0KT9yKCk6KEQuYXR0cih7d2lkdGg6MCxoZWlnaHQ6MH0pLGwoImltZyIse29ubG9hZDpmdW5jdGlvbigpe3ZhciBhPWhbdy5jaGFydEluZGV4XTswPT09dGhpcy53aWR0aCYmKHQodGhpcyx7cG9zaXRpb246ImFic29sdXRlIix0b3A6Ii05OTllbSJ9KSxwLmJvZHkuYXBwZW5kQ2hpbGQodGhpcykpO1JbR109e3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fTsNCiAgICAgICAgICAgIEQuaW1nd2lkdGg9dGhpcy53aWR0aDtELmltZ2hlaWdodD10aGlzLmhlaWdodDtELmVsZW1lbnQmJnIoKTt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzKTt3LmltZ0NvdW50LS07aWYoIXcuaW1nQ291bnQmJmEmJmEub25sb2FkKWEub25sb2FkKCl9LHNyYzpHfSksdGhpcy5pbWdDb3VudCsrKSk7cmV0dXJuIER9LHN5bWJvbHM6e2NpcmNsZTpmdW5jdGlvbihhLGcsZixiKXtyZXR1cm4gdGhpcy5hcmMoYStmLzIsZytiLzIsZi8yLGIvMix7c3RhcnQ6MCxlbmQ6MipNYXRoLlBJLG9wZW46ITF9KX0sc3F1YXJlOmZ1bmN0aW9uKGEsZyxmLGIpe3JldHVyblsiTSIsYSxnLCJMIixhK2YsZyxhK2YsZytiLGEsZytiLCJaIl19LHRyaWFuZ2xlOmZ1bmN0aW9uKGEsZyxmLGIpe3JldHVyblsiTSIsYStmLzIsZywiTCIsYStmLGcrYixhLGcrYiwiWiJdfSwidHJpYW5nbGUtZG93biI6ZnVuY3Rpb24oYSxnLGYsYil7cmV0dXJuWyJNIixhLGcsIkwiLGErZiwNCiAgICBnLGErZi8yLGcrYiwiWiJdfSxkaWFtb25kOmZ1bmN0aW9uKGEsZyxmLGIpe3JldHVyblsiTSIsYStmLzIsZywiTCIsYStmLGcrYi8yLGErZi8yLGcrYixhLGcrYi8yLCJaIl19LGFyYzpmdW5jdGlvbihhLGcsZixiLGQpe3ZhciBjPWQuc3RhcnQsdz1kLnJ8fGYscT1kLnJ8fGJ8fGYsRD1kLmVuZC0uMDAxO2Y9ZC5pbm5lclI7Yj1kLm9wZW47dmFyIHk9TWF0aC5jb3MoYyksbT1NYXRoLnNpbihjKSx4PU1hdGguY29zKEQpLEQ9TWF0aC5zaW4oRCk7ZD1kLmVuZC1jPE1hdGguUEk/MDoxO3c9WyJNIixhK3cqeSxnK3EqbSwiQSIsdyxxLDAsZCwxLGErdyp4LGcrcSpEXTtrKGYpJiZ3LnB1c2goYj8iTSI6IkwiLGErZip4LGcrZipELCJBIixmLGYsMCxkLDAsYStmKnksZytmKm0pO3cucHVzaChiPyIiOiJaIik7cmV0dXJuIHd9LGNhbGxvdXQ6ZnVuY3Rpb24oYSxnLGYsYixkKXt2YXIgYz1NYXRoLm1pbihkJiZkLnJ8fDAsZixiKSxxPWMrNixEPWQmJmQuYW5jaG9yWDtkPWQmJmQuYW5jaG9yWTsNCiAgICB2YXIgdzt3PVsiTSIsYStjLGcsIkwiLGErZi1jLGcsIkMiLGErZixnLGErZixnLGErZixnK2MsIkwiLGErZixnK2ItYywiQyIsYStmLGcrYixhK2YsZytiLGErZi1jLGcrYiwiTCIsYStjLGcrYiwiQyIsYSxnK2IsYSxnK2IsYSxnK2ItYywiTCIsYSxnK2MsIkMiLGEsZyxhLGcsYStjLGddO0QmJkQ+Zj9kPmcrcSYmZDxnK2ItcT93LnNwbGljZSgxMywzLCJMIixhK2YsZC02LGErZis2LGQsYStmLGQrNixhK2YsZytiLWMpOncuc3BsaWNlKDEzLDMsIkwiLGErZixiLzIsRCxkLGErZixiLzIsYStmLGcrYi1jKTpEJiYwPkQ/ZD5nK3EmJmQ8ZytiLXE/dy5zcGxpY2UoMzMsMywiTCIsYSxkKzYsYS02LGQsYSxkLTYsYSxnK2MpOncuc3BsaWNlKDMzLDMsIkwiLGEsYi8yLEQsZCxhLGIvMixhLGcrYyk6ZCYmZD5iJiZEPmErcSYmRDxhK2YtcT93LnNwbGljZSgyMywzLCJMIixEKzYsZytiLEQsZytiKzYsRC02LGcrYixhK2MsZytiKTpkJiYwPmQmJkQ+YStxJiZEPGErZi1xJiZ3LnNwbGljZSgzLA0KICAgICAgICAgICAgICAgICAgICAzLCJMIixELTYsZyxELGctNixEKzYsZyxmLWMsZyk7cmV0dXJuIHd9fSxjbGlwUmVjdDpmdW5jdGlvbihnLGYsYixkKXt2YXIgYz1hLnVuaXF1ZUtleSgpLHE9dGhpcy5jcmVhdGVFbGVtZW50KCJjbGlwUGF0aCIpLmF0dHIoe2lkOmN9KS5hZGQodGhpcy5kZWZzKTtnPXRoaXMucmVjdChnLGYsYixkLDApLmFkZChxKTtnLmlkPWM7Zy5jbGlwUGF0aD1xO2cuY291bnQ9MDtyZXR1cm4gZ30sdGV4dDpmdW5jdGlvbihhLGcsZixiKXt2YXIgZD0hUyYmdGhpcy5mb3JFeHBvcnQsYz17fTtpZihiJiYodGhpcy5hbGxvd0hUTUx8fCF0aGlzLmZvckV4cG9ydCkpcmV0dXJuIHRoaXMuaHRtbChhLGcsZik7Yy54PU1hdGgucm91bmQoZ3x8MCk7ZiYmKGMueT1NYXRoLnJvdW5kKGYpKTtpZihhfHwwPT09YSljLnRleHQ9YTthPXRoaXMuY3JlYXRlRWxlbWVudCgidGV4dCIpLmF0dHIoYyk7ZCYmYS5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSJ9KTtifHwoYS54U2V0dGVyPWZ1bmN0aW9uKGEsZyxmKXt2YXIgYj0NCiAgICBmLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0c3BhbiIpLGQsYz1mLmdldEF0dHJpYnV0ZShnKSxxO2ZvcihxPTA7cTxiLmxlbmd0aDtxKyspZD1iW3FdLGQuZ2V0QXR0cmlidXRlKGcpPT09YyYmZC5zZXRBdHRyaWJ1dGUoZyxhKTtmLnNldEF0dHJpYnV0ZShnLGEpfSk7cmV0dXJuIGF9LGZvbnRNZXRyaWNzOmZ1bmN0aW9uKGEsZyl7YT1hfHxnJiZnLnN0eWxlJiZnLnN0eWxlLmZvbnRTaXplfHx0aGlzLnN0eWxlJiZ0aGlzLnN0eWxlLmZvbnRTaXplO2E9L3B4Ly50ZXN0KGEpP0woYSk6L2VtLy50ZXN0KGEpP3BhcnNlRmxvYXQoYSkqKGc/dGhpcy5mb250TWV0cmljcyhudWxsLGcucGFyZW50Tm9kZSkuZjoxNik6MTI7Zz0yND5hP2ErMzpNYXRoLnJvdW5kKDEuMiphKTtyZXR1cm57aDpnLGI6TWF0aC5yb3VuZCguOCpnKSxmOmF9fSxyb3RDb3JyOmZ1bmN0aW9uKGEsZyxmKXt2YXIgYj1hO2cmJmYmJihiPU1hdGgubWF4KGIqTWF0aC5jb3MoZyplKSw0KSk7cmV0dXJue3g6LWEvMypNYXRoLnNpbihnKg0KICAgIGUpLHk6Yn19LGxhYmVsOmZ1bmN0aW9uKGYsZCxjLHEsRCx5LG0sRyxyKXt2YXIgdz10aGlzLGU9dy5nKCJidXR0b24iIT09ciYmImxhYmVsIiksdj1lLnRleHQ9dy50ZXh0KCIiLDAsMCxtKS5hdHRyKHt6SW5kZXg6MX0pLHAsbCxGPTAsQT0zLGg9MCxKLHQsUyxuLE0sSz17fSxMLHUsTz0vXnVybFwoKC4qPylcKSQvLnRlc3QocSksUj1PLFAsUSxOLFU7ciYmZS5hZGRDbGFzcygiaGlnaGNoYXJ0cy0iK3IpO1I9TztQPWZ1bmN0aW9uKCl7cmV0dXJuKEx8fDApJTIvMn07UT1mdW5jdGlvbigpe3ZhciBhPXYuZWxlbWVudC5zdHlsZSxnPXt9O2w9KHZvaWQgMD09PUp8fHZvaWQgMD09PXR8fE0pJiZrKHYudGV4dFN0cikmJnYuZ2V0QkJveCgpO2Uud2lkdGg9KEp8fGwud2lkdGh8fDApKzIqQStoO2UuaGVpZ2h0PSh0fHxsLmhlaWdodHx8MCkrMipBO3U9QSt3LmZvbnRNZXRyaWNzKGEmJmEuZm9udFNpemUsdikuYjtSJiYocHx8KGUuYm94PXA9dy5zeW1ib2xzW3FdfHxPP3cuc3ltYm9sKHEpOg0KICAgIHcucmVjdCgpLHAuYWRkQ2xhc3MoKCJidXR0b24iPT09cj8iIjoiaGlnaGNoYXJ0cy1sYWJlbC1ib3giKSsocj8iIGhpZ2hjaGFydHMtIityKyItYm94IjoiIikpLHAuYWRkKGUpLGE9UCgpLGcueD1hLGcueT0oRz8tdTowKSthKSxnLndpZHRoPU1hdGgucm91bmQoZS53aWR0aCksZy5oZWlnaHQ9TWF0aC5yb3VuZChlLmhlaWdodCkscC5hdHRyKGIoZyxLKSksSz17fSl9O049ZnVuY3Rpb24oKXt2YXIgYT1oK0EsZztnPUc/MDp1O2soSikmJmwmJigiY2VudGVyIj09PU18fCJyaWdodCI9PT1NKSYmKGErPXtjZW50ZXI6LjUscmlnaHQ6MX1bTV0qKEotbC53aWR0aCkpO2lmKGEhPT12Lnh8fGchPT12Lnkpdi5hdHRyKCJ4IixhKSx2b2lkIDAhPT1nJiZ2LmF0dHIoInkiLGcpO3YueD1hO3YueT1nfTtVPWZ1bmN0aW9uKGEsZyl7cD9wLmF0dHIoYSxnKTpLW2FdPWd9O2Uub25BZGQ9ZnVuY3Rpb24oKXt2LmFkZChlKTtlLmF0dHIoe3RleHQ6Znx8MD09PWY/ZjoiIix4OmQseTpjfSk7cCYmayhEKSYmDQplLmF0dHIoe2FuY2hvclg6RCxhbmNob3JZOnl9KX07ZS53aWR0aFNldHRlcj1mdW5jdGlvbihnKXtKPWEuaXNOdW1iZXIoZyk/ZzpudWxsfTtlLmhlaWdodFNldHRlcj1mdW5jdGlvbihhKXt0PWF9O2VbInRleHQtYWxpZ25TZXR0ZXIiXT1mdW5jdGlvbihhKXtNPWF9O2UucGFkZGluZ1NldHRlcj1mdW5jdGlvbihhKXtrKGEpJiZhIT09QSYmKEE9ZS5wYWRkaW5nPWEsTigpKX07ZS5wYWRkaW5nTGVmdFNldHRlcj1mdW5jdGlvbihhKXtrKGEpJiZhIT09aCYmKGg9YSxOKCkpfTtlLmFsaWduU2V0dGVyPWZ1bmN0aW9uKGEpe2E9e2xlZnQ6MCxjZW50ZXI6LjUscmlnaHQ6MX1bYV07YSE9PUYmJihGPWEsbCYmZS5hdHRyKHt4OlN9KSl9O2UudGV4dFNldHRlcj1mdW5jdGlvbihhKXt2b2lkIDAhPT1hJiZ2LnRleHRTZXR0ZXIoYSk7USgpO04oKX07ZVsic3Ryb2tlLXdpZHRoU2V0dGVyIl09ZnVuY3Rpb24oYSxnKXthJiYoUj0hMCk7TD10aGlzWyJzdHJva2Utd2lkdGgiXT1hO1UoZyxhKX07DQogICAgZS5zdHJva2VTZXR0ZXI9ZS5maWxsU2V0dGVyPWUuclNldHRlcj1mdW5jdGlvbihhLGcpeyJmaWxsIj09PWcmJmEmJihSPSEwKTtVKGcsYSl9O2UuYW5jaG9yWFNldHRlcj1mdW5jdGlvbihhLGcpe0Q9YTtVKGcsTWF0aC5yb3VuZChhKS1QKCktUyl9O2UuYW5jaG9yWVNldHRlcj1mdW5jdGlvbihhLGcpe3k9YTtVKGcsYS1uKX07ZS54U2V0dGVyPWZ1bmN0aW9uKGEpe2UueD1hO0YmJihhLT1GKigoSnx8bC53aWR0aCkrMipBKSk7Uz1NYXRoLnJvdW5kKGEpO2UuYXR0cigidHJhbnNsYXRlWCIsUyl9O2UueVNldHRlcj1mdW5jdGlvbihhKXtuPWUueT1NYXRoLnJvdW5kKGEpO2UuYXR0cigidHJhbnNsYXRlWSIsbil9O3ZhciBXPWUuY3NzO3JldHVybiBiKGUse2NzczpmdW5jdGlvbihhKXtpZihhKXt2YXIgZz17fTthPXgoYSk7SChlLnRleHRQcm9wcyxmdW5jdGlvbihmKXt2b2lkIDAhPT1hW2ZdJiYoZ1tmXT1hW2ZdLGRlbGV0ZSBhW2ZdKX0pO3YuY3NzKGcpfXJldHVybiBXLmNhbGwoZSwNCiAgICAgICAgYSl9LGdldEJCb3g6ZnVuY3Rpb24oKXtyZXR1cm57d2lkdGg6bC53aWR0aCsyKkEsaGVpZ2h0OmwuaGVpZ2h0KzIqQSx4OmwueC1BLHk6bC55LUF9fSxzaGFkb3c6ZnVuY3Rpb24oYSl7YSYmKFEoKSxwJiZwLnNoYWRvdyhhKSk7cmV0dXJuIGV9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtnKGUuZWxlbWVudCwibW91c2VlbnRlciIpO2coZS5lbGVtZW50LCJtb3VzZWxlYXZlIik7diYmKHY9di5kZXN0cm95KCkpO3AmJihwPXAuZGVzdHJveSgpKTtCLnByb3RvdHlwZS5kZXN0cm95LmNhbGwoZSk7ZT13PVE9Tj1VPW51bGx9fSl9fTthLlJlbmRlcmVyPXp9KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5hdHRyLHo9YS5jcmVhdGVFbGVtZW50LEM9YS5jc3MsRT1hLmRlZmluZWQsdT1hLmVhY2gsaD1hLmV4dGVuZCxuPWEuaXNGaXJlZm94LHQ9YS5pc01TLGw9YS5pc1dlYktpdCxrPWEucEludCxlPWEuU1ZHUmVuZGVyZXIsYz1hLndpbixwPWEud3JhcDtoKGEuU1ZHRWxlbWVudC5wcm90b3R5cGUsDQogICAge2h0bWxDc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5lbGVtZW50O2lmKGI9YSYmIlNQQU4iPT09Yi50YWdOYW1lJiZhLndpZHRoKWRlbGV0ZSBhLndpZHRoLHRoaXMudGV4dFdpZHRoPWIsdGhpcy51cGRhdGVUcmFuc2Zvcm0oKTthJiYiZWxsaXBzaXMiPT09YS50ZXh0T3ZlcmZsb3cmJihhLndoaXRlU3BhY2U9Im5vd3JhcCIsYS5vdmVyZmxvdz0iaGlkZGVuIik7dGhpcy5zdHlsZXM9aCh0aGlzLnN0eWxlcyxhKTtDKHRoaXMuZWxlbWVudCxhKTtyZXR1cm4gdGhpc30saHRtbEdldEJCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmVsZW1lbnQ7InRleHQiPT09YS5ub2RlTmFtZSYmKGEuc3R5bGUucG9zaXRpb249ImFic29sdXRlIik7cmV0dXJue3g6YS5vZmZzZXRMZWZ0LHk6YS5vZmZzZXRUb3Asd2lkdGg6YS5vZmZzZXRXaWR0aCxoZWlnaHQ6YS5vZmZzZXRIZWlnaHR9fSxodG1sVXBkYXRlVHJhbnNmb3JtOmZ1bmN0aW9uKCl7aWYodGhpcy5hZGRlZCl7dmFyIGE9dGhpcy5yZW5kZXJlciwNCiAgICAgICAgYj10aGlzLmVsZW1lbnQsYz10aGlzLnRyYW5zbGF0ZVh8fDAsZD10aGlzLnRyYW5zbGF0ZVl8fDAsZT10aGlzLnh8fDAscD10aGlzLnl8fDAsdj10aGlzLnRleHRBbGlnbnx8ImxlZnQiLGY9e2xlZnQ6MCxjZW50ZXI6LjUscmlnaHQ6MX1bdl0seT10aGlzLnN0eWxlcztDKGIse21hcmdpbkxlZnQ6YyxtYXJnaW5Ub3A6ZH0pO3RoaXMuc2hhZG93cyYmdSh0aGlzLnNoYWRvd3MsZnVuY3Rpb24oYSl7QyhhLHttYXJnaW5MZWZ0OmMrMSxtYXJnaW5Ub3A6ZCsxfSl9KTt0aGlzLmludmVydGVkJiZ1KGIuY2hpbGROb2RlcyxmdW5jdGlvbihmKXthLmludmVydENoaWxkKGYsYil9KTtpZigiU1BBTiI9PT1iLnRhZ05hbWUpe3ZhciBHPXRoaXMucm90YXRpb24sRj1rKHRoaXMudGV4dFdpZHRoKSxxPXkmJnkud2hpdGVTcGFjZSx4PVtHLHYsYi5pbm5lckhUTUwsdGhpcy50ZXh0V2lkdGgsdGhpcy50ZXh0QWxpZ25dLmpvaW4oKTt4IT09dGhpcy5jVFQmJih5PWEuZm9udE1ldHJpY3MoYi5zdHlsZS5mb250U2l6ZSkuYiwNCiAgICBFKEcpJiZ0aGlzLnNldFNwYW5Sb3RhdGlvbihHLGYseSksQyhiLHt3aWR0aDoiIix3aGl0ZVNwYWNlOnF8fCJub3dyYXAifSksYi5vZmZzZXRXaWR0aD5GJiYvWyBcLV0vLnRlc3QoYi50ZXh0Q29udGVudHx8Yi5pbm5lclRleHQpJiZDKGIse3dpZHRoOkYrInB4IixkaXNwbGF5OiJibG9jayIsd2hpdGVTcGFjZTpxfHwibm9ybWFsIn0pLHRoaXMuZ2V0U3BhbkNvcnJlY3Rpb24oYi5vZmZzZXRXaWR0aCx5LGYsRyx2KSk7QyhiLHtsZWZ0OmUrKHRoaXMueENvcnJ8fDApKyJweCIsdG9wOnArKHRoaXMueUNvcnJ8fDApKyJweCJ9KTtsJiYoeT1iLm9mZnNldEhlaWdodCk7dGhpcy5jVFQ9eH19ZWxzZSB0aGlzLmFsaWduT25BZGQ9ITB9LHNldFNwYW5Sb3RhdGlvbjpmdW5jdGlvbihhLGIsZSl7dmFyIGQ9e30sbT10PyItbXMtdHJhbnNmb3JtIjpsPyItd2Via2l0LXRyYW5zZm9ybSI6bj8iTW96VHJhbnNmb3JtIjpjLm9wZXJhPyItby10cmFuc2Zvcm0iOiIiO2RbbV09ZC50cmFuc2Zvcm09DQogICAgICAgICJyb3RhdGUoIithKyJkZWcpIjtkW20rKG4/Ik9yaWdpbiI6Ii1vcmlnaW4iKV09ZC50cmFuc2Zvcm1PcmlnaW49MTAwKmIrIiUgIitlKyJweCI7Qyh0aGlzLmVsZW1lbnQsZCl9LGdldFNwYW5Db3JyZWN0aW9uOmZ1bmN0aW9uKGEsYixjKXt0aGlzLnhDb3JyPS1hKmM7dGhpcy55Q29ycj0tYn19KTtoKGUucHJvdG90eXBlLHtodG1sOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNyZWF0ZUVsZW1lbnQoInNwYW4iKSxlPWQuZWxlbWVudCxtPWQucmVuZGVyZXIsdj1tLmlzU1ZHLGY9ZnVuY3Rpb24oYSxmKXt1KFsib3BhY2l0eSIsInZpc2liaWxpdHkiXSxmdW5jdGlvbihiKXtwKGEsYisiU2V0dGVyIixmdW5jdGlvbihhLGIsZCxjKXthLmNhbGwodGhpcyxiLGQsYyk7ZltkXT1ifSl9KX07ZC50ZXh0U2V0dGVyPWZ1bmN0aW9uKGEpe2EhPT1lLmlubmVySFRNTCYmZGVsZXRlIHRoaXMuYkJveDtlLmlubmVySFRNTD10aGlzLnRleHRTdHI9YTtkLmh0bWxVcGRhdGVUcmFuc2Zvcm0oKX07DQogICAgdiYmZihkLGQuZWxlbWVudC5zdHlsZSk7ZC54U2V0dGVyPWQueVNldHRlcj1kLmFsaWduU2V0dGVyPWQucm90YXRpb25TZXR0ZXI9ZnVuY3Rpb24oYSxmKXsiYWxpZ24iPT09ZiYmKGY9InRleHRBbGlnbiIpO2RbZl09YTtkLmh0bWxVcGRhdGVUcmFuc2Zvcm0oKX07ZC5hdHRyKHt0ZXh0OmEseDpNYXRoLnJvdW5kKGIpLHk6TWF0aC5yb3VuZChjKX0pLmNzcyh7Zm9udEZhbWlseTp0aGlzLnN0eWxlLmZvbnRGYW1pbHksZm9udFNpemU6dGhpcy5zdHlsZS5mb250U2l6ZSxwb3NpdGlvbjoiYWJzb2x1dGUifSk7ZS5zdHlsZS53aGl0ZVNwYWNlPSJub3dyYXAiO2QuY3NzPWQuaHRtbENzczt2JiYoZC5hZGQ9ZnVuY3Rpb24oYSl7dmFyIGIsYz1tLmJveC5wYXJlbnROb2RlLHE9W107aWYodGhpcy5wYXJlbnRHcm91cD1hKXtpZihiPWEuZGl2LCFiKXtmb3IoO2E7KXEucHVzaChhKSxhPWEucGFyZW50R3JvdXA7dShxLnJldmVyc2UoKSxmdW5jdGlvbihhKXt2YXIgeSxlPUIoYS5lbGVtZW50LA0KICAgICAgICAiY2xhc3MiKTtlJiYoZT17Y2xhc3NOYW1lOmV9KTtiPWEuZGl2PWEuZGl2fHx6KCJkaXYiLGUse3Bvc2l0aW9uOiJhYnNvbHV0ZSIsbGVmdDooYS50cmFuc2xhdGVYfHwwKSsicHgiLHRvcDooYS50cmFuc2xhdGVZfHwwKSsicHgiLGRpc3BsYXk6YS5kaXNwbGF5LG9wYWNpdHk6YS5vcGFjaXR5LHBvaW50ZXJFdmVudHM6YS5zdHlsZXMmJmEuc3R5bGVzLnBvaW50ZXJFdmVudHN9LGJ8fGMpO3k9Yi5zdHlsZTtoKGEse29uOmZ1bmN0aW9uKCl7ZC5vbi5hcHBseSh7ZWxlbWVudDpxWzBdLmRpdn0sYXJndW1lbnRzKTtyZXR1cm4gYX0sdHJhbnNsYXRlWFNldHRlcjpmdW5jdGlvbihmLGcpe3kubGVmdD1mKyJweCI7YVtnXT1mO2EuZG9UcmFuc2Zvcm09ITB9LHRyYW5zbGF0ZVlTZXR0ZXI6ZnVuY3Rpb24oZixnKXt5LnRvcD1mKyJweCI7YVtnXT1mO2EuZG9UcmFuc2Zvcm09ITB9fSk7ZihhLHkpfSl9fWVsc2UgYj1jO2IuYXBwZW5kQ2hpbGQoZSk7ZC5hZGRlZD0hMDtkLmFsaWduT25BZGQmJg0KICAgIGQuaHRtbFVwZGF0ZVRyYW5zZm9ybSgpO3JldHVybiBkfSk7cmV0dXJuIGR9fSl9KShJKTsoZnVuY3Rpb24oYSl7dmFyIEIseixDPWEuY3JlYXRlRWxlbWVudCxFPWEuY3NzLHU9YS5kZWZpbmVkLGg9YS5kZWcycmFkLG49YS5kaXNjYXJkRWxlbWVudCx0PWEuZG9jLGw9YS5lYWNoLGs9YS5lcmFzZSxlPWEuZXh0ZW5kO0I9YS5leHRlbmRDbGFzczt2YXIgYz1hLmlzQXJyYXkscD1hLmlzTnVtYmVyLEg9YS5pc09iamVjdCxiPWEubWVyZ2U7ej1hLm5vb3A7dmFyIG09YS5waWNrLGQ9YS5wSW50LHI9YS5TVkdFbGVtZW50LEE9YS5TVkdSZW5kZXJlcix2PWEud2luO2Euc3ZnfHwoej17ZG9jTW9kZTg6dCYmOD09PXQuZG9jdW1lbnRNb2RlLGluaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgZj1bIlx4M2MiLGIsJyBmaWxsZWRceDNkImYiIHN0cm9rZWRceDNkImYiJ10sZD1bInBvc2l0aW9uOiAiLCJhYnNvbHV0ZSIsIjsiXSxjPSJkaXYiPT09YjsoInNoYXBlIj09PWJ8fGMpJiZkLnB1c2goImxlZnQ6MDt0b3A6MDt3aWR0aDoxcHg7aGVpZ2h0OjFweDsiKTsNCiAgICBkLnB1c2goInZpc2liaWxpdHk6ICIsYz8iaGlkZGVuIjoidmlzaWJsZSIpO2YucHVzaCgnIHN0eWxlXHgzZCInLGQuam9pbigiIiksJyIvXHgzZScpO2ImJihmPWN8fCJzcGFuIj09PWJ8fCJpbWciPT09Yj9mLmpvaW4oIiIpOmEucHJlcFZNTChmKSx0aGlzLmVsZW1lbnQ9QyhmKSk7dGhpcy5yZW5kZXJlcj1hfSxhZGQ6ZnVuY3Rpb24oYSl7dmFyIGY9dGhpcy5yZW5kZXJlcixiPXRoaXMuZWxlbWVudCxkPWYuYm94LGM9YSYmYS5pbnZlcnRlZCxkPWE/YS5lbGVtZW50fHxhOmQ7YSYmKHRoaXMucGFyZW50R3JvdXA9YSk7YyYmZi5pbnZlcnRDaGlsZChiLGQpO2QuYXBwZW5kQ2hpbGQoYik7dGhpcy5hZGRlZD0hMDt0aGlzLmFsaWduT25BZGQmJiF0aGlzLmRlZmVyVXBkYXRlVHJhbnNmb3JtJiZ0aGlzLnVwZGF0ZVRyYW5zZm9ybSgpO2lmKHRoaXMub25BZGQpdGhpcy5vbkFkZCgpO3RoaXMuY2xhc3NOYW1lJiZ0aGlzLmF0dHIoImNsYXNzIix0aGlzLmNsYXNzTmFtZSk7cmV0dXJuIHRoaXN9LA0KICAgIHVwZGF0ZVRyYW5zZm9ybTpyLnByb3RvdHlwZS5odG1sVXBkYXRlVHJhbnNmb3JtLHNldFNwYW5Sb3RhdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucm90YXRpb24sYj1NYXRoLmNvcyhhKmgpLGQ9TWF0aC5zaW4oYSpoKTtFKHRoaXMuZWxlbWVudCx7ZmlsdGVyOmE/WyJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuTWF0cml4KE0xMVx4M2QiLGIsIiwgTTEyXHgzZCIsLWQsIiwgTTIxXHgzZCIsZCwiLCBNMjJceDNkIixiLCIsIHNpemluZ01ldGhvZFx4M2QnYXV0byBleHBhbmQnKSJdLmpvaW4oIiIpOiJub25lIn0pfSxnZXRTcGFuQ29ycmVjdGlvbjpmdW5jdGlvbihhLGIsZCxjLHEpe3ZhciBmPWM/TWF0aC5jb3MoYypoKToxLGU9Yz9NYXRoLnNpbihjKmgpOjAseT1tKHRoaXMuZWxlbUhlaWdodCx0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0KSxyO3RoaXMueENvcnI9MD5mJiYtYTt0aGlzLnlDb3JyPTA+ZSYmLXk7cj0wPmYqZTt0aGlzLnhDb3JyKz1lKmIqKHI/MS0NCiAgICAgICAgICAgIGQ6ZCk7dGhpcy55Q29yci09ZipiKihjP3I/ZDoxLWQ6MSk7cSYmImxlZnQiIT09cSYmKHRoaXMueENvcnItPWEqZCooMD5mPy0xOjEpLGMmJih0aGlzLnlDb3JyLT15KmQqKDA+ZT8tMToxKSksRSh0aGlzLmVsZW1lbnQse3RleHRBbGlnbjpxfSkpfSxwYXRoVG9WTUw6ZnVuY3Rpb24oYSl7Zm9yKHZhciBmPWEubGVuZ3RoLGI9W107Zi0tOylwKGFbZl0pP2JbZl09TWF0aC5yb3VuZCgxMCphW2ZdKS01OiJaIj09PWFbZl0/YltmXT0ieCI6KGJbZl09YVtmXSwhYS5pc0FyY3x8IndhIiE9PWFbZl0mJiJhdCIhPT1hW2ZdfHwoYltmKzVdPT09YltmKzddJiYoYltmKzddKz1hW2YrN10+YVtmKzVdPzE6LTEpLGJbZis2XT09PWJbZis4XSYmKGJbZis4XSs9YVtmKzhdPmFbZis2XT8xOi0xKSkpO3JldHVybiBiLmpvaW4oIiAiKXx8IngifSxjbGlwOmZ1bmN0aW9uKGEpe3ZhciBmPXRoaXMsYjthPyhiPWEubWVtYmVycyxrKGIsZiksYi5wdXNoKGYpLGYuZGVzdHJveUNsaXA9ZnVuY3Rpb24oKXtrKGIsDQogICAgICAgICAgICBmKX0sYT1hLmdldENTUyhmKSk6KGYuZGVzdHJveUNsaXAmJmYuZGVzdHJveUNsaXAoKSxhPXtjbGlwOmYuZG9jTW9kZTg/ImluaGVyaXQiOiJyZWN0KGF1dG8pIn0pO3JldHVybiBmLmNzcyhhKX0sY3NzOnIucHJvdG90eXBlLmh0bWxDc3Msc2FmZVJlbW92ZUNoaWxkOmZ1bmN0aW9uKGEpe2EucGFyZW50Tm9kZSYmbihhKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZGVzdHJveUNsaXAmJnRoaXMuZGVzdHJveUNsaXAoKTtyZXR1cm4gci5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzKX0sb246ZnVuY3Rpb24oYSxiKXt0aGlzLmVsZW1lbnRbIm9uIithXT1mdW5jdGlvbigpe3ZhciBhPXYuZXZlbnQ7YS50YXJnZXQ9YS5zcmNFbGVtZW50O2IoYSl9O3JldHVybiB0aGlzfSxjdXRPZmZQYXRoOmZ1bmN0aW9uKGEsYil7dmFyIGY7YT1hLnNwbGl0KC9bICxdLyk7Zj1hLmxlbmd0aDtpZig5PT09Znx8MTE9PT1mKWFbZi00XT1hW2YtMl09ZChhW2YtMl0pLTEwKmI7cmV0dXJuIGEuam9pbigiICIpfSwNCiAgICBzaGFkb3c6ZnVuY3Rpb24oYSxiLGMpe3ZhciBmPVtdLHEsZT10aGlzLmVsZW1lbnQseT10aGlzLnJlbmRlcmVyLHIsdj1lLnN0eWxlLGcsRD1lLnBhdGgscCxsLEcsaztEJiYic3RyaW5nIiE9PXR5cGVvZiBELnZhbHVlJiYoRD0ieCIpO2w9RDtpZihhKXtHPW0oYS53aWR0aCwzKTtrPShhLm9wYWNpdHl8fC4xNSkvRztmb3IocT0xOzM+PXE7cSsrKXA9MipHKzEtMipxLGMmJihsPXRoaXMuY3V0T2ZmUGF0aChELnZhbHVlLHArLjUpKSxnPVsnXHgzY3NoYXBlIGlzU2hhZG93XHgzZCJ0cnVlIiBzdHJva2V3ZWlnaHRceDNkIicscCwnIiBmaWxsZWRceDNkImZhbHNlIiBwYXRoXHgzZCInLGwsJyIgY29vcmRzaXplXHgzZCIxMCAxMCIgc3R5bGVceDNkIicsZS5zdHlsZS5jc3NUZXh0LCciIC9ceDNlJ10scj1DKHkucHJlcFZNTChnKSxudWxsLHtsZWZ0OmQodi5sZWZ0KSttKGEub2Zmc2V0WCwxKSx0b3A6ZCh2LnRvcCkrbShhLm9mZnNldFksMSl9KSxjJiYoci5jdXRPZmY9cCsxKSxnPVsnXHgzY3N0cm9rZSBjb2xvclx4M2QiJywNCiAgICAgICAgYS5jb2xvcnx8IiMwMDAwMDAiLCciIG9wYWNpdHlceDNkIicsaypxLCciL1x4M2UnXSxDKHkucHJlcFZNTChnKSxudWxsLG51bGwsciksYj9iLmVsZW1lbnQuYXBwZW5kQ2hpbGQocik6ZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyLGUpLGYucHVzaChyKTt0aGlzLnNoYWRvd3M9Zn1yZXR1cm4gdGhpc30sdXBkYXRlU2hhZG93czp6LHNldEF0dHI6ZnVuY3Rpb24oYSxiKXt0aGlzLmRvY01vZGU4P3RoaXMuZWxlbWVudFthXT1iOnRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoYSxiKX0sY2xhc3NTZXR0ZXI6ZnVuY3Rpb24oYSl7KHRoaXMuYWRkZWQ/dGhpcy5lbGVtZW50OnRoaXMpLmNsYXNzTmFtZT1hfSxkYXNoc3R5bGVTZXR0ZXI6ZnVuY3Rpb24oYSxiLGQpeyhkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzdHJva2UiKVswXXx8Qyh0aGlzLnJlbmRlcmVyLnByZXBWTUwoWyJceDNjc3Ryb2tlL1x4M2UiXSksbnVsbCxudWxsLGQpKVtiXT1hfHwic29saWQiO3RoaXNbYl09YX0sZFNldHRlcjpmdW5jdGlvbihhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIsZCl7dmFyIGY9dGhpcy5zaGFkb3dzO2E9YXx8W107dGhpcy5kPWEuam9pbiYmYS5qb2luKCIgIik7ZC5wYXRoPWE9dGhpcy5wYXRoVG9WTUwoYSk7aWYoZilmb3IoZD1mLmxlbmd0aDtkLS07KWZbZF0ucGF0aD1mW2RdLmN1dE9mZj90aGlzLmN1dE9mZlBhdGgoYSxmW2RdLmN1dE9mZik6YTt0aGlzLnNldEF0dHIoYixhKX0sZmlsbFNldHRlcjpmdW5jdGlvbihhLGIsZCl7dmFyIGY9ZC5ub2RlTmFtZTsiU1BBTiI9PT1mP2Quc3R5bGUuY29sb3I9YToiSU1HIiE9PWYmJihkLmZpbGxlZD0ibm9uZSIhPT1hLHRoaXMuc2V0QXR0cigiZmlsbGNvbG9yIix0aGlzLnJlbmRlcmVyLmNvbG9yKGEsZCxiLHRoaXMpKSl9LCJmaWxsLW9wYWNpdHlTZXR0ZXIiOmZ1bmN0aW9uKGEsYixkKXtDKHRoaXMucmVuZGVyZXIucHJlcFZNTChbIlx4M2MiLGIuc3BsaXQoIi0iKVswXSwnIG9wYWNpdHlceDNkIicsYSwnIi9ceDNlJ10pLG51bGwsbnVsbCxkKX0sb3BhY2l0eVNldHRlcjp6LHJvdGF0aW9uU2V0dGVyOmZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYixkKXtkPWQuc3R5bGU7dGhpc1tiXT1kW2JdPWE7ZC5sZWZ0PS1NYXRoLnJvdW5kKE1hdGguc2luKGEqaCkrMSkrInB4IjtkLnRvcD1NYXRoLnJvdW5kKE1hdGguY29zKGEqaCkpKyJweCJ9LHN0cm9rZVNldHRlcjpmdW5jdGlvbihhLGIsZCl7dGhpcy5zZXRBdHRyKCJzdHJva2Vjb2xvciIsdGhpcy5yZW5kZXJlci5jb2xvcihhLGQsYix0aGlzKSl9LCJzdHJva2Utd2lkdGhTZXR0ZXIiOmZ1bmN0aW9uKGEsYixkKXtkLnN0cm9rZWQ9ISFhO3RoaXNbYl09YTtwKGEpJiYoYSs9InB4Iik7dGhpcy5zZXRBdHRyKCJzdHJva2V3ZWlnaHQiLGEpfSx0aXRsZVNldHRlcjpmdW5jdGlvbihhLGIpe3RoaXMuc2V0QXR0cihiLGEpfSx2aXNpYmlsaXR5U2V0dGVyOmZ1bmN0aW9uKGEsYixkKXsiaW5oZXJpdCI9PT1hJiYoYT0idmlzaWJsZSIpO3RoaXMuc2hhZG93cyYmbCh0aGlzLnNoYWRvd3MsZnVuY3Rpb24oZil7Zi5zdHlsZVtiXT1hfSk7IkRJViI9PT1kLm5vZGVOYW1lJiYoYT0iaGlkZGVuIj09PQ0KICAgIGE/Ii05OTllbSI6MCx0aGlzLmRvY01vZGU4fHwoZC5zdHlsZVtiXT1hPyJ2aXNpYmxlIjoiaGlkZGVuIiksYj0idG9wIik7ZC5zdHlsZVtiXT1hfSx4U2V0dGVyOmZ1bmN0aW9uKGEsYixkKXt0aGlzW2JdPWE7IngiPT09Yj9iPSJsZWZ0IjoieSI9PT1iJiYoYj0idG9wIik7dGhpcy51cGRhdGVDbGlwcGluZz8odGhpc1tiXT1hLHRoaXMudXBkYXRlQ2xpcHBpbmcoKSk6ZC5zdHlsZVtiXT1hfSx6SW5kZXhTZXR0ZXI6ZnVuY3Rpb24oYSxiLGQpe2Quc3R5bGVbYl09YX19LHpbInN0cm9rZS1vcGFjaXR5U2V0dGVyIl09elsiZmlsbC1vcGFjaXR5U2V0dGVyIl0sYS5WTUxFbGVtZW50PXo9QihyLHopLHoucHJvdG90eXBlLnlTZXR0ZXI9ei5wcm90b3R5cGUud2lkdGhTZXR0ZXI9ei5wcm90b3R5cGUuaGVpZ2h0U2V0dGVyPXoucHJvdG90eXBlLnhTZXR0ZXIsej17RWxlbWVudDp6LGlzSUU4Oi0xPHYubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDguMCIpLGluaXQ6ZnVuY3Rpb24oYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIsZCl7dmFyIGYsYzt0aGlzLmFsaWduZWRPYmplY3RzPVtdO2Y9dGhpcy5jcmVhdGVFbGVtZW50KCJkaXYiKS5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSJ9KTtjPWYuZWxlbWVudDthLmFwcGVuZENoaWxkKGYuZWxlbWVudCk7dGhpcy5pc1ZNTD0hMDt0aGlzLmJveD1jO3RoaXMuYm94V3JhcHBlcj1mO3RoaXMuZ3JhZGllbnRzPXt9O3RoaXMuY2FjaGU9e307dGhpcy5jYWNoZUtleXM9W107dGhpcy5pbWdDb3VudD0wO3RoaXMuc2V0U2l6ZShiLGQsITEpO2lmKCF0Lm5hbWVzcGFjZXMuaGN2KXt0Lm5hbWVzcGFjZXMuYWRkKCJoY3YiLCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbCIpO3RyeXt0LmNyZWF0ZVN0eWxlU2hlZXQoKS5jc3NUZXh0PSJoY3ZcXDpmaWxsLCBoY3ZcXDpwYXRoLCBoY3ZcXDpzaGFwZSwgaGN2XFw6c3Ryb2tleyBiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKTsgZGlzcGxheTogaW5saW5lLWJsb2NrOyB9ICJ9Y2F0Y2goeCl7dC5zdHlsZVNoZWV0c1swXS5jc3NUZXh0Kz0NCiAgICAiaGN2XFw6ZmlsbCwgaGN2XFw6cGF0aCwgaGN2XFw6c2hhcGUsIGhjdlxcOnN0cm9rZXsgYmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgfSAifX19LGlzSGlkZGVuOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuYm94Lm9mZnNldFdpZHRofSxjbGlwUmVjdDpmdW5jdGlvbihhLGIsZCxjKXt2YXIgZj10aGlzLmNyZWF0ZUVsZW1lbnQoKSxtPUgoYSk7cmV0dXJuIGUoZix7bWVtYmVyczpbXSxjb3VudDowLGxlZnQ6KG0/YS54OmEpKzEsdG9wOihtP2EueTpiKSsxLHdpZHRoOihtP2Eud2lkdGg6ZCktMSxoZWlnaHQ6KG0/YS5oZWlnaHQ6YyktMSxnZXRDU1M6ZnVuY3Rpb24oYSl7dmFyIGI9YS5lbGVtZW50LGQ9Yi5ub2RlTmFtZSxnPWEuaW52ZXJ0ZWQsZj10aGlzLnRvcC0oInNoYXBlIj09PWQ/Yi5vZmZzZXRUb3A6MCksYz10aGlzLmxlZnQsYj1jK3RoaXMud2lkdGgscT1mK3RoaXMuaGVpZ2h0LGY9e2NsaXA6InJlY3QoIitNYXRoLnJvdW5kKGc/DQogICAgYzpmKSsicHgsIitNYXRoLnJvdW5kKGc/cTpiKSsicHgsIitNYXRoLnJvdW5kKGc/YjpxKSsicHgsIitNYXRoLnJvdW5kKGc/ZjpjKSsicHgpIn07IWcmJmEuZG9jTW9kZTgmJiJESVYiPT09ZCYmZShmLHt3aWR0aDpiKyJweCIsaGVpZ2h0OnErInB4In0pO3JldHVybiBmfSx1cGRhdGVDbGlwcGluZzpmdW5jdGlvbigpe2woZi5tZW1iZXJzLGZ1bmN0aW9uKGEpe2EuZWxlbWVudCYmYS5jc3MoZi5nZXRDU1MoYSkpfSl9fSl9LGNvbG9yOmZ1bmN0aW9uKGIsZCxjLGUpe3ZhciBmPXRoaXMsbSxyPS9ecmdiYS8sdixwLGc9Im5vbmUiO2ImJmIubGluZWFyR3JhZGllbnQ/cD0iZ3JhZGllbnQiOmImJmIucmFkaWFsR3JhZGllbnQmJihwPSJwYXR0ZXJuIik7aWYocCl7dmFyIEQseSxrPWIubGluZWFyR3JhZGllbnR8fGIucmFkaWFsR3JhZGllbnQsQSxoLHcsRyx0LEY9IiI7Yj1iLnN0b3BzO3ZhciBuLEg9W10sdT1mdW5jdGlvbigpe3Y9WydceDNjZmlsbCBjb2xvcnNceDNkIicrSC5qb2luKCIsIikrDQonIiBvcGFjaXR5XHgzZCInLHcsJyIgbzpvcGFjaXR5Mlx4M2QiJyxoLCciIHR5cGVceDNkIicscCwnIiAnLEYsJ2ZvY3VzXHgzZCIxMDAlIiBtZXRob2RceDNkImFueSIgL1x4M2UnXTtDKGYucHJlcFZNTCh2KSxudWxsLG51bGwsZCl9O0E9YlswXTtuPWJbYi5sZW5ndGgtMV07MDxBWzBdJiZiLnVuc2hpZnQoWzAsQVsxXV0pOzE+blswXSYmYi5wdXNoKFsxLG5bMV1dKTtsKGIsZnVuY3Rpb24oZyxiKXtyLnRlc3QoZ1sxXSk/KG09YS5jb2xvcihnWzFdKSxEPW0uZ2V0KCJyZ2IiKSx5PW0uZ2V0KCJhIikpOihEPWdbMV0seT0xKTtILnB1c2goMTAwKmdbMF0rIiUgIitEKTtiPyh3PXksRz1EKTooaD15LHQ9RCl9KTtpZigiZmlsbCI9PT1jKWlmKCJncmFkaWVudCI9PT1wKWM9ay54MXx8a1swXXx8MCxiPWsueTF8fGtbMV18fDAsQT1rLngyfHxrWzJdfHwwLGs9ay55Mnx8a1szXXx8MCxGPSdhbmdsZVx4M2QiJysoOTAtMTgwKk1hdGguYXRhbigoay1iKS8oQS1jKSkvTWF0aC5QSSkrJyInLA0KICAgIHUoKTtlbHNle3ZhciBnPWsucix6PTIqZyxCPTIqZyxFPWsuY3gsVj1rLmN5LEk9ZC5yYWRpYWxSZWZlcmVuY2UsVCxnPWZ1bmN0aW9uKCl7SSYmKFQ9ZS5nZXRCQm94KCksRSs9KElbMF0tVC54KS9ULndpZHRoLS41LFYrPShJWzFdLVQueSkvVC5oZWlnaHQtLjUseio9SVsyXS9ULndpZHRoLEIqPUlbMl0vVC5oZWlnaHQpO0Y9J3NyY1x4M2QiJythLmdldE9wdGlvbnMoKS5nbG9iYWwuVk1MUmFkaWFsR3JhZGllbnRVUkwrJyIgc2l6ZVx4M2QiJyt6KyIsIitCKyciIG9yaWdpblx4M2QiMC41LDAuNSIgcG9zaXRpb25ceDNkIicrRSsiLCIrVisnIiBjb2xvcjJceDNkIicrdCsnIiAnO3UoKX07ZS5hZGRlZD9nKCk6ZS5vbkFkZD1nO2c9R31lbHNlIGc9RH1lbHNlIHIudGVzdChiKSYmIklNRyIhPT1kLnRhZ05hbWU/KG09YS5jb2xvcihiKSxlW2MrIi1vcGFjaXR5U2V0dGVyIl0obS5nZXQoImEiKSxjLGQpLGc9bS5nZXQoInJnYiIpKTooZz1kLmdldEVsZW1lbnRzQnlUYWdOYW1lKGMpLA0KICAgIGcubGVuZ3RoJiYoZ1swXS5vcGFjaXR5PTEsZ1swXS50eXBlPSJzb2xpZCIpLGc9Yik7cmV0dXJuIGd9LHByZXBWTUw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pc0lFODthPWEuam9pbigiIik7Yj8oYT1hLnJlcGxhY2UoIi9ceDNlIiwnIHhtbG5zXHgzZCJ1cm46c2NoZW1hcy1taWNyb3NvZnQtY29tOnZtbCIgL1x4M2UnKSxhPS0xPT09YS5pbmRleE9mKCdzdHlsZVx4M2QiJyk/YS5yZXBsYWNlKCIvXHgzZSIsJyBzdHlsZVx4M2QiZGlzcGxheTppbmxpbmUtYmxvY2s7YmVoYXZpb3I6dXJsKCNkZWZhdWx0I1ZNTCk7IiAvXHgzZScpOmEucmVwbGFjZSgnc3R5bGVceDNkIicsJ3N0eWxlXHgzZCJkaXNwbGF5OmlubGluZS1ibG9jaztiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKTsnKSk6YT1hLnJlcGxhY2UoIlx4M2MiLCJceDNjaGN2OiIpO3JldHVybiBhfSx0ZXh0OkEucHJvdG90eXBlLmh0bWwscGF0aDpmdW5jdGlvbihhKXt2YXIgYj17Y29vcmRzaXplOiIxMCAxMCJ9O2MoYSk/Yi5kPQ0KICAgICAgICBhOkgoYSkmJmUoYixhKTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50KCJzaGFwZSIpLmF0dHIoYil9LGNpcmNsZTpmdW5jdGlvbihhLGIsZCl7dmFyIGY9dGhpcy5zeW1ib2woImNpcmNsZSIpO0goYSkmJihkPWEucixiPWEueSxhPWEueCk7Zi5pc0NpcmNsZT0hMDtmLnI9ZDtyZXR1cm4gZi5hdHRyKHt4OmEseTpifSl9LGc6ZnVuY3Rpb24oYSl7dmFyIGI7YSYmKGI9e2NsYXNzTmFtZToiaGlnaGNoYXJ0cy0iK2EsImNsYXNzIjoiaGlnaGNoYXJ0cy0iK2F9KTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50KCJkaXYiKS5hdHRyKGIpfSxpbWFnZTpmdW5jdGlvbihhLGIsZCxjLHEpe3ZhciBmPXRoaXMuY3JlYXRlRWxlbWVudCgiaW1nIikuYXR0cih7c3JjOmF9KTsxPGFyZ3VtZW50cy5sZW5ndGgmJmYuYXR0cih7eDpiLHk6ZCx3aWR0aDpjLGhlaWdodDpxfSk7cmV0dXJuIGZ9LGNyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuInJlY3QiPT09YT90aGlzLnN5bWJvbChhKTpBLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50LmNhbGwodGhpcywNCiAgICAgICAgYSl9LGludmVydENoaWxkOmZ1bmN0aW9uKGEsYil7dmFyIGY9dGhpcztiPWIuc3R5bGU7dmFyIGM9IklNRyI9PT1hLnRhZ05hbWUmJmEuc3R5bGU7RShhLHtmbGlwOiJ4IixsZWZ0OmQoYi53aWR0aCktKGM/ZChjLnRvcCk6MSksdG9wOmQoYi5oZWlnaHQpLShjP2QoYy5sZWZ0KToxKSxyb3RhdGlvbjotOTB9KTtsKGEuY2hpbGROb2RlcyxmdW5jdGlvbihiKXtmLmludmVydENoaWxkKGIsYSl9KX0sc3ltYm9sczp7YXJjOmZ1bmN0aW9uKGEsYixkLGMscSl7dmFyIGY9cS5zdGFydCxlPXEuZW5kLG09cS5yfHxkfHxjO2Q9cS5pbm5lclI7Yz1NYXRoLmNvcyhmKTt2YXIgcj1NYXRoLnNpbihmKSxnPU1hdGguY29zKGUpLEQ9TWF0aC5zaW4oZSk7aWYoMD09PWUtZilyZXR1cm5bIngiXTtmPVsid2EiLGEtbSxiLW0sYSttLGIrbSxhK20qYyxiK20qcixhK20qZyxiK20qRF07cS5vcGVuJiYhZCYmZi5wdXNoKCJlIiwiTSIsYSxiKTtmLnB1c2goImF0IixhLWQsYi1kLGErZCxiK2QsYStkKmcsDQogICAgYitkKkQsYStkKmMsYitkKnIsIngiLCJlIik7Zi5pc0FyYz0hMDtyZXR1cm4gZn0sY2lyY2xlOmZ1bmN0aW9uKGEsYixkLGMscSl7cSYmdShxLnIpJiYoZD1jPTIqcS5yKTtxJiZxLmlzQ2lyY2xlJiYoYS09ZC8yLGItPWMvMik7cmV0dXJuWyJ3YSIsYSxiLGErZCxiK2MsYStkLGIrYy8yLGErZCxiK2MvMiwiZSJdfSxyZWN0OmZ1bmN0aW9uKGEsYixkLGMscSl7cmV0dXJuIEEucHJvdG90eXBlLnN5bWJvbHNbdShxKSYmcS5yPyJjYWxsb3V0Ijoic3F1YXJlIl0uY2FsbCgwLGEsYixkLGMscSl9fX0sYS5WTUxSZW5kZXJlcj1CPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sQi5wcm90b3R5cGU9YihBLnByb3RvdHlwZSx6KSxhLlJlbmRlcmVyPUIpO0EucHJvdG90eXBlLm1lYXN1cmVTcGFuV2lkdGg9ZnVuY3Rpb24oYSxiKXt2YXIgZD10LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTthPXQuY3JlYXRlVGV4dE5vZGUoYSk7ZC5hcHBlbmRDaGlsZChhKTtFKGQsDQogICAgYik7dGhpcy5ib3guYXBwZW5kQ2hpbGQoZCk7Yj1kLm9mZnNldFdpZHRoO24oZCk7cmV0dXJuIGJ9fSkoSSk7KGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIEIoKXt2YXIgbD1hLmRlZmF1bHRPcHRpb25zLmdsb2JhbCxrPXQubW9tZW50O2lmKGwudGltZXpvbmUpe2lmKGspcmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybi1rLnR6KGEsbC50aW1lem9uZSkudXRjT2Zmc2V0KCl9O2EuZXJyb3IoMjUpfXJldHVybiBsLnVzZVVUQyYmbC5nZXRUaW1lem9uZU9mZnNldH1mdW5jdGlvbiB6KCl7dmFyIGw9YS5kZWZhdWx0T3B0aW9ucy5nbG9iYWwsayxlPWwudXNlVVRDLGM9ZT8iZ2V0VVRDIjoiZ2V0IixwPWU/InNldFVUQyI6InNldCI7YS5EYXRlPWs9bC5EYXRlfHx0LkRhdGU7ay5oY1RpbWV6b25lT2Zmc2V0PWUmJmwudGltZXpvbmVPZmZzZXQ7ay5oY0dldFRpbWV6b25lT2Zmc2V0PUIoKTtrLmhjTWFrZVRpbWU9ZnVuY3Rpb24oYSxiLGMsZCxyLHApe3ZhciBtO2U/KG09ay5VVEMuYXBwbHkoMCxhcmd1bWVudHMpLA0KICAgICAgICBtKz11KG0pKTptPShuZXcgayhhLGIsbihjLDEpLG4oZCwwKSxuKHIsMCksbihwLDApKSkuZ2V0VGltZSgpO3JldHVybiBtfTtFKCJNaW51dGVzIEhvdXJzIERheSBEYXRlIE1vbnRoIEZ1bGxZZWFyIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGEpe2tbImhjR2V0IithXT1jK2F9KTtFKCJNaWxsaXNlY29uZHMgU2Vjb25kcyBNaW51dGVzIEhvdXJzIERhdGUgTW9udGggRnVsbFllYXIiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSl7a1siaGNTZXQiK2FdPXArYX0pfXZhciBDPWEuY29sb3IsRT1hLmVhY2gsdT1hLmdldFRaT2Zmc2V0LGg9YS5tZXJnZSxuPWEucGljayx0PWEud2luO2EuZGVmYXVsdE9wdGlvbnM9e2NvbG9yczoiIzdjYjVlYyAjNDM0MzQ4ICM5MGVkN2QgI2Y3YTM1YyAjODA4NWU5ICNmMTVjODAgI2U0ZDM1NCAjMmI5MDhmICNmNDViNWIgIzkxZThlMSIuc3BsaXQoIiAiKSxzeW1ib2xzOlsiY2lyY2xlIiwiZGlhbW9uZCIsInNxdWFyZSIsInRyaWFuZ2xlIiwidHJpYW5nbGUtZG93biJdLA0KICAgIGxhbmc6e2xvYWRpbmc6IkxvYWRpbmcuLi4iLG1vbnRoczoiSmFudWFyeSBGZWJydWFyeSBNYXJjaCBBcHJpbCBNYXkgSnVuZSBKdWx5IEF1Z3VzdCBTZXB0ZW1iZXIgT2N0b2JlciBOb3ZlbWJlciBEZWNlbWJlciIuc3BsaXQoIiAiKSxzaG9ydE1vbnRoczoiSmFuIEZlYiBNYXIgQXByIE1heSBKdW4gSnVsIEF1ZyBTZXAgT2N0IE5vdiBEZWMiLnNwbGl0KCIgIiksd2Vla2RheXM6IlN1bmRheSBNb25kYXkgVHVlc2RheSBXZWRuZXNkYXkgVGh1cnNkYXkgRnJpZGF5IFNhdHVyZGF5Ii5zcGxpdCgiICIpLGRlY2ltYWxQb2ludDoiLiIsbnVtZXJpY1N5bWJvbHM6ImtNR1RQRSIuc3BsaXQoIiIpLHJlc2V0Wm9vbToiUmVzZXQgem9vbSIscmVzZXRab29tVGl0bGU6IlJlc2V0IHpvb20gbGV2ZWwgMToxIix0aG91c2FuZHNTZXA6IiAifSxnbG9iYWw6e3VzZVVUQzohMCxWTUxSYWRpYWxHcmFkaWVudFVSTDoiaHR0cDovL2NvZGUuaGlnaGNoYXJ0cy5jb20vNS4wLjkvZ2Z4L3ZtbC1yYWRpYWwtZ3JhZGllbnQucG5nIn0sDQogICAgY2hhcnQ6e2JvcmRlclJhZGl1czowLGRlZmF1bHRTZXJpZXNUeXBlOiJsaW5lIixpZ25vcmVIaWRkZW5TZXJpZXM6ITAsc3BhY2luZzpbMTAsMTAsMTUsMTBdLHJlc2V0Wm9vbUJ1dHRvbjp7dGhlbWU6e3pJbmRleDoyMH0scG9zaXRpb246e2FsaWduOiJyaWdodCIseDotMTAseToxMH19LHdpZHRoOm51bGwsaGVpZ2h0Om51bGwsYm9yZGVyQ29sb3I6IiMzMzVjYWQiLGJhY2tncm91bmRDb2xvcjoiI2ZmZmZmZiIscGxvdEJvcmRlckNvbG9yOiIjY2NjY2NjIn0sdGl0bGU6e3RleHQ6IkNoYXJ0IHRpdGxlIixhbGlnbjoiY2VudGVyIixtYXJnaW46MTUsd2lkdGhBZGp1c3Q6LTQ0fSxzdWJ0aXRsZTp7dGV4dDoiIixhbGlnbjoiY2VudGVyIix3aWR0aEFkanVzdDotNDR9LHBsb3RPcHRpb25zOnt9LGxhYmVsczp7c3R5bGU6e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsY29sb3I6IiMzMzMzMzMifX0sbGVnZW5kOntlbmFibGVkOiEwLGFsaWduOiJjZW50ZXIiLGxheW91dDoiaG9yaXpvbnRhbCIsDQogICAgICAgIGxhYmVsRm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZX0sYm9yZGVyQ29sb3I6IiM5OTk5OTkiLGJvcmRlclJhZGl1czowLG5hdmlnYXRpb246e2FjdGl2ZUNvbG9yOiIjMDAzMzk5IixpbmFjdGl2ZUNvbG9yOiIjY2NjY2NjIn0saXRlbVN0eWxlOntjb2xvcjoiIzMzMzMzMyIsZm9udFNpemU6IjEycHgiLGZvbnRXZWlnaHQ6ImJvbGQifSxpdGVtSG92ZXJTdHlsZTp7Y29sb3I6IiMwMDAwMDAifSxpdGVtSGlkZGVuU3R5bGU6e2NvbG9yOiIjY2NjY2NjIn0sc2hhZG93OiExLGl0ZW1DaGVja2JveFN0eWxlOntwb3NpdGlvbjoiYWJzb2x1dGUiLHdpZHRoOiIxM3B4IixoZWlnaHQ6IjEzcHgifSxzcXVhcmVTeW1ib2w6ITAsc3ltYm9sUGFkZGluZzo1LHZlcnRpY2FsQWxpZ246ImJvdHRvbSIseDowLHk6MCx0aXRsZTp7c3R5bGU6e2ZvbnRXZWlnaHQ6ImJvbGQifX19LGxvYWRpbmc6e2xhYmVsU3R5bGU6e2ZvbnRXZWlnaHQ6ImJvbGQiLHBvc2l0aW9uOiJyZWxhdGl2ZSIsDQogICAgICAgIHRvcDoiNDUlIn0sc3R5bGU6e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsYmFja2dyb3VuZENvbG9yOiIjZmZmZmZmIixvcGFjaXR5Oi41LHRleHRBbGlnbjoiY2VudGVyIn19LHRvb2x0aXA6e2VuYWJsZWQ6ITAsYW5pbWF0aW9uOmEuc3ZnLGJvcmRlclJhZGl1czozLGRhdGVUaW1lTGFiZWxGb3JtYXRzOnttaWxsaXNlY29uZDoiJUEsICViICVlLCAlSDolTTolUy4lTCIsc2Vjb25kOiIlQSwgJWIgJWUsICVIOiVNOiVTIixtaW51dGU6IiVBLCAlYiAlZSwgJUg6JU0iLGhvdXI6IiVBLCAlYiAlZSwgJUg6JU0iLGRheToiJUEsICViICVlLCAlWSIsd2VlazoiV2VlayBmcm9tICVBLCAlYiAlZSwgJVkiLG1vbnRoOiIlQiAlWSIseWVhcjoiJVkifSxmb290ZXJGb3JtYXQ6IiIscGFkZGluZzo4LHNuYXA6YS5pc1RvdWNoRGV2aWNlPzI1OjEwLGJhY2tncm91bmRDb2xvcjpDKCIjZjdmN2Y3Iikuc2V0T3BhY2l0eSguODUpLmdldCgpLGJvcmRlcldpZHRoOjEsaGVhZGVyRm9ybWF0OidceDNjc3BhbiBzdHlsZVx4M2QiZm9udC1zaXplOiAxMHB4Ilx4M2V7cG9pbnQua2V5fVx4M2Mvc3Bhblx4M2VceDNjYnIvXHgzZScsDQogICAgICAgIHBvaW50Rm9ybWF0OidceDNjc3BhbiBzdHlsZVx4M2QiY29sb3I6e3BvaW50LmNvbG9yfSJceDNlXHUyNWNmXHgzYy9zcGFuXHgzZSB7c2VyaWVzLm5hbWV9OiBceDNjYlx4M2V7cG9pbnQueX1ceDNjL2JceDNlXHgzY2JyL1x4M2UnLHNoYWRvdzohMCxzdHlsZTp7Y29sb3I6IiMzMzMzMzMiLGN1cnNvcjoiZGVmYXVsdCIsZm9udFNpemU6IjEycHgiLHBvaW50ZXJFdmVudHM6Im5vbmUiLHdoaXRlU3BhY2U6Im5vd3JhcCJ9fSxjcmVkaXRzOntlbmFibGVkOiEwLGhyZWY6Imh0dHA6Ly93d3cuaGlnaGNoYXJ0cy5jb20iLHBvc2l0aW9uOnthbGlnbjoicmlnaHQiLHg6LTEwLHZlcnRpY2FsQWxpZ246ImJvdHRvbSIseTotNX0sc3R5bGU6e2N1cnNvcjoicG9pbnRlciIsY29sb3I6IiM5OTk5OTkiLGZvbnRTaXplOiI5cHgifSx0ZXh0OiJIaWdoY2hhcnRzLmNvbSJ9fTthLnNldE9wdGlvbnM9ZnVuY3Rpb24obCl7YS5kZWZhdWx0T3B0aW9ucz1oKCEwLGEuZGVmYXVsdE9wdGlvbnMsbCk7eigpOw0KICAgIHJldHVybiBhLmRlZmF1bHRPcHRpb25zfTthLmdldE9wdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gYS5kZWZhdWx0T3B0aW9uc307YS5kZWZhdWx0UGxvdE9wdGlvbnM9YS5kZWZhdWx0T3B0aW9ucy5wbG90T3B0aW9uczt6KCl9KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5hcnJheU1heCx6PWEuYXJyYXlNaW4sQz1hLmRlZmluZWQsRT1hLmRlc3Ryb3lPYmplY3RQcm9wZXJ0aWVzLHU9YS5lYWNoLGg9YS5lcmFzZSxuPWEubWVyZ2UsdD1hLnBpY2s7YS5QbG90TGluZU9yQmFuZD1mdW5jdGlvbihhLGspe3RoaXMuYXhpcz1hO2smJih0aGlzLm9wdGlvbnM9ayx0aGlzLmlkPWsuaWQpfTthLlBsb3RMaW5lT3JCYW5kLnByb3RvdHlwZT17cmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxrPWEuYXhpcyxlPWsuaG9yaXosYz1hLm9wdGlvbnMscD1jLmxhYmVsLGg9YS5sYWJlbCxiPWMudG8sbT1jLmZyb20sZD1jLnZhbHVlLHI9QyhtKSYmQyhiKSxBPUMoZCksdj1hLnN2Z0VsZW0sZj0hdiwNCiAgICB5PVtdLEcsRj1jLmNvbG9yLHE9dChjLnpJbmRleCwwKSx4PWMuZXZlbnRzLHk9eyJjbGFzcyI6ImhpZ2hjaGFydHMtcGxvdC0iKyhyPyJiYW5kICI6ImxpbmUgIikrKGMuY2xhc3NOYW1lfHwiIil9LEo9e30sdT1rLmNoYXJ0LnJlbmRlcmVyLEw9cj8iYmFuZHMiOiJsaW5lcyIsZz1rLmxvZzJsaW47ay5pc0xvZyYmKG09ZyhtKSxiPWcoYiksZD1nKGQpKTtBPyh5PXtzdHJva2U6Riwic3Ryb2tlLXdpZHRoIjpjLndpZHRofSxjLmRhc2hTdHlsZSYmKHkuZGFzaHN0eWxlPWMuZGFzaFN0eWxlKSk6ciYmKEYmJih5LmZpbGw9RiksYy5ib3JkZXJXaWR0aCYmKHkuc3Ryb2tlPWMuYm9yZGVyQ29sb3IseVsic3Ryb2tlLXdpZHRoIl09Yy5ib3JkZXJXaWR0aCkpO0ouekluZGV4PXE7TCs9Ii0iK3E7KEY9a1tMXSl8fChrW0xdPUY9dS5nKCJwbG90LSIrTCkuYXR0cihKKS5hZGQoKSk7ZiYmKGEuc3ZnRWxlbT12PXUucGF0aCgpLmF0dHIoeSkuYWRkKEYpKTtpZihBKXk9ay5nZXRQbG90TGluZVBhdGgoZCwNCiAgICB2LnN0cm9rZVdpZHRoKCkpO2Vsc2UgaWYocil5PWsuZ2V0UGxvdEJhbmRQYXRoKG0sYixjKTtlbHNlIHJldHVybjtpZihmJiZ5JiZ5Lmxlbmd0aCl7aWYodi5hdHRyKHtkOnl9KSx4KWZvcihHIGluIGM9ZnVuY3Rpb24oYil7di5vbihiLGZ1bmN0aW9uKGcpe3hbYl0uYXBwbHkoYSxbZ10pfSl9LHgpYyhHKX1lbHNlIHYmJih5Pyh2LnNob3coKSx2LmFuaW1hdGUoe2Q6eX0pKToodi5oaWRlKCksaCYmKGEubGFiZWw9aD1oLmRlc3Ryb3koKSkpKTtwJiZDKHAudGV4dCkmJnkmJnkubGVuZ3RoJiYwPGsud2lkdGgmJjA8ay5oZWlnaHQmJiF5LmZsYXQ/KHA9bih7YWxpZ246ZSYmciYmImNlbnRlciIseDplPyFyJiY0OjEwLHZlcnRpY2FsQWxpZ246IWUmJnImJiJtaWRkbGUiLHk6ZT9yPzE2OjEwOnI/NjotNCxyb3RhdGlvbjplJiYhciYmOTB9LHApLHRoaXMucmVuZGVyTGFiZWwocCx5LHIscSkpOmgmJmguaGlkZSgpO3JldHVybiBhfSxyZW5kZXJMYWJlbDpmdW5jdGlvbihhLGssZSxjKXt2YXIgcD0NCiAgICB0aGlzLmxhYmVsLGw9dGhpcy5heGlzLmNoYXJ0LnJlbmRlcmVyO3B8fChwPXthbGlnbjphLnRleHRBbGlnbnx8YS5hbGlnbixyb3RhdGlvbjphLnJvdGF0aW9uLCJjbGFzcyI6ImhpZ2hjaGFydHMtcGxvdC0iKyhlPyJiYW5kIjoibGluZSIpKyItbGFiZWwgIisoYS5jbGFzc05hbWV8fCIiKX0scC56SW5kZXg9Yyx0aGlzLmxhYmVsPXA9bC50ZXh0KGEudGV4dCwwLDAsYS51c2VIVE1MKS5hdHRyKHApLmFkZCgpLHAuY3NzKGEuc3R5bGUpKTtjPVtrWzFdLGtbNF0sZT9rWzZdOmtbMV1dO2s9W2tbMl0sa1s1XSxlP2tbN106a1syXV07ZT16KGMpO2w9eihrKTtwLmFsaWduKGEsITEse3g6ZSx5Omwsd2lkdGg6QihjKS1lLGhlaWdodDpCKGspLWx9KTtwLnNob3coKX0sZGVzdHJveTpmdW5jdGlvbigpe2godGhpcy5heGlzLnBsb3RMaW5lc0FuZEJhbmRzLHRoaXMpO2RlbGV0ZSB0aGlzLmF4aXM7RSh0aGlzKX19O2EuQXhpc1Bsb3RMaW5lT3JCYW5kRXh0ZW5zaW9uPXtnZXRQbG90QmFuZFBhdGg6ZnVuY3Rpb24oYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayl7az10aGlzLmdldFBsb3RMaW5lUGF0aChrLG51bGwsbnVsbCwhMCk7KGE9dGhpcy5nZXRQbG90TGluZVBhdGgoYSxudWxsLG51bGwsITApKSYmaz8oYS5mbGF0PWEudG9TdHJpbmcoKT09PWsudG9TdHJpbmcoKSxhLnB1c2goa1s0XSxrWzVdLGtbMV0sa1syXSwieiIpKTphPW51bGw7cmV0dXJuIGF9LGFkZFBsb3RCYW5kOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZFBsb3RCYW5kT3JMaW5lKGEsInBsb3RCYW5kcyIpfSxhZGRQbG90TGluZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGRQbG90QmFuZE9yTGluZShhLCJwbG90TGluZXMiKX0sYWRkUGxvdEJhbmRPckxpbmU6ZnVuY3Rpb24obCxrKXt2YXIgZT0obmV3IGEuUGxvdExpbmVPckJhbmQodGhpcyxsKSkucmVuZGVyKCksYz10aGlzLnVzZXJPcHRpb25zO2UmJihrJiYoY1trXT1jW2tdfHxbXSxjW2tdLnB1c2gobCkpLHRoaXMucGxvdExpbmVzQW5kQmFuZHMucHVzaChlKSk7cmV0dXJuIGV9LHJlbW92ZVBsb3RCYW5kT3JMaW5lOmZ1bmN0aW9uKGEpe2Zvcih2YXIgaz0NCiAgICB0aGlzLnBsb3RMaW5lc0FuZEJhbmRzLGU9dGhpcy5vcHRpb25zLGM9dGhpcy51c2VyT3B0aW9ucyxwPWsubGVuZ3RoO3AtLTspa1twXS5pZD09PWEmJmtbcF0uZGVzdHJveSgpO3UoW2UucGxvdExpbmVzfHxbXSxjLnBsb3RMaW5lc3x8W10sZS5wbG90QmFuZHN8fFtdLGMucGxvdEJhbmRzfHxbXV0sZnVuY3Rpb24oYyl7Zm9yKHA9Yy5sZW5ndGg7cC0tOyljW3BdLmlkPT09YSYmaChjLGNbcF0pfSl9fX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmNvcnJlY3RGbG9hdCx6PWEuZGVmaW5lZCxDPWEuZGVzdHJveU9iamVjdFByb3BlcnRpZXMsRT1hLmlzTnVtYmVyLHU9YS5tZXJnZSxoPWEucGljayxuPWEuZGVnMnJhZDthLlRpY2s9ZnVuY3Rpb24oYSxsLGssZSl7dGhpcy5heGlzPWE7dGhpcy5wb3M9bDt0aGlzLnR5cGU9a3x8IiI7dGhpcy5pc05ldz0hMDtrfHxlfHx0aGlzLmFkZExhYmVsKCl9O2EuVGljay5wcm90b3R5cGU9e2FkZExhYmVsOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5heGlzLA0KICAgIGw9YS5vcHRpb25zLGs9YS5jaGFydCxlPWEuY2F0ZWdvcmllcyxjPWEubmFtZXMscD10aGlzLnBvcyxuPWwubGFiZWxzLGI9YS50aWNrUG9zaXRpb25zLG09cD09PWJbMF0sZD1wPT09YltiLmxlbmd0aC0xXSxjPWU/aChlW3BdLGNbcF0scCk6cCxlPXRoaXMubGFiZWwsYj1iLmluZm8scjthLmlzRGF0ZXRpbWVBeGlzJiZiJiYocj1sLmRhdGVUaW1lTGFiZWxGb3JtYXRzW2IuaGlnaGVyUmFua3NbcF18fGIudW5pdE5hbWVdKTt0aGlzLmlzRmlyc3Q9bTt0aGlzLmlzTGFzdD1kO2w9YS5sYWJlbEZvcm1hdHRlci5jYWxsKHtheGlzOmEsY2hhcnQ6ayxpc0ZpcnN0Om0saXNMYXN0OmQsZGF0ZVRpbWVMYWJlbEZvcm1hdDpyLHZhbHVlOmEuaXNMb2c/QihhLmxpbjJsb2coYykpOmN9KTt6KGUpP2UmJmUuYXR0cih7dGV4dDpsfSk6KHRoaXMubGFiZWxMZW5ndGg9KHRoaXMubGFiZWw9ZT16KGwpJiZuLmVuYWJsZWQ/ay5yZW5kZXJlci50ZXh0KGwsMCwwLG4udXNlSFRNTCkuY3NzKHUobi5zdHlsZSkpLmFkZChhLmxhYmVsR3JvdXApOg0KICAgICAgICAgICAgbnVsbCkmJmUuZ2V0QkJveCgpLndpZHRoLHRoaXMucm90YXRpb249MCl9LGdldExhYmVsU2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsP3RoaXMubGFiZWwuZ2V0QkJveCgpW3RoaXMuYXhpcy5ob3Jpej8iaGVpZ2h0Ijoid2lkdGgiXTowfSxoYW5kbGVPdmVyZmxvdzpmdW5jdGlvbihhKXt2YXIgbD10aGlzLmF4aXMsaz1hLngsZT1sLmNoYXJ0LmNoYXJ0V2lkdGgsYz1sLmNoYXJ0LnNwYWNpbmcscD1oKGwubGFiZWxMZWZ0LE1hdGgubWluKGwucG9zLGNbM10pKSxjPWgobC5sYWJlbFJpZ2h0LE1hdGgubWF4KGwucG9zK2wubGVuLGUtY1sxXSkpLHQ9dGhpcy5sYWJlbCxiPXRoaXMucm90YXRpb24sbT17bGVmdDowLGNlbnRlcjouNSxyaWdodDoxfVtsLmxhYmVsQWxpZ25dLGQ9dC5nZXRCQm94KCkud2lkdGgscj1sLmdldFNsb3RXaWR0aCgpLEE9cix2PTEsZix5PXt9O2lmKGIpMD5iJiZrLW0qZDxwP2Y9TWF0aC5yb3VuZChrL01hdGguY29zKGIqbiktcCk6MDxiJiZrK20qDQogICAgZD5jJiYoZj1NYXRoLnJvdW5kKChlLWspL01hdGguY29zKGIqbikpKTtlbHNlIGlmKGU9aysoMS1tKSpkLGstbSpkPHA/QT1hLngrQSooMS1tKS1wOmU+YyYmKEE9Yy1hLngrQSptLHY9LTEpLEE9TWF0aC5taW4ocixBKSxBPHImJiJjZW50ZXIiPT09bC5sYWJlbEFsaWduJiYoYS54Kz12KihyLUEtbSooci1NYXRoLm1pbihkLEEpKSkpLGQ+QXx8bC5hdXRvUm90YXRpb24mJih0LnN0eWxlc3x8e30pLndpZHRoKWY9QTtmJiYoeS53aWR0aD1mLChsLm9wdGlvbnMubGFiZWxzLnN0eWxlfHx7fSkudGV4dE92ZXJmbG93fHwoeS50ZXh0T3ZlcmZsb3c9ImVsbGlwc2lzIiksdC5jc3MoeSkpfSxnZXRQb3NpdGlvbjpmdW5jdGlvbihhLGwsayxlKXt2YXIgYz10aGlzLmF4aXMscD1jLmNoYXJ0LGg9ZSYmcC5vbGRDaGFydEhlaWdodHx8cC5jaGFydEhlaWdodDtyZXR1cm57eDphP2MudHJhbnNsYXRlKGwrayxudWxsLG51bGwsZSkrYy50cmFuc0I6Yy5sZWZ0K2Mub2Zmc2V0KyhjLm9wcG9zaXRlPw0KICAgICAgICAoZSYmcC5vbGRDaGFydFdpZHRofHxwLmNoYXJ0V2lkdGgpLWMucmlnaHQtYy5sZWZ0OjApLHk6YT9oLWMuYm90dG9tK2Mub2Zmc2V0LShjLm9wcG9zaXRlP2MuaGVpZ2h0OjApOmgtYy50cmFuc2xhdGUobCtrLG51bGwsbnVsbCxlKS1jLnRyYW5zQn19LGdldExhYmVsUG9zaXRpb246ZnVuY3Rpb24oYSxoLGssZSxjLHAsSCxiKXt2YXIgbT10aGlzLmF4aXMsZD1tLnRyYW5zQSxyPW0ucmV2ZXJzZWQsbD1tLnN0YWdnZXJMaW5lcyx2PW0udGlja1JvdENvcnJ8fHt4OjAseTowfSxmPWMueTt6KGYpfHwoZj0wPT09bS5zaWRlP2sucm90YXRpb24/LTg6LWsuZ2V0QkJveCgpLmhlaWdodDoyPT09bS5zaWRlP3YueSs4Ok1hdGguY29zKGsucm90YXRpb24qbikqKHYueS1rLmdldEJCb3goITEsMCkuaGVpZ2h0LzIpKTthPWErYy54K3YueC0ocCYmZT9wKmQqKHI/LTE6MSk6MCk7aD1oK2YtKHAmJiFlP3AqZCoocj8xOi0xKTowKTtsJiYoaz1ILyhifHwxKSVsLG0ub3Bwb3NpdGUmJihrPWwtay0NCiAgICAxKSxoKz1tLmxhYmVsT2Zmc2V0L2wqayk7cmV0dXJue3g6YSx5Ok1hdGgucm91bmQoaCl9fSxnZXRNYXJrUGF0aDpmdW5jdGlvbihhLGgsayxlLGMscCl7cmV0dXJuIHAuY3Jpc3BMaW5lKFsiTSIsYSxoLCJMIixhKyhjPzA6LWspLGgrKGM/azowKV0sZSl9LHJlbmRlckdyaWRMaW5lOmZ1bmN0aW9uKGEsaCxrKXt2YXIgZT10aGlzLmF4aXMsYz1lLm9wdGlvbnMscD10aGlzLmdyaWRMaW5lLGw9e30sYj10aGlzLnBvcyxtPXRoaXMudHlwZSxkPWUudGlja21hcmtPZmZzZXQscj1lLmNoYXJ0LnJlbmRlcmVyLEE9bT9tKyJHcmlkIjoiZ3JpZCIsdj1jW0ErIkxpbmVXaWR0aCJdLGY9Y1tBKyJMaW5lQ29sb3IiXSxjPWNbQSsiTGluZURhc2hTdHlsZSJdO3B8fChsLnN0cm9rZT1mLGxbInN0cm9rZS13aWR0aCJdPXYsYyYmKGwuZGFzaHN0eWxlPWMpLG18fChsLnpJbmRleD0xKSxhJiYobC5vcGFjaXR5PTApLHRoaXMuZ3JpZExpbmU9cD1yLnBhdGgoKS5hdHRyKGwpLmFkZENsYXNzKCJoaWdoY2hhcnRzLSIrDQogICAgKG0/bSsiLSI6IiIpKyJncmlkLWxpbmUiKS5hZGQoZS5ncmlkR3JvdXApKTtpZighYSYmcCYmKGE9ZS5nZXRQbG90TGluZVBhdGgoYitkLHAuc3Ryb2tlV2lkdGgoKSprLGEsITApKSlwW3RoaXMuaXNOZXc/ImF0dHIiOiJhbmltYXRlIl0oe2Q6YSxvcGFjaXR5Omh9KX0scmVuZGVyTWFyazpmdW5jdGlvbihhLGwsayl7dmFyIGU9dGhpcy5heGlzLGM9ZS5vcHRpb25zLHA9ZS5jaGFydC5yZW5kZXJlcixuPXRoaXMudHlwZSxiPW4/bisiVGljayI6InRpY2siLG09ZS50aWNrU2l6ZShiKSxkPXRoaXMubWFyayxyPSFkLEE9YS54O2E9YS55O3ZhciB2PWgoY1tiKyJXaWR0aCJdLCFuJiZlLmlzWEF4aXM/MTowKSxjPWNbYisiQ29sb3IiXTttJiYoZS5vcHBvc2l0ZSYmKG1bMF09LW1bMF0pLHImJih0aGlzLm1hcms9ZD1wLnBhdGgoKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy0iKyhuP24rIi0iOiIiKSsidGljayIpLmFkZChlLmF4aXNHcm91cCksZC5hdHRyKHtzdHJva2U6Yywic3Ryb2tlLXdpZHRoIjp2fSkpLA0KICAgIGRbcj8iYXR0ciI6ImFuaW1hdGUiXSh7ZDp0aGlzLmdldE1hcmtQYXRoKEEsYSxtWzBdLGQuc3Ryb2tlV2lkdGgoKSprLGUuaG9yaXoscCksb3BhY2l0eTpsfSkpfSxyZW5kZXJMYWJlbDpmdW5jdGlvbihhLGwsayxlKXt2YXIgYz10aGlzLmF4aXMscD1jLmhvcml6LG49Yy5vcHRpb25zLGI9dGhpcy5sYWJlbCxtPW4ubGFiZWxzLGQ9bS5zdGVwLHI9Yy50aWNrbWFya09mZnNldCxBPSEwLHY9YS54O2E9YS55O2ImJkUodikmJihiLnh5PWE9dGhpcy5nZXRMYWJlbFBvc2l0aW9uKHYsYSxiLHAsbSxyLGUsZCksdGhpcy5pc0ZpcnN0JiYhdGhpcy5pc0xhc3QmJiFoKG4uc2hvd0ZpcnN0TGFiZWwsMSl8fHRoaXMuaXNMYXN0JiYhdGhpcy5pc0ZpcnN0JiYhaChuLnNob3dMYXN0TGFiZWwsMSk/QT0hMTohcHx8Yy5pc1JhZGlhbHx8bS5zdGVwfHxtLnJvdGF0aW9ufHxsfHwwPT09a3x8dGhpcy5oYW5kbGVPdmVyZmxvdyhhKSxkJiZlJWQmJihBPSExKSxBJiZFKGEueSk/KGEub3BhY2l0eT1rLA0KICAgICAgICBiW3RoaXMuaXNOZXc/ImF0dHIiOiJhbmltYXRlIl0oYSkpOmIuYXR0cigieSIsLTk5OTkpLHRoaXMuaXNOZXc9ITEpfSxyZW5kZXI6ZnVuY3Rpb24oYSxsLGspe3ZhciBlPXRoaXMuYXhpcyxjPWUuaG9yaXoscD10aGlzLmdldFBvc2l0aW9uKGMsdGhpcy5wb3MsZS50aWNrbWFya09mZnNldCxsKSxuPXAueCxiPXAueSxlPWMmJm49PT1lLnBvcytlLmxlbnx8IWMmJmI9PT1lLnBvcz8tMToxO2s9aChrLDEpO3RoaXMuaXNBY3RpdmU9ITA7dGhpcy5yZW5kZXJHcmlkTGluZShsLGssZSk7dGhpcy5yZW5kZXJNYXJrKHAsayxlKTt0aGlzLnJlbmRlckxhYmVsKHAsbCxrLGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7Qyh0aGlzLHRoaXMuYXhpcyl9fX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmFkZEV2ZW50LHo9YS5hbmltT2JqZWN0LEM9YS5hcnJheU1heCxFPWEuYXJyYXlNaW4sdT1hLkF4aXNQbG90TGluZU9yQmFuZEV4dGVuc2lvbixoPWEuY29sb3Isbj1hLmNvcnJlY3RGbG9hdCx0PWEuZGVmYXVsdE9wdGlvbnMsDQogICAgbD1hLmRlZmluZWQsaz1hLmRlZzJyYWQsZT1hLmRlc3Ryb3lPYmplY3RQcm9wZXJ0aWVzLGM9YS5lYWNoLHA9YS5leHRlbmQsSD1hLmZpcmVFdmVudCxiPWEuZm9ybWF0LG09YS5nZXRNYWduaXR1ZGUsZD1hLmdyZXAscj1hLmluQXJyYXksQT1hLmlzQXJyYXksdj1hLmlzTnVtYmVyLGY9YS5pc1N0cmluZyx5PWEubWVyZ2UsRz1hLm5vcm1hbGl6ZVRpY2tJbnRlcnZhbCxGPWEucGljayxxPWEuUGxvdExpbmVPckJhbmQseD1hLnJlbW92ZUV2ZW50LEo9YS5zcGxhdCxLPWEuc3luY1RpbWVvdXQsTD1hLlRpY2s7YS5BeGlzPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07YS5BeGlzLnByb3RvdHlwZT17ZGVmYXVsdE9wdGlvbnM6e2RhdGVUaW1lTGFiZWxGb3JtYXRzOnttaWxsaXNlY29uZDoiJUg6JU06JVMuJUwiLHNlY29uZDoiJUg6JU06JVMiLG1pbnV0ZToiJUg6JU0iLGhvdXI6IiVIOiVNIixkYXk6IiVlLiAlYiIsd2VlazoiJWUuICViIixtb250aDoiJWIgJyV5IiwNCiAgICB5ZWFyOiIlWSJ9LGVuZE9uVGljazohMSxsYWJlbHM6e2VuYWJsZWQ6ITAsc3R5bGU6e2NvbG9yOiIjNjY2NjY2IixjdXJzb3I6ImRlZmF1bHQiLGZvbnRTaXplOiIxMXB4In0seDowfSxtaW5QYWRkaW5nOi4wMSxtYXhQYWRkaW5nOi4wMSxtaW5vclRpY2tMZW5ndGg6MixtaW5vclRpY2tQb3NpdGlvbjoib3V0c2lkZSIsc3RhcnRPZldlZWs6MSxzdGFydE9uVGljazohMSx0aWNrTGVuZ3RoOjEwLHRpY2ttYXJrUGxhY2VtZW50OiJiZXR3ZWVuIix0aWNrUGl4ZWxJbnRlcnZhbDoxMDAsdGlja1Bvc2l0aW9uOiJvdXRzaWRlIix0aXRsZTp7YWxpZ246Im1pZGRsZSIsc3R5bGU6e2NvbG9yOiIjNjY2NjY2In19LHR5cGU6ImxpbmVhciIsbWlub3JHcmlkTGluZUNvbG9yOiIjZjJmMmYyIixtaW5vckdyaWRMaW5lV2lkdGg6MSxtaW5vclRpY2tDb2xvcjoiIzk5OTk5OSIsbGluZUNvbG9yOiIjY2NkNmViIixsaW5lV2lkdGg6MSxncmlkTGluZUNvbG9yOiIjZTZlNmU2Iix0aWNrQ29sb3I6IiNjY2Q2ZWIifSwNCiAgICBkZWZhdWx0WUF4aXNPcHRpb25zOntlbmRPblRpY2s6ITAsdGlja1BpeGVsSW50ZXJ2YWw6NzIsc2hvd0xhc3RMYWJlbDohMCxsYWJlbHM6e3g6LTh9LG1heFBhZGRpbmc6LjA1LG1pblBhZGRpbmc6LjA1LHN0YXJ0T25UaWNrOiEwLHRpdGxlOntyb3RhdGlvbjoyNzAsdGV4dDoiVmFsdWVzIn0sc3RhY2tMYWJlbHM6e2VuYWJsZWQ6ITEsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIGEubnVtYmVyRm9ybWF0KHRoaXMudG90YWwsLTEpfSxzdHlsZTp7Zm9udFNpemU6IjExcHgiLGZvbnRXZWlnaHQ6ImJvbGQiLGNvbG9yOiIjMDAwMDAwIix0ZXh0T3V0bGluZToiMXB4IGNvbnRyYXN0In19LGdyaWRMaW5lV2lkdGg6MSxsaW5lV2lkdGg6MH0sZGVmYXVsdExlZnRBeGlzT3B0aW9uczp7bGFiZWxzOnt4Oi0xNX0sdGl0bGU6e3JvdGF0aW9uOjI3MH19LGRlZmF1bHRSaWdodEF4aXNPcHRpb25zOntsYWJlbHM6e3g6MTV9LHRpdGxlOntyb3RhdGlvbjo5MH19LGRlZmF1bHRCb3R0b21BeGlzT3B0aW9uczp7bGFiZWxzOnthdXRvUm90YXRpb246Wy00NV0sDQogICAgICAgIHg6MH0sdGl0bGU6e3JvdGF0aW9uOjB9fSxkZWZhdWx0VG9wQXhpc09wdGlvbnM6e2xhYmVsczp7YXV0b1JvdGF0aW9uOlstNDVdLHg6MH0sdGl0bGU6e3JvdGF0aW9uOjB9fSxpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGc9Yi5pc1g7dGhpcy5jaGFydD1hO3RoaXMuaG9yaXo9YS5pbnZlcnRlZD8hZzpnO3RoaXMuaXNYQXhpcz1nO3RoaXMuY29sbD10aGlzLmNvbGx8fChnPyJ4QXhpcyI6InlBeGlzIik7dGhpcy5vcHBvc2l0ZT1iLm9wcG9zaXRlO3RoaXMuc2lkZT1iLnNpZGV8fCh0aGlzLmhvcml6P3RoaXMub3Bwb3NpdGU/MDoyOnRoaXMub3Bwb3NpdGU/MTozKTt0aGlzLnNldE9wdGlvbnMoYik7dmFyIGQ9dGhpcy5vcHRpb25zLGM9ZC50eXBlO3RoaXMubGFiZWxGb3JtYXR0ZXI9ZC5sYWJlbHMuZm9ybWF0dGVyfHx0aGlzLmRlZmF1bHRMYWJlbEZvcm1hdHRlcjt0aGlzLnVzZXJPcHRpb25zPWI7dGhpcy5taW5QaXhlbFBhZGRpbmc9MDt0aGlzLnJldmVyc2VkPWQucmV2ZXJzZWQ7dGhpcy52aXNpYmxlPQ0KICAgICAgICAhMSE9PWQudmlzaWJsZTt0aGlzLnpvb21FbmFibGVkPSExIT09ZC56b29tRW5hYmxlZDt0aGlzLmhhc05hbWVzPSJjYXRlZ29yeSI9PT1jfHwhMD09PWQuY2F0ZWdvcmllczt0aGlzLmNhdGVnb3JpZXM9ZC5jYXRlZ29yaWVzfHx0aGlzLmhhc05hbWVzO3RoaXMubmFtZXM9dGhpcy5uYW1lc3x8W107dGhpcy5pc0xvZz0ibG9nYXJpdGhtaWMiPT09Yzt0aGlzLmlzRGF0ZXRpbWVBeGlzPSJkYXRldGltZSI9PT1jO3RoaXMucG9zaXRpdmVWYWx1ZXNPbmx5PXRoaXMuaXNMb2cmJiF0aGlzLmFsbG93TmVnYXRpdmVMb2c7dGhpcy5pc0xpbmtlZD1sKGQubGlua2VkVG8pO3RoaXMudGlja3M9e307dGhpcy5sYWJlbEVkZ2U9W107dGhpcy5taW5vclRpY2tzPXt9O3RoaXMucGxvdExpbmVzQW5kQmFuZHM9W107dGhpcy5hbHRlcm5hdGVCYW5kcz17fTt0aGlzLmxlbj0wO3RoaXMubWluUmFuZ2U9dGhpcy51c2VyTWluUmFuZ2U9ZC5taW5SYW5nZXx8ZC5tYXhab29tO3RoaXMucmFuZ2U9ZC5yYW5nZTsNCiAgICAgICAgdGhpcy5vZmZzZXQ9ZC5vZmZzZXR8fDA7dGhpcy5zdGFja3M9e307dGhpcy5vbGRTdGFja3M9e307dGhpcy5zdGFja3NUb3VjaGVkPTA7dGhpcy5taW49dGhpcy5tYXg9bnVsbDt0aGlzLmNyb3NzaGFpcj1GKGQuY3Jvc3NoYWlyLEooYS5vcHRpb25zLnRvb2x0aXAuY3Jvc3NoYWlycylbZz8wOjFdLCExKTt2YXIgZjtiPXRoaXMub3B0aW9ucy5ldmVudHM7LTE9PT1yKHRoaXMsYS5heGVzKSYmKGc/YS5heGVzLnNwbGljZShhLnhBeGlzLmxlbmd0aCwwLHRoaXMpOmEuYXhlcy5wdXNoKHRoaXMpLGFbdGhpcy5jb2xsXS5wdXNoKHRoaXMpKTt0aGlzLnNlcmllcz10aGlzLnNlcmllc3x8W107YS5pbnZlcnRlZCYmZyYmdm9pZCAwPT09dGhpcy5yZXZlcnNlZCYmKHRoaXMucmV2ZXJzZWQ9ITApO3RoaXMucmVtb3ZlUGxvdExpbmU9dGhpcy5yZW1vdmVQbG90QmFuZD10aGlzLnJlbW92ZVBsb3RCYW5kT3JMaW5lO2ZvcihmIGluIGIpQih0aGlzLGYsYltmXSk7dGhpcy5saW4ybG9nPWQubGluZWFyVG9Mb2dDb252ZXJ0ZXJ8fA0KICAgICAgICAgICAgdGhpcy5saW4ybG9nO3RoaXMuaXNMb2cmJih0aGlzLnZhbDJsaW49dGhpcy5sb2cybGluLHRoaXMubGluMnZhbD10aGlzLmxpbjJsb2cpfSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3RoaXMub3B0aW9ucz15KHRoaXMuZGVmYXVsdE9wdGlvbnMsInlBeGlzIj09PXRoaXMuY29sbCYmdGhpcy5kZWZhdWx0WUF4aXNPcHRpb25zLFt0aGlzLmRlZmF1bHRUb3BBeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRSaWdodEF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdEJvdHRvbUF4aXNPcHRpb25zLHRoaXMuZGVmYXVsdExlZnRBeGlzT3B0aW9uc11bdGhpcy5zaWRlXSx5KHRbdGhpcy5jb2xsXSxhKSl9LGRlZmF1bHRMYWJlbEZvcm1hdHRlcjpmdW5jdGlvbigpe3ZhciBnPXRoaXMuYXhpcyxkPXRoaXMudmFsdWUsYz1nLmNhdGVnb3JpZXMsZj10aGlzLmRhdGVUaW1lTGFiZWxGb3JtYXQscT10LmxhbmcsZT1xLm51bWVyaWNTeW1ib2xzLHE9cS5udW1lcmljU3ltYm9sTWFnbml0dWRlfHwxRTMsdz1lJiZlLmxlbmd0aCwNCiAgICAgICAgbSxyPWcub3B0aW9ucy5sYWJlbHMuZm9ybWF0LGc9Zy5pc0xvZz9NYXRoLmFicyhkKTpnLnRpY2tJbnRlcnZhbDtpZihyKW09YihyLHRoaXMpO2Vsc2UgaWYoYyltPWQ7ZWxzZSBpZihmKW09YS5kYXRlRm9ybWF0KGYsZCk7ZWxzZSBpZih3JiYxRTM8PWcpZm9yKDt3LS0mJnZvaWQgMD09PW07KWM9TWF0aC5wb3cocSx3KzEpLGc+PWMmJjA9PT0xMCpkJWMmJm51bGwhPT1lW3ddJiYwIT09ZCYmKG09YS5udW1iZXJGb3JtYXQoZC9jLC0xKStlW3ddKTt2b2lkIDA9PT1tJiYobT0xRTQ8PU1hdGguYWJzKGQpP2EubnVtYmVyRm9ybWF0KGQsLTEpOmEubnVtYmVyRm9ybWF0KGQsLTEsdm9pZCAwLCIiKSk7cmV0dXJuIG19LGdldFNlcmllc0V4dHJlbWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQ7YS5oYXNWaXNpYmxlU2VyaWVzPSExO2EuZGF0YU1pbj1hLmRhdGFNYXg9YS50aHJlc2hvbGQ9bnVsbDthLnNvZnRUaHJlc2hvbGQ9IWEuaXNYQXhpczthLmJ1aWxkU3RhY2tzJiZhLmJ1aWxkU3RhY2tzKCk7DQogICAgICAgIGMoYS5zZXJpZXMsZnVuY3Rpb24oZyl7aWYoZy52aXNpYmxlfHwhYi5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyl7dmFyIGM9Zy5vcHRpb25zLGY9Yy50aHJlc2hvbGQscTthLmhhc1Zpc2libGVTZXJpZXM9ITA7YS5wb3NpdGl2ZVZhbHVlc09ubHkmJjA+PWYmJihmPW51bGwpO2lmKGEuaXNYQXhpcyljPWcueERhdGEsYy5sZW5ndGgmJihnPUUoYyksdihnKXx8ZyBpbnN0YW5jZW9mIERhdGV8fChjPWQoYyxmdW5jdGlvbihhKXtyZXR1cm4gdihhKX0pLGc9RShjKSksYS5kYXRhTWluPU1hdGgubWluKEYoYS5kYXRhTWluLGNbMF0pLGcpLGEuZGF0YU1heD1NYXRoLm1heChGKGEuZGF0YU1heCxjWzBdKSxDKGMpKSk7ZWxzZSBpZihnLmdldEV4dHJlbWVzKCkscT1nLmRhdGFNYXgsZz1nLmRhdGFNaW4sbChnKSYmbChxKSYmKGEuZGF0YU1pbj1NYXRoLm1pbihGKGEuZGF0YU1pbixnKSxnKSxhLmRhdGFNYXg9TWF0aC5tYXgoRihhLmRhdGFNYXgscSkscSkpLGwoZikmJihhLnRocmVzaG9sZD0NCiAgICAgICAgICAgICAgICBmKSwhYy5zb2Z0VGhyZXNob2xkfHxhLnBvc2l0aXZlVmFsdWVzT25seSlhLnNvZnRUaHJlc2hvbGQ9ITF9fSl9LHRyYW5zbGF0ZTpmdW5jdGlvbihhLGIsZCxjLGYscSl7dmFyIGc9dGhpcy5saW5rZWRQYXJlbnR8fHRoaXMsRD0xLGU9MCxtPWM/Zy5vbGRUcmFuc0E6Zy50cmFuc0E7Yz1jP2cub2xkTWluOmcubWluO3ZhciByPWcubWluUGl4ZWxQYWRkaW5nO2Y9KGcuaXNPcmRpbmFsfHxnLmlzQnJva2VufHxnLmlzTG9nJiZmKSYmZy5saW4ydmFsO218fChtPWcudHJhbnNBKTtkJiYoRCo9LTEsZT1nLmxlbik7Zy5yZXZlcnNlZCYmKEQqPS0xLGUtPUQqKGcuc2VjdG9yfHxnLmxlbikpO2I/KGE9KGEqRCtlLXIpL20rYyxmJiYoYT1nLmxpbjJ2YWwoYSkpKTooZiYmKGE9Zy52YWwybGluKGEpKSxhPUQqKGEtYykqbStlK0QqcisodihxKT9tKnE6MCkpO3JldHVybiBhfSx0b1BpeGVsczpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRyYW5zbGF0ZShhLCExLCF0aGlzLmhvcml6LG51bGwsDQogICAgICAgICAgICAhMCkrKGI/MDp0aGlzLnBvcyl9LHRvVmFsdWU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy50cmFuc2xhdGUoYS0oYj8wOnRoaXMucG9zKSwhMCwhdGhpcy5ob3JpeixudWxsLCEwKX0sZ2V0UGxvdExpbmVQYXRoOmZ1bmN0aW9uKGEsYixkLGMsZil7dmFyIGc9dGhpcy5jaGFydCxxPXRoaXMubGVmdCxEPXRoaXMudG9wLGUsbSxyPWQmJmcub2xkQ2hhcnRIZWlnaHR8fGcuY2hhcnRIZWlnaHQscD1kJiZnLm9sZENoYXJ0V2lkdGh8fGcuY2hhcnRXaWR0aCx4O2U9dGhpcy50cmFuc0I7dmFyIGs9ZnVuY3Rpb24oYSxiLGcpe2lmKGE8Ynx8YT5nKWM/YT1NYXRoLm1pbihNYXRoLm1heChiLGEpLGcpOng9ITA7cmV0dXJuIGF9O2Y9RihmLHRoaXMudHJhbnNsYXRlKGEsbnVsbCxudWxsLGQpKTthPWQ9TWF0aC5yb3VuZChmK2UpO2U9bT1NYXRoLnJvdW5kKHItZi1lKTt2KGYpP3RoaXMuaG9yaXo/KGU9RCxtPXItdGhpcy5ib3R0b20sYT1kPWsoYSxxLHErdGhpcy53aWR0aCkpOihhPXEsZD0NCiAgICAgICAgICAgICAgICBwLXRoaXMucmlnaHQsZT1tPWsoZSxELEQrdGhpcy5oZWlnaHQpKTp4PSEwO3JldHVybiB4JiYhYz9udWxsOmcucmVuZGVyZXIuY3Jpc3BMaW5lKFsiTSIsYSxlLCJMIixkLG1dLGJ8fDEpfSxnZXRMaW5lYXJUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKGEsYixkKXt2YXIgZyxjPW4oTWF0aC5mbG9vcihiL2EpKmEpO2Q9bihNYXRoLmNlaWwoZC9hKSphKTt2YXIgZj1bXTtpZih0aGlzLnNpbmdsZSlyZXR1cm5bYl07Zm9yKGI9YztiPD1kOyl7Zi5wdXNoKGIpO2I9bihiK2EpO2lmKGI9PT1nKWJyZWFrO2c9Yn1yZXR1cm4gZn0sZ2V0TWlub3JUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEub3B0aW9ucyxkPWEudGlja1Bvc2l0aW9ucyxmPWEubWlub3JUaWNrSW50ZXJ2YWwscT1bXSxlPWEucG9pbnRSYW5nZVBhZGRpbmd8fDAsbT1hLm1pbi1lLGU9YS5tYXgrZSxyPWUtbTtpZihyJiZyL2Y8YS5sZW4vMylpZihhLmlzTG9nKWModGhpcy5wYWRkZWRUaWNrcyxmdW5jdGlvbihiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcsZCl7ZyYmcS5wdXNoLmFwcGx5KHEsYS5nZXRMb2dUaWNrUG9zaXRpb25zKGYsZFtnLTFdLGRbZ10sITApKX0pO2Vsc2UgaWYoYS5pc0RhdGV0aW1lQXhpcyYmImF1dG8iPT09Yi5taW5vclRpY2tJbnRlcnZhbClxPXEuY29uY2F0KGEuZ2V0VGltZVRpY2tzKGEubm9ybWFsaXplVGltZVRpY2tJbnRlcnZhbChmKSxtLGUsYi5zdGFydE9mV2VlaykpO2Vsc2UgZm9yKGI9bSsoZFswXS1tKSVmO2I8PWUmJmIhPT1xWzBdO2IrPWYpcS5wdXNoKGIpOzAhPT1xLmxlbmd0aCYmYS50cmltVGlja3MocSk7cmV0dXJuIHF9LGFkanVzdEZvck1pblJhbmdlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5taW4sZD10aGlzLm1heCxmLHE9dGhpcy5kYXRhTWF4LXRoaXMuZGF0YU1pbj49dGhpcy5taW5SYW5nZSxlLG0scixwLHYseDt0aGlzLmlzWEF4aXMmJnZvaWQgMD09PXRoaXMubWluUmFuZ2UmJiF0aGlzLmlzTG9nJiYobChhLm1pbil8fGwoYS5tYXgpP3RoaXMubWluUmFuZ2U9DQogICAgICAgICAgICBudWxsOihjKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe3A9YS54RGF0YTtmb3IobT12PWEueEluY3JlbWVudD8xOnAubGVuZ3RoLTE7MDxtO20tLSlpZihyPXBbbV0tcFttLTFdLHZvaWQgMD09PWV8fHI8ZSllPXJ9KSx0aGlzLm1pblJhbmdlPU1hdGgubWluKDUqZSx0aGlzLmRhdGFNYXgtdGhpcy5kYXRhTWluKSkpO2QtYjx0aGlzLm1pblJhbmdlJiYoeD10aGlzLm1pblJhbmdlLGY9KHgtZCtiKS8yLGY9W2ItZixGKGEubWluLGItZildLHEmJihmWzJdPXRoaXMuaXNMb2c/dGhpcy5sb2cybGluKHRoaXMuZGF0YU1pbik6dGhpcy5kYXRhTWluKSxiPUMoZiksZD1bYit4LEYoYS5tYXgsYit4KV0scSYmKGRbMl09dGhpcy5pc0xvZz90aGlzLmxvZzJsaW4odGhpcy5kYXRhTWF4KTp0aGlzLmRhdGFNYXgpLGQ9RShkKSxkLWI8eCYmKGZbMF09ZC14LGZbMV09RihhLm1pbixkLXgpLGI9QyhmKSkpO3RoaXMubWluPWI7dGhpcy5tYXg9ZH0sZ2V0Q2xvc2VzdDpmdW5jdGlvbigpe3ZhciBhO3RoaXMuY2F0ZWdvcmllcz8NCiAgICAgICAgYT0xOmModGhpcy5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGc9Yi5jbG9zZXN0UG9pbnRSYW5nZSxkPWIudmlzaWJsZXx8IWIuY2hhcnQub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXM7IWIubm9TaGFyZWRUb29sdGlwJiZsKGcpJiZkJiYoYT1sKGEpP01hdGgubWluKGEsZyk6Zyl9KTtyZXR1cm4gYX0sbmFtZVRvWDpmdW5jdGlvbihhKXt2YXIgYj1BKHRoaXMuY2F0ZWdvcmllcyksZz1iP3RoaXMuY2F0ZWdvcmllczp0aGlzLm5hbWVzLGQ9YS5vcHRpb25zLngsYzthLnNlcmllcy5yZXF1aXJlU29ydGluZz0hMTtsKGQpfHwoZD0hMT09PXRoaXMub3B0aW9ucy51bmlxdWVOYW1lcz9hLnNlcmllcy5hdXRvSW5jcmVtZW50KCk6cihhLm5hbWUsZykpOy0xPT09ZD9ifHwoYz1nLmxlbmd0aCk6Yz1kO3RoaXMubmFtZXNbY109YS5uYW1lO3JldHVybiBjfSx1cGRhdGVOYW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXM7MDx0aGlzLm5hbWVzLmxlbmd0aCYmKHRoaXMubmFtZXMubGVuZ3RoPQ0KICAgICAgICAwLHRoaXMubWluUmFuZ2U9dm9pZCAwLGModGhpcy5zZXJpZXN8fFtdLGZ1bmN0aW9uKGIpe2IueEluY3JlbWVudD1udWxsO2lmKCFiLnBvaW50c3x8Yi5pc0RpcnR5RGF0YSliLnByb2Nlc3NEYXRhKCksYi5nZW5lcmF0ZVBvaW50cygpO2MoYi5wb2ludHMsZnVuY3Rpb24oZyxkKXt2YXIgYztnLm9wdGlvbnMmJihjPWEubmFtZVRvWChnKSxjIT09Zy54JiYoZy54PWMsYi54RGF0YVtkXT1jKSl9KX0pKX0sc2V0QXhpc1RyYW5zbGF0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsZz1iLm1heC1iLm1pbixkPWIuYXhpc1BvaW50UmFuZ2V8fDAscSxlPTAsbT0wLHI9Yi5saW5rZWRQYXJlbnQscD0hIWIuY2F0ZWdvcmllcyx2PWIudHJhbnNBLHg9Yi5pc1hBeGlzO2lmKHh8fHB8fGQpcT1iLmdldENsb3Nlc3QoKSxyPyhlPXIubWluUG9pbnRPZmZzZXQsbT1yLnBvaW50UmFuZ2VQYWRkaW5nKTpjKGIuc2VyaWVzLGZ1bmN0aW9uKGEpe3ZhciBnPXA/MTp4P0YoYS5vcHRpb25zLnBvaW50UmFuZ2UsDQogICAgICAgICAgICAgICAgICAgIHEsMCk6Yi5heGlzUG9pbnRSYW5nZXx8MDthPWEub3B0aW9ucy5wb2ludFBsYWNlbWVudDtkPU1hdGgubWF4KGQsZyk7Yi5zaW5nbGV8fChlPU1hdGgubWF4KGUsZihhKT8wOmcvMiksbT1NYXRoLm1heChtLCJvbiI9PT1hPzA6ZykpfSkscj1iLm9yZGluYWxTbG9wZSYmcT9iLm9yZGluYWxTbG9wZS9xOjEsYi5taW5Qb2ludE9mZnNldD1lKj1yLGIucG9pbnRSYW5nZVBhZGRpbmc9bSo9cixiLnBvaW50UmFuZ2U9TWF0aC5taW4oZCxnKSx4JiYoYi5jbG9zZXN0UG9pbnRSYW5nZT1xKTthJiYoYi5vbGRUcmFuc0E9dik7Yi50cmFuc2xhdGlvblNsb3BlPWIudHJhbnNBPXY9Yi5vcHRpb25zLnN0YXRpY1NjYWxlfHxiLmxlbi8oZyttfHwxKTtiLnRyYW5zQj1iLmhvcml6P2IubGVmdDpiLmJvdHRvbTtiLm1pblBpeGVsUGFkZGluZz12KmV9LG1pbkZyb21SYW5nZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1heC10aGlzLnJhbmdlfSxzZXRUaWNrSW50ZXJ2YWw6ZnVuY3Rpb24oYil7dmFyIGc9DQogICAgICAgIHRoaXMsZD1nLmNoYXJ0LGY9Zy5vcHRpb25zLHE9Zy5pc0xvZyxlPWcubG9nMmxpbixyPWcuaXNEYXRldGltZUF4aXMscD1nLmlzWEF4aXMseD1nLmlzTGlua2VkLGs9Zi5tYXhQYWRkaW5nLGg9Zi5taW5QYWRkaW5nLHk9Zi50aWNrSW50ZXJ2YWwsQT1mLnRpY2tQaXhlbEludGVydmFsLEo9Zy5jYXRlZ29yaWVzLHQ9Zy50aHJlc2hvbGQsdT1nLnNvZnRUaHJlc2hvbGQsTCxLLHosQjtyfHxKfHx4fHx0aGlzLmdldFRpY2tBbW91bnQoKTt6PUYoZy51c2VyTWluLGYubWluKTtCPUYoZy51c2VyTWF4LGYubWF4KTt4PyhnLmxpbmtlZFBhcmVudD1kW2cuY29sbF1bZi5saW5rZWRUb10sZD1nLmxpbmtlZFBhcmVudC5nZXRFeHRyZW1lcygpLGcubWluPUYoZC5taW4sZC5kYXRhTWluKSxnLm1heD1GKGQubWF4LGQuZGF0YU1heCksZi50eXBlIT09Zy5saW5rZWRQYXJlbnQub3B0aW9ucy50eXBlJiZhLmVycm9yKDExLDEpKTooIXUmJmwodCkmJihnLmRhdGFNaW4+PXQ/KEw9dCxoPTApOmcuZGF0YU1heDw9DQogICAgICAgICAgICB0JiYoSz10LGs9MCkpLGcubWluPUYoeixMLGcuZGF0YU1pbiksZy5tYXg9RihCLEssZy5kYXRhTWF4KSk7cSYmKGcucG9zaXRpdmVWYWx1ZXNPbmx5JiYhYiYmMD49TWF0aC5taW4oZy5taW4sRihnLmRhdGFNaW4sZy5taW4pKSYmYS5lcnJvcigxMCwxKSxnLm1pbj1uKGUoZy5taW4pLDE1KSxnLm1heD1uKGUoZy5tYXgpLDE1KSk7Zy5yYW5nZSYmbChnLm1heCkmJihnLnVzZXJNaW49Zy5taW49ej1NYXRoLm1heChnLm1pbixnLm1pbkZyb21SYW5nZSgpKSxnLnVzZXJNYXg9Qj1nLm1heCxnLnJhbmdlPW51bGwpO0goZywiZm91bmRFeHRyZW1lcyIpO2cuYmVmb3JlUGFkZGluZyYmZy5iZWZvcmVQYWRkaW5nKCk7Zy5hZGp1c3RGb3JNaW5SYW5nZSgpOyEoSnx8Zy5heGlzUG9pbnRSYW5nZXx8Zy51c2VQZXJjZW50YWdlfHx4KSYmbChnLm1pbikmJmwoZy5tYXgpJiYoZT1nLm1heC1nLm1pbikmJighbCh6KSYmaCYmKGcubWluLT1lKmgpLCFsKEIpJiZrJiYoZy5tYXgrPWUqaykpO3YoZi5mbG9vcik/DQogICAgICAgIGcubWluPU1hdGgubWF4KGcubWluLGYuZmxvb3IpOnYoZi5zb2Z0TWluKSYmKGcubWluPU1hdGgubWluKGcubWluLGYuc29mdE1pbikpO3YoZi5jZWlsaW5nKT9nLm1heD1NYXRoLm1pbihnLm1heCxmLmNlaWxpbmcpOnYoZi5zb2Z0TWF4KSYmKGcubWF4PU1hdGgubWF4KGcubWF4LGYuc29mdE1heCkpO3UmJmwoZy5kYXRhTWluKSYmKHQ9dHx8MCwhbCh6KSYmZy5taW48dCYmZy5kYXRhTWluPj10P2cubWluPXQ6IWwoQikmJmcubWF4PnQmJmcuZGF0YU1heDw9dCYmKGcubWF4PXQpKTtnLnRpY2tJbnRlcnZhbD1nLm1pbj09PWcubWF4fHx2b2lkIDA9PT1nLm1pbnx8dm9pZCAwPT09Zy5tYXg/MTp4JiYheSYmQT09PWcubGlua2VkUGFyZW50Lm9wdGlvbnMudGlja1BpeGVsSW50ZXJ2YWw/eT1nLmxpbmtlZFBhcmVudC50aWNrSW50ZXJ2YWw6Rih5LHRoaXMudGlja0Ftb3VudD8oZy5tYXgtZy5taW4pL01hdGgubWF4KHRoaXMudGlja0Ftb3VudC0xLDEpOnZvaWQgMCxKPzE6KGcubWF4LQ0KICAgICAgICAgICAgICAgIGcubWluKSpBL01hdGgubWF4KGcubGVuLEEpKTtwJiYhYiYmYyhnLnNlcmllcyxmdW5jdGlvbihhKXthLnByb2Nlc3NEYXRhKGcubWluIT09Zy5vbGRNaW58fGcubWF4IT09Zy5vbGRNYXgpfSk7Zy5zZXRBeGlzVHJhbnNsYXRpb24oITApO2cuYmVmb3JlU2V0VGlja1Bvc2l0aW9ucyYmZy5iZWZvcmVTZXRUaWNrUG9zaXRpb25zKCk7Zy5wb3N0UHJvY2Vzc1RpY2tJbnRlcnZhbCYmKGcudGlja0ludGVydmFsPWcucG9zdFByb2Nlc3NUaWNrSW50ZXJ2YWwoZy50aWNrSW50ZXJ2YWwpKTtnLnBvaW50UmFuZ2UmJiF5JiYoZy50aWNrSW50ZXJ2YWw9TWF0aC5tYXgoZy5wb2ludFJhbmdlLGcudGlja0ludGVydmFsKSk7Yj1GKGYubWluVGlja0ludGVydmFsLGcuaXNEYXRldGltZUF4aXMmJmcuY2xvc2VzdFBvaW50UmFuZ2UpOyF5JiZnLnRpY2tJbnRlcnZhbDxiJiYoZy50aWNrSW50ZXJ2YWw9Yik7cnx8cXx8eXx8KGcudGlja0ludGVydmFsPUcoZy50aWNrSW50ZXJ2YWwsbnVsbCxtKGcudGlja0ludGVydmFsKSwNCiAgICAgICAgRihmLmFsbG93RGVjaW1hbHMsISguNTxnLnRpY2tJbnRlcnZhbCYmNT5nLnRpY2tJbnRlcnZhbCYmMUUzPGcubWF4JiY5OTk5PmcubWF4KSksISF0aGlzLnRpY2tBbW91bnQpKTt0aGlzLnRpY2tBbW91bnR8fChnLnRpY2tJbnRlcnZhbD1nLnVuc3F1aXNoKCkpO3RoaXMuc2V0VGlja1Bvc2l0aW9ucygpfSxzZXRUaWNrUG9zaXRpb25zOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGIsZD1hLnRpY2tQb3NpdGlvbnMsYz1hLnRpY2tQb3NpdGlvbmVyLGY9YS5zdGFydE9uVGljayxxPWEuZW5kT25UaWNrO3RoaXMudGlja21hcmtPZmZzZXQ9dGhpcy5jYXRlZ29yaWVzJiYiYmV0d2VlbiI9PT1hLnRpY2ttYXJrUGxhY2VtZW50JiYxPT09dGhpcy50aWNrSW50ZXJ2YWw/LjU6MDt0aGlzLm1pbm9yVGlja0ludGVydmFsPSJhdXRvIj09PWEubWlub3JUaWNrSW50ZXJ2YWwmJnRoaXMudGlja0ludGVydmFsP3RoaXMudGlja0ludGVydmFsLzU6YS5taW5vclRpY2tJbnRlcnZhbDt0aGlzLnNpbmdsZT0NCiAgICAgICAgdGhpcy5taW49PT10aGlzLm1heCYmbCh0aGlzLm1pbikmJiF0aGlzLnRpY2tBbW91bnQmJiExIT09YS5hbGxvd0RlY2ltYWxzO3RoaXMudGlja1Bvc2l0aW9ucz1iPWQmJmQuc2xpY2UoKTshYiYmKGI9dGhpcy5pc0RhdGV0aW1lQXhpcz90aGlzLmdldFRpbWVUaWNrcyh0aGlzLm5vcm1hbGl6ZVRpbWVUaWNrSW50ZXJ2YWwodGhpcy50aWNrSW50ZXJ2YWwsYS51bml0cyksdGhpcy5taW4sdGhpcy5tYXgsYS5zdGFydE9mV2Vlayx0aGlzLm9yZGluYWxQb3NpdGlvbnMsdGhpcy5jbG9zZXN0UG9pbnRSYW5nZSwhMCk6dGhpcy5pc0xvZz90aGlzLmdldExvZ1RpY2tQb3NpdGlvbnModGhpcy50aWNrSW50ZXJ2YWwsdGhpcy5taW4sdGhpcy5tYXgpOnRoaXMuZ2V0TGluZWFyVGlja1Bvc2l0aW9ucyh0aGlzLnRpY2tJbnRlcnZhbCx0aGlzLm1pbix0aGlzLm1heCksYi5sZW5ndGg+dGhpcy5sZW4mJihiPVtiWzBdLGIucG9wKCldKSx0aGlzLnRpY2tQb3NpdGlvbnM9YixjJiYoYz1jLmFwcGx5KHRoaXMsDQogICAgICAgIFt0aGlzLm1pbix0aGlzLm1heF0pKSkmJih0aGlzLnRpY2tQb3NpdGlvbnM9Yj1jKTt0aGlzLnBhZGRlZFRpY2tzPWIuc2xpY2UoMCk7dGhpcy50cmltVGlja3MoYixmLHEpO3RoaXMuaXNMaW5rZWR8fCh0aGlzLnNpbmdsZSYmKHRoaXMubWluLT0uNSx0aGlzLm1heCs9LjUpLGR8fGN8fHRoaXMuYWRqdXN0VGlja0Ftb3VudCgpKX0sdHJpbVRpY2tzOmZ1bmN0aW9uKGEsYixkKXt2YXIgZz1hWzBdLGM9YVthLmxlbmd0aC0xXSxmPXRoaXMubWluUG9pbnRPZmZzZXR8fDA7aWYoIXRoaXMuaXNMaW5rZWQpe2lmKGIpdGhpcy5taW49ZztlbHNlIGZvcig7dGhpcy5taW4tZj5hWzBdOylhLnNoaWZ0KCk7aWYoZCl0aGlzLm1heD1jO2Vsc2UgZm9yKDt0aGlzLm1heCtmPGFbYS5sZW5ndGgtMV07KWEucG9wKCk7MD09PWEubGVuZ3RoJiZsKGcpJiZhLnB1c2goKGMrZykvMil9fSxhbGlnblRvT3RoZXJzOmZ1bmN0aW9uKCl7dmFyIGE9e30sYixkPXRoaXMub3B0aW9uczshMT09PXRoaXMuY2hhcnQub3B0aW9ucy5jaGFydC5hbGlnblRpY2tzfHwNCiAgICAhMT09PWQuYWxpZ25UaWNrc3x8dGhpcy5pc0xvZ3x8Yyh0aGlzLmNoYXJ0W3RoaXMuY29sbF0sZnVuY3Rpb24oZyl7dmFyIGQ9Zy5vcHRpb25zLGQ9W2cuaG9yaXo/ZC5sZWZ0OmQudG9wLGQud2lkdGgsZC5oZWlnaHQsZC5wYW5lXS5qb2luKCk7Zy5zZXJpZXMubGVuZ3RoJiYoYVtkXT9iPSEwOmFbZF09MSl9KTtyZXR1cm4gYn0sZ2V0VGlja0Ftb3VudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucyxiPWEudGlja0Ftb3VudCxkPWEudGlja1BpeGVsSW50ZXJ2YWw7IWwoYS50aWNrSW50ZXJ2YWwpJiZ0aGlzLmxlbjxkJiYhdGhpcy5pc1JhZGlhbCYmIXRoaXMuaXNMb2cmJmEuc3RhcnRPblRpY2smJmEuZW5kT25UaWNrJiYoYj0yKTshYiYmdGhpcy5hbGlnblRvT3RoZXJzKCkmJihiPU1hdGguY2VpbCh0aGlzLmxlbi9kKSsxKTs0PmImJih0aGlzLmZpbmFsVGlja0FtdD1iLGI9NSk7dGhpcy50aWNrQW1vdW50PWJ9LGFkanVzdFRpY2tBbW91bnQ6ZnVuY3Rpb24oKXt2YXIgYT0NCiAgICAgICAgdGhpcy50aWNrSW50ZXJ2YWwsYj10aGlzLnRpY2tQb3NpdGlvbnMsZD10aGlzLnRpY2tBbW91bnQsYz10aGlzLmZpbmFsVGlja0FtdCxmPWImJmIubGVuZ3RoO2lmKGY8ZCl7Zm9yKDtiLmxlbmd0aDxkOyliLnB1c2gobihiW2IubGVuZ3RoLTFdK2EpKTt0aGlzLnRyYW5zQSo9KGYtMSkvKGQtMSk7dGhpcy5tYXg9YltiLmxlbmd0aC0xXX1lbHNlIGY+ZCYmKHRoaXMudGlja0ludGVydmFsKj0yLHRoaXMuc2V0VGlja1Bvc2l0aW9ucygpKTtpZihsKGMpKXtmb3IoYT1kPWIubGVuZ3RoO2EtLTspKDM9PT1jJiYxPT09YSUyfHwyPj1jJiYwPGEmJmE8ZC0xKSYmYi5zcGxpY2UoYSwxKTt0aGlzLmZpbmFsVGlja0FtdD12b2lkIDB9fSxzZXRTY2FsZTpmdW5jdGlvbigpe3ZhciBhLGI7dGhpcy5vbGRNaW49dGhpcy5taW47dGhpcy5vbGRNYXg9dGhpcy5tYXg7dGhpcy5vbGRBeGlzTGVuZ3RoPXRoaXMubGVuO3RoaXMuc2V0QXhpc1NpemUoKTtiPXRoaXMubGVuIT09dGhpcy5vbGRBeGlzTGVuZ3RoOw0KICAgICAgICBjKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe2lmKGIuaXNEaXJ0eURhdGF8fGIuaXNEaXJ0eXx8Yi54QXhpcy5pc0RpcnR5KWE9ITB9KTtifHxhfHx0aGlzLmlzTGlua2VkfHx0aGlzLmZvcmNlUmVkcmF3fHx0aGlzLnVzZXJNaW4hPT10aGlzLm9sZFVzZXJNaW58fHRoaXMudXNlck1heCE9PXRoaXMub2xkVXNlck1heHx8dGhpcy5hbGlnblRvT3RoZXJzKCk/KHRoaXMucmVzZXRTdGFja3MmJnRoaXMucmVzZXRTdGFja3MoKSx0aGlzLmZvcmNlUmVkcmF3PSExLHRoaXMuZ2V0U2VyaWVzRXh0cmVtZXMoKSx0aGlzLnNldFRpY2tJbnRlcnZhbCgpLHRoaXMub2xkVXNlck1pbj10aGlzLnVzZXJNaW4sdGhpcy5vbGRVc2VyTWF4PXRoaXMudXNlck1heCx0aGlzLmlzRGlydHl8fCh0aGlzLmlzRGlydHk9Ynx8dGhpcy5taW4hPT10aGlzLm9sZE1pbnx8dGhpcy5tYXghPT10aGlzLm9sZE1heCkpOnRoaXMuY2xlYW5TdGFja3MmJnRoaXMuY2xlYW5TdGFja3MoKX0sc2V0RXh0cmVtZXM6ZnVuY3Rpb24oYSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIsZCxmLHEpe3ZhciBnPXRoaXMsZT1nLmNoYXJ0O2Q9RihkLCEwKTtjKGcuc2VyaWVzLGZ1bmN0aW9uKGEpe2RlbGV0ZSBhLmtkVHJlZX0pO3E9cChxLHttaW46YSxtYXg6Yn0pO0goZywic2V0RXh0cmVtZXMiLHEsZnVuY3Rpb24oKXtnLnVzZXJNaW49YTtnLnVzZXJNYXg9YjtnLmV2ZW50QXJncz1xO2QmJmUucmVkcmF3KGYpfSl9LHpvb206ZnVuY3Rpb24oYSxiKXt2YXIgZz10aGlzLmRhdGFNaW4sZD10aGlzLmRhdGFNYXgsYz10aGlzLm9wdGlvbnMsZj1NYXRoLm1pbihnLEYoYy5taW4sZykpLGM9TWF0aC5tYXgoZCxGKGMubWF4LGQpKTtpZihhIT09dGhpcy5taW58fGIhPT10aGlzLm1heCl0aGlzLmFsbG93Wm9vbU91dHNpZGV8fChsKGcpJiYoYTxmJiYoYT1mKSxhPmMmJihhPWMpKSxsKGQpJiYoYjxmJiYoYj1mKSxiPmMmJihiPWMpKSksdGhpcy5kaXNwbGF5QnRuPXZvaWQgMCE9PWF8fHZvaWQgMCE9PWIsdGhpcy5zZXRFeHRyZW1lcyhhLGIsITEsdm9pZCAwLHt0cmlnZ2VyOiJ6b29tIn0pOw0KICAgICAgICByZXR1cm4hMH0sc2V0QXhpc1NpemU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5vcHRpb25zLGQ9Yi5vZmZzZXRzfHxbMCwwLDAsMF0sYz10aGlzLmhvcml6LGY9RihiLndpZHRoLGEucGxvdFdpZHRoLWRbM10rZFsxXSkscT1GKGIuaGVpZ2h0LGEucGxvdEhlaWdodC1kWzBdK2RbMl0pLGU9RihiLnRvcCxhLnBsb3RUb3ArZFswXSksYj1GKGIubGVmdCxhLnBsb3RMZWZ0K2RbM10pLGQ9LyUkLztkLnRlc3QocSkmJihxPU1hdGgucm91bmQocGFyc2VGbG9hdChxKS8xMDAqYS5wbG90SGVpZ2h0KSk7ZC50ZXN0KGUpJiYoZT1NYXRoLnJvdW5kKHBhcnNlRmxvYXQoZSkvMTAwKmEucGxvdEhlaWdodCthLnBsb3RUb3ApKTt0aGlzLmxlZnQ9Yjt0aGlzLnRvcD1lO3RoaXMud2lkdGg9Zjt0aGlzLmhlaWdodD1xO3RoaXMuYm90dG9tPWEuY2hhcnRIZWlnaHQtcS1lO3RoaXMucmlnaHQ9YS5jaGFydFdpZHRoLWYtYjt0aGlzLmxlbj1NYXRoLm1heChjP2Y6cSwwKTt0aGlzLnBvcz0NCiAgICAgICAgYz9iOmV9LGdldEV4dHJlbWVzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5pc0xvZyxiPXRoaXMubGluMmxvZztyZXR1cm57bWluOmE/bihiKHRoaXMubWluKSk6dGhpcy5taW4sbWF4OmE/bihiKHRoaXMubWF4KSk6dGhpcy5tYXgsZGF0YU1pbjp0aGlzLmRhdGFNaW4sZGF0YU1heDp0aGlzLmRhdGFNYXgsdXNlck1pbjp0aGlzLnVzZXJNaW4sdXNlck1heDp0aGlzLnVzZXJNYXh9fSxnZXRUaHJlc2hvbGQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5pc0xvZyxnPXRoaXMubGluMmxvZyxkPWI/Zyh0aGlzLm1pbik6dGhpcy5taW4sYj1iP2codGhpcy5tYXgpOnRoaXMubWF4O251bGw9PT1hP2E9ZDpkPmE/YT1kOmI8YSYmKGE9Yik7cmV0dXJuIHRoaXMudHJhbnNsYXRlKGEsMCwxLDAsMSl9LGF1dG9MYWJlbEFsaWduOmZ1bmN0aW9uKGEpe2E9KEYoYSwwKS05MCp0aGlzLnNpZGUrNzIwKSUzNjA7cmV0dXJuIDE1PGEmJjE2NT5hPyJyaWdodCI6MTk1PGEmJjM0NT5hPyJsZWZ0IjoiY2VudGVyIn0sDQogICAgdGlja1NpemU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGc9YlthKyJMZW5ndGgiXSxkPUYoYlthKyJXaWR0aCJdLCJ0aWNrIj09PWEmJnRoaXMuaXNYQXhpcz8xOjApO2lmKGQmJmcpcmV0dXJuImluc2lkZSI9PT1iW2ErIlBvc2l0aW9uIl0mJihnPS1nKSxbZyxkXX0sbGFiZWxNZXRyaWNzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hhcnQucmVuZGVyZXIuZm9udE1ldHJpY3ModGhpcy5vcHRpb25zLmxhYmVscy5zdHlsZSYmdGhpcy5vcHRpb25zLmxhYmVscy5zdHlsZS5mb250U2l6ZSx0aGlzLnRpY2tzWzBdJiZ0aGlzLnRpY2tzWzBdLmxhYmVsKX0sdW5zcXVpc2g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMubGFiZWxzLGI9dGhpcy5ob3JpeixkPXRoaXMudGlja0ludGVydmFsLGY9ZCxxPXRoaXMubGVuLygoKHRoaXMuY2F0ZWdvcmllcz8xOjApK3RoaXMubWF4LXRoaXMubWluKS9kKSxlLG09YS5yb3RhdGlvbixyPXRoaXMubGFiZWxNZXRyaWNzKCkscCx4PQ0KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFLHYsaD1mdW5jdGlvbihhKXthLz1xfHwxO2E9MTxhP01hdGguY2VpbChhKToxO3JldHVybiBhKmR9O2I/KHY9IWEuc3RhZ2dlckxpbmVzJiYhYS5zdGVwJiYobChtKT9bbV06cTxGKGEuYXV0b1JvdGF0aW9uTGltaXQsODApJiZhLmF1dG9Sb3RhdGlvbikpJiZjKHYsZnVuY3Rpb24oYSl7dmFyIGI7aWYoYT09PW18fGEmJi05MDw9YSYmOTA+PWEpcD1oKE1hdGguYWJzKHIuaC9NYXRoLnNpbihrKmEpKSksYj1wK01hdGguYWJzKGEvMzYwKSxiPHgmJih4PWIsZT1hLGY9cCl9KTphLnN0ZXB8fChmPWgoci5oKSk7dGhpcy5hdXRvUm90YXRpb249djt0aGlzLmxhYmVsUm90YXRpb249RihlLG0pO3JldHVybiBmfSxnZXRTbG90V2lkdGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5ob3JpeixkPXRoaXMub3B0aW9ucy5sYWJlbHMsYz1NYXRoLm1heCh0aGlzLnRpY2tQb3NpdGlvbnMubGVuZ3RoLSh0aGlzLmNhdGVnb3JpZXM/MDoxKSwxKSxmPWEubWFyZ2luWzNdOw0KICAgICAgICByZXR1cm4gYiYmMj4oZC5zdGVwfHwwKSYmIWQucm90YXRpb24mJih0aGlzLnN0YWdnZXJMaW5lc3x8MSkqdGhpcy5sZW4vY3x8IWImJihmJiZmLWEuc3BhY2luZ1szXXx8LjMzKmEuY2hhcnRXaWR0aCl9LHJlbmRlclVuc3F1aXNoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxiPWEucmVuZGVyZXIsZD10aGlzLnRpY2tQb3NpdGlvbnMscT10aGlzLnRpY2tzLGU9dGhpcy5vcHRpb25zLmxhYmVscyxtPXRoaXMuaG9yaXoscj10aGlzLmdldFNsb3RXaWR0aCgpLHA9TWF0aC5tYXgoMSxNYXRoLnJvdW5kKHItMiooZS5wYWRkaW5nfHw1KSkpLHg9e30sdj10aGlzLmxhYmVsTWV0cmljcygpLGs9ZS5zdHlsZSYmZS5zdHlsZS50ZXh0T3ZlcmZsb3csaCxsPTAsQSxuO2YoZS5yb3RhdGlvbil8fCh4LnJvdGF0aW9uPWUucm90YXRpb258fDApO2MoZCxmdW5jdGlvbihhKXsoYT1xW2FdKSYmYS5sYWJlbExlbmd0aD5sJiYobD1hLmxhYmVsTGVuZ3RoKX0pO3RoaXMubWF4TGFiZWxMZW5ndGg9DQogICAgICAgIGw7aWYodGhpcy5hdXRvUm90YXRpb24pbD5wJiZsPnYuaD94LnJvdGF0aW9uPXRoaXMubGFiZWxSb3RhdGlvbjp0aGlzLmxhYmVsUm90YXRpb249MDtlbHNlIGlmKHImJihoPXt3aWR0aDpwKyJweCJ9LCFrKSlmb3IoaC50ZXh0T3ZlcmZsb3c9ImNsaXAiLEE9ZC5sZW5ndGg7IW0mJkEtLTspaWYobj1kW0FdLHA9cVtuXS5sYWJlbClwLnN0eWxlcyYmImVsbGlwc2lzIj09PXAuc3R5bGVzLnRleHRPdmVyZmxvdz9wLmNzcyh7dGV4dE92ZXJmbG93OiJjbGlwIn0pOnFbbl0ubGFiZWxMZW5ndGg+ciYmcC5jc3Moe3dpZHRoOnIrInB4In0pLHAuZ2V0QkJveCgpLmhlaWdodD50aGlzLmxlbi9kLmxlbmd0aC0odi5oLXYuZikmJihwLnNwZWNDc3M9e3RleHRPdmVyZmxvdzoiZWxsaXBzaXMifSk7eC5yb3RhdGlvbiYmKGg9e3dpZHRoOihsPi41KmEuY2hhcnRIZWlnaHQ/LjMzKmEuY2hhcnRIZWlnaHQ6YS5jaGFydEhlaWdodCkrInB4In0sa3x8KGgudGV4dE92ZXJmbG93PSJlbGxpcHNpcyIpKTsNCiAgICAgICAgaWYodGhpcy5sYWJlbEFsaWduPWUuYWxpZ258fHRoaXMuYXV0b0xhYmVsQWxpZ24odGhpcy5sYWJlbFJvdGF0aW9uKSl4LmFsaWduPXRoaXMubGFiZWxBbGlnbjtjKGQsZnVuY3Rpb24oYSl7dmFyIGI9KGE9cVthXSkmJmEubGFiZWw7YiYmKGIuYXR0cih4KSxoJiZiLmNzcyh5KGgsYi5zcGVjQ3NzKSksZGVsZXRlIGIuc3BlY0NzcyxhLnJvdGF0aW9uPXgucm90YXRpb24pfSk7dGhpcy50aWNrUm90Q29ycj1iLnJvdENvcnIodi5iLHRoaXMubGFiZWxSb3RhdGlvbnx8MCwwIT09dGhpcy5zaWRlKX0saGFzRGF0YTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc1Zpc2libGVTZXJpZXN8fGwodGhpcy5taW4pJiZsKHRoaXMubWF4KSYmISF0aGlzLnRpY2tQb3NpdGlvbnN9LGFkZFRpdGxlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQucmVuZGVyZXIsZD10aGlzLmhvcml6LGc9dGhpcy5vcHBvc2l0ZSxjPXRoaXMub3B0aW9ucy50aXRsZSxmO3RoaXMuYXhpc1RpdGxlfHwoKGY9Yy50ZXh0QWxpZ24pfHwNCiAgICAoZj0oZD97bG93OiJsZWZ0IixtaWRkbGU6ImNlbnRlciIsaGlnaDoicmlnaHQifTp7bG93Omc/InJpZ2h0IjoibGVmdCIsbWlkZGxlOiJjZW50ZXIiLGhpZ2g6Zz8ibGVmdCI6InJpZ2h0In0pW2MuYWxpZ25dKSx0aGlzLmF4aXNUaXRsZT1iLnRleHQoYy50ZXh0LDAsMCxjLnVzZUhUTUwpLmF0dHIoe3pJbmRleDo3LHJvdGF0aW9uOmMucm90YXRpb258fDAsYWxpZ246Zn0pLmFkZENsYXNzKCJoaWdoY2hhcnRzLWF4aXMtdGl0bGUiKS5jc3MoYy5zdHlsZSkuYWRkKHRoaXMuYXhpc0dyb3VwKSx0aGlzLmF4aXNUaXRsZS5pc05ldz0hMCk7dGhpcy5heGlzVGl0bGVbYT8ic2hvdyI6ImhpZGUiXSghMCl9LGdlbmVyYXRlVGljazpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnRpY2tzO2JbYV0/YlthXS5hZGRMYWJlbCgpOmJbYV09bmV3IEwodGhpcyxhKX0sZ2V0T2Zmc2V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxiPWEuY2hhcnQsZD1iLnJlbmRlcmVyLGY9YS5vcHRpb25zLHE9YS50aWNrUG9zaXRpb25zLA0KICAgICAgICBlPWEudGlja3MsbT1hLmhvcml6LHI9YS5zaWRlLHA9Yi5pbnZlcnRlZD9bMSwwLDMsMl1bcl06cix4LHYsaD0wLGsseT0wLEE9Zi50aXRsZSxuPWYubGFiZWxzLEc9MCxKPWIuYXhpc09mZnNldCxiPWIuY2xpcE9mZnNldCx0PVstMSwxLDEsLTFdW3JdLHUsSD1mLmNsYXNzTmFtZSxMPWEuYXhpc1BhcmVudCxLPXRoaXMudGlja1NpemUoInRpY2siKTt4PWEuaGFzRGF0YSgpO2Euc2hvd0F4aXM9dj14fHxGKGYuc2hvd0VtcHR5LCEwKTthLnN0YWdnZXJMaW5lcz1hLmhvcml6JiZuLnN0YWdnZXJMaW5lczthLmF4aXNHcm91cHx8KGEuZ3JpZEdyb3VwPWQuZygiZ3JpZCIpLmF0dHIoe3pJbmRleDpmLmdyaWRaSW5kZXh8fDF9KS5hZGRDbGFzcygiaGlnaGNoYXJ0cy0iK3RoaXMuY29sbC50b0xvd2VyQ2FzZSgpKyItZ3JpZCAiKyhIfHwiIikpLmFkZChMKSxhLmF4aXNHcm91cD1kLmcoImF4aXMiKS5hdHRyKHt6SW5kZXg6Zi56SW5kZXh8fDJ9KS5hZGRDbGFzcygiaGlnaGNoYXJ0cy0iK3RoaXMuY29sbC50b0xvd2VyQ2FzZSgpKw0KICAgICAgICAiICIrKEh8fCIiKSkuYWRkKEwpLGEubGFiZWxHcm91cD1kLmcoImF4aXMtbGFiZWxzIikuYXR0cih7ekluZGV4Om4uekluZGV4fHw3fSkuYWRkQ2xhc3MoImhpZ2hjaGFydHMtIithLmNvbGwudG9Mb3dlckNhc2UoKSsiLWxhYmVscyAiKyhIfHwiIikpLmFkZChMKSk7aWYoeHx8YS5pc0xpbmtlZCljKHEsZnVuY3Rpb24oYixkKXthLmdlbmVyYXRlVGljayhiLGQpfSksYS5yZW5kZXJVbnNxdWlzaCgpLCExPT09bi5yZXNlcnZlU3BhY2V8fDAhPT1yJiYyIT09ciYmezE6ImxlZnQiLDM6InJpZ2h0In1bcl0hPT1hLmxhYmVsQWxpZ24mJiJjZW50ZXIiIT09YS5sYWJlbEFsaWdufHxjKHEsZnVuY3Rpb24oYSl7Rz1NYXRoLm1heChlW2FdLmdldExhYmVsU2l6ZSgpLEcpfSksYS5zdGFnZ2VyTGluZXMmJihHKj1hLnN0YWdnZXJMaW5lcyxhLmxhYmVsT2Zmc2V0PUcqKGEub3Bwb3NpdGU/LTE6MSkpO2Vsc2UgZm9yKHUgaW4gZSllW3VdLmRlc3Ryb3koKSxkZWxldGUgZVt1XTtBJiZBLnRleHQmJg0KICAgICExIT09QS5lbmFibGVkJiYoYS5hZGRUaXRsZSh2KSx2JiYoaD1hLmF4aXNUaXRsZS5nZXRCQm94KClbbT8iaGVpZ2h0Ijoid2lkdGgiXSxrPUEub2Zmc2V0LHk9bChrKT8wOkYoQS5tYXJnaW4sbT81OjEwKSkpO2EucmVuZGVyTGluZSgpO2Eub2Zmc2V0PXQqRihmLm9mZnNldCxKW3JdKTthLnRpY2tSb3RDb3JyPWEudGlja1JvdENvcnJ8fHt4OjAseTowfTtkPTA9PT1yPy1hLmxhYmVsTWV0cmljcygpLmg6Mj09PXI/YS50aWNrUm90Q29yci55OjA7eT1NYXRoLmFicyhHKSt5O0cmJih5PXktZCt0KihtP0Yobi55LGEudGlja1JvdENvcnIueSs4KnQpOm4ueCkpO2EuYXhpc1RpdGxlTWFyZ2luPUYoayx5KTtKW3JdPU1hdGgubWF4KEpbcl0sYS5heGlzVGl0bGVNYXJnaW4raCt0KmEub2Zmc2V0LHkseCYmcS5sZW5ndGgmJks/S1swXSt0KmEub2Zmc2V0OjApO2Y9Zi5vZmZzZXQ/MDoyKk1hdGguZmxvb3IoYS5heGlzTGluZS5zdHJva2VXaWR0aCgpLzIpO2JbcF09TWF0aC5tYXgoYltwXSwNCiAgICAgICAgZil9LGdldExpbmVQYXRoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsZD10aGlzLm9wcG9zaXRlLGc9dGhpcy5vZmZzZXQsZj10aGlzLmhvcml6LGM9dGhpcy5sZWZ0KyhkP3RoaXMud2lkdGg6MCkrZyxnPWIuY2hhcnRIZWlnaHQtdGhpcy5ib3R0b20tKGQ/dGhpcy5oZWlnaHQ6MCkrZztkJiYoYSo9LTEpO3JldHVybiBiLnJlbmRlcmVyLmNyaXNwTGluZShbIk0iLGY/dGhpcy5sZWZ0OmMsZj9nOnRoaXMudG9wLCJMIixmP2IuY2hhcnRXaWR0aC10aGlzLnJpZ2h0OmMsZj9nOmIuY2hhcnRIZWlnaHQtdGhpcy5ib3R0b21dLGEpfSxyZW5kZXJMaW5lOmZ1bmN0aW9uKCl7dGhpcy5heGlzTGluZXx8KHRoaXMuYXhpc0xpbmU9dGhpcy5jaGFydC5yZW5kZXJlci5wYXRoKCkuYWRkQ2xhc3MoImhpZ2hjaGFydHMtYXhpcy1saW5lIikuYWRkKHRoaXMuYXhpc0dyb3VwKSx0aGlzLmF4aXNMaW5lLmF0dHIoe3N0cm9rZTp0aGlzLm9wdGlvbnMubGluZUNvbG9yLCJzdHJva2Utd2lkdGgiOnRoaXMub3B0aW9ucy5saW5lV2lkdGgsDQogICAgICAgIHpJbmRleDo3fSkpfSxnZXRUaXRsZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5ob3JpeixiPXRoaXMubGVmdCxkPXRoaXMudG9wLGY9dGhpcy5sZW4sYz10aGlzLm9wdGlvbnMudGl0bGUscT1hP2I6ZCxlPXRoaXMub3Bwb3NpdGUsbT10aGlzLm9mZnNldCxyPWMueHx8MCxwPWMueXx8MCx4PXRoaXMuY2hhcnQucmVuZGVyZXIuZm9udE1ldHJpY3MoYy5zdHlsZSYmYy5zdHlsZS5mb250U2l6ZSx0aGlzLmF4aXNUaXRsZSkuZixmPXtsb3c6cSsoYT8wOmYpLG1pZGRsZTpxK2YvMixoaWdoOnErKGE/ZjowKX1bYy5hbGlnbl0sYj0oYT9kK3RoaXMuaGVpZ2h0OmIpKyhhPzE6LTEpKihlPy0xOjEpKnRoaXMuYXhpc1RpdGxlTWFyZ2luKygyPT09dGhpcy5zaWRlP3g6MCk7cmV0dXJue3g6YT9mK3I6YisoZT90aGlzLndpZHRoOjApK20rcix5OmE/YitwLShlP3RoaXMuaGVpZ2h0OjApK206ZitwfX0scmVuZGVyTWlub3JUaWNrOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQuaGFzUmVuZGVyZWQmJg0KICAgICAgICB2KHRoaXMub2xkTWluKSxkPXRoaXMubWlub3JUaWNrcztkW2FdfHwoZFthXT1uZXcgTCh0aGlzLGEsIm1pbm9yIikpO2ImJmRbYV0uaXNOZXcmJmRbYV0ucmVuZGVyKG51bGwsITApO2RbYV0ucmVuZGVyKG51bGwsITEsMSl9LHJlbmRlclRpY2s6ZnVuY3Rpb24oYSxiKXt2YXIgZD10aGlzLmlzTGlua2VkLGc9dGhpcy50aWNrcyxmPXRoaXMuY2hhcnQuaGFzUmVuZGVyZWQmJnYodGhpcy5vbGRNaW4pO2lmKCFkfHxhPj10aGlzLm1pbiYmYTw9dGhpcy5tYXgpZ1thXXx8KGdbYV09bmV3IEwodGhpcyxhKSksZiYmZ1thXS5pc05ldyYmZ1thXS5yZW5kZXIoYiwhMCwuMSksZ1thXS5yZW5kZXIoYil9LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0LGQ9YS5vcHRpb25zLGY9YS5pc0xvZyxlPWEubGluMmxvZyxtPWEuaXNMaW5rZWQscj1hLnRpY2tQb3NpdGlvbnMscD1hLmF4aXNUaXRsZSx4PWEudGlja3Msdj1hLm1pbm9yVGlja3MsaD1hLmFsdGVybmF0ZUJhbmRzLGs9DQogICAgICAgIGQuc3RhY2tMYWJlbHMseT1kLmFsdGVybmF0ZUdyaWRDb2xvcixsPWEudGlja21hcmtPZmZzZXQsQT1hLmF4aXNMaW5lLG49YS5zaG93QXhpcyxHPXooYi5yZW5kZXJlci5nbG9iYWxBbmltYXRpb24pLEosdDthLmxhYmVsRWRnZS5sZW5ndGg9MDthLm92ZXJsYXA9ITE7YyhbeCx2LGhdLGZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWFbYl0uaXNBY3RpdmU9ITF9KTtpZihhLmhhc0RhdGEoKXx8bSlhLm1pbm9yVGlja0ludGVydmFsJiYhYS5jYXRlZ29yaWVzJiZjKGEuZ2V0TWlub3JUaWNrUG9zaXRpb25zKCksZnVuY3Rpb24oYil7YS5yZW5kZXJNaW5vclRpY2soYil9KSxyLmxlbmd0aCYmKGMocixmdW5jdGlvbihiLGQpe2EucmVuZGVyVGljayhiLGQpfSksbCYmKDA9PT1hLm1pbnx8YS5zaW5nbGUpJiYoeFstMV18fCh4Wy0xXT1uZXcgTChhLC0xLG51bGwsITApKSx4Wy0xXS5yZW5kZXIoLTEpKSkseSYmYyhyLGZ1bmN0aW9uKGQsZyl7dD12b2lkIDAhPT1yW2crMV0/cltnKzFdKw0KICAgICAgICBsOmEubWF4LWw7MD09PWclMiYmZDxhLm1heCYmdDw9YS5tYXgrKGIucG9sYXI/LWw6bCkmJihoW2RdfHwoaFtkXT1uZXcgcShhKSksSj1kK2wsaFtkXS5vcHRpb25zPXtmcm9tOmY/ZShKKTpKLHRvOmY/ZSh0KTp0LGNvbG9yOnl9LGhbZF0ucmVuZGVyKCksaFtkXS5pc0FjdGl2ZT0hMCl9KSxhLl9hZGRlZFBsb3RMQnx8KGMoKGQucGxvdExpbmVzfHxbXSkuY29uY2F0KGQucGxvdEJhbmRzfHxbXSksZnVuY3Rpb24oYil7YS5hZGRQbG90QmFuZE9yTGluZShiKX0pLGEuX2FkZGVkUGxvdExCPSEwKTtjKFt4LHYsaF0sZnVuY3Rpb24oYSl7dmFyIGQsZyxmPVtdLGM9Ry5kdXJhdGlvbjtmb3IoZCBpbiBhKWFbZF0uaXNBY3RpdmV8fChhW2RdLnJlbmRlcihkLCExLDApLGFbZF0uaXNBY3RpdmU9ITEsZi5wdXNoKGQpKTtLKGZ1bmN0aW9uKCl7Zm9yKGc9Zi5sZW5ndGg7Zy0tOylhW2ZbZ11dJiYhYVtmW2ddXS5pc0FjdGl2ZSYmKGFbZltnXV0uZGVzdHJveSgpLGRlbGV0ZSBhW2ZbZ11dKX0sDQogICAgICAgIGEhPT1oJiZiLmhhc1JlbmRlcmVkJiZjP2M6MCl9KTtBJiYoQVtBLmlzUGxhY2VkPyJhbmltYXRlIjoiYXR0ciJdKHtkOnRoaXMuZ2V0TGluZVBhdGgoQS5zdHJva2VXaWR0aCgpKX0pLEEuaXNQbGFjZWQ9ITAsQVtuPyJzaG93IjoiaGlkZSJdKCEwKSk7cCYmbiYmKHBbcC5pc05ldz8iYXR0ciI6ImFuaW1hdGUiXShhLmdldFRpdGxlUG9zaXRpb24oKSkscC5pc05ldz0hMSk7ayYmay5lbmFibGVkJiZhLnJlbmRlclN0YWNrVG90YWxzKCk7YS5pc0RpcnR5PSExfSxyZWRyYXc6ZnVuY3Rpb24oKXt0aGlzLnZpc2libGUmJih0aGlzLnJlbmRlcigpLGModGhpcy5wbG90TGluZXNBbmRCYW5kcyxmdW5jdGlvbihhKXthLnJlbmRlcigpfSkpO2ModGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwfSl9LGtlZXBQcm9wczoiZXh0S2V5IGhjRXZlbnRzIG5hbWVzIHNlcmllcyB1c2VyTWF4IHVzZXJNaW4iLnNwbGl0KCIgIiksZGVzdHJveTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLA0KICAgICAgICBkPWIuc3RhY2tzLGcsZj1iLnBsb3RMaW5lc0FuZEJhbmRzLHE7YXx8eChiKTtmb3IoZyBpbiBkKWUoZFtnXSksZFtnXT1udWxsO2MoW2IudGlja3MsYi5taW5vclRpY2tzLGIuYWx0ZXJuYXRlQmFuZHNdLGZ1bmN0aW9uKGEpe2UoYSl9KTtpZihmKWZvcihhPWYubGVuZ3RoO2EtLTspZlthXS5kZXN0cm95KCk7Yygic3RhY2tUb3RhbEdyb3VwIGF4aXNMaW5lIGF4aXNUaXRsZSBheGlzR3JvdXAgZ3JpZEdyb3VwIGxhYmVsR3JvdXAgY3Jvc3MiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSl7YlthXSYmKGJbYV09YlthXS5kZXN0cm95KCkpfSk7Zm9yKHEgaW4gYiliLmhhc093blByb3BlcnR5KHEpJiYtMT09PXIocSxiLmtlZXBQcm9wcykmJmRlbGV0ZSBiW3FdfSxkcmF3Q3Jvc3NoYWlyOmZ1bmN0aW9uKGEsYil7dmFyIGQsZj10aGlzLmNyb3NzaGFpcixnPUYoZi5zbmFwLCEwKSxjLHE9dGhpcy5jcm9zczthfHwoYT10aGlzLmNyb3NzJiZ0aGlzLmNyb3NzLmUpO3RoaXMuY3Jvc3NoYWlyJiYNCiAgICAhMSE9PShsKGIpfHwhZyk/KGc/bChiKSYmKGM9dGhpcy5pc1hBeGlzP2IucGxvdFg6dGhpcy5sZW4tYi5wbG90WSk6Yz1hJiYodGhpcy5ob3Jpej9hLmNoYXJ0WC10aGlzLnBvczp0aGlzLmxlbi1hLmNoYXJ0WSt0aGlzLnBvcyksbChjKSYmKGQ9dGhpcy5nZXRQbG90TGluZVBhdGgoYiYmKHRoaXMuaXNYQXhpcz9iLng6RihiLnN0YWNrWSxiLnkpKSxudWxsLG51bGwsbnVsbCxjKXx8bnVsbCksbChkKT8oYj10aGlzLmNhdGVnb3JpZXMmJiF0aGlzLmlzUmFkaWFsLHF8fCh0aGlzLmNyb3NzPXE9dGhpcy5jaGFydC5yZW5kZXJlci5wYXRoKCkuYWRkQ2xhc3MoImhpZ2hjaGFydHMtY3Jvc3NoYWlyIGhpZ2hjaGFydHMtY3Jvc3NoYWlyLSIrKGI/ImNhdGVnb3J5ICI6InRoaW4gIikrZi5jbGFzc05hbWUpLmF0dHIoe3pJbmRleDpGKGYuekluZGV4LDIpfSkuYWRkKCkscS5hdHRyKHtzdHJva2U6Zi5jb2xvcnx8KGI/aCgiI2NjZDZlYiIpLnNldE9wYWNpdHkoLjI1KS5nZXQoKToiI2NjY2NjYyIpLA0KICAgICAgICAgICAgICAgICJzdHJva2Utd2lkdGgiOkYoZi53aWR0aCwxKX0pLGYuZGFzaFN0eWxlJiZxLmF0dHIoe2Rhc2hzdHlsZTpmLmRhc2hTdHlsZX0pKSxxLnNob3coKS5hdHRyKHtkOmR9KSxiJiYhZi53aWR0aCYmcS5hdHRyKHsic3Ryb2tlLXdpZHRoIjp0aGlzLnRyYW5zQX0pLHRoaXMuY3Jvc3MuZT1hKTp0aGlzLmhpZGVDcm9zc2hhaXIoKSk6dGhpcy5oaWRlQ3Jvc3NoYWlyKCl9LGhpZGVDcm9zc2hhaXI6ZnVuY3Rpb24oKXt0aGlzLmNyb3NzJiZ0aGlzLmNyb3NzLmhpZGUoKX19O3AoYS5BeGlzLnByb3RvdHlwZSx1KX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLkF4aXMsej1hLkRhdGUsQz1hLmRhdGVGb3JtYXQsRT1hLmRlZmF1bHRPcHRpb25zLHU9YS5kZWZpbmVkLGg9YS5lYWNoLG49YS5leHRlbmQsdD1hLmdldE1hZ25pdHVkZSxsPWEuZ2V0VFpPZmZzZXQsaz1hLm5vcm1hbGl6ZVRpY2tJbnRlcnZhbCxlPWEucGljayxjPWEudGltZVVuaXRzO0IucHJvdG90eXBlLmdldFRpbWVUaWNrcz1mdW5jdGlvbihhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLGIsbSl7dmFyIGQ9W10scj17fSxwPUUuZ2xvYmFsLnVzZVVUQyx2LGY9bmV3IHooay1NYXRoLmFicyhsKGspKSkseT16LmhjTWFrZVRpbWUsRz1hLnVuaXRSYW5nZSx0PWEuY291bnQscTtpZih1KGspKXtmW3ouaGNTZXRNaWxsaXNlY29uZHNdKEc+PWMuc2Vjb25kPzA6dCpNYXRoLmZsb29yKGYuZ2V0TWlsbGlzZWNvbmRzKCkvdCkpO2lmKEc+PWMuc2Vjb25kKWZbei5oY1NldFNlY29uZHNdKEc+PWMubWludXRlPzA6dCpNYXRoLmZsb29yKGYuZ2V0U2Vjb25kcygpL3QpKTtpZihHPj1jLm1pbnV0ZSlmW3ouaGNTZXRNaW51dGVzXShHPj1jLmhvdXI/MDp0Kk1hdGguZmxvb3IoZlt6LmhjR2V0TWludXRlc10oKS90KSk7aWYoRz49Yy5ob3VyKWZbei5oY1NldEhvdXJzXShHPj1jLmRheT8wOnQqTWF0aC5mbG9vcihmW3ouaGNHZXRIb3Vyc10oKS90KSk7aWYoRz49Yy5kYXkpZlt6LmhjU2V0RGF0ZV0oRz49Yy5tb250aD8xOnQqTWF0aC5mbG9vcihmW3ouaGNHZXREYXRlXSgpL3QpKTsNCiAgICBHPj1jLm1vbnRoJiYoZlt6LmhjU2V0TW9udGhdKEc+PWMueWVhcj8wOnQqTWF0aC5mbG9vcihmW3ouaGNHZXRNb250aF0oKS90KSksdj1mW3ouaGNHZXRGdWxsWWVhcl0oKSk7aWYoRz49Yy55ZWFyKWZbei5oY1NldEZ1bGxZZWFyXSh2LXYldCk7aWYoRz09PWMud2VlaylmW3ouaGNTZXREYXRlXShmW3ouaGNHZXREYXRlXSgpLWZbei5oY0dldERheV0oKStlKG0sMSkpO3Y9Zlt6LmhjR2V0RnVsbFllYXJdKCk7bT1mW3ouaGNHZXRNb250aF0oKTt2YXIgeD1mW3ouaGNHZXREYXRlXSgpLEo9Zlt6LmhjR2V0SG91cnNdKCk7aWYoei5oY1RpbWV6b25lT2Zmc2V0fHx6LmhjR2V0VGltZXpvbmVPZmZzZXQpcT0oIXB8fCEhei5oY0dldFRpbWV6b25lT2Zmc2V0KSYmKGItaz40KmMubW9udGh8fGwoaykhPT1sKGIpKSxmPWYuZ2V0VGltZSgpLGY9bmV3IHooZitsKGYpKTtwPWYuZ2V0VGltZSgpO2ZvcihrPTE7cDxiOylkLnB1c2gocCkscD1HPT09Yy55ZWFyP3koditrKnQsMCk6Rz09PWMubW9udGg/DQogICAgICAgICAgICB5KHYsbStrKnQpOiFxfHxHIT09Yy5kYXkmJkchPT1jLndlZWs/cSYmRz09PWMuaG91cj95KHYsbSx4LEorayp0KTpwK0cqdDp5KHYsbSx4K2sqdCooRz09PWMuZGF5PzE6NykpLGsrKztkLnB1c2gocCk7Rzw9Yy5ob3VyJiYxRTQ+ZC5sZW5ndGgmJmgoZCxmdW5jdGlvbihhKXswPT09YSUxOEU1JiYiMDAwMDAwMDAwIj09PUMoIiVIJU0lUyVMIixhKSYmKHJbYV09ImRheSIpfSl9ZC5pbmZvPW4oYSx7aGlnaGVyUmFua3M6cix0b3RhbFJhbmdlOkcqdH0pO3JldHVybiBkfTtCLnByb3RvdHlwZS5ub3JtYWxpemVUaW1lVGlja0ludGVydmFsPWZ1bmN0aW9uKGEsZSl7dmFyIGI9ZXx8W1sibWlsbGlzZWNvbmQiLFsxLDIsNSwxMCwyMCwyNSw1MCwxMDAsMjAwLDUwMF1dLFsic2Vjb25kIixbMSwyLDUsMTAsMTUsMzBdXSxbIm1pbnV0ZSIsWzEsMiw1LDEwLDE1LDMwXV0sWyJob3VyIixbMSwyLDMsNCw2LDgsMTJdXSxbImRheSIsWzEsMl1dLFsid2VlayIsWzEsMl1dLFsibW9udGgiLFsxLDIsDQogICAgICAgIDMsNCw2XV0sWyJ5ZWFyIixudWxsXV07ZT1iW2IubGVuZ3RoLTFdO3ZhciBtPWNbZVswXV0sZD1lWzFdLHI7Zm9yKHI9MDtyPGIubGVuZ3RoJiYhKGU9YltyXSxtPWNbZVswXV0sZD1lWzFdLGJbcisxXSYmYTw9KG0qZFtkLmxlbmd0aC0xXStjW2JbcisxXVswXV0pLzIpO3IrKyk7bT09PWMueWVhciYmYTw1Km0mJihkPVsxLDIsNV0pO2E9ayhhL20sZCwieWVhciI9PT1lWzBdP01hdGgubWF4KHQoYS9tKSwxKToxKTtyZXR1cm57dW5pdFJhbmdlOm0sY291bnQ6YSx1bml0TmFtZTplWzBdfX19KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5BeGlzLHo9YS5nZXRNYWduaXR1ZGUsQz1hLm1hcCxFPWEubm9ybWFsaXplVGlja0ludGVydmFsLHU9YS5waWNrO0IucHJvdG90eXBlLmdldExvZ1RpY2tQb3NpdGlvbnM9ZnVuY3Rpb24oYSxuLHQsbCl7dmFyIGs9dGhpcy5vcHRpb25zLGU9dGhpcy5sZW4sYz10aGlzLmxpbjJsb2cscD10aGlzLmxvZzJsaW4saD1bXTtsfHwodGhpcy5fbWlub3JBdXRvSW50ZXJ2YWw9DQogICAgbnVsbCk7aWYoLjU8PWEpYT1NYXRoLnJvdW5kKGEpLGg9dGhpcy5nZXRMaW5lYXJUaWNrUG9zaXRpb25zKGEsbix0KTtlbHNlIGlmKC4wODw9YSlmb3IodmFyIGU9TWF0aC5mbG9vcihuKSxiLG0sZCxyLEEsaz0uMzxhP1sxLDIsNF06LjE1PGE/WzEsMiw0LDYsOF06WzEsMiwzLDQsNSw2LDcsOCw5XTtlPHQrMSYmIUE7ZSsrKWZvcihtPWsubGVuZ3RoLGI9MDtiPG0mJiFBO2IrKylkPXAoYyhlKSprW2JdKSxkPm4mJighbHx8cjw9dCkmJnZvaWQgMCE9PXImJmgucHVzaChyKSxyPnQmJihBPSEwKSxyPWQ7ZWxzZSBuPWMobiksdD1jKHQpLGE9a1tsPyJtaW5vclRpY2tJbnRlcnZhbCI6InRpY2tJbnRlcnZhbCJdLGE9dSgiYXV0byI9PT1hP251bGw6YSx0aGlzLl9taW5vckF1dG9JbnRlcnZhbCxrLnRpY2tQaXhlbEludGVydmFsLyhsPzU6MSkqKHQtbikvKChsP2UvdGhpcy50aWNrUG9zaXRpb25zLmxlbmd0aDplKXx8MSkpLGE9RShhLG51bGwseihhKSksaD1DKHRoaXMuZ2V0TGluZWFyVGlja1Bvc2l0aW9ucyhhLA0KICAgIG4sdCkscCksbHx8KHRoaXMuX21pbm9yQXV0b0ludGVydmFsPWEvNSk7bHx8KHRoaXMudGlja0ludGVydmFsPWEpO3JldHVybiBofTtCLnByb3RvdHlwZS5sb2cybGluPWZ1bmN0aW9uKGEpe3JldHVybiBNYXRoLmxvZyhhKS9NYXRoLkxOMTB9O0IucHJvdG90eXBlLmxpbjJsb2c9ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGgucG93KDEwLGEpfX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmRhdGVGb3JtYXQsej1hLmVhY2gsQz1hLmV4dGVuZCxFPWEuZm9ybWF0LHU9YS5pc051bWJlcixoPWEubWFwLG49YS5tZXJnZSx0PWEucGljayxsPWEuc3BsYXQsaz1hLnN5bmNUaW1lb3V0LGU9YS50aW1lVW5pdHM7YS5Ub29sdGlwPWZ1bmN0aW9uKCl7dGhpcy5pbml0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX07YS5Ub29sdGlwLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGUpe3RoaXMuY2hhcnQ9YTt0aGlzLm9wdGlvbnM9ZTt0aGlzLmNyb3NzaGFpcnM9W107dGhpcy5ub3c9e3g6MCx5OjB9Ow0KICAgIHRoaXMuaXNIaWRkZW49ITA7dGhpcy5zcGxpdD1lLnNwbGl0JiYhYS5pbnZlcnRlZDt0aGlzLnNoYXJlZD1lLnNoYXJlZHx8dGhpcy5zcGxpdH0sY2xlYW5TcGxpdDpmdW5jdGlvbihhKXt6KHRoaXMuY2hhcnQuc2VyaWVzLGZ1bmN0aW9uKGMpe3ZhciBlPWMmJmMudHQ7ZSYmKCFlLmlzQWN0aXZlfHxhP2MudHQ9ZS5kZXN0cm95KCk6ZS5pc0FjdGl2ZT0hMSl9KX0sZ2V0TGFiZWw6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LnJlbmRlcmVyLGU9dGhpcy5vcHRpb25zO3RoaXMubGFiZWx8fCh0aGlzLnNwbGl0P3RoaXMubGFiZWw9YS5nKCJ0b29sdGlwIik6KHRoaXMubGFiZWw9YS5sYWJlbCgiIiwwLDAsZS5zaGFwZXx8ImNhbGxvdXQiLG51bGwsbnVsbCxlLnVzZUhUTUwsbnVsbCwidG9vbHRpcCIpLmF0dHIoe3BhZGRpbmc6ZS5wYWRkaW5nLHI6ZS5ib3JkZXJSYWRpdXN9KSx0aGlzLmxhYmVsLmF0dHIoe2ZpbGw6ZS5iYWNrZ3JvdW5kQ29sb3IsInN0cm9rZS13aWR0aCI6ZS5ib3JkZXJXaWR0aH0pLmNzcyhlLnN0eWxlKS5zaGFkb3coZS5zaGFkb3cpKSwNCiAgICB0aGlzLmxhYmVsLmF0dHIoe3pJbmRleDo4fSkuYWRkKCkpO3JldHVybiB0aGlzLmxhYmVsfSx1cGRhdGU6ZnVuY3Rpb24oYSl7dGhpcy5kZXN0cm95KCk7dGhpcy5pbml0KHRoaXMuY2hhcnQsbighMCx0aGlzLm9wdGlvbnMsYSkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5sYWJlbCYmKHRoaXMubGFiZWw9dGhpcy5sYWJlbC5kZXN0cm95KCkpO3RoaXMuc3BsaXQmJnRoaXMudHQmJih0aGlzLmNsZWFuU3BsaXQodGhpcy5jaGFydCwhMCksdGhpcy50dD10aGlzLnR0LmRlc3Ryb3koKSk7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTtjbGVhclRpbWVvdXQodGhpcy50b29sdGlwVGltZW91dCl9LG1vdmU6ZnVuY3Rpb24oYSxlLGssYil7dmFyIGM9dGhpcyxkPWMubm93LHI9ITEhPT1jLm9wdGlvbnMuYW5pbWF0aW9uJiYhYy5pc0hpZGRlbiYmKDE8TWF0aC5hYnMoYS1kLngpfHwxPE1hdGguYWJzKGUtZC55KSkscD1jLmZvbGxvd1BvaW50ZXJ8fDE8Yy5sZW47QyhkLHt4OnI/KDIqDQogICAgZC54K2EpLzM6YSx5OnI/KGQueStlKS8yOmUsYW5jaG9yWDpwP3ZvaWQgMDpyPygyKmQuYW5jaG9yWCtrKS8zOmssYW5jaG9yWTpwP3ZvaWQgMDpyPyhkLmFuY2hvclkrYikvMjpifSk7Yy5nZXRMYWJlbCgpLmF0dHIoZCk7ciYmKGNsZWFyVGltZW91dCh0aGlzLnRvb2x0aXBUaW1lb3V0KSx0aGlzLnRvb2x0aXBUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtjJiZjLm1vdmUoYSxlLGssYil9LDMyKSl9LGhpZGU6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcztjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZXIpO2E9dChhLHRoaXMub3B0aW9ucy5oaWRlRGVsYXksNTAwKTt0aGlzLmlzSGlkZGVufHwodGhpcy5oaWRlVGltZXI9ayhmdW5jdGlvbigpe2MuZ2V0TGFiZWwoKVthPyJmYWRlT3V0IjoiaGlkZSJdKCk7Yy5pc0hpZGRlbj0hMH0sYSkpfSxnZXRBbmNob3I6ZnVuY3Rpb24oYSxlKXt2YXIgYyxiPXRoaXMuY2hhcnQsbT1iLmludmVydGVkLGQ9Yi5wbG90VG9wLHI9Yi5wbG90TGVmdCwNCiAgICBwPTAsdj0wLGYsazthPWwoYSk7Yz1hWzBdLnRvb2x0aXBQb3M7dGhpcy5mb2xsb3dQb2ludGVyJiZlJiYodm9pZCAwPT09ZS5jaGFydFgmJihlPWIucG9pbnRlci5ub3JtYWxpemUoZSkpLGM9W2UuY2hhcnRYLWIucGxvdExlZnQsZS5jaGFydFktZF0pO2N8fCh6KGEsZnVuY3Rpb24oYSl7Zj1hLnNlcmllcy55QXhpcztrPWEuc2VyaWVzLnhBeGlzO3ArPWEucGxvdFgrKCFtJiZrP2subGVmdC1yOjApO3YrPShhLnBsb3RMb3c/KGEucGxvdExvdythLnBsb3RIaWdoKS8yOmEucGxvdFkpKyghbSYmZj9mLnRvcC1kOjApfSkscC89YS5sZW5ndGgsdi89YS5sZW5ndGgsYz1bbT9iLnBsb3RXaWR0aC12OnAsdGhpcy5zaGFyZWQmJiFtJiYxPGEubGVuZ3RoJiZlP2UuY2hhcnRZLWQ6bT9iLnBsb3RIZWlnaHQtcDp2XSk7cmV0dXJuIGgoYyxNYXRoLnJvdW5kKX0sZ2V0UG9zaXRpb246ZnVuY3Rpb24oYSxlLGspe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLmRpc3RhbmNlLGQ9e30scj1rLmh8fDAsDQogICAgcCx2PVsieSIsYi5jaGFydEhlaWdodCxlLGsucGxvdFkrYi5wbG90VG9wLGIucGxvdFRvcCxiLnBsb3RUb3ArYi5wbG90SGVpZ2h0XSxmPVsieCIsYi5jaGFydFdpZHRoLGEsay5wbG90WCtiLnBsb3RMZWZ0LGIucGxvdExlZnQsYi5wbG90TGVmdCtiLnBsb3RXaWR0aF0saD0hdGhpcy5mb2xsb3dQb2ludGVyJiZ0KGsudHRCZWxvdywhYi5pbnZlcnRlZD09PSEhay5uZWdhdGl2ZSksbD1mdW5jdGlvbihhLGIsZixnLHEsZSl7dmFyIG09ZjxnLWMseD1nK2MrZjxiLHY9Zy1jLWY7Zys9YztpZihoJiZ4KWRbYV09ZztlbHNlIGlmKCFoJiZtKWRbYV09djtlbHNlIGlmKG0pZFthXT1NYXRoLm1pbihlLWYsMD52LXI/djp2LXIpO2Vsc2UgaWYoeClkW2FdPU1hdGgubWF4KHEsZytyK2Y+Yj9nOmcrcik7ZWxzZSByZXR1cm4hMX0sbj1mdW5jdGlvbihhLGIsZixnKXt2YXIgcTtnPGN8fGc+Yi1jP3E9ITE6ZFthXT1nPGYvMj8xOmc+Yi1mLzI/Yi1mLTI6Zy1mLzI7cmV0dXJuIHF9LHE9ZnVuY3Rpb24oYSl7dmFyIGI9DQogICAgICAgIHY7dj1mO2Y9YjtwPWF9LHg9ZnVuY3Rpb24oKXshMSE9PWwuYXBwbHkoMCx2KT8hMSE9PW4uYXBwbHkoMCxmKXx8cHx8KHEoITApLHgoKSk6cD9kLng9ZC55PTA6KHEoITApLHgoKSl9OyhiLmludmVydGVkfHwxPHRoaXMubGVuKSYmcSgpO3goKTtyZXR1cm4gZH0sZGVmYXVsdEZvcm1hdHRlcjpmdW5jdGlvbihhKXt2YXIgYz10aGlzLnBvaW50c3x8bCh0aGlzKSxlO2U9W2EudG9vbHRpcEZvb3RlckhlYWRlckZvcm1hdHRlcihjWzBdKV07ZT1lLmNvbmNhdChhLmJvZHlGb3JtYXR0ZXIoYykpO2UucHVzaChhLnRvb2x0aXBGb290ZXJIZWFkZXJGb3JtYXR0ZXIoY1swXSwhMCkpO3JldHVybiBlfSxyZWZyZXNoOmZ1bmN0aW9uKGEsZSl7dmFyIGMsYj10aGlzLm9wdGlvbnMsbSxkPWEscixwPXt9LHY9W107Yz1iLmZvcm1hdHRlcnx8dGhpcy5kZWZhdWx0Rm9ybWF0dGVyO3ZhciBwPXRoaXMuc2hhcmVkLGY7Y2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVyKTt0aGlzLmZvbGxvd1BvaW50ZXI9DQogICAgbChkKVswXS5zZXJpZXMudG9vbHRpcE9wdGlvbnMuZm9sbG93UG9pbnRlcjtyPXRoaXMuZ2V0QW5jaG9yKGQsZSk7ZT1yWzBdO209clsxXTshcHx8ZC5zZXJpZXMmJmQuc2VyaWVzLm5vU2hhcmVkVG9vbHRpcD9wPWQuZ2V0TGFiZWxDb25maWcoKTooeihkLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoImhvdmVyIik7di5wdXNoKGEuZ2V0TGFiZWxDb25maWcoKSl9KSxwPXt4OmRbMF0uY2F0ZWdvcnkseTpkWzBdLnl9LHAucG9pbnRzPXYsZD1kWzBdKTt0aGlzLmxlbj12Lmxlbmd0aDtwPWMuY2FsbChwLHRoaXMpO2Y9ZC5zZXJpZXM7dGhpcy5kaXN0YW5jZT10KGYudG9vbHRpcE9wdGlvbnMuZGlzdGFuY2UsMTYpOyExPT09cD90aGlzLmhpZGUoKTooYz10aGlzLmdldExhYmVsKCksdGhpcy5pc0hpZGRlbiYmYy5hdHRyKHtvcGFjaXR5OjF9KS5zaG93KCksdGhpcy5zcGxpdD90aGlzLnJlbmRlclNwbGl0KHAsYSk6KGMuYXR0cih7dGV4dDpwJiZwLmpvaW4/cC5qb2luKCIiKTpwfSksYy5yZW1vdmVDbGFzcygvaGlnaGNoYXJ0cy1jb2xvci1bXGRdKy9nKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1jb2xvci0iKw0KICAgICAgICAgICAgdChkLmNvbG9ySW5kZXgsZi5jb2xvckluZGV4KSksYy5hdHRyKHtzdHJva2U6Yi5ib3JkZXJDb2xvcnx8ZC5jb2xvcnx8Zi5jb2xvcnx8IiM2NjY2NjYifSksdGhpcy51cGRhdGVQb3NpdGlvbih7cGxvdFg6ZSxwbG90WTptLG5lZ2F0aXZlOmQubmVnYXRpdmUsdHRCZWxvdzpkLnR0QmVsb3csaDpyWzJdfHwwfSkpLHRoaXMuaXNIaWRkZW49ITEpfSxyZW5kZXJTcGxpdDpmdW5jdGlvbihjLGUpe3ZhciBwPXRoaXMsYj1bXSxtPXRoaXMuY2hhcnQsZD1tLnJlbmRlcmVyLHI9ITAsaz10aGlzLm9wdGlvbnMsdixmPXRoaXMuZ2V0TGFiZWwoKTt6KGMuc2xpY2UoMCxlLmxlbmd0aCsxKSxmdW5jdGlvbihhLGMpe2M9ZVtjLTFdfHx7aXNIZWFkZXI6ITAscGxvdFg6ZVswXS5wbG90WH07dmFyIGg9Yy5zZXJpZXN8fHAscT1oLnR0LHg9Yy5zZXJpZXN8fHt9LGw9ImhpZ2hjaGFydHMtY29sb3ItIit0KGMuY29sb3JJbmRleCx4LmNvbG9ySW5kZXgsIm5vbmUiKTtxfHwoaC50dD1xPWQubGFiZWwobnVsbCwNCiAgICBudWxsLG51bGwsImNhbGxvdXQiKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy10b29sdGlwLWJveCAiK2wpLmF0dHIoe3BhZGRpbmc6ay5wYWRkaW5nLHI6ay5ib3JkZXJSYWRpdXMsZmlsbDprLmJhY2tncm91bmRDb2xvcixzdHJva2U6Yy5jb2xvcnx8eC5jb2xvcnx8IiMzMzMzMzMiLCJzdHJva2Utd2lkdGgiOmsuYm9yZGVyV2lkdGh9KS5hZGQoZikpO3EuaXNBY3RpdmU9ITA7cS5hdHRyKHt0ZXh0OmF9KTtxLmNzcyhrLnN0eWxlKTthPXEuZ2V0QkJveCgpO3g9YS53aWR0aCtxLnN0cm9rZVdpZHRoKCk7Yy5pc0hlYWRlcj8odj1hLmhlaWdodCx4PU1hdGgubWF4KDAsTWF0aC5taW4oYy5wbG90WCttLnBsb3RMZWZ0LXgvMixtLmNoYXJ0V2lkdGgteCkpKTp4PWMucGxvdFgrbS5wbG90TGVmdC10KGsuZGlzdGFuY2UsMTYpLXg7MD54JiYocj0hMSk7YT0oYy5zZXJpZXMmJmMuc2VyaWVzLnlBeGlzJiZjLnNlcmllcy55QXhpcy5wb3MpKyhjLnBsb3RZfHwwKTthLT1tLnBsb3RUb3A7Yi5wdXNoKHt0YXJnZXQ6Yy5pc0hlYWRlcj8NCiAgICBtLnBsb3RIZWlnaHQrdjphLHJhbms6Yy5pc0hlYWRlcj8xOjAsc2l6ZTpoLnR0LmdldEJCb3goKS5oZWlnaHQrMSxwb2ludDpjLHg6eCx0dDpxfSl9KTt0aGlzLmNsZWFuU3BsaXQoKTthLmRpc3RyaWJ1dGUoYixtLnBsb3RIZWlnaHQrdik7eihiLGZ1bmN0aW9uKGEpe3ZhciBiPWEucG9pbnQsZD1iLnNlcmllczthLnR0LmF0dHIoe3Zpc2liaWxpdHk6dm9pZCAwPT09YS5wb3M/ImhpZGRlbiI6ImluaGVyaXQiLHg6cnx8Yi5pc0hlYWRlcj9hLng6Yi5wbG90WCttLnBsb3RMZWZ0K3Qoay5kaXN0YW5jZSwxNikseTphLnBvcyttLnBsb3RUb3AsYW5jaG9yWDpiLmlzSGVhZGVyP2IucGxvdFgrbS5wbG90TGVmdDpiLnBsb3RYK2QueEF4aXMucG9zLGFuY2hvclk6Yi5pc0hlYWRlcj9hLnBvcyttLnBsb3RUb3AtMTU6Yi5wbG90WStkLnlBeGlzLnBvc30pfSl9LHVwZGF0ZVBvc2l0aW9uOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuY2hhcnQsZT10aGlzLmdldExhYmVsKCksZT0odGhpcy5vcHRpb25zLnBvc2l0aW9uZXJ8fA0KdGhpcy5nZXRQb3NpdGlvbikuY2FsbCh0aGlzLGUud2lkdGgsZS5oZWlnaHQsYSk7dGhpcy5tb3ZlKE1hdGgucm91bmQoZS54KSxNYXRoLnJvdW5kKGUueXx8MCksYS5wbG90WCtjLnBsb3RMZWZ0LGEucGxvdFkrYy5wbG90VG9wKX0sZ2V0RGF0ZUZvcm1hdDpmdW5jdGlvbihhLHAsayxiKXt2YXIgYz1CKCIlbS0lZCAlSDolTTolUy4lTCIscCksZCxyLGg9e21pbGxpc2Vjb25kOjE1LHNlY29uZDoxMixtaW51dGU6OSxob3VyOjYsZGF5OjN9LHY9Im1pbGxpc2Vjb25kIjtmb3IociBpbiBlKXtpZihhPT09ZS53ZWVrJiYrQigiJXciLHApPT09ayYmIjAwOjAwOjAwLjAwMCI9PT1jLnN1YnN0cig2KSl7cj0id2VlayI7YnJlYWt9aWYoZVtyXT5hKXtyPXY7YnJlYWt9aWYoaFtyXSYmYy5zdWJzdHIoaFtyXSkhPT0iMDEtMDEgMDA6MDA6MDAuMDAwIi5zdWJzdHIoaFtyXSkpYnJlYWs7IndlZWsiIT09ciYmKHY9cil9ciYmKGQ9YltyXSk7cmV0dXJuIGR9LGdldFhEYXRlRm9ybWF0OmZ1bmN0aW9uKGEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSxrKXtlPWUuZGF0ZVRpbWVMYWJlbEZvcm1hdHM7dmFyIGI9ayYmay5jbG9zZXN0UG9pbnRSYW5nZTtyZXR1cm4oYj90aGlzLmdldERhdGVGb3JtYXQoYixhLngsay5vcHRpb25zLnN0YXJ0T2ZXZWVrLGUpOmUuZGF5KXx8ZS55ZWFyfSx0b29sdGlwRm9vdGVySGVhZGVyRm9ybWF0dGVyOmZ1bmN0aW9uKGEsZSl7dmFyIGM9ZT8iZm9vdGVyIjoiaGVhZGVyIjtlPWEuc2VyaWVzO3ZhciBiPWUudG9vbHRpcE9wdGlvbnMsbT1iLnhEYXRlRm9ybWF0LGQ9ZS54QXhpcyxyPWQmJiJkYXRldGltZSI9PT1kLm9wdGlvbnMudHlwZSYmdShhLmtleSksYz1iW2MrIkZvcm1hdCJdO3ImJiFtJiYobT10aGlzLmdldFhEYXRlRm9ybWF0KGEsYixkKSk7ciYmbSYmKGM9Yy5yZXBsYWNlKCJ7cG9pbnQua2V5fSIsIntwb2ludC5rZXk6IittKyJ9IikpO3JldHVybiBFKGMse3BvaW50OmEsc2VyaWVzOmV9KX0sYm9keUZvcm1hdHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gaChhLGZ1bmN0aW9uKGEpe3ZhciBjPQ0KICAgIGEuc2VyaWVzLnRvb2x0aXBPcHRpb25zO3JldHVybihjLnBvaW50Rm9ybWF0dGVyfHxhLnBvaW50LnRvb2x0aXBGb3JtYXR0ZXIpLmNhbGwoYS5wb2ludCxjLnBvaW50Rm9ybWF0KX0pfX19KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5hZGRFdmVudCx6PWEuYXR0cixDPWEuY2hhcnRzLEU9YS5jb2xvcix1PWEuY3NzLGg9YS5kZWZpbmVkLG49YS5kb2MsdD1hLmVhY2gsbD1hLmV4dGVuZCxrPWEuZmlyZUV2ZW50LGU9YS5vZmZzZXQsYz1hLnBpY2sscD1hLnJlbW92ZUV2ZW50LEg9YS5zcGxhdCxiPWEuVG9vbHRpcCxtPWEud2luO2EuUG9pbnRlcj1mdW5jdGlvbihhLGIpe3RoaXMuaW5pdChhLGIpfTthLlBvaW50ZXIucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsZSl7dGhpcy5vcHRpb25zPWU7dGhpcy5jaGFydD1hO3RoaXMucnVuQ2hhcnRDbGljaz1lLmNoYXJ0LmV2ZW50cyYmISFlLmNoYXJ0LmV2ZW50cy5jbGljazt0aGlzLnBpbmNoRG93bj1bXTt0aGlzLmxhc3RWYWxpZFRvdWNoPQ0KICAgIHt9O2ImJmUudG9vbHRpcC5lbmFibGVkJiYoYS50b29sdGlwPW5ldyBiKGEsZS50b29sdGlwKSx0aGlzLmZvbGxvd1RvdWNoTW92ZT1jKGUudG9vbHRpcC5mb2xsb3dUb3VjaE1vdmUsITApKTt0aGlzLnNldERPTUV2ZW50cygpfSx6b29tT3B0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsZD1iLm9wdGlvbnMuY2hhcnQsZT1kLnpvb21UeXBlfHwiIixiPWIuaW52ZXJ0ZWQ7L3RvdWNoLy50ZXN0KGEudHlwZSkmJihlPWMoZC5waW5jaFR5cGUsZSkpO3RoaXMuem9vbVg9YT0veC8udGVzdChlKTt0aGlzLnpvb21ZPWU9L3kvLnRlc3QoZSk7dGhpcy56b29tSG9yPWEmJiFifHxlJiZiO3RoaXMuem9vbVZlcnQ9ZSYmIWJ8fGEmJmI7dGhpcy5oYXNab29tPWF8fGV9LG5vcm1hbGl6ZTpmdW5jdGlvbihhLGIpe3ZhciBkLGM7YT1hfHxtLmV2ZW50O2EudGFyZ2V0fHwoYS50YXJnZXQ9YS5zcmNFbGVtZW50KTtjPWEudG91Y2hlcz9hLnRvdWNoZXMubGVuZ3RoP2EudG91Y2hlcy5pdGVtKDApOg0KICAgICAgICBhLmNoYW5nZWRUb3VjaGVzWzBdOmE7Ynx8KHRoaXMuY2hhcnRQb3NpdGlvbj1iPWUodGhpcy5jaGFydC5jb250YWluZXIpKTt2b2lkIDA9PT1jLnBhZ2VYPyhkPU1hdGgubWF4KGEueCxhLmNsaWVudFgtYi5sZWZ0KSxiPWEueSk6KGQ9Yy5wYWdlWC1iLmxlZnQsYj1jLnBhZ2VZLWIudG9wKTtyZXR1cm4gbChhLHtjaGFydFg6TWF0aC5yb3VuZChkKSxjaGFydFk6TWF0aC5yb3VuZChiKX0pfSxnZXRDb29yZGluYXRlczpmdW5jdGlvbihhKXt2YXIgYj17eEF4aXM6W10seUF4aXM6W119O3QodGhpcy5jaGFydC5heGVzLGZ1bmN0aW9uKGQpe2JbZC5pc1hBeGlzPyJ4QXhpcyI6InlBeGlzIl0ucHVzaCh7YXhpczpkLHZhbHVlOmQudG9WYWx1ZShhW2QuaG9yaXo/ImNoYXJ0WCI6ImNoYXJ0WSJdKX0pfSk7cmV0dXJuIGJ9LGdldEtEUG9pbnRzOmZ1bmN0aW9uKGEsYixlKXt2YXIgZD1bXSxmLG0scjt0KGEsZnVuY3Rpb24oYSl7Zj1hLm5vU2hhcmVkVG9vbHRpcCYmYjttPSFiJiZhLmRpcmVjdFRvdWNoOw0KICAgIGEudmlzaWJsZSYmIWYmJiFtJiZjKGEub3B0aW9ucy5lbmFibGVNb3VzZVRyYWNraW5nLCEwKSYmKHI9YS5zZWFyY2hQb2ludChlLCFmJiYxPT09YS5rZERpbWVuc2lvbnMpKSYmci5zZXJpZXMmJmQucHVzaChyKX0pO2Quc29ydChmdW5jdGlvbihhLGQpe3ZhciBmPWEuZGlzdFgtZC5kaXN0WCxjPWEuZGlzdC1kLmRpc3QsZT0oZC5zZXJpZXMuZ3JvdXAmJmQuc2VyaWVzLmdyb3VwLnpJbmRleCktKGEuc2VyaWVzLmdyb3VwJiZhLnNlcmllcy5ncm91cC56SW5kZXgpO3JldHVybiAwIT09ZiYmYj9mOjAhPT1jP2M6MCE9PWU/ZTphLnNlcmllcy5pbmRleD5kLnNlcmllcy5pbmRleD8tMToxfSk7aWYoYilmb3IoYT1kLmxlbmd0aDthLS07KShkW2FdLnghPT1kWzBdLnh8fGRbYV0uc2VyaWVzLm5vU2hhcmVkVG9vbHRpcCkmJmQuc3BsaWNlKGEsMSk7cmV0dXJuIGR9LGdldFBvaW50RnJvbUV2ZW50OmZ1bmN0aW9uKGEpe2E9YS50YXJnZXQ7Zm9yKHZhciBiO2EmJiFiOyliPWEucG9pbnQsYT0NCiAgICBhLnBhcmVudE5vZGU7cmV0dXJuIGJ9LGdldEhvdmVyRGF0YTpmdW5jdGlvbihhLGIsZSxtLGYsayl7dmFyIGQ9YTthPWI7dmFyIHI7aWYobSlmPyhyPVtdLHQoZSxmdW5jdGlvbihhKXt2YXIgYj1hLm5vU2hhcmVkVG9vbHRpcCYmZixlPSFmJiZhLmRpcmVjdFRvdWNoO2EudmlzaWJsZSYmIWImJiFlJiZjKGEub3B0aW9ucy5lbmFibGVNb3VzZVRyYWNraW5nLCEwKSYmKGE9YS5zZWFyY2hLRFRyZWUoe2NsaWVudFg6ZC5jbGllbnRYLHBsb3RZOmQucGxvdFl9LCFiJiYxPT09YS5rZERpbWVuc2lvbnMpKSYmYS5zZXJpZXMmJnIucHVzaChhKX0pLDA9PT1yLmxlbmd0aCYmKHI9W2RdKSk6cj1bZF07ZWxzZXtpZihhJiYhYS5vcHRpb25zLnN0aWNreVRyYWNraW5nKXI9dGhpcy5nZXRLRFBvaW50cyhbYV0sZixrKTtlbHNle2lmKCFmKWlmKGEpYS5vcHRpb25zLnN0aWNreVRyYWNraW5nfHwoZT1bYV0pO2Vsc2UgZm9yKG09MDttPGUubGVuZ3RoO20rKylpZihlW21dLmRpcmVjdFRvdWNofHwNCiAgICAhZVttXS5vcHRpb25zLnN0aWNreVRyYWNraW5nKWU9W107cj10aGlzLmdldEtEUG9pbnRzKGUsZixrKX1hPShkPXJbMF0pJiZkLnNlcmllc31yLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5zZXJpZXMuaW5kZXgtYi5zZXJpZXMuaW5kZXh9KTtyZXR1cm57aG92ZXJQb2ludDpkLGhvdmVyU2VyaWVzOmEsaG92ZXJQb2ludHM6cn19LHJ1blBvaW50QWN0aW9uczpmdW5jdGlvbihiLGMpe3ZhciBkPXRoaXMuY2hhcnQsZT1kLnRvb2x0aXAsZj1lP2Uuc2hhcmVkOiExLG09Y3x8ZC5ob3ZlclBvaW50LHI9bSYmbS5zZXJpZXN8fGQuaG92ZXJTZXJpZXM7Yz10aGlzLmdldEhvdmVyRGF0YShtLHIsZC5zZXJpZXMsISFjfHxyJiZyLmRpcmVjdFRvdWNoLGYsYik7dmFyIGsscSxtPWMuaG92ZXJQb2ludDtrPShyPWMuaG92ZXJTZXJpZXMpJiZyLnRvb2x0aXBPcHRpb25zLmZvbGxvd1BvaW50ZXI7cT0oZj1mJiZtJiYhbS5zZXJpZXMubm9TaGFyZWRUb29sdGlwKT9jLmhvdmVyUG9pbnRzOlttXTsNCiAgICBpZihtJiYobSE9PWQuaG92ZXJQb2ludHx8ZSYmZS5pc0hpZGRlbikpe3QoZC5ob3ZlclBvaW50c3x8W10sZnVuY3Rpb24oYil7LTE9PT1hLmluQXJyYXkoYixxKSYmYi5zZXRTdGF0ZSgpfSk7dChxfHxbXSxmdW5jdGlvbihhKXthLnNldFN0YXRlKCJob3ZlciIpfSk7aWYoZC5ob3ZlclNlcmllcyE9PXIpci5vbk1vdXNlT3ZlcigpO3ImJiFyLmRpcmVjdFRvdWNoJiYoZC5ob3ZlclBvaW50JiZkLmhvdmVyUG9pbnQuZmlyZVBvaW50RXZlbnQoIm1vdXNlT3V0IiksbS5maXJlUG9pbnRFdmVudCgibW91c2VPdmVyIikpO2QuaG92ZXJQb2ludHM9cTtkLmhvdmVyUG9pbnQ9bTtlJiZlLnJlZnJlc2goZj9xOm0sYil9ZWxzZSBrJiZlJiYhZS5pc0hpZGRlbiYmKG09ZS5nZXRBbmNob3IoW3t9XSxiKSxlLnVwZGF0ZVBvc2l0aW9uKHtwbG90WDptWzBdLHBsb3RZOm1bMV19KSk7dGhpcy51bkRvY01vdXNlTW92ZXx8KHRoaXMudW5Eb2NNb3VzZU1vdmU9QihuLCJtb3VzZW1vdmUiLGZ1bmN0aW9uKGIpe3ZhciBkPQ0KICAgICAgICBDW2EuaG92ZXJDaGFydEluZGV4XTtpZihkKWQucG9pbnRlci5vbkRvY3VtZW50TW91c2VNb3ZlKGIpfSkpO3QocSxmdW5jdGlvbihhKXt0KGQuYXhlcyxmdW5jdGlvbihkKXsoIWF8fGEuc2VyaWVzJiZhLnNlcmllc1tkLmNvbGxdPT09ZCkmJmQuZHJhd0Nyb3NzaGFpcihiLGEpfSl9KX0scmVzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgZD10aGlzLmNoYXJ0LGM9ZC5ob3ZlclNlcmllcyxmPWQuaG92ZXJQb2ludCxlPWQuaG92ZXJQb2ludHMsbT1kLnRvb2x0aXAscj1tJiZtLnNoYXJlZD9lOmY7YSYmciYmdChIKHIpLGZ1bmN0aW9uKGIpe2Iuc2VyaWVzLmlzQ2FydGVzaWFuJiZ2b2lkIDA9PT1iLnBsb3RYJiYoYT0hMSl9KTtpZihhKW0mJnImJihtLnJlZnJlc2gociksZiYmKGYuc2V0U3RhdGUoZi5zdGF0ZSwhMCksdChkLmF4ZXMsZnVuY3Rpb24oYSl7YS5jcm9zc2hhaXImJmEuZHJhd0Nyb3NzaGFpcihudWxsLGYpfSkpKTtlbHNle2lmKGYpZi5vbk1vdXNlT3V0KCk7ZSYmdChlLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pOw0KICAgIGlmKGMpYy5vbk1vdXNlT3V0KCk7bSYmbS5oaWRlKGIpO3RoaXMudW5Eb2NNb3VzZU1vdmUmJih0aGlzLnVuRG9jTW91c2VNb3ZlPXRoaXMudW5Eb2NNb3VzZU1vdmUoKSk7dChkLmF4ZXMsZnVuY3Rpb24oYSl7YS5oaWRlQ3Jvc3NoYWlyKCl9KTt0aGlzLmhvdmVyWD1kLmhvdmVyUG9pbnRzPWQuaG92ZXJQb2ludD1udWxsfX0sc2NhbGVHcm91cHM6ZnVuY3Rpb24oYSxiKXt2YXIgZD10aGlzLmNoYXJ0LGM7dChkLnNlcmllcyxmdW5jdGlvbihmKXtjPWF8fGYuZ2V0UGxvdEJveCgpO2YueEF4aXMmJmYueEF4aXMuem9vbUVuYWJsZWQmJmYuZ3JvdXAmJihmLmdyb3VwLmF0dHIoYyksZi5tYXJrZXJHcm91cCYmKGYubWFya2VyR3JvdXAuYXR0cihjKSxmLm1hcmtlckdyb3VwLmNsaXAoYj9kLmNsaXBSZWN0Om51bGwpKSxmLmRhdGFMYWJlbHNHcm91cCYmZi5kYXRhTGFiZWxzR3JvdXAuYXR0cihjKSl9KTtkLmNsaXBSZWN0LmF0dHIoYnx8ZC5jbGlwQm94KX0sZHJhZ1N0YXJ0OmZ1bmN0aW9uKGEpe3ZhciBiPQ0KICAgIHRoaXMuY2hhcnQ7Yi5tb3VzZUlzRG93bj1hLnR5cGU7Yi5jYW5jZWxDbGljaz0hMTtiLm1vdXNlRG93blg9dGhpcy5tb3VzZURvd25YPWEuY2hhcnRYO2IubW91c2VEb3duWT10aGlzLm1vdXNlRG93blk9YS5jaGFydFl9LGRyYWc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxkPWIub3B0aW9ucy5jaGFydCxjPWEuY2hhcnRYLGY9YS5jaGFydFksZT10aGlzLnpvb21Ib3IsbT10aGlzLnpvb21WZXJ0LGs9Yi5wbG90TGVmdCxxPWIucGxvdFRvcCx4PWIucGxvdFdpZHRoLHA9Yi5wbG90SGVpZ2h0LGgsbD10aGlzLnNlbGVjdGlvbk1hcmtlcixnPXRoaXMubW91c2VEb3duWCxuPXRoaXMubW91c2VEb3duWSx0PWQucGFuS2V5JiZhW2QucGFuS2V5KyJLZXkiXTtsJiZsLnRvdWNofHwoYzxrP2M9azpjPmsreCYmKGM9ayt4KSxmPHE/Zj1xOmY+cStwJiYoZj1xK3ApLHRoaXMuaGFzRHJhZ2dlZD1NYXRoLnNxcnQoTWF0aC5wb3coZy1jLDIpK01hdGgucG93KG4tZiwyKSksMTA8dGhpcy5oYXNEcmFnZ2VkJiYNCihoPWIuaXNJbnNpZGVQbG90KGctayxuLXEpLGIuaGFzQ2FydGVzaWFuU2VyaWVzJiYodGhpcy56b29tWHx8dGhpcy56b29tWSkmJmgmJiF0JiYhbCYmKHRoaXMuc2VsZWN0aW9uTWFya2VyPWw9Yi5yZW5kZXJlci5yZWN0KGsscSxlPzE6eCxtPzE6cCwwKS5hdHRyKHtmaWxsOmQuc2VsZWN0aW9uTWFya2VyRmlsbHx8RSgiIzMzNWNhZCIpLnNldE9wYWNpdHkoLjI1KS5nZXQoKSwiY2xhc3MiOiJoaWdoY2hhcnRzLXNlbGVjdGlvbi1tYXJrZXIiLHpJbmRleDo3fSkuYWRkKCkpLGwmJmUmJihjLT1nLGwuYXR0cih7d2lkdGg6TWF0aC5hYnMoYykseDooMDxjPzA6YykrZ30pKSxsJiZtJiYoYz1mLW4sbC5hdHRyKHtoZWlnaHQ6TWF0aC5hYnMoYykseTooMDxjPzA6Yykrbn0pKSxoJiYhbCYmZC5wYW5uaW5nJiZiLnBhbihhLGQucGFubmluZykpKX0sZHJvcDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLGQ9dGhpcy5jaGFydCxjPXRoaXMuaGFzUGluY2hlZDtpZih0aGlzLnNlbGVjdGlvbk1hcmtlcil7dmFyIGY9DQogICAge29yaWdpbmFsRXZlbnQ6YSx4QXhpczpbXSx5QXhpczpbXX0sZT10aGlzLnNlbGVjdGlvbk1hcmtlcixtPWUuYXR0cj9lLmF0dHIoIngiKTplLngscD1lLmF0dHI/ZS5hdHRyKCJ5Iik6ZS55LHE9ZS5hdHRyP2UuYXR0cigid2lkdGgiKTplLndpZHRoLHg9ZS5hdHRyP2UuYXR0cigiaGVpZ2h0Iik6ZS5oZWlnaHQsbjtpZih0aGlzLmhhc0RyYWdnZWR8fGMpdChkLmF4ZXMsZnVuY3Rpb24oZCl7aWYoZC56b29tRW5hYmxlZCYmaChkLm1pbikmJihjfHxiW3t4QXhpczoiem9vbVgiLHlBeGlzOiJ6b29tWSJ9W2QuY29sbF1dKSl7dmFyIGU9ZC5ob3JpeixnPSJ0b3VjaGVuZCI9PT1hLnR5cGU/ZC5taW5QaXhlbFBhZGRpbmc6MCxyPWQudG9WYWx1ZSgoZT9tOnApK2cpLGU9ZC50b1ZhbHVlKChlP20rcTpwK3gpLWcpO2ZbZC5jb2xsXS5wdXNoKHtheGlzOmQsbWluOk1hdGgubWluKHIsZSksbWF4Ok1hdGgubWF4KHIsZSl9KTtuPSEwfX0pLG4mJmsoZCwic2VsZWN0aW9uIixmLGZ1bmN0aW9uKGEpe2Quem9vbShsKGEsDQogICAgYz97YW5pbWF0aW9uOiExfTpudWxsKSl9KTt0aGlzLnNlbGVjdGlvbk1hcmtlcj10aGlzLnNlbGVjdGlvbk1hcmtlci5kZXN0cm95KCk7YyYmdGhpcy5zY2FsZUdyb3VwcygpfWQmJih1KGQuY29udGFpbmVyLHtjdXJzb3I6ZC5fY3Vyc29yfSksZC5jYW5jZWxDbGljaz0xMDx0aGlzLmhhc0RyYWdnZWQsZC5tb3VzZUlzRG93bj10aGlzLmhhc0RyYWdnZWQ9dGhpcy5oYXNQaW5jaGVkPSExLHRoaXMucGluY2hEb3duPVtdKX0sb25Db250YWluZXJNb3VzZURvd246ZnVuY3Rpb24oYSl7YT10aGlzLm5vcm1hbGl6ZShhKTt0aGlzLnpvb21PcHRpb24oYSk7YS5wcmV2ZW50RGVmYXVsdCYmYS5wcmV2ZW50RGVmYXVsdCgpO3RoaXMuZHJhZ1N0YXJ0KGEpfSxvbkRvY3VtZW50TW91c2VVcDpmdW5jdGlvbihiKXtDW2EuaG92ZXJDaGFydEluZGV4XSYmQ1thLmhvdmVyQ2hhcnRJbmRleF0ucG9pbnRlci5kcm9wKGIpfSxvbkRvY3VtZW50TW91c2VNb3ZlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsDQogICAgZD10aGlzLmNoYXJ0UG9zaXRpb247YT10aGlzLm5vcm1hbGl6ZShhLGQpOyFkfHx0aGlzLmluQ2xhc3MoYS50YXJnZXQsImhpZ2hjaGFydHMtdHJhY2tlciIpfHxiLmlzSW5zaWRlUGxvdChhLmNoYXJ0WC1iLnBsb3RMZWZ0LGEuY2hhcnRZLWIucGxvdFRvcCl8fHRoaXMucmVzZXQoKX0sb25Db250YWluZXJNb3VzZUxlYXZlOmZ1bmN0aW9uKGIpe3ZhciBkPUNbYS5ob3ZlckNoYXJ0SW5kZXhdO2QmJihiLnJlbGF0ZWRUYXJnZXR8fGIudG9FbGVtZW50KSYmKGQucG9pbnRlci5yZXNldCgpLGQucG9pbnRlci5jaGFydFBvc2l0aW9uPW51bGwpfSxvbkNvbnRhaW5lck1vdXNlTW92ZTpmdW5jdGlvbihiKXt2YXIgZD10aGlzLmNoYXJ0O2goYS5ob3ZlckNoYXJ0SW5kZXgpJiZDW2EuaG92ZXJDaGFydEluZGV4XSYmQ1thLmhvdmVyQ2hhcnRJbmRleF0ubW91c2VJc0Rvd258fChhLmhvdmVyQ2hhcnRJbmRleD1kLmluZGV4KTtiPXRoaXMubm9ybWFsaXplKGIpO2IucmV0dXJuVmFsdWU9ITE7DQogICAgIm1vdXNlZG93biI9PT1kLm1vdXNlSXNEb3duJiZ0aGlzLmRyYWcoYik7IXRoaXMuaW5DbGFzcyhiLnRhcmdldCwiaGlnaGNoYXJ0cy10cmFja2VyIikmJiFkLmlzSW5zaWRlUGxvdChiLmNoYXJ0WC1kLnBsb3RMZWZ0LGIuY2hhcnRZLWQucGxvdFRvcCl8fGQub3Blbk1lbnV8fHRoaXMucnVuUG9pbnRBY3Rpb25zKGIpfSxpbkNsYXNzOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBkO2E7KXtpZihkPXooYSwiY2xhc3MiKSl7aWYoLTEhPT1kLmluZGV4T2YoYikpcmV0dXJuITA7aWYoLTEhPT1kLmluZGV4T2YoImhpZ2hjaGFydHMtY29udGFpbmVyIikpcmV0dXJuITF9YT1hLnBhcmVudE5vZGV9fSxvblRyYWNrZXJNb3VzZU91dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LmhvdmVyU2VyaWVzO2E9YS5yZWxhdGVkVGFyZ2V0fHxhLnRvRWxlbWVudDtpZighKCFifHwhYXx8Yi5vcHRpb25zLnN0aWNreVRyYWNraW5nfHx0aGlzLmluQ2xhc3MoYSwiaGlnaGNoYXJ0cy10b29sdGlwIil8fA0KICAgIHRoaXMuaW5DbGFzcyhhLCJoaWdoY2hhcnRzLXNlcmllcy0iK2IuaW5kZXgpJiZ0aGlzLmluQ2xhc3MoYSwiaGlnaGNoYXJ0cy10cmFja2VyIikpKWIub25Nb3VzZU91dCgpfSxvbkNvbnRhaW5lckNsaWNrOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsZD1iLmhvdmVyUG9pbnQsYz1iLnBsb3RMZWZ0LGY9Yi5wbG90VG9wO2E9dGhpcy5ub3JtYWxpemUoYSk7Yi5jYW5jZWxDbGlja3x8KGQmJnRoaXMuaW5DbGFzcyhhLnRhcmdldCwiaGlnaGNoYXJ0cy10cmFja2VyIik/KGsoZC5zZXJpZXMsImNsaWNrIixsKGEse3BvaW50OmR9KSksYi5ob3ZlclBvaW50JiZkLmZpcmVQb2ludEV2ZW50KCJjbGljayIsYSkpOihsKGEsdGhpcy5nZXRDb29yZGluYXRlcyhhKSksYi5pc0luc2lkZVBsb3QoYS5jaGFydFgtYyxhLmNoYXJ0WS1mKSYmayhiLCJjbGljayIsYSkpKX0sc2V0RE9NRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxjPWIuY2hhcnQuY29udGFpbmVyO2Mub25tb3VzZWRvd249DQogICAgZnVuY3Rpb24oYSl7Yi5vbkNvbnRhaW5lck1vdXNlRG93bihhKX07Yy5vbm1vdXNlbW92ZT1mdW5jdGlvbihhKXtiLm9uQ29udGFpbmVyTW91c2VNb3ZlKGEpfTtjLm9uY2xpY2s9ZnVuY3Rpb24oYSl7Yi5vbkNvbnRhaW5lckNsaWNrKGEpfTtCKGMsIm1vdXNlbGVhdmUiLGIub25Db250YWluZXJNb3VzZUxlYXZlKTsxPT09YS5jaGFydENvdW50JiZCKG4sIm1vdXNldXAiLGIub25Eb2N1bWVudE1vdXNlVXApO2EuaGFzVG91Y2gmJihjLm9udG91Y2hzdGFydD1mdW5jdGlvbihhKXtiLm9uQ29udGFpbmVyVG91Y2hTdGFydChhKX0sYy5vbnRvdWNobW92ZT1mdW5jdGlvbihhKXtiLm9uQ29udGFpbmVyVG91Y2hNb3ZlKGEpfSwxPT09YS5jaGFydENvdW50JiZCKG4sInRvdWNoZW5kIixiLm9uRG9jdW1lbnRUb3VjaEVuZCkpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGI7cCh0aGlzLmNoYXJ0LmNvbnRhaW5lciwibW91c2VsZWF2ZSIsdGhpcy5vbkNvbnRhaW5lck1vdXNlTGVhdmUpO2EuY2hhcnRDb3VudHx8DQoocChuLCJtb3VzZXVwIix0aGlzLm9uRG9jdW1lbnRNb3VzZVVwKSxwKG4sInRvdWNoZW5kIix0aGlzLm9uRG9jdW1lbnRUb3VjaEVuZCkpO2NsZWFySW50ZXJ2YWwodGhpcy50b29sdGlwVGltZW91dCk7Zm9yKGIgaW4gdGhpcyl0aGlzW2JdPW51bGx9fX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmNoYXJ0cyx6PWEuZWFjaCxDPWEuZXh0ZW5kLEU9YS5tYXAsdT1hLm5vb3AsaD1hLnBpY2s7QyhhLlBvaW50ZXIucHJvdG90eXBlLHtwaW5jaFRyYW5zbGF0ZTpmdW5jdGlvbihhLGgsbCxrLGUsYyl7dGhpcy56b29tSG9yJiZ0aGlzLnBpbmNoVHJhbnNsYXRlRGlyZWN0aW9uKCEwLGEsaCxsLGssZSxjKTt0aGlzLnpvb21WZXJ0JiZ0aGlzLnBpbmNoVHJhbnNsYXRlRGlyZWN0aW9uKCExLGEsaCxsLGssZSxjKX0scGluY2hUcmFuc2xhdGVEaXJlY3Rpb246ZnVuY3Rpb24oYSxoLGwsayxlLGMscCx1KXt2YXIgYj10aGlzLmNoYXJ0LG09YT8ieCI6InkiLGQ9YT8iWCI6IlkiLHI9ImNoYXJ0IisNCiAgICBkLG49YT8id2lkdGgiOiJoZWlnaHQiLHY9YlsicGxvdCIrKGE/IkxlZnQiOiJUb3AiKV0sZix5LHQ9dXx8MSxGPWIuaW52ZXJ0ZWQscT1iLmJvdW5kc1thPyJoIjoidiJdLHg9MT09PWgubGVuZ3RoLEo9aFswXVtyXSxLPWxbMF1bcl0sTD0heCYmaFsxXVtyXSxnPSF4JiZsWzFdW3JdLEQ7bD1mdW5jdGlvbigpeyF4JiYyMDxNYXRoLmFicyhKLUwpJiYodD11fHxNYXRoLmFicyhLLWcpL01hdGguYWJzKEotTCkpO3k9KHYtSykvdCtKO2Y9YlsicGxvdCIrKGE/IldpZHRoIjoiSGVpZ2h0IildL3R9O2woKTtoPXk7aDxxLm1pbj8oaD1xLm1pbixEPSEwKTpoK2Y+cS5tYXgmJihoPXEubWF4LWYsRD0hMCk7RD8oSy09LjgqKEstcFttXVswXSkseHx8KGctPS44KihnLXBbbV1bMV0pKSxsKCkpOnBbbV09W0ssZ107Rnx8KGNbbV09eS12LGNbbl09Zik7Yz1GPzEvdDp0O2Vbbl09ZjtlW21dPWg7a1tGP2E/InNjYWxlWSI6InNjYWxlWCI6InNjYWxlIitkXT10O2tbInRyYW5zbGF0ZSIrZF09YyoNCiAgICB2KyhLLWMqSil9LHBpbmNoOmZ1bmN0aW9uKGEpe3ZhciBuPXRoaXMsbD1uLmNoYXJ0LGs9bi5waW5jaERvd24sZT1hLnRvdWNoZXMsYz1lLmxlbmd0aCxwPW4ubGFzdFZhbGlkVG91Y2gsSD1uLmhhc1pvb20sYj1uLnNlbGVjdGlvbk1hcmtlcixtPXt9LGQ9MT09PWMmJihuLmluQ2xhc3MoYS50YXJnZXQsImhpZ2hjaGFydHMtdHJhY2tlciIpJiZsLnJ1blRyYWNrZXJDbGlja3x8bi5ydW5DaGFydENsaWNrKSxyPXt9OzE8YyYmKG4uaW5pdGlhdGVkPSEwKTtIJiZuLmluaXRpYXRlZCYmIWQmJmEucHJldmVudERlZmF1bHQoKTtFKGUsZnVuY3Rpb24oYSl7cmV0dXJuIG4ubm9ybWFsaXplKGEpfSk7InRvdWNoc3RhcnQiPT09YS50eXBlPyh6KGUsZnVuY3Rpb24oYSxiKXtrW2JdPXtjaGFydFg6YS5jaGFydFgsY2hhcnRZOmEuY2hhcnRZfX0pLHAueD1ba1swXS5jaGFydFgsa1sxXSYma1sxXS5jaGFydFhdLHAueT1ba1swXS5jaGFydFksa1sxXSYma1sxXS5jaGFydFldLHoobC5heGVzLGZ1bmN0aW9uKGEpe2lmKGEuem9vbUVuYWJsZWQpe3ZhciBiPQ0KICAgICAgICBsLmJvdW5kc1thLmhvcml6PyJoIjoidiJdLGQ9YS5taW5QaXhlbFBhZGRpbmcsYz1hLnRvUGl4ZWxzKGgoYS5vcHRpb25zLm1pbixhLmRhdGFNaW4pKSxlPWEudG9QaXhlbHMoaChhLm9wdGlvbnMubWF4LGEuZGF0YU1heCkpLG09TWF0aC5tYXgoYyxlKTtiLm1pbj1NYXRoLm1pbihhLnBvcyxNYXRoLm1pbihjLGUpLWQpO2IubWF4PU1hdGgubWF4KGEucG9zK2EubGVuLG0rZCl9fSksbi5yZXM9ITApOm4uZm9sbG93VG91Y2hNb3ZlJiYxPT09Yz90aGlzLnJ1blBvaW50QWN0aW9ucyhuLm5vcm1hbGl6ZShhKSk6ay5sZW5ndGgmJihifHwobi5zZWxlY3Rpb25NYXJrZXI9Yj1DKHtkZXN0cm95OnUsdG91Y2g6ITB9LGwucGxvdEJveCkpLG4ucGluY2hUcmFuc2xhdGUoayxlLG0sYixyLHApLG4uaGFzUGluY2hlZD1ILG4uc2NhbGVHcm91cHMobSxyKSxuLnJlcyYmKG4ucmVzPSExLHRoaXMucmVzZXQoITEsMCkpKX0sdG91Y2g6ZnVuY3Rpb24obix0KXt2YXIgbD10aGlzLmNoYXJ0LGssZTsNCiAgICBpZihsLmluZGV4IT09YS5ob3ZlckNoYXJ0SW5kZXgpdGhpcy5vbkNvbnRhaW5lck1vdXNlTGVhdmUoe3JlbGF0ZWRUYXJnZXQ6ITB9KTthLmhvdmVyQ2hhcnRJbmRleD1sLmluZGV4OzE9PT1uLnRvdWNoZXMubGVuZ3RoPyhuPXRoaXMubm9ybWFsaXplKG4pLChlPWwuaXNJbnNpZGVQbG90KG4uY2hhcnRYLWwucGxvdExlZnQsbi5jaGFydFktbC5wbG90VG9wKSkmJiFsLm9wZW5NZW51Pyh0JiZ0aGlzLnJ1blBvaW50QWN0aW9ucyhuKSwidG91Y2htb3ZlIj09PW4udHlwZSYmKHQ9dGhpcy5waW5jaERvd24saz10WzBdPzQ8PU1hdGguc3FydChNYXRoLnBvdyh0WzBdLmNoYXJ0WC1uLmNoYXJ0WCwyKStNYXRoLnBvdyh0WzBdLmNoYXJ0WS1uLmNoYXJ0WSwyKSk6ITEpLGgoaywhMCkmJnRoaXMucGluY2gobikpOnQmJnRoaXMucmVzZXQoKSk6Mj09PW4udG91Y2hlcy5sZW5ndGgmJnRoaXMucGluY2gobil9LG9uQ29udGFpbmVyVG91Y2hTdGFydDpmdW5jdGlvbihhKXt0aGlzLnpvb21PcHRpb24oYSk7DQogICAgdGhpcy50b3VjaChhLCEwKX0sb25Db250YWluZXJUb3VjaE1vdmU6ZnVuY3Rpb24oYSl7dGhpcy50b3VjaChhKX0sb25Eb2N1bWVudFRvdWNoRW5kOmZ1bmN0aW9uKGgpe0JbYS5ob3ZlckNoYXJ0SW5kZXhdJiZCW2EuaG92ZXJDaGFydEluZGV4XS5wb2ludGVyLmRyb3AoaCl9fSl9KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5hZGRFdmVudCx6PWEuY2hhcnRzLEM9YS5jc3MsRT1hLmRvYyx1PWEuZXh0ZW5kLGg9YS5ub29wLG49YS5Qb2ludGVyLHQ9YS5yZW1vdmVFdmVudCxsPWEud2luLGs9YS53cmFwO2lmKGwuUG9pbnRlckV2ZW50fHxsLk1TUG9pbnRlckV2ZW50KXt2YXIgZT17fSxjPSEhbC5Qb2ludGVyRXZlbnQscD1mdW5jdGlvbigpe3ZhciBhLGM9W107Yy5pdGVtPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzW2FdfTtmb3IoYSBpbiBlKWUuaGFzT3duUHJvcGVydHkoYSkmJmMucHVzaCh7cGFnZVg6ZVthXS5wYWdlWCxwYWdlWTplW2FdLnBhZ2VZLHRhcmdldDplW2FdLnRhcmdldH0pOw0KICAgIHJldHVybiBjfSxIPWZ1bmN0aW9uKGIsYyxkLGUpeyJ0b3VjaCIhPT1iLnBvaW50ZXJUeXBlJiZiLnBvaW50ZXJUeXBlIT09Yi5NU1BPSU5URVJfVFlQRV9UT1VDSHx8IXpbYS5ob3ZlckNoYXJ0SW5kZXhdfHwoZShiKSxlPXpbYS5ob3ZlckNoYXJ0SW5kZXhdLnBvaW50ZXIsZVtjXSh7dHlwZTpkLHRhcmdldDpiLmN1cnJlbnRUYXJnZXQscHJldmVudERlZmF1bHQ6aCx0b3VjaGVzOnAoKX0pKX07dShuLnByb3RvdHlwZSx7b25Db250YWluZXJQb2ludGVyRG93bjpmdW5jdGlvbihhKXtIKGEsIm9uQ29udGFpbmVyVG91Y2hTdGFydCIsInRvdWNoc3RhcnQiLGZ1bmN0aW9uKGEpe2VbYS5wb2ludGVySWRdPXtwYWdlWDphLnBhZ2VYLHBhZ2VZOmEucGFnZVksdGFyZ2V0OmEuY3VycmVudFRhcmdldH19KX0sb25Db250YWluZXJQb2ludGVyTW92ZTpmdW5jdGlvbihhKXtIKGEsIm9uQ29udGFpbmVyVG91Y2hNb3ZlIiwidG91Y2htb3ZlIixmdW5jdGlvbihhKXtlW2EucG9pbnRlcklkXT17cGFnZVg6YS5wYWdlWCwNCiAgICBwYWdlWTphLnBhZ2VZfTtlW2EucG9pbnRlcklkXS50YXJnZXR8fChlW2EucG9pbnRlcklkXS50YXJnZXQ9YS5jdXJyZW50VGFyZ2V0KX0pfSxvbkRvY3VtZW50UG9pbnRlclVwOmZ1bmN0aW9uKGEpe0goYSwib25Eb2N1bWVudFRvdWNoRW5kIiwidG91Y2hlbmQiLGZ1bmN0aW9uKGEpe2RlbGV0ZSBlW2EucG9pbnRlcklkXX0pfSxiYXRjaE1TRXZlbnRzOmZ1bmN0aW9uKGEpe2EodGhpcy5jaGFydC5jb250YWluZXIsYz8icG9pbnRlcmRvd24iOiJNU1BvaW50ZXJEb3duIix0aGlzLm9uQ29udGFpbmVyUG9pbnRlckRvd24pO2EodGhpcy5jaGFydC5jb250YWluZXIsYz8icG9pbnRlcm1vdmUiOiJNU1BvaW50ZXJNb3ZlIix0aGlzLm9uQ29udGFpbmVyUG9pbnRlck1vdmUpO2EoRSxjPyJwb2ludGVydXAiOiJNU1BvaW50ZXJVcCIsdGhpcy5vbkRvY3VtZW50UG9pbnRlclVwKX19KTtrKG4ucHJvdG90eXBlLCJpbml0IixmdW5jdGlvbihhLGMsZCl7YS5jYWxsKHRoaXMsYyxkKTt0aGlzLmhhc1pvb20mJg0KQyhjLmNvbnRhaW5lcix7Ii1tcy10b3VjaC1hY3Rpb24iOiJub25lIiwidG91Y2gtYWN0aW9uIjoibm9uZSJ9KX0pO2sobi5wcm90b3R5cGUsInNldERPTUV2ZW50cyIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzKTsodGhpcy5oYXNab29tfHx0aGlzLmZvbGxvd1RvdWNoTW92ZSkmJnRoaXMuYmF0Y2hNU0V2ZW50cyhCKX0pO2sobi5wcm90b3R5cGUsImRlc3Ryb3kiLGZ1bmN0aW9uKGEpe3RoaXMuYmF0Y2hNU0V2ZW50cyh0KTthLmNhbGwodGhpcyl9KX19KShJKTsoZnVuY3Rpb24oYSl7dmFyIEIsej1hLmFkZEV2ZW50LEM9YS5jc3MsRT1hLmRpc2NhcmRFbGVtZW50LHU9YS5kZWZpbmVkLGg9YS5lYWNoLG49YS5pc0ZpcmVmb3gsdD1hLm1hcmdpbk5hbWVzLGw9YS5tZXJnZSxrPWEucGljayxlPWEuc2V0QW5pbWF0aW9uLGM9YS5zdGFibGVTb3J0LHA9YS53aW4sSD1hLndyYXA7Qj1hLkxlZ2VuZD1mdW5jdGlvbihhLGMpe3RoaXMuaW5pdChhLGMpfTtCLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjKXt0aGlzLmNoYXJ0PWE7dGhpcy5zZXRPcHRpb25zKGMpO2MuZW5hYmxlZCYmKHRoaXMucmVuZGVyKCkseih0aGlzLmNoYXJ0LCJlbmRSZXNpemUiLGZ1bmN0aW9uKCl7dGhpcy5sZWdlbmQucG9zaXRpb25DaGVja2JveGVzKCl9KSl9LHNldE9wdGlvbnM6ZnVuY3Rpb24oYSl7dmFyIGI9ayhhLnBhZGRpbmcsOCk7dGhpcy5vcHRpb25zPWE7dGhpcy5pdGVtU3R5bGU9YS5pdGVtU3R5bGU7dGhpcy5pdGVtSGlkZGVuU3R5bGU9bCh0aGlzLml0ZW1TdHlsZSxhLml0ZW1IaWRkZW5TdHlsZSk7dGhpcy5pdGVtTWFyZ2luVG9wPWEuaXRlbU1hcmdpblRvcHx8MDt0aGlzLmluaXRpYWxJdGVtWD10aGlzLnBhZGRpbmc9Yjt0aGlzLmluaXRpYWxJdGVtWT1iLTU7dGhpcy5pdGVtSGVpZ2h0PXRoaXMubWF4SXRlbVdpZHRoPTA7dGhpcy5zeW1ib2xXaWR0aD1rKGEuc3ltYm9sV2lkdGgsMTYpO3RoaXMucGFnZXM9W119LHVwZGF0ZTpmdW5jdGlvbihhLGMpe3ZhciBiPXRoaXMuY2hhcnQ7dGhpcy5zZXRPcHRpb25zKGwoITAsDQogICAgdGhpcy5vcHRpb25zLGEpKTt0aGlzLmRlc3Ryb3koKTtiLmlzRGlydHlMZWdlbmQ9Yi5pc0RpcnR5Qm94PSEwO2soYywhMCkmJmIucmVkcmF3KCl9LGNvbG9yaXplSXRlbTpmdW5jdGlvbihhLGMpe2EubGVnZW5kR3JvdXBbYz8icmVtb3ZlQ2xhc3MiOiJhZGRDbGFzcyJdKCJoaWdoY2hhcnRzLWxlZ2VuZC1pdGVtLWhpZGRlbiIpO3ZhciBiPXRoaXMub3B0aW9ucyxlPWEubGVnZW5kSXRlbSxtPWEubGVnZW5kTGluZSxrPWEubGVnZW5kU3ltYm9sLGY9dGhpcy5pdGVtSGlkZGVuU3R5bGUuY29sb3IsYj1jP2IuaXRlbVN0eWxlLmNvbG9yOmYscD1jP2EuY29sb3J8fGY6ZixoPWEub3B0aW9ucyYmYS5vcHRpb25zLm1hcmtlcixsPXtmaWxsOnB9LHE7ZSYmZS5jc3Moe2ZpbGw6Yixjb2xvcjpifSk7bSYmbS5hdHRyKHtzdHJva2U6cH0pO2lmKGspe2lmKGgmJmsuaXNNYXJrZXImJihsPWEucG9pbnRBdHRyaWJzKCksIWMpKWZvcihxIGluIGwpbFtxXT1mO2suYXR0cihsKX19LHBvc2l0aW9uSXRlbTpmdW5jdGlvbihhKXt2YXIgYj0NCiAgICB0aGlzLm9wdGlvbnMsZD1iLnN5bWJvbFBhZGRpbmcsYj0hYi5ydGwsYz1hLl9sZWdlbmRJdGVtUG9zLGU9Y1swXSxjPWNbMV0saz1hLmNoZWNrYm94OyhhPWEubGVnZW5kR3JvdXApJiZhLmVsZW1lbnQmJmEudHJhbnNsYXRlKGI/ZTp0aGlzLmxlZ2VuZFdpZHRoLWUtMipkLTQsYyk7ayYmKGsueD1lLGsueT1jKX0sZGVzdHJveUl0ZW06ZnVuY3Rpb24oYSl7dmFyIGI9YS5jaGVja2JveDtoKFsibGVnZW5kSXRlbSIsImxlZ2VuZExpbmUiLCJsZWdlbmRTeW1ib2wiLCJsZWdlbmRHcm91cCJdLGZ1bmN0aW9uKGIpe2FbYl0mJihhW2JdPWFbYl0uZGVzdHJveSgpKX0pO2ImJkUoYS5jaGVja2JveCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3RoaXNbYV0mJih0aGlzW2FdPXRoaXNbYV0uZGVzdHJveSgpKX1oKHRoaXMuZ2V0QWxsSXRlbXMoKSxmdW5jdGlvbihiKXtoKFsibGVnZW5kSXRlbSIsImxlZ2VuZEdyb3VwIl0sYSxiKX0pO2goImNsaXBSZWN0IHVwIGRvd24gcGFnZXIgbmF2IGJveCB0aXRsZSBncm91cCIuc3BsaXQoIiAiKSwNCiAgICBhLHRoaXMpO3RoaXMuZGlzcGxheT1udWxsfSxwb3NpdGlvbkNoZWNrYm94ZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5ncm91cCYmdGhpcy5ncm91cC5hbGlnbkF0dHIsZCxjPXRoaXMuY2xpcEhlaWdodHx8dGhpcy5sZWdlbmRIZWlnaHQsZT10aGlzLnRpdGxlSGVpZ2h0O2ImJihkPWIudHJhbnNsYXRlWSxoKHRoaXMuYWxsSXRlbXMsZnVuY3Rpb24obSl7dmFyIGY9bS5jaGVja2JveCxrO2YmJihrPWQrZStmLnkrKGF8fDApKzMsQyhmLHtsZWZ0OmIudHJhbnNsYXRlWCttLmNoZWNrYm94T2Zmc2V0K2YueC0yMCsicHgiLHRvcDprKyJweCIsZGlzcGxheTprPmQtNiYmazxkK2MtNj8iIjoibm9uZSJ9KSl9KSl9LHJlbmRlclRpdGxlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wYWRkaW5nLGM9dGhpcy5vcHRpb25zLnRpdGxlLGQ9MDtjLnRleHQmJih0aGlzLnRpdGxlfHwodGhpcy50aXRsZT10aGlzLmNoYXJ0LnJlbmRlcmVyLmxhYmVsKGMudGV4dCxhLTMsYS00LG51bGwsbnVsbCxudWxsLA0KICAgIG51bGwsbnVsbCwibGVnZW5kLXRpdGxlIikuYXR0cih7ekluZGV4OjF9KS5jc3MoYy5zdHlsZSkuYWRkKHRoaXMuZ3JvdXApKSxhPXRoaXMudGl0bGUuZ2V0QkJveCgpLGQ9YS5oZWlnaHQsdGhpcy5vZmZzZXRXaWR0aD1hLndpZHRoLHRoaXMuY29udGVudEdyb3VwLmF0dHIoe3RyYW5zbGF0ZVk6ZH0pKTt0aGlzLnRpdGxlSGVpZ2h0PWR9LHNldFRleHQ6ZnVuY3Rpb24oYil7dmFyIGM9dGhpcy5vcHRpb25zO2IubGVnZW5kSXRlbS5hdHRyKHt0ZXh0OmMubGFiZWxGb3JtYXQ/YS5mb3JtYXQoYy5sYWJlbEZvcm1hdCxiKTpjLmxhYmVsRm9ybWF0dGVyLmNhbGwoYil9KX0scmVuZGVySXRlbTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNoYXJ0LGQ9Yi5yZW5kZXJlcixjPXRoaXMub3B0aW9ucyxlPSJob3Jpem9udGFsIj09PWMubGF5b3V0LHA9dGhpcy5zeW1ib2xXaWR0aCxmPWMuc3ltYm9sUGFkZGluZyxoPXRoaXMuaXRlbVN0eWxlLG49dGhpcy5pdGVtSGlkZGVuU3R5bGUsdD10aGlzLnBhZGRpbmcsDQogICAgcT1lP2soYy5pdGVtRGlzdGFuY2UsMjApOjAseD0hYy5ydGwsSj1jLndpZHRoLHU9Yy5pdGVtTWFyZ2luQm90dG9tfHwwLEw9dGhpcy5pdGVtTWFyZ2luVG9wLGc9dGhpcy5pbml0aWFsSXRlbVgsRD1hLmxlZ2VuZEl0ZW0sSD0hYS5zZXJpZXMsej0hSCYmYS5zZXJpZXMuZHJhd0xlZ2VuZFN5bWJvbD9hLnNlcmllczphLEI9ei5vcHRpb25zLEI9dGhpcy5jcmVhdGVDaGVja2JveEZvckl0ZW0mJkImJkIuc2hvd0NoZWNrYm94LEM9Yy51c2VIVE1MO0R8fChhLmxlZ2VuZEdyb3VwPWQuZygibGVnZW5kLWl0ZW0iKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy0iK3oudHlwZSsiLXNlcmllcyBoaWdoY2hhcnRzLWNvbG9yLSIrYS5jb2xvckluZGV4KyhhLm9wdGlvbnMuY2xhc3NOYW1lPyIgIithLm9wdGlvbnMuY2xhc3NOYW1lOiIiKSsoSD8iIGhpZ2hjaGFydHMtc2VyaWVzLSIrYS5pbmRleDoiIikpLmF0dHIoe3pJbmRleDoxfSkuYWRkKHRoaXMuc2Nyb2xsR3JvdXApLGEubGVnZW5kSXRlbT1EPQ0KICAgIGQudGV4dCgiIix4P3ArZjotZix0aGlzLmJhc2VsaW5lfHwwLEMpLmNzcyhsKGEudmlzaWJsZT9oOm4pKS5hdHRyKHthbGlnbjp4PyJsZWZ0IjoicmlnaHQiLHpJbmRleDoyfSkuYWRkKGEubGVnZW5kR3JvdXApLHRoaXMuYmFzZWxpbmV8fChoPWguZm9udFNpemUsdGhpcy5mb250TWV0cmljcz1kLmZvbnRNZXRyaWNzKGgsRCksdGhpcy5iYXNlbGluZT10aGlzLmZvbnRNZXRyaWNzLmYrMytMLEQuYXR0cigieSIsdGhpcy5iYXNlbGluZSkpLHRoaXMuc3ltYm9sSGVpZ2h0PWMuc3ltYm9sSGVpZ2h0fHx0aGlzLmZvbnRNZXRyaWNzLmYsei5kcmF3TGVnZW5kU3ltYm9sKHRoaXMsYSksdGhpcy5zZXRJdGVtRXZlbnRzJiZ0aGlzLnNldEl0ZW1FdmVudHMoYSxELEMpLEImJnRoaXMuY3JlYXRlQ2hlY2tib3hGb3JJdGVtKGEpKTt0aGlzLmNvbG9yaXplSXRlbShhLGEudmlzaWJsZSk7dGhpcy5zZXRUZXh0KGEpO2Q9RC5nZXRCQm94KCk7cD1hLmNoZWNrYm94T2Zmc2V0PWMuaXRlbVdpZHRofHwNCiAgICBhLmxlZ2VuZEl0ZW1XaWR0aHx8cCtmK2Qud2lkdGgrcSsoQj8yMDowKTt0aGlzLml0ZW1IZWlnaHQ9Zj1NYXRoLnJvdW5kKGEubGVnZW5kSXRlbUhlaWdodHx8ZC5oZWlnaHQpO2UmJnRoaXMuaXRlbVgtZytwPihKfHxiLmNoYXJ0V2lkdGgtMip0LWctYy54KSYmKHRoaXMuaXRlbVg9Zyx0aGlzLml0ZW1ZKz1MK3RoaXMubGFzdExpbmVIZWlnaHQrdSx0aGlzLmxhc3RMaW5lSGVpZ2h0PTApO3RoaXMubWF4SXRlbVdpZHRoPU1hdGgubWF4KHRoaXMubWF4SXRlbVdpZHRoLHApO3RoaXMubGFzdEl0ZW1ZPUwrdGhpcy5pdGVtWSt1O3RoaXMubGFzdExpbmVIZWlnaHQ9TWF0aC5tYXgoZix0aGlzLmxhc3RMaW5lSGVpZ2h0KTthLl9sZWdlbmRJdGVtUG9zPVt0aGlzLml0ZW1YLHRoaXMuaXRlbVldO2U/dGhpcy5pdGVtWCs9cDoodGhpcy5pdGVtWSs9TCtmK3UsdGhpcy5sYXN0TGluZUhlaWdodD1mKTt0aGlzLm9mZnNldFdpZHRoPUp8fE1hdGgubWF4KChlP3RoaXMuaXRlbVgtZy1xOnApK3QsDQogICAgICAgIHRoaXMub2Zmc2V0V2lkdGgpfSxnZXRBbGxJdGVtczpmdW5jdGlvbigpe3ZhciBhPVtdO2godGhpcy5jaGFydC5zZXJpZXMsZnVuY3Rpb24oYil7dmFyIGQ9YiYmYi5vcHRpb25zO2ImJmsoZC5zaG93SW5MZWdlbmQsdShkLmxpbmtlZFRvKT8hMTp2b2lkIDAsITApJiYoYT1hLmNvbmNhdChiLmxlZ2VuZEl0ZW1zfHwoInBvaW50Ij09PWQubGVnZW5kVHlwZT9iLmRhdGE6YikpKX0pO3JldHVybiBhfSxhZGp1c3RNYXJnaW5zOmZ1bmN0aW9uKGEsYyl7dmFyIGI9dGhpcy5jaGFydCxlPXRoaXMub3B0aW9ucyxtPWUuYWxpZ24uY2hhckF0KDApK2UudmVydGljYWxBbGlnbi5jaGFyQXQoMCkrZS5sYXlvdXQuY2hhckF0KDApO2UuZmxvYXRpbmd8fGgoWy8obHRofGN0fHJ0aCkvLC8ocnR2fHJtfHJidikvLC8ocmJofGNifGxiaCkvLC8obGJ2fGxtfGx0dikvXSxmdW5jdGlvbihkLGYpe2QudGVzdChtKSYmIXUoYVtmXSkmJihiW3RbZl1dPU1hdGgubWF4KGJbdFtmXV0sYi5sZWdlbmRbKGYrMSklDQogICAgMj8ibGVnZW5kSGVpZ2h0IjoibGVnZW5kV2lkdGgiXStbMSwtMSwtMSwxXVtmXSplW2YlMj8ieCI6InkiXStrKGUubWFyZ2luLDEyKStjW2ZdKSl9KX0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxlPWEuY2hhcnQsZD1lLnJlbmRlcmVyLGs9YS5ncm91cCxwLG4sZix5LHQ9YS5ib3gsdT1hLm9wdGlvbnMscT1hLnBhZGRpbmc7YS5pdGVtWD1hLmluaXRpYWxJdGVtWDthLml0ZW1ZPWEuaW5pdGlhbEl0ZW1ZO2Eub2Zmc2V0V2lkdGg9MDthLmxhc3RJdGVtWT0wO2t8fChhLmdyb3VwPWs9ZC5nKCJsZWdlbmQiKS5hdHRyKHt6SW5kZXg6N30pLmFkZCgpLGEuY29udGVudEdyb3VwPWQuZygpLmF0dHIoe3pJbmRleDoxfSkuYWRkKGspLGEuc2Nyb2xsR3JvdXA9ZC5nKCkuYWRkKGEuY29udGVudEdyb3VwKSk7YS5yZW5kZXJUaXRsZSgpO3A9YS5nZXRBbGxJdGVtcygpO2MocCxmdW5jdGlvbihhLGIpe3JldHVybihhLm9wdGlvbnMmJmEub3B0aW9ucy5sZWdlbmRJbmRleHx8MCktKGIub3B0aW9ucyYmDQogICAgYi5vcHRpb25zLmxlZ2VuZEluZGV4fHwwKX0pO3UucmV2ZXJzZWQmJnAucmV2ZXJzZSgpO2EuYWxsSXRlbXM9cDthLmRpc3BsYXk9bj0hIXAubGVuZ3RoO2EubGFzdExpbmVIZWlnaHQ9MDtoKHAsZnVuY3Rpb24oYil7YS5yZW5kZXJJdGVtKGIpfSk7Zj0odS53aWR0aHx8YS5vZmZzZXRXaWR0aCkrcTt5PWEubGFzdEl0ZW1ZK2EubGFzdExpbmVIZWlnaHQrYS50aXRsZUhlaWdodDt5PWEuaGFuZGxlT3ZlcmZsb3coeSk7eSs9cTt0fHwoYS5ib3g9dD1kLnJlY3QoKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1sZWdlbmQtYm94IikuYXR0cih7cjp1LmJvcmRlclJhZGl1c30pLmFkZChrKSx0LmlzTmV3PSEwKTt0LmF0dHIoe3N0cm9rZTp1LmJvcmRlckNvbG9yLCJzdHJva2Utd2lkdGgiOnUuYm9yZGVyV2lkdGh8fDAsZmlsbDp1LmJhY2tncm91bmRDb2xvcnx8Im5vbmUifSkuc2hhZG93KHUuc2hhZG93KTswPGYmJjA8eSYmKHRbdC5pc05ldz8iYXR0ciI6ImFuaW1hdGUiXSh0LmNyaXNwKHt4OjAsDQogICAgeTowLHdpZHRoOmYsaGVpZ2h0Onl9LHQuc3Ryb2tlV2lkdGgoKSkpLHQuaXNOZXc9ITEpO3Rbbj8ic2hvdyI6ImhpZGUiXSgpO2EubGVnZW5kV2lkdGg9ZjthLmxlZ2VuZEhlaWdodD15O2gocCxmdW5jdGlvbihiKXthLnBvc2l0aW9uSXRlbShiKX0pO24mJmsuYWxpZ24obCh1LHt3aWR0aDpmLGhlaWdodDp5fSksITAsInNwYWNpbmdCb3giKTtlLmlzUmVzaXppbmd8fHRoaXMucG9zaXRpb25DaGVja2JveGVzKCl9LGhhbmRsZU92ZXJmbG93OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsZD10aGlzLmNoYXJ0LGM9ZC5yZW5kZXJlcixlPXRoaXMub3B0aW9ucyxwPWUueSxkPWQuc3BhY2luZ0JveC5oZWlnaHQrKCJ0b3AiPT09ZS52ZXJ0aWNhbEFsaWduPy1wOnApLXRoaXMucGFkZGluZyxwPWUubWF4SGVpZ2h0LGYsbD10aGlzLmNsaXBSZWN0LG49ZS5uYXZpZ2F0aW9uLHQ9ayhuLmFuaW1hdGlvbiwhMCkscT1uLmFycm93U2l6ZXx8MTIseD10aGlzLm5hdix1PXRoaXMucGFnZXMsSz10aGlzLnBhZGRpbmcsDQogICAgTCxnPXRoaXMuYWxsSXRlbXMsRD1mdW5jdGlvbihhKXthP2wuYXR0cih7aGVpZ2h0OmF9KTpsJiYoYi5jbGlwUmVjdD1sLmRlc3Ryb3koKSxiLmNvbnRlbnRHcm91cC5jbGlwKCkpO2IuY29udGVudEdyb3VwLmRpdiYmKGIuY29udGVudEdyb3VwLmRpdi5zdHlsZS5jbGlwPWE/InJlY3QoIitLKyJweCw5OTk5cHgsIisoSythKSsicHgsMCkiOiJhdXRvIil9OyJob3Jpem9udGFsIiE9PWUubGF5b3V0fHwibWlkZGxlIj09PWUudmVydGljYWxBbGlnbnx8ZS5mbG9hdGluZ3x8KGQvPTIpO3AmJihkPU1hdGgubWluKGQscCkpO3UubGVuZ3RoPTA7YT5kJiYhMSE9PW4uZW5hYmxlZD8odGhpcy5jbGlwSGVpZ2h0PWY9TWF0aC5tYXgoZC0yMC10aGlzLnRpdGxlSGVpZ2h0LUssMCksdGhpcy5jdXJyZW50UGFnZT1rKHRoaXMuY3VycmVudFBhZ2UsMSksdGhpcy5mdWxsSGVpZ2h0PWEsaChnLGZ1bmN0aW9uKGEsYil7dmFyIGQ9YS5fbGVnZW5kSXRlbVBvc1sxXTthPU1hdGgucm91bmQoYS5sZWdlbmRJdGVtLmdldEJCb3goKS5oZWlnaHQpOw0KICAgICAgICB2YXIgYz11Lmxlbmd0aDtpZighY3x8ZC11W2MtMV0+ZiYmKEx8fGQpIT09dVtjLTFdKXUucHVzaChMfHxkKSxjKys7Yj09PWcubGVuZ3RoLTEmJmQrYS11W2MtMV0+ZiYmdS5wdXNoKGQpO2QhPT1MJiYoTD1kKX0pLGx8fChsPWIuY2xpcFJlY3Q9Yy5jbGlwUmVjdCgwLEssOTk5OSwwKSxiLmNvbnRlbnRHcm91cC5jbGlwKGwpKSxEKGYpLHh8fCh0aGlzLm5hdj14PWMuZygpLmF0dHIoe3pJbmRleDoxfSkuYWRkKHRoaXMuZ3JvdXApLHRoaXMudXA9Yy5zeW1ib2woInRyaWFuZ2xlIiwwLDAscSxxKS5vbigiY2xpY2siLGZ1bmN0aW9uKCl7Yi5zY3JvbGwoLTEsdCl9KS5hZGQoeCksdGhpcy5wYWdlcj1jLnRleHQoIiIsMTUsMTApLmFkZENsYXNzKCJoaWdoY2hhcnRzLWxlZ2VuZC1uYXZpZ2F0aW9uIikuY3NzKG4uc3R5bGUpLmFkZCh4KSx0aGlzLmRvd249Yy5zeW1ib2woInRyaWFuZ2xlLWRvd24iLDAsMCxxLHEpLm9uKCJjbGljayIsZnVuY3Rpb24oKXtiLnNjcm9sbCgxLHQpfSkuYWRkKHgpKSwNCiAgICAgICAgYi5zY3JvbGwoMCksYT1kKTp4JiYoRCgpLHRoaXMubmF2PXguZGVzdHJveSgpLHRoaXMuc2Nyb2xsR3JvdXAuYXR0cih7dHJhbnNsYXRlWToxfSksdGhpcy5jbGlwSGVpZ2h0PTApO3JldHVybiBhfSxzY3JvbGw6ZnVuY3Rpb24oYSxjKXt2YXIgYj10aGlzLnBhZ2VzLG09Yi5sZW5ndGg7YT10aGlzLmN1cnJlbnRQYWdlK2E7dmFyIGs9dGhpcy5jbGlwSGVpZ2h0LHA9dGhpcy5vcHRpb25zLm5hdmlnYXRpb24sZj10aGlzLnBhZ2VyLGg9dGhpcy5wYWRkaW5nO2E+bSYmKGE9bSk7MDxhJiYodm9pZCAwIT09YyYmZShjLHRoaXMuY2hhcnQpLHRoaXMubmF2LmF0dHIoe3RyYW5zbGF0ZVg6aCx0cmFuc2xhdGVZOmsrdGhpcy5wYWRkaW5nKzcrdGhpcy50aXRsZUhlaWdodCx2aXNpYmlsaXR5OiJ2aXNpYmxlIn0pLHRoaXMudXAuYXR0cih7ImNsYXNzIjoxPT09YT8iaGlnaGNoYXJ0cy1sZWdlbmQtbmF2LWluYWN0aXZlIjoiaGlnaGNoYXJ0cy1sZWdlbmQtbmF2LWFjdGl2ZSJ9KSxmLmF0dHIoe3RleHQ6YSsNCiIvIittfSksdGhpcy5kb3duLmF0dHIoe3g6MTgrdGhpcy5wYWdlci5nZXRCQm94KCkud2lkdGgsImNsYXNzIjphPT09bT8iaGlnaGNoYXJ0cy1sZWdlbmQtbmF2LWluYWN0aXZlIjoiaGlnaGNoYXJ0cy1sZWdlbmQtbmF2LWFjdGl2ZSJ9KSx0aGlzLnVwLmF0dHIoe2ZpbGw6MT09PWE/cC5pbmFjdGl2ZUNvbG9yOnAuYWN0aXZlQ29sb3J9KS5jc3Moe2N1cnNvcjoxPT09YT8iZGVmYXVsdCI6InBvaW50ZXIifSksdGhpcy5kb3duLmF0dHIoe2ZpbGw6YT09PW0/cC5pbmFjdGl2ZUNvbG9yOnAuYWN0aXZlQ29sb3J9KS5jc3Moe2N1cnNvcjphPT09bT8iZGVmYXVsdCI6InBvaW50ZXIifSksYz0tYlthLTFdK3RoaXMuaW5pdGlhbEl0ZW1ZLHRoaXMuc2Nyb2xsR3JvdXAuYW5pbWF0ZSh7dHJhbnNsYXRlWTpjfSksdGhpcy5jdXJyZW50UGFnZT1hLHRoaXMucG9zaXRpb25DaGVja2JveGVzKGMpKX19O2EuTGVnZW5kU3ltYm9sTWl4aW49e2RyYXdSZWN0YW5nbGU6ZnVuY3Rpb24oYSxjKXt2YXIgYj0NCiAgICBhLnN5bWJvbEhlaWdodCxlPWEub3B0aW9ucy5zcXVhcmVTeW1ib2w7Yy5sZWdlbmRTeW1ib2w9dGhpcy5jaGFydC5yZW5kZXJlci5yZWN0KGU/KGEuc3ltYm9sV2lkdGgtYikvMjowLGEuYmFzZWxpbmUtYisxLGU/YjphLnN5bWJvbFdpZHRoLGIsayhhLm9wdGlvbnMuc3ltYm9sUmFkaXVzLGIvMikpLmFkZENsYXNzKCJoaWdoY2hhcnRzLXBvaW50IikuYXR0cih7ekluZGV4OjN9KS5hZGQoYy5sZWdlbmRHcm91cCl9LGRyYXdMaW5lTWFya2VyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWIubWFya2VyLGU9YS5zeW1ib2xXaWR0aCxwPWEuc3ltYm9sSGVpZ2h0LGg9cC8yLGY9dGhpcy5jaGFydC5yZW5kZXJlcixuPXRoaXMubGVnZW5kR3JvdXA7YT1hLmJhc2VsaW5lLU1hdGgucm91bmQoLjMqYS5mb250TWV0cmljcy5iKTt2YXIgdDt0PXsic3Ryb2tlLXdpZHRoIjpiLmxpbmVXaWR0aHx8MH07Yi5kYXNoU3R5bGUmJih0LmRhc2hzdHlsZT1iLmRhc2hTdHlsZSk7dGhpcy5sZWdlbmRMaW5lPQ0KICAgIGYucGF0aChbIk0iLDAsYSwiTCIsZSxhXSkuYWRkQ2xhc3MoImhpZ2hjaGFydHMtZ3JhcGgiKS5hdHRyKHQpLmFkZChuKTtjJiYhMSE9PWMuZW5hYmxlZCYmKGI9TWF0aC5taW4oayhjLnJhZGl1cyxoKSxoKSwwPT09dGhpcy5zeW1ib2wuaW5kZXhPZigidXJsIikmJihjPWwoYyx7d2lkdGg6cCxoZWlnaHQ6cH0pLGI9MCksdGhpcy5sZWdlbmRTeW1ib2w9Yz1mLnN5bWJvbCh0aGlzLnN5bWJvbCxlLzItYixhLWIsMipiLDIqYixjKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1wb2ludCIpLmFkZChuKSxjLmlzTWFya2VyPSEwKX19OygvVHJpZGVudFwvN1wuMC8udGVzdChwLm5hdmlnYXRvci51c2VyQWdlbnQpfHxuKSYmSChCLnByb3RvdHlwZSwicG9zaXRpb25JdGVtIixmdW5jdGlvbihhLGMpe3ZhciBiPXRoaXMsZT1mdW5jdGlvbigpe2MuX2xlZ2VuZEl0ZW1Qb3MmJmEuY2FsbChiLGMpfTtlKCk7c2V0VGltZW91dChlKX0pfSkoSSk7KGZ1bmN0aW9uKGEpe3ZhciBCPWEuYWRkRXZlbnQsej0NCiAgICBhLmFuaW1hdGUsQz1hLmFuaW1PYmplY3QsRT1hLmF0dHIsdT1hLmRvYyxoPWEuQXhpcyxuPWEuY3JlYXRlRWxlbWVudCx0PWEuZGVmYXVsdE9wdGlvbnMsbD1hLmRpc2NhcmRFbGVtZW50LGs9YS5jaGFydHMsZT1hLmNzcyxjPWEuZGVmaW5lZCxwPWEuZWFjaCxIPWEuZXh0ZW5kLGI9YS5maW5kLG09YS5maXJlRXZlbnQsZD1hLmdldFN0eWxlLHI9YS5ncmVwLEE9YS5pc051bWJlcix2PWEuaXNPYmplY3QsZj1hLmlzU3RyaW5nLHk9YS5MZWdlbmQsRz1hLm1hcmdpbk5hbWVzLEY9YS5tZXJnZSxxPWEuUG9pbnRlcix4PWEucGljayxKPWEucEludCxLPWEucmVtb3ZlRXZlbnQsTD1hLnNlcmllc1R5cGVzLGc9YS5zcGxhdCxEPWEuc3ZnLFM9YS5zeW5jVGltZW91dCxNPWEud2luLFI9YS5SZW5kZXJlcixOPWEuQ2hhcnQ9ZnVuY3Rpb24oKXt0aGlzLmdldEFyZ3MuYXBwbHkodGhpcyxhcmd1bWVudHMpfTthLmNoYXJ0PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmV3IE4oYSxiLGMpfTtOLnByb3RvdHlwZT0NCiAgICB7Y2FsbGJhY2tzOltdLGdldEFyZ3M6ZnVuY3Rpb24oKXt2YXIgYT1bXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7aWYoZihhWzBdKXx8YVswXS5ub2RlTmFtZSl0aGlzLnJlbmRlclRvPWEuc2hpZnQoKTt0aGlzLmluaXQoYVswXSxhWzFdKX0saW5pdDpmdW5jdGlvbihiLGMpe3ZhciBkLGY9Yi5zZXJpZXM7Yi5zZXJpZXM9bnVsbDtkPUYodCxiKTtkLnNlcmllcz1iLnNlcmllcz1mO3RoaXMudXNlck9wdGlvbnM9YjtiPWQuY2hhcnQ7Zj1iLmV2ZW50czt0aGlzLm1hcmdpbj1bXTt0aGlzLnNwYWNpbmc9W107dGhpcy5ib3VuZHM9e2g6e30sdjp7fX07dGhpcy5jYWxsYmFjaz1jO3RoaXMuaXNSZXNpemluZz0wO3RoaXMub3B0aW9ucz1kO3RoaXMuYXhlcz1bXTt0aGlzLnNlcmllcz1bXTt0aGlzLmhhc0NhcnRlc2lhblNlcmllcz1iLnNob3dBeGVzO3ZhciBnO3RoaXMuaW5kZXg9ay5sZW5ndGg7ay5wdXNoKHRoaXMpO2EuY2hhcnRDb3VudCsrO2lmKGYpZm9yKGcgaW4gZilCKHRoaXMsZywNCiAgICAgICAgZltnXSk7dGhpcy54QXhpcz1bXTt0aGlzLnlBeGlzPVtdO3RoaXMucG9pbnRDb3VudD10aGlzLmNvbG9yQ291bnRlcj10aGlzLnN5bWJvbENvdW50ZXI9MDt0aGlzLmZpcnN0UmVuZGVyKCl9LGluaXRTZXJpZXM6ZnVuY3Rpb24oYil7dmFyIGM9dGhpcy5vcHRpb25zLmNoYXJ0OyhjPUxbYi50eXBlfHxjLnR5cGV8fGMuZGVmYXVsdFNlcmllc1R5cGVdKXx8YS5lcnJvcigxNywhMCk7Yz1uZXcgYztjLmluaXQodGhpcyxiKTtyZXR1cm4gY30sb3JkZXJTZXJpZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zZXJpZXM7Zm9yKGE9YXx8MDthPGIubGVuZ3RoO2ErKyliW2FdJiYoYlthXS5pbmRleD1hLGJbYV0ubmFtZT1iW2FdLm5hbWV8fCJTZXJpZXMgIisoYlthXS5pbmRleCsxKSl9LGlzSW5zaWRlUGxvdDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yz9iOmE7YT1jP2E6YjtyZXR1cm4gMDw9ZCYmZDw9dGhpcy5wbG90V2lkdGgmJjA8PWEmJmE8PXRoaXMucGxvdEhlaWdodH0scmVkcmF3OmZ1bmN0aW9uKGIpe3ZhciBjPQ0KICAgICAgICB0aGlzLmF4ZXMsZD10aGlzLnNlcmllcyxmPXRoaXMucG9pbnRlcixnPXRoaXMubGVnZW5kLGU9dGhpcy5pc0RpcnR5TGVnZW5kLHEsayxoPXRoaXMuaGFzQ2FydGVzaWFuU2VyaWVzLHg9dGhpcy5pc0RpcnR5Qm94LGwsdz10aGlzLnJlbmRlcmVyLHI9dy5pc0hpZGRlbigpLG49W107dGhpcy5zZXRSZXNwb25zaXZlJiZ0aGlzLnNldFJlc3BvbnNpdmUoITEpO2Euc2V0QW5pbWF0aW9uKGIsdGhpcyk7ciYmdGhpcy5jbG9uZVJlbmRlclRvKCk7dGhpcy5sYXlPdXRUaXRsZXMoKTtmb3IoYj1kLmxlbmd0aDtiLS07KWlmKGw9ZFtiXSxsLm9wdGlvbnMuc3RhY2tpbmcmJihxPSEwLGwuaXNEaXJ0eSkpe2s9ITA7YnJlYWt9aWYoaylmb3IoYj1kLmxlbmd0aDtiLS07KWw9ZFtiXSxsLm9wdGlvbnMuc3RhY2tpbmcmJihsLmlzRGlydHk9ITApO3AoZCxmdW5jdGlvbihhKXthLmlzRGlydHkmJiJwb2ludCI9PT1hLm9wdGlvbnMubGVnZW5kVHlwZSYmKGEudXBkYXRlVG90YWxzJiZhLnVwZGF0ZVRvdGFscygpLA0KICAgICAgICBlPSEwKTthLmlzRGlydHlEYXRhJiZtKGEsInVwZGF0ZWREYXRhIil9KTtlJiZnLm9wdGlvbnMuZW5hYmxlZCYmKGcucmVuZGVyKCksdGhpcy5pc0RpcnR5TGVnZW5kPSExKTtxJiZ0aGlzLmdldFN0YWNrcygpO2gmJnAoYyxmdW5jdGlvbihhKXthLnVwZGF0ZU5hbWVzKCk7YS5zZXRTY2FsZSgpfSk7dGhpcy5nZXRNYXJnaW5zKCk7aCYmKHAoYyxmdW5jdGlvbihhKXthLmlzRGlydHkmJih4PSEwKX0pLHAoYyxmdW5jdGlvbihhKXt2YXIgYj1hLm1pbisiLCIrYS5tYXg7YS5leHRLZXkhPT1iJiYoYS5leHRLZXk9YixuLnB1c2goZnVuY3Rpb24oKXttKGEsImFmdGVyU2V0RXh0cmVtZXMiLEgoYS5ldmVudEFyZ3MsYS5nZXRFeHRyZW1lcygpKSk7ZGVsZXRlIGEuZXZlbnRBcmdzfSkpOyh4fHxxKSYmYS5yZWRyYXcoKX0pKTt4JiZ0aGlzLmRyYXdDaGFydEJveCgpO20odGhpcywicHJlZHJhdyIpO3AoZCxmdW5jdGlvbihhKXsoeHx8YS5pc0RpcnR5KSYmYS52aXNpYmxlJiZhLnJlZHJhdygpOw0KICAgICAgICBhLmlzRGlydHlEYXRhPSExfSk7ZiYmZi5yZXNldCghMCk7dy5kcmF3KCk7bSh0aGlzLCJyZWRyYXciKTttKHRoaXMsInJlbmRlciIpO3ImJnRoaXMuY2xvbmVSZW5kZXJUbyghMCk7cChuLGZ1bmN0aW9uKGEpe2EuY2FsbCgpfSl9LGdldDpmdW5jdGlvbihhKXtmdW5jdGlvbiBjKGIpe3JldHVybiBiLmlkPT09YXx8Yi5vcHRpb25zJiZiLm9wdGlvbnMuaWQ9PT1hfXZhciBkLGY9dGhpcy5zZXJpZXMsZztkPWIodGhpcy5heGVzLGMpfHxiKHRoaXMuc2VyaWVzLGMpO2ZvcihnPTA7IWQmJmc8Zi5sZW5ndGg7ZysrKWQ9YihmW2ddLnBvaW50c3x8W10sYyk7cmV0dXJuIGR9LGdldEF4ZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5vcHRpb25zLGM9Yi54QXhpcz1nKGIueEF4aXN8fHt9KSxiPWIueUF4aXM9ZyhiLnlBeGlzfHx7fSk7cChjLGZ1bmN0aW9uKGEsYil7YS5pbmRleD1iO2EuaXNYPSEwfSk7cChiLGZ1bmN0aW9uKGEsYil7YS5pbmRleD1ifSk7Yz1jLmNvbmNhdChiKTsNCiAgICAgICAgcChjLGZ1bmN0aW9uKGIpe25ldyBoKGEsYil9KX0sZ2V0U2VsZWN0ZWRQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT1bXTtwKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGIpe2E9YS5jb25jYXQocihiLnBvaW50c3x8W10sZnVuY3Rpb24oYSl7cmV0dXJuIGEuc2VsZWN0ZWR9KSl9KTtyZXR1cm4gYX0sZ2V0U2VsZWN0ZWRTZXJpZXM6ZnVuY3Rpb24oKXtyZXR1cm4gcih0aGlzLnNlcmllcyxmdW5jdGlvbihhKXtyZXR1cm4gYS5zZWxlY3RlZH0pfSxzZXRUaXRsZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxmPWQub3B0aW9ucyxnO2c9Zi50aXRsZT1GKHtzdHlsZTp7Y29sb3I6IiMzMzMzMzMiLGZvbnRTaXplOmYuaXNTdG9jaz8iMTZweCI6IjE4cHgifX0sZi50aXRsZSxhKTtmPWYuc3VidGl0bGU9Rih7c3R5bGU6e2NvbG9yOiIjNjY2NjY2In19LGYuc3VidGl0bGUsYik7cChbWyJ0aXRsZSIsYSxnXSxbInN1YnRpdGxlIixiLGZdXSxmdW5jdGlvbihhLGIpe3ZhciBjPWFbMF0sZj1kW2NdLA0KICAgICAgICBnPWFbMV07YT1hWzJdO2YmJmcmJihkW2NdPWY9Zi5kZXN0cm95KCkpO2EmJmEudGV4dCYmIWYmJihkW2NdPWQucmVuZGVyZXIudGV4dChhLnRleHQsMCwwLGEudXNlSFRNTCkuYXR0cih7YWxpZ246YS5hbGlnbiwiY2xhc3MiOiJoaWdoY2hhcnRzLSIrYyx6SW5kZXg6YS56SW5kZXh8fDR9KS5hZGQoKSxkW2NdLnVwZGF0ZT1mdW5jdGlvbihhKXtkLnNldFRpdGxlKCFiJiZhLGImJmEpfSxkW2NdLmNzcyhhLnN0eWxlKSl9KTtkLmxheU91dFRpdGxlcyhjKX0sbGF5T3V0VGl0bGVzOmZ1bmN0aW9uKGEpe3ZhciBiPTAsYyxkPXRoaXMucmVuZGVyZXIsZj10aGlzLnNwYWNpbmdCb3g7cChbInRpdGxlIiwic3VidGl0bGUiXSxmdW5jdGlvbihhKXt2YXIgYz10aGlzW2FdLGc9dGhpcy5vcHRpb25zW2FdLGU7YyYmKGU9Zy5zdHlsZS5mb250U2l6ZSxlPWQuZm9udE1ldHJpY3MoZSxjKS5iLGMuY3NzKHt3aWR0aDooZy53aWR0aHx8Zi53aWR0aCtnLndpZHRoQWRqdXN0KSsicHgifSkuYWxpZ24oSCh7eTpiKw0KICAgIGUrKCJ0aXRsZSI9PT1hPy0zOjIpfSxnKSwhMSwic3BhY2luZ0JveCIpLGcuZmxvYXRpbmd8fGcudmVydGljYWxBbGlnbnx8KGI9TWF0aC5jZWlsKGIrYy5nZXRCQm94KCkuaGVpZ2h0KSkpfSx0aGlzKTtjPXRoaXMudGl0bGVPZmZzZXQhPT1iO3RoaXMudGl0bGVPZmZzZXQ9YjshdGhpcy5pc0RpcnR5Qm94JiZjJiYodGhpcy5pc0RpcnR5Qm94PWMsdGhpcy5oYXNSZW5kZXJlZCYmeChhLCEwKSYmdGhpcy5pc0RpcnR5Qm94JiZ0aGlzLnJlZHJhdygpKX0sZ2V0Q2hhcnRTaXplOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5vcHRpb25zLmNoYXJ0LGY9Yi53aWR0aCxiPWIuaGVpZ2h0LGc9dGhpcy5yZW5kZXJUb0Nsb25lfHx0aGlzLnJlbmRlclRvO2MoZil8fCh0aGlzLmNvbnRhaW5lcldpZHRoPWQoZywid2lkdGgiKSk7YyhiKXx8KHRoaXMuY29udGFpbmVySGVpZ2h0PWQoZywiaGVpZ2h0IikpO3RoaXMuY2hhcnRXaWR0aD1NYXRoLm1heCgwLGZ8fHRoaXMuY29udGFpbmVyV2lkdGh8fDYwMCk7DQogICAgICAgIHRoaXMuY2hhcnRIZWlnaHQ9TWF0aC5tYXgoMCxhLnJlbGF0aXZlTGVuZ3RoKGIsdGhpcy5jaGFydFdpZHRoKXx8dGhpcy5jb250YWluZXJIZWlnaHR8fDQwMCl9LGNsb25lUmVuZGVyVG86ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yZW5kZXJUb0Nsb25lLGM9dGhpcy5jb250YWluZXI7aWYoYSl7aWYoYil7Zm9yKDtiLmNoaWxkTm9kZXMubGVuZ3RoOyl0aGlzLnJlbmRlclRvLmFwcGVuZENoaWxkKGIuZmlyc3RDaGlsZCk7bChiKTtkZWxldGUgdGhpcy5yZW5kZXJUb0Nsb25lfX1lbHNlIGMmJmMucGFyZW50Tm9kZT09PXRoaXMucmVuZGVyVG8mJnRoaXMucmVuZGVyVG8ucmVtb3ZlQ2hpbGQoYyksdGhpcy5yZW5kZXJUb0Nsb25lPWI9dGhpcy5yZW5kZXJUby5jbG9uZU5vZGUoMCksZShiLHtwb3NpdGlvbjoiYWJzb2x1dGUiLHRvcDoiLTk5OTlweCIsZGlzcGxheToiYmxvY2sifSksYi5zdHlsZS5zZXRQcm9wZXJ0eSYmYi5zdHlsZS5zZXRQcm9wZXJ0eSgiZGlzcGxheSIsImJsb2NrIiwNCiAgICAgICAgImltcG9ydGFudCIpLHUuYm9keS5hcHBlbmRDaGlsZChiKSxjJiZiLmFwcGVuZENoaWxkKGMpfSxzZXRDbGFzc05hbWU6ZnVuY3Rpb24oYSl7dGhpcy5jb250YWluZXIuY2xhc3NOYW1lPSJoaWdoY2hhcnRzLWNvbnRhaW5lciAiKyhhfHwiIil9LGdldENvbnRhaW5lcjpmdW5jdGlvbigpe3ZhciBiLGM9dGhpcy5vcHRpb25zLGQ9Yy5jaGFydCxnLGU7Yj10aGlzLnJlbmRlclRvO3ZhciBxPWEudW5pcXVlS2V5KCksbTtifHwodGhpcy5yZW5kZXJUbz1iPWQucmVuZGVyVG8pO2YoYikmJih0aGlzLnJlbmRlclRvPWI9dS5nZXRFbGVtZW50QnlJZChiKSk7Ynx8YS5lcnJvcigxMywhMCk7Zz1KKEUoYiwiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0IikpO0EoZykmJmtbZ10mJmtbZ10uaGFzUmVuZGVyZWQmJmtbZ10uZGVzdHJveSgpO0UoYiwiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0Iix0aGlzLmluZGV4KTtiLmlubmVySFRNTD0iIjtkLnNraXBDbG9uZXx8Yi5vZmZzZXRXaWR0aHx8dGhpcy5jbG9uZVJlbmRlclRvKCk7DQogICAgICAgIHRoaXMuZ2V0Q2hhcnRTaXplKCk7Zz10aGlzLmNoYXJ0V2lkdGg7ZT10aGlzLmNoYXJ0SGVpZ2h0O209SCh7cG9zaXRpb246InJlbGF0aXZlIixvdmVyZmxvdzoiaGlkZGVuIix3aWR0aDpnKyJweCIsaGVpZ2h0OmUrInB4Iix0ZXh0QWxpZ246ImxlZnQiLGxpbmVIZWlnaHQ6Im5vcm1hbCIsekluZGV4OjAsIi13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvciI6InJnYmEoMCwwLDAsMCkifSxkLnN0eWxlKTt0aGlzLmNvbnRhaW5lcj1iPW4oImRpdiIse2lkOnF9LG0sdGhpcy5yZW5kZXJUb0Nsb25lfHxiKTt0aGlzLl9jdXJzb3I9Yi5zdHlsZS5jdXJzb3I7dGhpcy5yZW5kZXJlcj1uZXcgKGFbZC5yZW5kZXJlcl18fFIpKGIsZyxlLG51bGwsZC5mb3JFeHBvcnQsYy5leHBvcnRpbmcmJmMuZXhwb3J0aW5nLmFsbG93SFRNTCk7dGhpcy5zZXRDbGFzc05hbWUoZC5jbGFzc05hbWUpO3RoaXMucmVuZGVyZXIuc2V0U3R5bGUoZC5zdHlsZSk7dGhpcy5yZW5kZXJlci5jaGFydEluZGV4PXRoaXMuaW5kZXh9LA0KICAgICAgICBnZXRNYXJnaW5zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuc3BhY2luZyxkPXRoaXMubWFyZ2luLGY9dGhpcy50aXRsZU9mZnNldDt0aGlzLnJlc2V0TWFyZ2lucygpO2YmJiFjKGRbMF0pJiYodGhpcy5wbG90VG9wPU1hdGgubWF4KHRoaXMucGxvdFRvcCxmK3RoaXMub3B0aW9ucy50aXRsZS5tYXJnaW4rYlswXSkpO3RoaXMubGVnZW5kLmRpc3BsYXkmJnRoaXMubGVnZW5kLmFkanVzdE1hcmdpbnMoZCxiKTt0aGlzLmV4dHJhTWFyZ2luJiYodGhpc1t0aGlzLmV4dHJhTWFyZ2luLnR5cGVdPSh0aGlzW3RoaXMuZXh0cmFNYXJnaW4udHlwZV18fDApK3RoaXMuZXh0cmFNYXJnaW4udmFsdWUpO3RoaXMuZXh0cmFUb3BNYXJnaW4mJih0aGlzLnBsb3RUb3ArPXRoaXMuZXh0cmFUb3BNYXJnaW4pO2F8fHRoaXMuZ2V0QXhpc01hcmdpbnMoKX0sZ2V0QXhpc01hcmdpbnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5heGlzT2Zmc2V0PVswLDAsMCwwXSxkPWEubWFyZ2luO2EuaGFzQ2FydGVzaWFuU2VyaWVzJiYNCiAgICBwKGEuYXhlcyxmdW5jdGlvbihhKXthLnZpc2libGUmJmEuZ2V0T2Zmc2V0KCl9KTtwKEcsZnVuY3Rpb24oZixnKXtjKGRbZ10pfHwoYVtmXSs9YltnXSl9KTthLnNldENoYXJ0U2l6ZSgpfSxyZWZsb3c6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxmPWIub3B0aW9ucy5jaGFydCxnPWIucmVuZGVyVG8sZT1jKGYud2lkdGgpLHE9Zi53aWR0aHx8ZChnLCJ3aWR0aCIpLGY9Zi5oZWlnaHR8fGQoZywiaGVpZ2h0IiksZz1hP2EudGFyZ2V0Ok07aWYoIWUmJiFiLmlzUHJpbnRpbmcmJnEmJmYmJihnPT09TXx8Zz09PXUpKXtpZihxIT09Yi5jb250YWluZXJXaWR0aHx8ZiE9PWIuY29udGFpbmVySGVpZ2h0KWNsZWFyVGltZW91dChiLnJlZmxvd1RpbWVvdXQpLGIucmVmbG93VGltZW91dD1TKGZ1bmN0aW9uKCl7Yi5jb250YWluZXImJmIuc2V0U2l6ZSh2b2lkIDAsdm9pZCAwLCExKX0sYT8xMDA6MCk7Yi5jb250YWluZXJXaWR0aD1xO2IuY29udGFpbmVySGVpZ2h0PWZ9fSxpbml0UmVmbG93OmZ1bmN0aW9uKCl7dmFyIGE9DQogICAgICAgIHRoaXMsYjtiPUIoTSwicmVzaXplIixmdW5jdGlvbihiKXthLnJlZmxvdyhiKX0pO0IoYSwiZGVzdHJveSIsYil9LHNldFNpemU6ZnVuY3Rpb24oYixjLGQpe3ZhciBmPXRoaXMsZz1mLnJlbmRlcmVyO2YuaXNSZXNpemluZys9MTthLnNldEFuaW1hdGlvbihkLGYpO2Yub2xkQ2hhcnRIZWlnaHQ9Zi5jaGFydEhlaWdodDtmLm9sZENoYXJ0V2lkdGg9Zi5jaGFydFdpZHRoO3ZvaWQgMCE9PWImJihmLm9wdGlvbnMuY2hhcnQud2lkdGg9Yik7dm9pZCAwIT09YyYmKGYub3B0aW9ucy5jaGFydC5oZWlnaHQ9Yyk7Zi5nZXRDaGFydFNpemUoKTtiPWcuZ2xvYmFsQW5pbWF0aW9uOyhiP3o6ZSkoZi5jb250YWluZXIse3dpZHRoOmYuY2hhcnRXaWR0aCsicHgiLGhlaWdodDpmLmNoYXJ0SGVpZ2h0KyJweCJ9LGIpO2Yuc2V0Q2hhcnRTaXplKCEwKTtnLnNldFNpemUoZi5jaGFydFdpZHRoLGYuY2hhcnRIZWlnaHQsZCk7cChmLmF4ZXMsZnVuY3Rpb24oYSl7YS5pc0RpcnR5PSEwO2Euc2V0U2NhbGUoKX0pOw0KICAgICAgICBmLmlzRGlydHlMZWdlbmQ9ITA7Zi5pc0RpcnR5Qm94PSEwO2YubGF5T3V0VGl0bGVzKCk7Zi5nZXRNYXJnaW5zKCk7Zi5yZWRyYXcoZCk7Zi5vbGRDaGFydEhlaWdodD1udWxsO20oZiwicmVzaXplIik7UyhmdW5jdGlvbigpe2YmJm0oZiwiZW5kUmVzaXplIixudWxsLGZ1bmN0aW9uKCl7LS1mLmlzUmVzaXppbmd9KX0sQyhiKS5kdXJhdGlvbil9LHNldENoYXJ0U2l6ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmludmVydGVkLGM9dGhpcy5yZW5kZXJlcixkPXRoaXMuY2hhcnRXaWR0aCxmPXRoaXMuY2hhcnRIZWlnaHQsZz10aGlzLm9wdGlvbnMuY2hhcnQsZT10aGlzLnNwYWNpbmcscT10aGlzLmNsaXBPZmZzZXQsayxtLGgseDt0aGlzLnBsb3RMZWZ0PWs9TWF0aC5yb3VuZCh0aGlzLnBsb3RMZWZ0KTt0aGlzLnBsb3RUb3A9bT1NYXRoLnJvdW5kKHRoaXMucGxvdFRvcCk7dGhpcy5wbG90V2lkdGg9aD1NYXRoLm1heCgwLE1hdGgucm91bmQoZC1rLXRoaXMubWFyZ2luUmlnaHQpKTsNCiAgICAgICAgdGhpcy5wbG90SGVpZ2h0PXg9TWF0aC5tYXgoMCxNYXRoLnJvdW5kKGYtbS10aGlzLm1hcmdpbkJvdHRvbSkpO3RoaXMucGxvdFNpemVYPWI/eDpoO3RoaXMucGxvdFNpemVZPWI/aDp4O3RoaXMucGxvdEJvcmRlcldpZHRoPWcucGxvdEJvcmRlcldpZHRofHwwO3RoaXMuc3BhY2luZ0JveD1jLnNwYWNpbmdCb3g9e3g6ZVszXSx5OmVbMF0sd2lkdGg6ZC1lWzNdLWVbMV0saGVpZ2h0OmYtZVswXS1lWzJdfTt0aGlzLnBsb3RCb3g9Yy5wbG90Qm94PXt4OmsseTptLHdpZHRoOmgsaGVpZ2h0Onh9O2Q9MipNYXRoLmZsb29yKHRoaXMucGxvdEJvcmRlcldpZHRoLzIpO2I9TWF0aC5jZWlsKE1hdGgubWF4KGQscVszXSkvMik7Yz1NYXRoLmNlaWwoTWF0aC5tYXgoZCxxWzBdKS8yKTt0aGlzLmNsaXBCb3g9e3g6Yix5OmMsd2lkdGg6TWF0aC5mbG9vcih0aGlzLnBsb3RTaXplWC1NYXRoLm1heChkLHFbMV0pLzItYiksaGVpZ2h0Ok1hdGgubWF4KDAsTWF0aC5mbG9vcih0aGlzLnBsb3RTaXplWS0NCiAgICAgICAgICAgIE1hdGgubWF4KGQscVsyXSkvMi1jKSl9O2F8fHAodGhpcy5heGVzLGZ1bmN0aW9uKGEpe2Euc2V0QXhpc1NpemUoKTthLnNldEF4aXNUcmFuc2xhdGlvbigpfSl9LHJlc2V0TWFyZ2luczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMuY2hhcnQ7cChbIm1hcmdpbiIsInNwYWNpbmciXSxmdW5jdGlvbihjKXt2YXIgZD1iW2NdLGY9dihkKT9kOltkLGQsZCxkXTtwKFsiVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il0sZnVuY3Rpb24oZCxnKXthW2NdW2ddPXgoYltjK2RdLGZbZ10pfSl9KTtwKEcsZnVuY3Rpb24oYixjKXthW2JdPXgoYS5tYXJnaW5bY10sYS5zcGFjaW5nW2NdKX0pO2EuYXhpc09mZnNldD1bMCwwLDAsMF07YS5jbGlwT2Zmc2V0PVswLDAsMCwwXX0sZHJhd0NoYXJ0Qm94OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmNoYXJ0LGI9dGhpcy5yZW5kZXJlcixjPXRoaXMuY2hhcnRXaWR0aCxkPXRoaXMuY2hhcnRIZWlnaHQsZj10aGlzLmNoYXJ0QmFja2dyb3VuZCwNCiAgICAgICAgZz10aGlzLnBsb3RCYWNrZ3JvdW5kLGU9dGhpcy5wbG90Qm9yZGVyLHEsaz10aGlzLnBsb3RCR0ltYWdlLG09YS5iYWNrZ3JvdW5kQ29sb3IscD1hLnBsb3RCYWNrZ3JvdW5kQ29sb3IsaD1hLnBsb3RCYWNrZ3JvdW5kSW1hZ2UseCxsPXRoaXMucGxvdExlZnQscj10aGlzLnBsb3RUb3Asbj10aGlzLnBsb3RXaWR0aCx2PXRoaXMucGxvdEhlaWdodCx0PXRoaXMucGxvdEJveCx5PXRoaXMuY2xpcFJlY3QsdT10aGlzLmNsaXBCb3gsSj0iYW5pbWF0ZSI7Znx8KHRoaXMuY2hhcnRCYWNrZ3JvdW5kPWY9Yi5yZWN0KCkuYWRkQ2xhc3MoImhpZ2hjaGFydHMtYmFja2dyb3VuZCIpLmFkZCgpLEo9ImF0dHIiKTtxPWEuYm9yZGVyV2lkdGh8fDA7eD1xKyhhLnNoYWRvdz84OjApO209e2ZpbGw6bXx8Im5vbmUifTtpZihxfHxmWyJzdHJva2Utd2lkdGgiXSltLnN0cm9rZT1hLmJvcmRlckNvbG9yLG1bInN0cm9rZS13aWR0aCJdPXE7Zi5hdHRyKG0pLnNoYWRvdyhhLnNoYWRvdyk7ZltKXSh7eDp4Lw0KICAgIDIseTp4LzIsd2lkdGg6Yy14LXElMixoZWlnaHQ6ZC14LXElMixyOmEuYm9yZGVyUmFkaXVzfSk7Sj0iYW5pbWF0ZSI7Z3x8KEo9ImF0dHIiLHRoaXMucGxvdEJhY2tncm91bmQ9Zz1iLnJlY3QoKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1wbG90LWJhY2tncm91bmQiKS5hZGQoKSk7Z1tKXSh0KTtnLmF0dHIoe2ZpbGw6cHx8Im5vbmUifSkuc2hhZG93KGEucGxvdFNoYWRvdyk7aCYmKGs/ay5hbmltYXRlKHQpOnRoaXMucGxvdEJHSW1hZ2U9Yi5pbWFnZShoLGwscixuLHYpLmFkZCgpKTt5P3kuYW5pbWF0ZSh7d2lkdGg6dS53aWR0aCxoZWlnaHQ6dS5oZWlnaHR9KTp0aGlzLmNsaXBSZWN0PWIuY2xpcFJlY3QodSk7Sj0iYW5pbWF0ZSI7ZXx8KEo9ImF0dHIiLHRoaXMucGxvdEJvcmRlcj1lPWIucmVjdCgpLmFkZENsYXNzKCJoaWdoY2hhcnRzLXBsb3QtYm9yZGVyIikuYXR0cih7ekluZGV4OjF9KS5hZGQoKSk7ZS5hdHRyKHtzdHJva2U6YS5wbG90Qm9yZGVyQ29sb3IsInN0cm9rZS13aWR0aCI6YS5wbG90Qm9yZGVyV2lkdGh8fA0KICAgIDAsZmlsbDoibm9uZSJ9KTtlW0pdKGUuY3Jpc3Aoe3g6bCx5OnIsd2lkdGg6bixoZWlnaHQ6dn0sLWUuc3Ryb2tlV2lkdGgoKSkpO3RoaXMuaXNEaXJ0eUJveD0hMX0scHJvcEZyb21TZXJpZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLmNoYXJ0LGMsZD1hLm9wdGlvbnMuc2VyaWVzLGYsZztwKFsiaW52ZXJ0ZWQiLCJhbmd1bGFyIiwicG9sYXIiXSxmdW5jdGlvbihlKXtjPUxbYi50eXBlfHxiLmRlZmF1bHRTZXJpZXNUeXBlXTtnPWJbZV18fGMmJmMucHJvdG90eXBlW2VdO2ZvcihmPWQmJmQubGVuZ3RoOyFnJiZmLS07KShjPUxbZFtmXS50eXBlXSkmJmMucHJvdG90eXBlW2VdJiYoZz0hMCk7YVtlXT1nfSl9LGxpbmtTZXJpZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5zZXJpZXM7cChiLGZ1bmN0aW9uKGEpe2EubGlua2VkU2VyaWVzLmxlbmd0aD0wfSk7cChiLGZ1bmN0aW9uKGIpe3ZhciBjPWIub3B0aW9ucy5saW5rZWRUbztmKGMpJiYoYz0iOnByZXZpb3VzIj09PQ0KICAgIGM/YS5zZXJpZXNbYi5pbmRleC0xXTphLmdldChjKSkmJmMubGlua2VkUGFyZW50IT09YiYmKGMubGlua2VkU2VyaWVzLnB1c2goYiksYi5saW5rZWRQYXJlbnQ9YyxiLnZpc2libGU9eChiLm9wdGlvbnMudmlzaWJsZSxjLm9wdGlvbnMudmlzaWJsZSxiLnZpc2libGUpKX0pfSxyZW5kZXJTZXJpZXM6ZnVuY3Rpb24oKXtwKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGEpe2EudHJhbnNsYXRlKCk7YS5yZW5kZXIoKX0pfSxyZW5kZXJMYWJlbHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zLmxhYmVscztiLml0ZW1zJiZwKGIuaXRlbXMsZnVuY3Rpb24oYyl7dmFyIGQ9SChiLnN0eWxlLGMuc3R5bGUpLGY9SihkLmxlZnQpK2EucGxvdExlZnQsZz1KKGQudG9wKSthLnBsb3RUb3ArMTI7ZGVsZXRlIGQubGVmdDtkZWxldGUgZC50b3A7YS5yZW5kZXJlci50ZXh0KGMuaHRtbCxmLGcpLmF0dHIoe3pJbmRleDoyfSkuY3NzKGQpLmFkZCgpfSl9LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPQ0KICAgICAgICB0aGlzLmF4ZXMsYj10aGlzLnJlbmRlcmVyLGM9dGhpcy5vcHRpb25zLGQsZixnO3RoaXMuc2V0VGl0bGUoKTt0aGlzLmxlZ2VuZD1uZXcgeSh0aGlzLGMubGVnZW5kKTt0aGlzLmdldFN0YWNrcyYmdGhpcy5nZXRTdGFja3MoKTt0aGlzLmdldE1hcmdpbnMoITApO3RoaXMuc2V0Q2hhcnRTaXplKCk7Yz10aGlzLnBsb3RXaWR0aDtkPXRoaXMucGxvdEhlaWdodC09MjE7cChhLGZ1bmN0aW9uKGEpe2Euc2V0U2NhbGUoKX0pO3RoaXMuZ2V0QXhpc01hcmdpbnMoKTtmPTEuMTxjL3RoaXMucGxvdFdpZHRoO2c9MS4wNTxkL3RoaXMucGxvdEhlaWdodDtpZihmfHxnKXAoYSxmdW5jdGlvbihhKXsoYS5ob3JpeiYmZnx8IWEuaG9yaXomJmcpJiZhLnNldFRpY2tJbnRlcnZhbCghMCl9KSx0aGlzLmdldE1hcmdpbnMoKTt0aGlzLmRyYXdDaGFydEJveCgpO3RoaXMuaGFzQ2FydGVzaWFuU2VyaWVzJiZwKGEsZnVuY3Rpb24oYSl7YS52aXNpYmxlJiZhLnJlbmRlcigpfSk7dGhpcy5zZXJpZXNHcm91cHx8DQogICAgKHRoaXMuc2VyaWVzR3JvdXA9Yi5nKCJzZXJpZXMtZ3JvdXAiKS5hdHRyKHt6SW5kZXg6M30pLmFkZCgpKTt0aGlzLnJlbmRlclNlcmllcygpO3RoaXMucmVuZGVyTGFiZWxzKCk7dGhpcy5hZGRDcmVkaXRzKCk7dGhpcy5zZXRSZXNwb25zaXZlJiZ0aGlzLnNldFJlc3BvbnNpdmUoKTt0aGlzLmhhc1JlbmRlcmVkPSEwfSxhZGRDcmVkaXRzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7YT1GKCEwLHRoaXMub3B0aW9ucy5jcmVkaXRzLGEpO2EuZW5hYmxlZCYmIXRoaXMuY3JlZGl0cyYmKHRoaXMuY3JlZGl0cz10aGlzLnJlbmRlcmVyLnRleHQoYS50ZXh0Kyh0aGlzLm1hcENyZWRpdHN8fCIiKSwwLDApLmFkZENsYXNzKCJoaWdoY2hhcnRzLWNyZWRpdHMiKS5vbigiY2xpY2siLGZ1bmN0aW9uKCl7YS5ocmVmJiYoTS5sb2NhdGlvbi5ocmVmPWEuaHJlZil9KS5hdHRyKHthbGlnbjphLnBvc2l0aW9uLmFsaWduLHpJbmRleDo4fSkuY3NzKGEuc3R5bGUpLmFkZCgpLmFsaWduKGEucG9zaXRpb24pLA0KICAgICAgICB0aGlzLmNyZWRpdHMudXBkYXRlPWZ1bmN0aW9uKGEpe2IuY3JlZGl0cz1iLmNyZWRpdHMuZGVzdHJveSgpO2IuYWRkQ3JlZGl0cyhhKX0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxjPWIuYXhlcyxkPWIuc2VyaWVzLGY9Yi5jb250YWluZXIsZyxlPWYmJmYucGFyZW50Tm9kZTttKGIsImRlc3Ryb3kiKTtrW2IuaW5kZXhdPXZvaWQgMDthLmNoYXJ0Q291bnQtLTtiLnJlbmRlclRvLnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS1oaWdoY2hhcnRzLWNoYXJ0Iik7SyhiKTtmb3IoZz1jLmxlbmd0aDtnLS07KWNbZ109Y1tnXS5kZXN0cm95KCk7dGhpcy5zY3JvbGxlciYmdGhpcy5zY3JvbGxlci5kZXN0cm95JiZ0aGlzLnNjcm9sbGVyLmRlc3Ryb3koKTtmb3IoZz1kLmxlbmd0aDtnLS07KWRbZ109ZFtnXS5kZXN0cm95KCk7cCgidGl0bGUgc3VidGl0bGUgY2hhcnRCYWNrZ3JvdW5kIHBsb3RCYWNrZ3JvdW5kIHBsb3RCR0ltYWdlIHBsb3RCb3JkZXIgc2VyaWVzR3JvdXAgY2xpcFJlY3QgY3JlZGl0cyBwb2ludGVyIHJhbmdlU2VsZWN0b3IgbGVnZW5kIHJlc2V0Wm9vbUJ1dHRvbiB0b29sdGlwIHJlbmRlcmVyIi5zcGxpdCgiICIpLA0KICAgICAgICBmdW5jdGlvbihhKXt2YXIgYz1iW2FdO2MmJmMuZGVzdHJveSYmKGJbYV09Yy5kZXN0cm95KCkpfSk7ZiYmKGYuaW5uZXJIVE1MPSIiLEsoZiksZSYmbChmKSk7Zm9yKGcgaW4gYilkZWxldGUgYltnXX0saXNSZWFkeVRvUmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gRHx8TSE9TS50b3B8fCJjb21wbGV0ZSI9PT11LnJlYWR5U3RhdGU/ITA6KHUuYXR0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsZnVuY3Rpb24oKXt1LmRldGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLGEuZmlyc3RSZW5kZXIpOyJjb21wbGV0ZSI9PT11LnJlYWR5U3RhdGUmJmEuZmlyc3RSZW5kZXIoKX0pLCExKX0sZmlyc3RSZW5kZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5vcHRpb25zO2lmKGEuaXNSZWFkeVRvUmVuZGVyKCkpe2EuZ2V0Q29udGFpbmVyKCk7bShhLCJpbml0Iik7YS5yZXNldE1hcmdpbnMoKTthLnNldENoYXJ0U2l6ZSgpO2EucHJvcEZyb21TZXJpZXMoKTsNCiAgICAgICAgYS5nZXRBeGVzKCk7cChiLnNlcmllc3x8W10sZnVuY3Rpb24oYil7YS5pbml0U2VyaWVzKGIpfSk7YS5saW5rU2VyaWVzKCk7bShhLCJiZWZvcmVSZW5kZXIiKTtxJiYoYS5wb2ludGVyPW5ldyBxKGEsYikpO2EucmVuZGVyKCk7aWYoIWEucmVuZGVyZXIuaW1nQ291bnQmJmEub25sb2FkKWEub25sb2FkKCk7YS5jbG9uZVJlbmRlclRvKCEwKX19LG9ubG9hZDpmdW5jdGlvbigpe3AoW3RoaXMuY2FsbGJhY2tdLmNvbmNhdCh0aGlzLmNhbGxiYWNrcyksZnVuY3Rpb24oYSl7YSYmdm9pZCAwIT09dGhpcy5pbmRleCYmYS5hcHBseSh0aGlzLFt0aGlzXSl9LHRoaXMpO20odGhpcywibG9hZCIpO20odGhpcywicmVuZGVyIik7Yyh0aGlzLmluZGV4KSYmITEhPT10aGlzLm9wdGlvbnMuY2hhcnQucmVmbG93JiZ0aGlzLmluaXRSZWZsb3coKTt0aGlzLm9ubG9hZD1udWxsfX19KShJKTsoZnVuY3Rpb24oYSl7dmFyIEIsej1hLmVhY2gsQz1hLmV4dGVuZCxFPWEuZXJhc2UsdT1hLmZpcmVFdmVudCwNCiAgICBoPWEuZm9ybWF0LG49YS5pc0FycmF5LHQ9YS5pc051bWJlcixsPWEucGljayxrPWEucmVtb3ZlRXZlbnQ7Qj1hLlBvaW50PWZ1bmN0aW9uKCl7fTtCLnByb3RvdHlwZT17aW5pdDpmdW5jdGlvbihhLGMsayl7dGhpcy5zZXJpZXM9YTt0aGlzLmNvbG9yPWEuY29sb3I7dGhpcy5hcHBseU9wdGlvbnMoYyxrKTthLm9wdGlvbnMuY29sb3JCeVBvaW50PyhjPWEub3B0aW9ucy5jb2xvcnN8fGEuY2hhcnQub3B0aW9ucy5jb2xvcnMsdGhpcy5jb2xvcj10aGlzLmNvbG9yfHxjW2EuY29sb3JDb3VudGVyXSxjPWMubGVuZ3RoLGs9YS5jb2xvckNvdW50ZXIsYS5jb2xvckNvdW50ZXIrKyxhLmNvbG9yQ291bnRlcj09PWMmJihhLmNvbG9yQ291bnRlcj0wKSk6az1hLmNvbG9ySW5kZXg7dGhpcy5jb2xvckluZGV4PWwodGhpcy5jb2xvckluZGV4LGspO2EuY2hhcnQucG9pbnRDb3VudCsrO3JldHVybiB0aGlzfSxhcHBseU9wdGlvbnM6ZnVuY3Rpb24oYSxjKXt2YXIgZT10aGlzLnNlcmllcyxrPWUub3B0aW9ucy5wb2ludFZhbEtleXx8DQogICAgZS5wb2ludFZhbEtleTthPUIucHJvdG90eXBlLm9wdGlvbnNUb09iamVjdC5jYWxsKHRoaXMsYSk7Qyh0aGlzLGEpO3RoaXMub3B0aW9ucz10aGlzLm9wdGlvbnM/Qyh0aGlzLm9wdGlvbnMsYSk6YTthLmdyb3VwJiZkZWxldGUgdGhpcy5ncm91cDtrJiYodGhpcy55PXRoaXNba10pO3RoaXMuaXNOdWxsPWwodGhpcy5pc1ZhbGlkJiYhdGhpcy5pc1ZhbGlkKCksbnVsbD09PXRoaXMueHx8IXQodGhpcy55LCEwKSk7dGhpcy5zZWxlY3RlZCYmKHRoaXMuc3RhdGU9InNlbGVjdCIpOyJuYW1lImluIHRoaXMmJnZvaWQgMD09PWMmJmUueEF4aXMmJmUueEF4aXMuaGFzTmFtZXMmJih0aGlzLng9ZS54QXhpcy5uYW1lVG9YKHRoaXMpKTt2b2lkIDA9PT10aGlzLngmJmUmJih0aGlzLng9dm9pZCAwPT09Yz9lLmF1dG9JbmNyZW1lbnQodGhpcyk6Yyk7cmV0dXJuIHRoaXN9LG9wdGlvbnNUb09iamVjdDpmdW5jdGlvbihhKXt2YXIgYz17fSxlPXRoaXMuc2VyaWVzLGs9ZS5vcHRpb25zLmtleXMsDQogICAgYj1rfHxlLnBvaW50QXJyYXlNYXB8fFsieSJdLG09Yi5sZW5ndGgsZD0wLGg9MDtpZih0KGEpfHxudWxsPT09YSljW2JbMF1dPWE7ZWxzZSBpZihuKGEpKWZvcighayYmYS5sZW5ndGg+bSYmKGU9dHlwZW9mIGFbMF0sInN0cmluZyI9PT1lP2MubmFtZT1hWzBdOiJudW1iZXIiPT09ZSYmKGMueD1hWzBdKSxkKyspO2g8bTspayYmdm9pZCAwPT09YVtkXXx8KGNbYltoXV09YVtkXSksZCsrLGgrKztlbHNlIm9iamVjdCI9PT10eXBlb2YgYSYmKGM9YSxhLmRhdGFMYWJlbHMmJihlLl9oYXNQb2ludExhYmVscz0hMCksYS5tYXJrZXImJihlLl9oYXNQb2ludE1hcmtlcnM9ITApKTtyZXR1cm4gY30sZ2V0Q2xhc3NOYW1lOmZ1bmN0aW9uKCl7cmV0dXJuImhpZ2hjaGFydHMtcG9pbnQiKyh0aGlzLnNlbGVjdGVkPyIgaGlnaGNoYXJ0cy1wb2ludC1zZWxlY3QiOiIiKSsodGhpcy5uZWdhdGl2ZT8iIGhpZ2hjaGFydHMtbmVnYXRpdmUiOiIiKSsodGhpcy5pc051bGw/IiBoaWdoY2hhcnRzLW51bGwtcG9pbnQiOg0KICAgICAgICAiIikrKHZvaWQgMCE9PXRoaXMuY29sb3JJbmRleD8iIGhpZ2hjaGFydHMtY29sb3ItIit0aGlzLmNvbG9ySW5kZXg6IiIpKyh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lPyIgIit0aGlzLm9wdGlvbnMuY2xhc3NOYW1lOiIiKSsodGhpcy56b25lJiZ0aGlzLnpvbmUuY2xhc3NOYW1lPyIgIit0aGlzLnpvbmUuY2xhc3NOYW1lLnJlcGxhY2UoImhpZ2hjaGFydHMtbmVnYXRpdmUiLCIiKToiIil9LGdldFpvbmU6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnNlcmllcyxjPWEuem9uZXMsYT1hLnpvbmVBeGlzfHwieSIsaz0wLGg7Zm9yKGg9Y1trXTt0aGlzW2FdPj1oLnZhbHVlOyloPWNbKytrXTtoJiZoLmNvbG9yJiYhdGhpcy5vcHRpb25zLmNvbG9yJiYodGhpcy5jb2xvcj1oLmNvbG9yKTtyZXR1cm4gaH0sZGVzdHJveTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuc2VyaWVzLmNoYXJ0LGM9YS5ob3ZlclBvaW50cyxoO2EucG9pbnRDb3VudC0tO2MmJih0aGlzLnNldFN0YXRlKCksRShjLHRoaXMpLGMubGVuZ3RofHwNCihhLmhvdmVyUG9pbnRzPW51bGwpKTtpZih0aGlzPT09YS5ob3ZlclBvaW50KXRoaXMub25Nb3VzZU91dCgpO2lmKHRoaXMuZ3JhcGhpY3x8dGhpcy5kYXRhTGFiZWwpayh0aGlzKSx0aGlzLmRlc3Ryb3lFbGVtZW50cygpO3RoaXMubGVnZW5kSXRlbSYmYS5sZWdlbmQuZGVzdHJveUl0ZW0odGhpcyk7Zm9yKGggaW4gdGhpcyl0aGlzW2hdPW51bGx9LGRlc3Ryb3lFbGVtZW50czpmdW5jdGlvbigpe2Zvcih2YXIgYT1bImdyYXBoaWMiLCJkYXRhTGFiZWwiLCJkYXRhTGFiZWxVcHBlciIsImNvbm5lY3RvciIsInNoYWRvd0dyb3VwIl0sYyxrPTY7ay0tOyljPWFba10sdGhpc1tjXSYmKHRoaXNbY109dGhpc1tjXS5kZXN0cm95KCkpfSxnZXRMYWJlbENvbmZpZzpmdW5jdGlvbigpe3JldHVybnt4OnRoaXMuY2F0ZWdvcnkseTp0aGlzLnksY29sb3I6dGhpcy5jb2xvcixjb2xvckluZGV4OnRoaXMuY29sb3JJbmRleCxrZXk6dGhpcy5uYW1lfHx0aGlzLmNhdGVnb3J5LHNlcmllczp0aGlzLnNlcmllcywNCiAgICBwb2ludDp0aGlzLHBlcmNlbnRhZ2U6dGhpcy5wZXJjZW50YWdlLHRvdGFsOnRoaXMudG90YWx8fHRoaXMuc3RhY2tUb3RhbH19LHRvb2x0aXBGb3JtYXR0ZXI6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy5zZXJpZXMsZT1jLnRvb2x0aXBPcHRpb25zLGs9bChlLnZhbHVlRGVjaW1hbHMsIiIpLGI9ZS52YWx1ZVByZWZpeHx8IiIsbT1lLnZhbHVlU3VmZml4fHwiIjt6KGMucG9pbnRBcnJheU1hcHx8WyJ5Il0sZnVuY3Rpb24oYyl7Yz0ie3BvaW50LiIrYztpZihifHxtKWE9YS5yZXBsYWNlKGMrIn0iLGIrYysifSIrbSk7YT1hLnJlcGxhY2UoYysifSIsYysiOiwuIitrKyJmfSIpfSk7cmV0dXJuIGgoYSx7cG9pbnQ6dGhpcyxzZXJpZXM6dGhpcy5zZXJpZXN9KX0sZmlyZVBvaW50RXZlbnQ6ZnVuY3Rpb24oYSxjLGspe3ZhciBlPXRoaXMsYj10aGlzLnNlcmllcy5vcHRpb25zOyhiLnBvaW50LmV2ZW50c1thXXx8ZS5vcHRpb25zJiZlLm9wdGlvbnMuZXZlbnRzJiZlLm9wdGlvbnMuZXZlbnRzW2FdKSYmDQp0aGlzLmltcG9ydEV2ZW50cygpOyJjbGljayI9PT1hJiZiLmFsbG93UG9pbnRTZWxlY3QmJihrPWZ1bmN0aW9uKGEpe2Uuc2VsZWN0JiZlLnNlbGVjdChudWxsLGEuY3RybEtleXx8YS5tZXRhS2V5fHxhLnNoaWZ0S2V5KX0pO3UodGhpcyxhLGMsayl9LHZpc2libGU6ITB9fSkoSSk7KGZ1bmN0aW9uKGEpe3ZhciBCPWEuYWRkRXZlbnQsej1hLmFuaW1PYmplY3QsQz1hLmFycmF5TWF4LEU9YS5hcnJheU1pbix1PWEuY29ycmVjdEZsb2F0LGg9YS5EYXRlLG49YS5kZWZhdWx0T3B0aW9ucyx0PWEuZGVmYXVsdFBsb3RPcHRpb25zLGw9YS5kZWZpbmVkLGs9YS5lYWNoLGU9YS5lcmFzZSxjPWEuZXh0ZW5kLHA9YS5maXJlRXZlbnQsSD1hLmdyZXAsYj1hLmlzQXJyYXksbT1hLmlzTnVtYmVyLGQ9YS5pc1N0cmluZyxyPWEubWVyZ2UsQT1hLnBpY2ssdj1hLnJlbW92ZUV2ZW50LGY9YS5zcGxhdCx5PWEuU1ZHRWxlbWVudCxHPWEuc3luY1RpbWVvdXQsRj1hLndpbjthLlNlcmllcz1hLnNlcmllc1R5cGUoImxpbmUiLA0KICAgIG51bGwse2xpbmVXaWR0aDoyLGFsbG93UG9pbnRTZWxlY3Q6ITEsc2hvd0NoZWNrYm94OiExLGFuaW1hdGlvbjp7ZHVyYXRpb246MUUzfSxldmVudHM6e30sbWFya2VyOntsaW5lV2lkdGg6MCxsaW5lQ29sb3I6IiNmZmZmZmYiLHJhZGl1czo0LHN0YXRlczp7aG92ZXI6e2FuaW1hdGlvbjp7ZHVyYXRpb246NTB9LGVuYWJsZWQ6ITAscmFkaXVzUGx1czoyLGxpbmVXaWR0aFBsdXM6MX0sc2VsZWN0OntmaWxsQ29sb3I6IiNjY2NjY2MiLGxpbmVDb2xvcjoiIzAwMDAwMCIsbGluZVdpZHRoOjJ9fX0scG9pbnQ6e2V2ZW50czp7fX0sZGF0YUxhYmVsczp7YWxpZ246ImNlbnRlciIsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PT10aGlzLnk/IiI6YS5udW1iZXJGb3JtYXQodGhpcy55LC0xKX0sc3R5bGU6e2ZvbnRTaXplOiIxMXB4Iixmb250V2VpZ2h0OiJib2xkIixjb2xvcjoiY29udHJhc3QiLHRleHRPdXRsaW5lOiIxcHggY29udHJhc3QifSx2ZXJ0aWNhbEFsaWduOiJib3R0b20iLA0KICAgICAgICB4OjAseTowLHBhZGRpbmc6NX0sY3JvcFRocmVzaG9sZDozMDAscG9pbnRSYW5nZTowLHNvZnRUaHJlc2hvbGQ6ITAsc3RhdGVzOntob3Zlcjp7YW5pbWF0aW9uOntkdXJhdGlvbjo1MH0sbGluZVdpZHRoUGx1czoxLG1hcmtlcjp7fSxoYWxvOntzaXplOjEwLG9wYWNpdHk6LjI1fX0sc2VsZWN0OnttYXJrZXI6e319fSxzdGlja3lUcmFja2luZzohMCx0dXJib1RocmVzaG9sZDoxRTN9LHtpc0NhcnRlc2lhbjohMCxwb2ludENsYXNzOmEuUG9pbnQsc29ydGVkOiEwLHJlcXVpcmVTb3J0aW5nOiEwLGRpcmVjdFRvdWNoOiExLGF4aXNUeXBlczpbInhBeGlzIiwieUF4aXMiXSxjb2xvckNvdW50ZXI6MCxwYXJhbGxlbEFycmF5czpbIngiLCJ5Il0sY29sbDoic2VyaWVzIixpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGQ9dGhpcyxmLGUsZz1hLnNlcmllcyxxO2QuY2hhcnQ9YTtkLm9wdGlvbnM9Yj1kLnNldE9wdGlvbnMoYik7ZC5saW5rZWRTZXJpZXM9W107ZC5iaW5kQXhlcygpO2MoZCx7bmFtZTpiLm5hbWUsDQogICAgICAgIHN0YXRlOiIiLHZpc2libGU6ITEhPT1iLnZpc2libGUsc2VsZWN0ZWQ6ITA9PT1iLnNlbGVjdGVkfSk7ZT1iLmV2ZW50cztmb3IoZiBpbiBlKUIoZCxmLGVbZl0pO2lmKGUmJmUuY2xpY2t8fGIucG9pbnQmJmIucG9pbnQuZXZlbnRzJiZiLnBvaW50LmV2ZW50cy5jbGlja3x8Yi5hbGxvd1BvaW50U2VsZWN0KWEucnVuVHJhY2tlckNsaWNrPSEwO2QuZ2V0Q29sb3IoKTtkLmdldFN5bWJvbCgpO2soZC5wYXJhbGxlbEFycmF5cyxmdW5jdGlvbihhKXtkW2ErIkRhdGEiXT1bXX0pO2Quc2V0RGF0YShiLmRhdGEsITEpO2QuaXNDYXJ0ZXNpYW4mJihhLmhhc0NhcnRlc2lhblNlcmllcz0hMCk7Zy5sZW5ndGgmJihxPWdbZy5sZW5ndGgtMV0pO2QuX2k9QShxJiZxLl9pLC0xKSsxO2Eub3JkZXJTZXJpZXModGhpcy5pbnNlcnQoZykpfSxpbnNlcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLmluZGV4LGM7aWYobShiKSl7Zm9yKGM9YS5sZW5ndGg7Yy0tOylpZihiPj1BKGFbY10ub3B0aW9ucy5pbmRleCwNCiAgICAgICAgICAgIGFbY10uX2kpKXthLnNwbGljZShjKzEsMCx0aGlzKTticmVha30tMT09PWMmJmEudW5zaGlmdCh0aGlzKTtjKz0xfWVsc2UgYS5wdXNoKHRoaXMpO3JldHVybiBBKGMsYS5sZW5ndGgtMSl9LGJpbmRBeGVzOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcyxjPWIub3B0aW9ucyxkPWIuY2hhcnQsZjtrKGIuYXhpc1R5cGVzfHxbXSxmdW5jdGlvbihlKXtrKGRbZV0sZnVuY3Rpb24oYSl7Zj1hLm9wdGlvbnM7aWYoY1tlXT09PWYuaW5kZXh8fHZvaWQgMCE9PWNbZV0mJmNbZV09PT1mLmlkfHx2b2lkIDA9PT1jW2VdJiYwPT09Zi5pbmRleCliLmluc2VydChhLnNlcmllcyksYltlXT1hLGEuaXNEaXJ0eT0hMH0pO2JbZV18fGIub3B0aW9uYWxBeGlzPT09ZXx8YS5lcnJvcigxOCwhMCl9KX0sdXBkYXRlUGFyYWxsZWxBcnJheXM6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLnNlcmllcyxkPWFyZ3VtZW50cyxmPW0oYik/ZnVuY3Rpb24oZCl7dmFyIGY9InkiPT09ZCYmYy50b1lEYXRhP2MudG9ZRGF0YShhKToNCiAgICAgICAgICAgIGFbZF07Y1tkKyJEYXRhIl1bYl09Zn06ZnVuY3Rpb24oYSl7QXJyYXkucHJvdG90eXBlW2JdLmFwcGx5KGNbYSsiRGF0YSJdLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGQsMikpfTtrKGMucGFyYWxsZWxBcnJheXMsZil9LGF1dG9JbmNyZW1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9wdGlvbnMsYj10aGlzLnhJbmNyZW1lbnQsYyxkPWEucG9pbnRJbnRlcnZhbFVuaXQsYj1BKGIsYS5wb2ludFN0YXJ0LDApO3RoaXMucG9pbnRJbnRlcnZhbD1jPUEodGhpcy5wb2ludEludGVydmFsLGEucG9pbnRJbnRlcnZhbCwxKTtkJiYoYT1uZXcgaChiKSwiZGF5Ij09PWQ/YT0rYVtoLmhjU2V0RGF0ZV0oYVtoLmhjR2V0RGF0ZV0oKStjKToibW9udGgiPT09ZD9hPSthW2guaGNTZXRNb250aF0oYVtoLmhjR2V0TW9udGhdKCkrYyk6InllYXIiPT09ZCYmKGE9K2FbaC5oY1NldEZ1bGxZZWFyXShhW2guaGNHZXRGdWxsWWVhcl0oKStjKSksYz1hLWIpO3RoaXMueEluY3JlbWVudD1iK2M7cmV0dXJuIGJ9LA0KICAgICAgICBzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz1iLm9wdGlvbnMucGxvdE9wdGlvbnMsYj1iLnVzZXJPcHRpb25zfHx7fSxkPWIucGxvdE9wdGlvbnN8fHt9LGY9Y1t0aGlzLnR5cGVdO3RoaXMudXNlck9wdGlvbnM9YTtjPXIoZixjLnNlcmllcyxhKTt0aGlzLnRvb2x0aXBPcHRpb25zPXIobi50b29sdGlwLG4ucGxvdE9wdGlvbnNbdGhpcy50eXBlXS50b29sdGlwLGIudG9vbHRpcCxkLnNlcmllcyYmZC5zZXJpZXMudG9vbHRpcCxkW3RoaXMudHlwZV0mJmRbdGhpcy50eXBlXS50b29sdGlwLGEudG9vbHRpcCk7bnVsbD09PWYubWFya2VyJiZkZWxldGUgYy5tYXJrZXI7dGhpcy56b25lQXhpcz1jLnpvbmVBeGlzO2E9dGhpcy56b25lcz0oYy56b25lc3x8W10pLnNsaWNlKCk7IWMubmVnYXRpdmVDb2xvciYmIWMubmVnYXRpdmVGaWxsQ29sb3J8fGMuem9uZXN8fGEucHVzaCh7dmFsdWU6Y1t0aGlzLnpvbmVBeGlzKyJUaHJlc2hvbGQiXXx8Yy50aHJlc2hvbGR8fA0KICAgICAgICAwLGNsYXNzTmFtZToiaGlnaGNoYXJ0cy1uZWdhdGl2ZSIsY29sb3I6Yy5uZWdhdGl2ZUNvbG9yLGZpbGxDb2xvcjpjLm5lZ2F0aXZlRmlsbENvbG9yfSk7YS5sZW5ndGgmJmwoYVthLmxlbmd0aC0xXS52YWx1ZSkmJmEucHVzaCh7Y29sb3I6dGhpcy5jb2xvcixmaWxsQ29sb3I6dGhpcy5maWxsQ29sb3J9KTtyZXR1cm4gY30sZ2V0Q3ljbGljOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxmPXRoaXMuY2hhcnQsZz10aGlzLnVzZXJPcHRpb25zLGU9YSsiSW5kZXgiLHE9YSsiQ291bnRlciIsaz1jP2MubGVuZ3RoOkEoZi5vcHRpb25zLmNoYXJ0W2ErIkNvdW50Il0sZlthKyJDb3VudCJdKTtifHwoZD1BKGdbZV0sZ1siXyIrZV0pLGwoZCl8fChmLnNlcmllcy5sZW5ndGh8fChmW3FdPTApLGdbIl8iK2VdPWQ9ZltxXSVrLGZbcV0rPTEpLGMmJihiPWNbZF0pKTt2b2lkIDAhPT1kJiYodGhpc1tlXT1kKTt0aGlzW2FdPWJ9LGdldENvbG9yOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmNvbG9yQnlQb2ludD8NCiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jb2xvcj1udWxsOnRoaXMuZ2V0Q3ljbGljKCJjb2xvciIsdGhpcy5vcHRpb25zLmNvbG9yfHx0W3RoaXMudHlwZV0uY29sb3IsdGhpcy5jaGFydC5vcHRpb25zLmNvbG9ycyl9LGdldFN5bWJvbDpmdW5jdGlvbigpe3RoaXMuZ2V0Q3ljbGljKCJzeW1ib2wiLHRoaXMub3B0aW9ucy5tYXJrZXIuc3ltYm9sLHRoaXMuY2hhcnQub3B0aW9ucy5zeW1ib2xzKX0sZHJhd0xlZ2VuZFN5bWJvbDphLkxlZ2VuZFN5bWJvbE1peGluLmRyYXdMaW5lTWFya2VyLHNldERhdGE6ZnVuY3Rpb24oYyxmLGUsaCl7dmFyIHE9dGhpcyxnPXEucG9pbnRzLHA9ZyYmZy5sZW5ndGh8fDAsbCx4PXEub3B0aW9ucyxyPXEuY2hhcnQsbj1udWxsLHY9cS54QXhpcyx0PXgudHVyYm9UaHJlc2hvbGQseT10aGlzLnhEYXRhLHU9dGhpcy55RGF0YSxHPShsPXEucG9pbnRBcnJheU1hcCkmJmwubGVuZ3RoO2M9Y3x8W107bD1jLmxlbmd0aDtmPUEoZiwhMCk7aWYoITEhPT1oJiZsJiZwPT09bCYmIXEuY3JvcHBlZCYmDQogICAgICAgICAgICAhcS5oYXNHcm91cGVkRGF0YSYmcS52aXNpYmxlKWsoYyxmdW5jdGlvbihhLGIpe2dbYl0udXBkYXRlJiZhIT09eC5kYXRhW2JdJiZnW2JdLnVwZGF0ZShhLCExLG51bGwsITEpfSk7ZWxzZXtxLnhJbmNyZW1lbnQ9bnVsbDtxLmNvbG9yQ291bnRlcj0wO2sodGhpcy5wYXJhbGxlbEFycmF5cyxmdW5jdGlvbihhKXtxW2ErIkRhdGEiXS5sZW5ndGg9MH0pO2lmKHQmJmw+dCl7Zm9yKGU9MDtudWxsPT09biYmZTxsOyluPWNbZV0sZSsrO2lmKG0obikpZm9yKGU9MDtlPGw7ZSsrKXlbZV09dGhpcy5hdXRvSW5jcmVtZW50KCksdVtlXT1jW2VdO2Vsc2UgaWYoYihuKSlpZihHKWZvcihlPTA7ZTxsO2UrKyluPWNbZV0seVtlXT1uWzBdLHVbZV09bi5zbGljZSgxLEcrMSk7ZWxzZSBmb3IoZT0wO2U8bDtlKyspbj1jW2VdLHlbZV09blswXSx1W2VdPW5bMV07ZWxzZSBhLmVycm9yKDEyKX1lbHNlIGZvcihlPTA7ZTxsO2UrKyl2b2lkIDAhPT1jW2VdJiYobj17c2VyaWVzOnF9LHEucG9pbnRDbGFzcy5wcm90b3R5cGUuYXBwbHlPcHRpb25zLmFwcGx5KG4sDQogICAgICAgICAgICBbY1tlXV0pLHEudXBkYXRlUGFyYWxsZWxBcnJheXMobixlKSk7ZCh1WzBdKSYmYS5lcnJvcigxNCwhMCk7cS5kYXRhPVtdO3Eub3B0aW9ucy5kYXRhPXEudXNlck9wdGlvbnMuZGF0YT1jO2ZvcihlPXA7ZS0tOylnW2VdJiZnW2VdLmRlc3Ryb3kmJmdbZV0uZGVzdHJveSgpO3YmJih2Lm1pblJhbmdlPXYudXNlck1pblJhbmdlKTtxLmlzRGlydHk9ci5pc0RpcnR5Qm94PSEwO3EuaXNEaXJ0eURhdGE9ISFnO2U9ITF9InBvaW50Ij09PXgubGVnZW5kVHlwZSYmKHRoaXMucHJvY2Vzc0RhdGEoKSx0aGlzLmdlbmVyYXRlUG9pbnRzKCkpO2YmJnIucmVkcmF3KGUpfSxwcm9jZXNzRGF0YTpmdW5jdGlvbihiKXt2YXIgYz10aGlzLnhEYXRhLGQ9dGhpcy55RGF0YSxmPWMubGVuZ3RoLGU7ZT0wO3ZhciBnLHEsaz10aGlzLnhBeGlzLG0saD10aGlzLm9wdGlvbnM7bT1oLmNyb3BUaHJlc2hvbGQ7dmFyIGw9dGhpcy5nZXRFeHRyZW1lc0Zyb21BbGx8fGguZ2V0RXh0cmVtZXNGcm9tQWxsLHA9dGhpcy5pc0NhcnRlc2lhbiwNCiAgICAgICAgICAgIGg9ayYmay52YWwybGluLG49ayYmay5pc0xvZyxyLHY7aWYocCYmIXRoaXMuaXNEaXJ0eSYmIWsuaXNEaXJ0eSYmIXRoaXMueUF4aXMuaXNEaXJ0eSYmIWIpcmV0dXJuITE7ayYmKGI9ay5nZXRFeHRyZW1lcygpLHI9Yi5taW4sdj1iLm1heCk7aWYocCYmdGhpcy5zb3J0ZWQmJiFsJiYoIW18fGY+bXx8dGhpcy5mb3JjZUNyb3ApKWlmKGNbZi0xXTxyfHxjWzBdPnYpYz1bXSxkPVtdO2Vsc2UgaWYoY1swXTxyfHxjW2YtMV0+dillPXRoaXMuY3JvcERhdGEodGhpcy54RGF0YSx0aGlzLnlEYXRhLHIsdiksYz1lLnhEYXRhLGQ9ZS55RGF0YSxlPWUuc3RhcnQsZz0hMDtmb3IobT1jLmxlbmd0aHx8MTstLW07KWY9bj9oKGNbbV0pLWgoY1ttLTFdKTpjW21dLWNbbS0xXSwwPGYmJih2b2lkIDA9PT1xfHxmPHEpP3E9ZjowPmYmJnRoaXMucmVxdWlyZVNvcnRpbmcmJmEuZXJyb3IoMTUpO3RoaXMuY3JvcHBlZD1nO3RoaXMuY3JvcFN0YXJ0PWU7dGhpcy5wcm9jZXNzZWRYRGF0YT1jO3RoaXMucHJvY2Vzc2VkWURhdGE9DQogICAgICAgICAgICBkO3RoaXMuY2xvc2VzdFBvaW50UmFuZ2U9cX0sY3JvcERhdGE6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGY9YS5sZW5ndGgsZz0wLGU9ZixxPUEodGhpcy5jcm9wU2hvdWxkZXIsMSksaztmb3Ioaz0wO2s8ZjtrKyspaWYoYVtrXT49Yyl7Zz1NYXRoLm1heCgwLGstcSk7YnJlYWt9Zm9yKGM9aztjPGY7YysrKWlmKGFbY10+ZCl7ZT1jK3E7YnJlYWt9cmV0dXJue3hEYXRhOmEuc2xpY2UoZyxlKSx5RGF0YTpiLnNsaWNlKGcsZSksc3RhcnQ6ZyxlbmQ6ZX19LGdlbmVyYXRlUG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLmRhdGEsYj10aGlzLmRhdGEsYyxkPXRoaXMucHJvY2Vzc2VkWERhdGEsZT10aGlzLnByb2Nlc3NlZFlEYXRhLGc9dGhpcy5wb2ludENsYXNzLGs9ZC5sZW5ndGgsbT10aGlzLmNyb3BTdGFydHx8MCxoLGw9dGhpcy5oYXNHcm91cGVkRGF0YSxwLG49W10scjtifHxsfHwoYj1bXSxiLmxlbmd0aD1hLmxlbmd0aCxiPXRoaXMuZGF0YT1iKTtmb3Iocj0wO3I8DQogICAgICAgIGs7cisrKWg9bStyLGw/KHA9KG5ldyBnKS5pbml0KHRoaXMsW2Rbcl1dLmNvbmNhdChmKGVbcl0pKSkscC5kYXRhR3JvdXA9dGhpcy5ncm91cE1hcFtyXSk6KHA9YltoXSl8fHZvaWQgMD09PWFbaF18fChiW2hdPXA9KG5ldyBnKS5pbml0KHRoaXMsYVtoXSxkW3JdKSkscC5pbmRleD1oLG5bcl09cDtpZihiJiYoayE9PShjPWIubGVuZ3RoKXx8bCkpZm9yKHI9MDtyPGM7cisrKXIhPT1tfHxsfHwocis9ayksYltyXSYmKGJbcl0uZGVzdHJveUVsZW1lbnRzKCksYltyXS5wbG90WD12b2lkIDApO3RoaXMuZGF0YT1iO3RoaXMucG9pbnRzPW59LGdldEV4dHJlbWVzOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMueUF4aXMsZD10aGlzLnByb2Nlc3NlZFhEYXRhLGYsZT1bXSxnPTA7Zj10aGlzLnhBeGlzLmdldEV4dHJlbWVzKCk7dmFyIHE9Zi5taW4saz1mLm1heCxoLGwscCxyO2E9YXx8dGhpcy5zdGFja2VkWURhdGF8fHRoaXMucHJvY2Vzc2VkWURhdGF8fFtdO2Y9YS5sZW5ndGg7Zm9yKHI9MDtyPA0KICAgICAgICBmO3IrKylpZihsPWRbcl0scD1hW3JdLGg9KG0ocCwhMCl8fGIocCkpJiYoIWMucG9zaXRpdmVWYWx1ZXNPbmx5fHxwLmxlbmd0aHx8MDxwKSxsPXRoaXMuZ2V0RXh0cmVtZXNGcm9tQWxsfHx0aGlzLm9wdGlvbnMuZ2V0RXh0cmVtZXNGcm9tQWxsfHx0aGlzLmNyb3BwZWR8fChkW3IrMV18fGwpPj1xJiYoZFtyLTFdfHxsKTw9ayxoJiZsKWlmKGg9cC5sZW5ndGgpZm9yKDtoLS07KW51bGwhPT1wW2hdJiYoZVtnKytdPXBbaF0pO2Vsc2UgZVtnKytdPXA7dGhpcy5kYXRhTWluPUUoZSk7dGhpcy5kYXRhTWF4PUMoZSl9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3RoaXMucHJvY2Vzc2VkWERhdGF8fHRoaXMucHJvY2Vzc0RhdGEoKTt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7dmFyIGE9dGhpcy5vcHRpb25zLGI9YS5zdGFja2luZyxjPXRoaXMueEF4aXMsZD1jLmNhdGVnb3JpZXMsZj10aGlzLnlBeGlzLGU9dGhpcy5wb2ludHMsaz1lLmxlbmd0aCxoPSEhdGhpcy5tb2RpZnlWYWx1ZSxwPWEucG9pbnRQbGFjZW1lbnQsDQogICAgICAgICAgICByPSJiZXR3ZWVuIj09PXB8fG0ocCksbj1hLnRocmVzaG9sZCx2PWEuc3RhcnRGcm9tVGhyZXNob2xkP246MCx0LHksRyxGLEg9TnVtYmVyLk1BWF9WQUxVRTsiYmV0d2VlbiI9PT1wJiYocD0uNSk7bShwKSYmKHAqPUEoYS5wb2ludFJhbmdlfHxjLnBvaW50UmFuZ2UpKTtmb3IoYT0wO2E8azthKyspe3ZhciB6PWVbYV0sQj16LngsQz16Lnk7eT16Lmxvdzt2YXIgRT1iJiZmLnN0YWNrc1sodGhpcy5uZWdTdGFja3MmJkM8KHY/MDpuKT8iLSI6IiIpK3RoaXMuc3RhY2tLZXldLEk7Zi5wb3NpdGl2ZVZhbHVlc09ubHkmJm51bGwhPT1DJiYwPj1DJiYoei5pc051bGw9ITApO3oucGxvdFg9dD11KE1hdGgubWluKE1hdGgubWF4KC0xRTUsYy50cmFuc2xhdGUoQiwwLDAsMCwxLHAsImZsYWdzIj09PXRoaXMudHlwZSkpLDFFNSkpO2ImJnRoaXMudmlzaWJsZSYmIXouaXNOdWxsJiZFJiZFW0JdJiYoRj10aGlzLmdldFN0YWNrSW5kaWNhdG9yKEYsQix0aGlzLmluZGV4KSxJPUVbQl0sQz1JLnBvaW50c1tGLmtleV0sDQogICAgICAgICAgICB5PUNbMF0sQz1DWzFdLHk9PT12JiZGLmtleT09PUVbQl0uYmFzZSYmKHk9QShuLGYubWluKSksZi5wb3NpdGl2ZVZhbHVlc09ubHkmJjA+PXkmJih5PW51bGwpLHoudG90YWw9ei5zdGFja1RvdGFsPUkudG90YWwsei5wZXJjZW50YWdlPUkudG90YWwmJnoueS9JLnRvdGFsKjEwMCx6LnN0YWNrWT1DLEkuc2V0T2Zmc2V0KHRoaXMucG9pbnRYT2Zmc2V0fHwwLHRoaXMuYmFyV3x8MCkpO3oueUJvdHRvbT1sKHkpP2YudHJhbnNsYXRlKHksMCwxLDAsMSk6bnVsbDtoJiYoQz10aGlzLm1vZGlmeVZhbHVlKEMseikpO3oucGxvdFk9eT0ibnVtYmVyIj09PXR5cGVvZiBDJiZJbmZpbml0eSE9PUM/TWF0aC5taW4oTWF0aC5tYXgoLTFFNSxmLnRyYW5zbGF0ZShDLDAsMSwwLDEpKSwxRTUpOnZvaWQgMDt6LmlzSW5zaWRlPXZvaWQgMCE9PXkmJjA8PXkmJnk8PWYubGVuJiYwPD10JiZ0PD1jLmxlbjt6LmNsaWVudFg9cj91KGMudHJhbnNsYXRlKEIsMCwwLDAsMSxwKSk6dDt6Lm5lZ2F0aXZlPXoueTwNCiAgICAgICAgICAgIChufHwwKTt6LmNhdGVnb3J5PWQmJnZvaWQgMCE9PWRbei54XT9kW3oueF06ei54O3ouaXNOdWxsfHwodm9pZCAwIT09RyYmKEg9TWF0aC5taW4oSCxNYXRoLmFicyh0LUcpKSksRz10KTt6LnpvbmU9dGhpcy56b25lcy5sZW5ndGgmJnouZ2V0Wm9uZSgpfXRoaXMuY2xvc2VzdFBvaW50UmFuZ2VQeD1IfSxnZXRWYWxpZFBvaW50czpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY2hhcnQ7cmV0dXJuIEgoYXx8dGhpcy5wb2ludHN8fFtdLGZ1bmN0aW9uKGEpe3JldHVybiBiJiYhYy5pc0luc2lkZVBsb3QoYS5wbG90WCxhLnBsb3RZLGMuaW52ZXJ0ZWQpPyExOiFhLmlzTnVsbH0pfSxzZXRDbGlwOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2hhcnQsYz10aGlzLm9wdGlvbnMsZD1iLnJlbmRlcmVyLGY9Yi5pbnZlcnRlZCxlPXRoaXMuY2xpcEJveCxxPWV8fGIuY2xpcEJveCxrPXRoaXMuc2hhcmVkQ2xpcEtleXx8WyJfc2hhcmVkQ2xpcCIsYSYmYS5kdXJhdGlvbixhJiZhLmVhc2luZyxxLmhlaWdodCwNCiAgICAgICAgICAgICAgICBjLnhBeGlzLGMueUF4aXNdLmpvaW4oKSxtPWJba10saD1iW2srIm0iXTttfHwoYSYmKHEud2lkdGg9MCxiW2srIm0iXT1oPWQuY2xpcFJlY3QoLTk5LGY/LWIucGxvdExlZnQ6LWIucGxvdFRvcCw5OSxmP2IuY2hhcnRXaWR0aDpiLmNoYXJ0SGVpZ2h0KSksYltrXT1tPWQuY2xpcFJlY3QocSksbS5jb3VudD17bGVuZ3RoOjB9KTthJiYhbS5jb3VudFt0aGlzLmluZGV4XSYmKG0uY291bnRbdGhpcy5pbmRleF09ITAsbS5jb3VudC5sZW5ndGgrPTEpOyExIT09Yy5jbGlwJiYodGhpcy5ncm91cC5jbGlwKGF8fGU/bTpiLmNsaXBSZWN0KSx0aGlzLm1hcmtlckdyb3VwLmNsaXAoaCksdGhpcy5zaGFyZWRDbGlwS2V5PWspO2F8fChtLmNvdW50W3RoaXMuaW5kZXhdJiYoZGVsZXRlIG0uY291bnRbdGhpcy5pbmRleF0sLS1tLmNvdW50Lmxlbmd0aCksMD09PW0uY291bnQubGVuZ3RoJiZrJiZiW2tdJiYoZXx8KGJba109YltrXS5kZXN0cm95KCkpLGJbaysibSJdJiYodGhpcy5tYXJrZXJHcm91cC5jbGlwKCksDQogICAgICAgICAgICBiW2srIm0iXT1iW2srIm0iXS5kZXN0cm95KCkpKSl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydCxjPXoodGhpcy5vcHRpb25zLmFuaW1hdGlvbiksZDthP3RoaXMuc2V0Q2xpcChjKTooZD10aGlzLnNoYXJlZENsaXBLZXksKGE9YltkXSkmJmEuYW5pbWF0ZSh7d2lkdGg6Yi5wbG90U2l6ZVh9LGMpLGJbZCsibSJdJiZiW2QrIm0iXS5hbmltYXRlKHt3aWR0aDpiLnBsb3RTaXplWCs5OX0sYyksdGhpcy5hbmltYXRlPW51bGwpfSxhZnRlckFuaW1hdGU6ZnVuY3Rpb24oKXt0aGlzLnNldENsaXAoKTtwKHRoaXMsImFmdGVyQW5pbWF0ZSIpfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb2ludHMsYj10aGlzLmNoYXJ0LGMsZCxmLGUsaz10aGlzLm9wdGlvbnMubWFya2VyLGgscCxsLHIsbj10aGlzLm1hcmtlckdyb3VwLHY9QShrLmVuYWJsZWQsdGhpcy54QXhpcy5pc1JhZGlhbD8hMDpudWxsLHRoaXMuY2xvc2VzdFBvaW50UmFuZ2VQeD49MiprLnJhZGl1cyk7DQogICAgICAgICAgICBpZighMSE9PWsuZW5hYmxlZHx8dGhpcy5faGFzUG9pbnRNYXJrZXJzKWZvcihkPTA7ZDxhLmxlbmd0aDtkKyspZj1hW2RdLGM9Zi5wbG90WSxlPWYuZ3JhcGhpYyxoPWYubWFya2VyfHx7fSxwPSEhZi5tYXJrZXIsbD12JiZ2b2lkIDA9PT1oLmVuYWJsZWR8fGguZW5hYmxlZCxyPWYuaXNJbnNpZGUsbCYmbShjKSYmbnVsbCE9PWYueT8oYz1BKGguc3ltYm9sLHRoaXMuc3ltYm9sKSxmLmhhc0ltYWdlPTA9PT1jLmluZGV4T2YoInVybCIpLGw9dGhpcy5tYXJrZXJBdHRyaWJzKGYsZi5zZWxlY3RlZCYmInNlbGVjdCIpLGU/ZVtyPyJzaG93IjoiaGlkZSJdKCEwKS5hbmltYXRlKGwpOnImJigwPGwud2lkdGh8fGYuaGFzSW1hZ2UpJiYoZi5ncmFwaGljPWU9Yi5yZW5kZXJlci5zeW1ib2woYyxsLngsbC55LGwud2lkdGgsbC5oZWlnaHQscD9oOmspLmFkZChuKSksZSYmZS5hdHRyKHRoaXMucG9pbnRBdHRyaWJzKGYsZi5zZWxlY3RlZCYmInNlbGVjdCIpKSxlJiZlLmFkZENsYXNzKGYuZ2V0Q2xhc3NOYW1lKCksDQogICAgICAgICAgICAgICAgICAgICEwKSk6ZSYmKGYuZ3JhcGhpYz1lLmRlc3Ryb3koKSl9LG1hcmtlckF0dHJpYnM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm9wdGlvbnMubWFya2VyLGQ9YS5tYXJrZXJ8fHt9LGY9QShkLnJhZGl1cyxjLnJhZGl1cyk7YiYmKGM9Yy5zdGF0ZXNbYl0sYj1kLnN0YXRlcyYmZC5zdGF0ZXNbYl0sZj1BKGImJmIucmFkaXVzLGMmJmMucmFkaXVzLGYrKGMmJmMucmFkaXVzUGx1c3x8MCkpKTthLmhhc0ltYWdlJiYoZj0wKTthPXt4Ok1hdGguZmxvb3IoYS5wbG90WCktZix5OmEucGxvdFktZn07ZiYmKGEud2lkdGg9YS5oZWlnaHQ9MipmKTtyZXR1cm4gYX0scG9pbnRBdHRyaWJzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5vcHRpb25zLm1hcmtlcixkPWEmJmEub3B0aW9ucyxmPWQmJmQubWFya2VyfHx7fSxlPXRoaXMuY29sb3IscT1kJiZkLmNvbG9yLGs9YSYmYS5jb2xvcixkPUEoZi5saW5lV2lkdGgsYy5saW5lV2lkdGgpO2E9YSYmYS56b25lJiZhLnpvbmUuY29sb3I7ZT1xfHxhfHwNCiAgICAgICAgICAgIGt8fGU7YT1mLmZpbGxDb2xvcnx8Yy5maWxsQ29sb3J8fGU7ZT1mLmxpbmVDb2xvcnx8Yy5saW5lQ29sb3J8fGU7YiYmKGM9Yy5zdGF0ZXNbYl0sYj1mLnN0YXRlcyYmZi5zdGF0ZXNbYl18fHt9LGQ9QShiLmxpbmVXaWR0aCxjLmxpbmVXaWR0aCxkK0EoYi5saW5lV2lkdGhQbHVzLGMubGluZVdpZHRoUGx1cywwKSksYT1iLmZpbGxDb2xvcnx8Yy5maWxsQ29sb3J8fGEsZT1iLmxpbmVDb2xvcnx8Yy5saW5lQ29sb3J8fGUpO3JldHVybntzdHJva2U6ZSwic3Ryb2tlLXdpZHRoIjpkLGZpbGw6YX19LGRlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydCxjPS9BcHBsZVdlYktpdFwvNTMzLy50ZXN0KEYubmF2aWdhdG9yLnVzZXJBZ2VudCksZCxmPWEuZGF0YXx8W10sZyxtLGg7cChhLCJkZXN0cm95Iik7dihhKTtrKGEuYXhpc1R5cGVzfHxbXSxmdW5jdGlvbihiKXsoaD1hW2JdKSYmaC5zZXJpZXMmJihlKGguc2VyaWVzLGEpLGguaXNEaXJ0eT1oLmZvcmNlUmVkcmF3PQ0KICAgICAgICAgICAgITApfSk7YS5sZWdlbmRJdGVtJiZhLmNoYXJ0LmxlZ2VuZC5kZXN0cm95SXRlbShhKTtmb3IoZD1mLmxlbmd0aDtkLS07KShnPWZbZF0pJiZnLmRlc3Ryb3kmJmcuZGVzdHJveSgpO2EucG9pbnRzPW51bGw7Y2xlYXJUaW1lb3V0KGEuYW5pbWF0aW9uVGltZW91dCk7Zm9yKG0gaW4gYSlhW21daW5zdGFuY2VvZiB5JiYhYVttXS5zdXJ2aXZlJiYoZD1jJiYiZ3JvdXAiPT09bT8iaGlkZSI6ImRlc3Ryb3kiLGFbbV1bZF0oKSk7Yi5ob3ZlclNlcmllcz09PWEmJihiLmhvdmVyU2VyaWVzPW51bGwpO2UoYi5zZXJpZXMsYSk7Yi5vcmRlclNlcmllcygpO2ZvcihtIGluIGEpZGVsZXRlIGFbbV19LGdldEdyYXBoUGF0aDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxmPWQub3B0aW9ucyxlPWYuc3RlcCxxLG09W10saD1bXSxwO2E9YXx8ZC5wb2ludHM7KHE9YS5yZXZlcnNlZCkmJmEucmV2ZXJzZSgpOyhlPXtyaWdodDoxLGNlbnRlcjoyfVtlXXx8ZSYmMykmJnEmJihlPTQtZSk7IWYuY29ubmVjdE51bGxzfHwNCiAgICAgICAgYnx8Y3x8KGE9dGhpcy5nZXRWYWxpZFBvaW50cyhhKSk7ayhhLGZ1bmN0aW9uKGcsayl7dmFyIHE9Zy5wbG90WCxyPWcucGxvdFksbj1hW2stMV07KGcubGVmdENsaWZmfHxuJiZuLnJpZ2h0Q2xpZmYpJiYhYyYmKHA9ITApO2cuaXNOdWxsJiYhbChiKSYmMDxrP3A9IWYuY29ubmVjdE51bGxzOmcuaXNOdWxsJiYhYj9wPSEwOigwPT09a3x8cD9rPVsiTSIsZy5wbG90WCxnLnBsb3RZXTpkLmdldFBvaW50U3BsaW5lP2s9ZC5nZXRQb2ludFNwbGluZShhLGcsayk6ZT8oaz0xPT09ZT9bIkwiLG4ucGxvdFgscl06Mj09PWU/WyJMIiwobi5wbG90WCtxKS8yLG4ucGxvdFksIkwiLChuLnBsb3RYK3EpLzIscl06WyJMIixxLG4ucGxvdFldLGsucHVzaCgiTCIscSxyKSk6az1bIkwiLHEscl0saC5wdXNoKGcueCksZSYmaC5wdXNoKGcueCksbS5wdXNoLmFwcGx5KG0saykscD0hMSl9KTttLnhNYXA9aDtyZXR1cm4gZC5ncmFwaFBhdGg9bX0sZHJhd0dyYXBoOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcywNCiAgICAgICAgICAgIGI9dGhpcy5vcHRpb25zLGM9KHRoaXMuZ2FwcGVkUGF0aHx8dGhpcy5nZXRHcmFwaFBhdGgpLmNhbGwodGhpcyksZD1bWyJncmFwaCIsImhpZ2hjaGFydHMtZ3JhcGgiLGIubGluZUNvbG9yfHx0aGlzLmNvbG9yLGIuZGFzaFN0eWxlXV07ayh0aGlzLnpvbmVzLGZ1bmN0aW9uKGMsZil7ZC5wdXNoKFsiem9uZS1ncmFwaC0iK2YsImhpZ2hjaGFydHMtZ3JhcGggaGlnaGNoYXJ0cy16b25lLWdyYXBoLSIrZisiICIrKGMuY2xhc3NOYW1lfHwiIiksYy5jb2xvcnx8YS5jb2xvcixjLmRhc2hTdHlsZXx8Yi5kYXNoU3R5bGVdKX0pO2soZCxmdW5jdGlvbihkLGYpe3ZhciBlPWRbMF0sZz1hW2VdO2c/KGcuZW5kWD1jLnhNYXAsZy5hbmltYXRlKHtkOmN9KSk6Yy5sZW5ndGgmJihhW2VdPWEuY2hhcnQucmVuZGVyZXIucGF0aChjKS5hZGRDbGFzcyhkWzFdKS5hdHRyKHt6SW5kZXg6MX0pLmFkZChhLmdyb3VwKSxnPXtzdHJva2U6ZFsyXSwic3Ryb2tlLXdpZHRoIjpiLmxpbmVXaWR0aCxmaWxsOmEuZmlsbEdyYXBoJiYNCiAgICAgICAgICAgIGEuY29sb3J8fCJub25lIn0sZFszXT9nLmRhc2hzdHlsZT1kWzNdOiJzcXVhcmUiIT09Yi5saW5lY2FwJiYoZ1sic3Ryb2tlLWxpbmVjYXAiXT1nWyJzdHJva2UtbGluZWpvaW4iXT0icm91bmQiKSxnPWFbZV0uYXR0cihnKS5zaGFkb3coMj5mJiZiLnNoYWRvdykpO2cmJihnLnN0YXJ0WD1jLnhNYXAsZy5pc0FyZWE9Yy5pc0FyZWEpfSl9LGFwcGx5Wm9uZXM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dGhpcy5jaGFydCxjPWIucmVuZGVyZXIsZD10aGlzLnpvbmVzLGYsZSxtPXRoaXMuY2xpcHN8fFtdLGgscD10aGlzLmdyYXBoLGw9dGhpcy5hcmVhLHI9TWF0aC5tYXgoYi5jaGFydFdpZHRoLGIuY2hhcnRIZWlnaHQpLG49dGhpc1sodGhpcy56b25lQXhpc3x8InkiKSsiQXhpcyJdLHYsdCx5PWIuaW52ZXJ0ZWQsdSxHLEYsSCx6PSExO2QubGVuZ3RoJiYocHx8bCkmJm4mJnZvaWQgMCE9PW4ubWluJiYodD1uLnJldmVyc2VkLHU9bi5ob3JpeixwJiZwLmhpZGUoKSxsJiZsLmhpZGUoKSwNCiAgICAgICAgICAgIHY9bi5nZXRFeHRyZW1lcygpLGsoZCxmdW5jdGlvbihkLGcpe2Y9dD91P2IucGxvdFdpZHRoOjA6dT8wOm4udG9QaXhlbHModi5taW4pO2Y9TWF0aC5taW4oTWF0aC5tYXgoQShlLGYpLDApLHIpO2U9TWF0aC5taW4oTWF0aC5tYXgoTWF0aC5yb3VuZChuLnRvUGl4ZWxzKEEoZC52YWx1ZSx2Lm1heCksITApKSwwKSxyKTt6JiYoZj1lPW4udG9QaXhlbHModi5tYXgpKTtHPU1hdGguYWJzKGYtZSk7Rj1NYXRoLm1pbihmLGUpO0g9TWF0aC5tYXgoZixlKTtuLmlzWEF4aXM/KGg9e3g6eT9IOkYseTowLHdpZHRoOkcsaGVpZ2h0OnJ9LHV8fChoLng9Yi5wbG90SGVpZ2h0LWgueCkpOihoPXt4OjAseTp5P0g6Rix3aWR0aDpyLGhlaWdodDpHfSx1JiYoaC55PWIucGxvdFdpZHRoLWgueSkpO3kmJmMuaXNWTUwmJihoPW4uaXNYQXhpcz97eDowLHk6dD9GOkgsaGVpZ2h0Omgud2lkdGgsd2lkdGg6Yi5jaGFydFdpZHRofTp7eDpoLnktYi5wbG90TGVmdC1iLnNwYWNpbmdCb3gueCx5OjAsd2lkdGg6aC5oZWlnaHQsDQogICAgICAgICAgICAgICAgaGVpZ2h0OmIuY2hhcnRIZWlnaHR9KTttW2ddP21bZ10uYW5pbWF0ZShoKToobVtnXT1jLmNsaXBSZWN0KGgpLHAmJmFbInpvbmUtZ3JhcGgtIitnXS5jbGlwKG1bZ10pLGwmJmFbInpvbmUtYXJlYS0iK2ddLmNsaXAobVtnXSkpO3o9ZC52YWx1ZT52Lm1heH0pLHRoaXMuY2xpcHM9bSl9LGludmVydEdyb3VwczpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7ayhbImdyb3VwIiwibWFya2VyR3JvdXAiXSxmdW5jdGlvbihiKXtjW2JdJiYoZC5yZW5kZXJlci5pc1ZNTCYmY1tiXS5hdHRyKHt3aWR0aDpjLnlBeGlzLmxlbixoZWlnaHQ6Yy54QXhpcy5sZW59KSxjW2JdLndpZHRoPWMueUF4aXMubGVuLGNbYl0uaGVpZ2h0PWMueEF4aXMubGVuLGNbYl0uaW52ZXJ0KGEpKX0pfXZhciBjPXRoaXMsZD1jLmNoYXJ0LGY7Yy54QXhpcyYmKGY9QihkLCJyZXNpemUiLGIpLEIoYywiZGVzdHJveSIsZiksYihhKSxjLmludmVydEdyb3Vwcz1iKX0scGxvdEdyb3VwOmZ1bmN0aW9uKGEsYixjLGQsZil7dmFyIGU9DQogICAgICAgICAgICB0aGlzW2FdLGs9IWU7ayYmKHRoaXNbYV09ZT10aGlzLmNoYXJ0LnJlbmRlcmVyLmcoYikuYXR0cih7ekluZGV4OmR8fC4xfSkuYWRkKGYpLGUuYWRkQ2xhc3MoImhpZ2hjaGFydHMtc2VyaWVzLSIrdGhpcy5pbmRleCsiIGhpZ2hjaGFydHMtIit0aGlzLnR5cGUrIi1zZXJpZXMgaGlnaGNoYXJ0cy1jb2xvci0iK3RoaXMuY29sb3JJbmRleCsiICIrKHRoaXMub3B0aW9ucy5jbGFzc05hbWV8fCIiKSkpO2UuYXR0cih7dmlzaWJpbGl0eTpjfSlbaz8iYXR0ciI6ImFuaW1hdGUiXSh0aGlzLmdldFBsb3RCb3goKSk7cmV0dXJuIGV9LGdldFBsb3RCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy54QXhpcyxjPXRoaXMueUF4aXM7YS5pbnZlcnRlZCYmKGI9YyxjPXRoaXMueEF4aXMpO3JldHVybnt0cmFuc2xhdGVYOmI/Yi5sZWZ0OmEucGxvdExlZnQsdHJhbnNsYXRlWTpjP2MudG9wOmEucGxvdFRvcCxzY2FsZVg6MSxzY2FsZVk6MX19LHJlbmRlcjpmdW5jdGlvbigpe3ZhciBhPQ0KICAgICAgICAgICAgdGhpcyxiPWEuY2hhcnQsYyxkPWEub3B0aW9ucyxmPSEhYS5hbmltYXRlJiZiLnJlbmRlcmVyLmlzU1ZHJiZ6KGQuYW5pbWF0aW9uKS5kdXJhdGlvbixlPWEudmlzaWJsZT8iaW5oZXJpdCI6ImhpZGRlbiIsaz1kLnpJbmRleCxtPWEuaGFzUmVuZGVyZWQsaD1iLnNlcmllc0dyb3VwLHA9Yi5pbnZlcnRlZDtjPWEucGxvdEdyb3VwKCJncm91cCIsInNlcmllcyIsZSxrLGgpO2EubWFya2VyR3JvdXA9YS5wbG90R3JvdXAoIm1hcmtlckdyb3VwIiwibWFya2VycyIsZSxrLGgpO2YmJmEuYW5pbWF0ZSghMCk7Yy5pbnZlcnRlZD1hLmlzQ2FydGVzaWFuP3A6ITE7YS5kcmF3R3JhcGgmJihhLmRyYXdHcmFwaCgpLGEuYXBwbHlab25lcygpKTthLmRyYXdEYXRhTGFiZWxzJiZhLmRyYXdEYXRhTGFiZWxzKCk7YS52aXNpYmxlJiZhLmRyYXdQb2ludHMoKTthLmRyYXdUcmFja2VyJiYhMSE9PWEub3B0aW9ucy5lbmFibGVNb3VzZVRyYWNraW5nJiZhLmRyYXdUcmFja2VyKCk7YS5pbnZlcnRHcm91cHMocCk7DQogICAgICAgICAgICAhMT09PWQuY2xpcHx8YS5zaGFyZWRDbGlwS2V5fHxtfHxjLmNsaXAoYi5jbGlwUmVjdCk7ZiYmYS5hbmltYXRlKCk7bXx8KGEuYW5pbWF0aW9uVGltZW91dD1HKGZ1bmN0aW9uKCl7YS5hZnRlckFuaW1hdGUoKX0sZikpO2EuaXNEaXJ0eT0hMTthLmhhc1JlbmRlcmVkPSEwfSxyZWRyYXc6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNoYXJ0LGI9dGhpcy5pc0RpcnR5fHx0aGlzLmlzRGlydHlEYXRhLGM9dGhpcy5ncm91cCxkPXRoaXMueEF4aXMsZj10aGlzLnlBeGlzO2MmJihhLmludmVydGVkJiZjLmF0dHIoe3dpZHRoOmEucGxvdFdpZHRoLGhlaWdodDphLnBsb3RIZWlnaHR9KSxjLmFuaW1hdGUoe3RyYW5zbGF0ZVg6QShkJiZkLmxlZnQsYS5wbG90TGVmdCksdHJhbnNsYXRlWTpBKGYmJmYudG9wLGEucGxvdFRvcCl9KSk7dGhpcy50cmFuc2xhdGUoKTt0aGlzLnJlbmRlcigpO2ImJmRlbGV0ZSB0aGlzLmtkVHJlZX0sa2REaW1lbnNpb25zOjEsa2RBeGlzQXJyYXk6WyJjbGllbnRYIiwNCiAgICAgICAgICAgICJwbG90WSJdLHNlYXJjaFBvaW50OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy54QXhpcyxkPXRoaXMueUF4aXMsZj10aGlzLmNoYXJ0LmludmVydGVkO3JldHVybiB0aGlzLnNlYXJjaEtEVHJlZSh7Y2xpZW50WDpmP2MubGVuLWEuY2hhcnRZK2MucG9zOmEuY2hhcnRYLWMucG9zLHBsb3RZOmY/ZC5sZW4tYS5jaGFydFgrZC5wb3M6YS5jaGFydFktZC5wb3N9LGIpfSxidWlsZEtEVHJlZTpmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGYpe3ZhciBlLGc7aWYoZz1jJiZjLmxlbmd0aClyZXR1cm4gZT1iLmtkQXhpc0FycmF5W2QlZl0sYy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGFbZV0tYltlXX0pLGc9TWF0aC5mbG9vcihnLzIpLHtwb2ludDpjW2ddLGxlZnQ6YShjLnNsaWNlKDAsZyksZCsxLGYpLHJpZ2h0OmEoYy5zbGljZShnKzEpLGQrMSxmKX19dGhpcy5idWlsZGluZ0tkVHJlZT0hMDt2YXIgYj10aGlzLGM9Yi5rZERpbWVuc2lvbnM7ZGVsZXRlIGIua2RUcmVlO0coZnVuY3Rpb24oKXtiLmtkVHJlZT0NCiAgICAgICAgICAgIGEoYi5nZXRWYWxpZFBvaW50cyhudWxsLCFiLmRpcmVjdFRvdWNoKSxjLGMpO2IuYnVpbGRpbmdLZFRyZWU9ITF9LGIub3B0aW9ucy5rZE5vdz8wOjEpfSxzZWFyY2hLRFRyZWU6ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEsYixnLG0pe3ZhciBoPWIucG9pbnQscD1kLmtkQXhpc0FycmF5W2clbV0scSxyLG49aDtyPWwoYVtmXSkmJmwoaFtmXSk/TWF0aC5wb3coYVtmXS1oW2ZdLDIpOm51bGw7cT1sKGFbZV0pJiZsKGhbZV0pP01hdGgucG93KGFbZV0taFtlXSwyKTpudWxsO3E9KHJ8fDApKyhxfHwwKTtoLmRpc3Q9bChxKT9NYXRoLnNxcnQocSk6TnVtYmVyLk1BWF9WQUxVRTtoLmRpc3RYPWwocik/TWF0aC5zcXJ0KHIpOk51bWJlci5NQVhfVkFMVUU7cD1hW3BdLWhbcF07cT0wPnA/ImxlZnQiOiJyaWdodCI7cj0wPnA/InJpZ2h0IjoibGVmdCI7YltxXSYmKHE9YyhhLGJbcV0sZysxLG0pLG49cVtrXTxuW2tdP3E6aCk7YltyXSYmTWF0aC5zcXJ0KHAqcCk8bltrXSYmKGE9YyhhLA0KICAgICAgICAgICAgYltyXSxnKzEsbSksbj1hW2tdPG5ba10/YTpuKTtyZXR1cm4gbn12YXIgZD10aGlzLGY9dGhpcy5rZEF4aXNBcnJheVswXSxlPXRoaXMua2RBeGlzQXJyYXlbMV0saz1iPyJkaXN0WCI6ImRpc3QiO3RoaXMua2RUcmVlfHx0aGlzLmJ1aWxkaW5nS2RUcmVlfHx0aGlzLmJ1aWxkS0RUcmVlKCk7aWYodGhpcy5rZFRyZWUpcmV0dXJuIGMoYSx0aGlzLmtkVHJlZSx0aGlzLmtkRGltZW5zaW9ucyx0aGlzLmtkRGltZW5zaW9ucyl9fSl9KShJKTsoZnVuY3Rpb24oYSl7ZnVuY3Rpb24gQihhLGUsYyxoLG4pe3ZhciBiPWEuY2hhcnQuaW52ZXJ0ZWQ7dGhpcy5heGlzPWE7dGhpcy5pc05lZ2F0aXZlPWM7dGhpcy5vcHRpb25zPWU7dGhpcy54PWg7dGhpcy50b3RhbD1udWxsO3RoaXMucG9pbnRzPXt9O3RoaXMuc3RhY2s9bjt0aGlzLnJpZ2h0Q2xpZmY9dGhpcy5sZWZ0Q2xpZmY9MDt0aGlzLmFsaWduT3B0aW9ucz17YWxpZ246ZS5hbGlnbnx8KGI/Yz8ibGVmdCI6InJpZ2h0IjoiY2VudGVyIiksDQogICAgdmVydGljYWxBbGlnbjplLnZlcnRpY2FsQWxpZ258fChiPyJtaWRkbGUiOmM/ImJvdHRvbSI6InRvcCIpLHk6bChlLnksYj80OmM/MTQ6LTYpLHg6bChlLngsYj9jPy02OjY6MCl9O3RoaXMudGV4dEFsaWduPWUudGV4dEFsaWdufHwoYj9jPyJyaWdodCI6ImxlZnQiOiJjZW50ZXIiKX12YXIgej1hLkF4aXMsQz1hLkNoYXJ0LEU9YS5jb3JyZWN0RmxvYXQsdT1hLmRlZmluZWQsaD1hLmRlc3Ryb3lPYmplY3RQcm9wZXJ0aWVzLG49YS5lYWNoLHQ9YS5mb3JtYXQsbD1hLnBpY2s7YT1hLlNlcmllcztCLnByb3RvdHlwZT17ZGVzdHJveTpmdW5jdGlvbigpe2godGhpcyx0aGlzLmF4aXMpfSxyZW5kZXI6ZnVuY3Rpb24oYSl7dmFyIGU9dGhpcy5vcHRpb25zLGM9ZS5mb3JtYXQsYz1jP3QoYyx0aGlzKTplLmZvcm1hdHRlci5jYWxsKHRoaXMpO3RoaXMubGFiZWw/dGhpcy5sYWJlbC5hdHRyKHt0ZXh0OmMsdmlzaWJpbGl0eToiaGlkZGVuIn0pOnRoaXMubGFiZWw9dGhpcy5heGlzLmNoYXJ0LnJlbmRlcmVyLnRleHQoYywNCiAgICAgICAgbnVsbCxudWxsLGUudXNlSFRNTCkuY3NzKGUuc3R5bGUpLmF0dHIoe2FsaWduOnRoaXMudGV4dEFsaWduLHJvdGF0aW9uOmUucm90YXRpb24sdmlzaWJpbGl0eToiaGlkZGVuIn0pLmFkZChhKX0sc2V0T2Zmc2V0OmZ1bmN0aW9uKGEsZSl7dmFyIGM9dGhpcy5heGlzLGs9Yy5jaGFydCxoPWsuaW52ZXJ0ZWQsYj1jLnJldmVyc2VkLGI9dGhpcy5pc05lZ2F0aXZlJiYhYnx8IXRoaXMuaXNOZWdhdGl2ZSYmYixtPWMudHJhbnNsYXRlKGMudXNlUGVyY2VudGFnZT8xMDA6dGhpcy50b3RhbCwwLDAsMCwxKSxjPWMudHJhbnNsYXRlKDApLGM9TWF0aC5hYnMobS1jKTthPWsueEF4aXNbMF0udHJhbnNsYXRlKHRoaXMueCkrYTt2YXIgZD1rLnBsb3RIZWlnaHQsaD17eDpoP2I/bTptLWM6YSx5Omg/ZC1hLWU6Yj9kLW0tYzpkLW0sd2lkdGg6aD9jOmUsaGVpZ2h0Omg/ZTpjfTtpZihlPXRoaXMubGFiZWwpZS5hbGlnbih0aGlzLmFsaWduT3B0aW9ucyxudWxsLGgpLGg9ZS5hbGlnbkF0dHIsZVshMT09PQ0KdGhpcy5vcHRpb25zLmNyb3B8fGsuaXNJbnNpZGVQbG90KGgueCxoLnkpPyJzaG93IjoiaGlkZSJdKCEwKX19O0MucHJvdG90eXBlLmdldFN0YWNrcz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7bihhLnlBeGlzLGZ1bmN0aW9uKGEpe2Euc3RhY2tzJiZhLmhhc1Zpc2libGVTZXJpZXMmJihhLm9sZFN0YWNrcz1hLnN0YWNrcyl9KTtuKGEuc2VyaWVzLGZ1bmN0aW9uKGUpeyFlLm9wdGlvbnMuc3RhY2tpbmd8fCEwIT09ZS52aXNpYmxlJiYhMSE9PWEub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXN8fChlLnN0YWNrS2V5PWUudHlwZStsKGUub3B0aW9ucy5zdGFjaywiIikpfSl9O3oucHJvdG90eXBlLmJ1aWxkU3RhY2tzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMsZSxjPWwodGhpcy5vcHRpb25zLnJldmVyc2VkU3RhY2tzLCEwKSxoPWEubGVuZ3RoLG47aWYoIXRoaXMuaXNYQXhpcyl7dGhpcy51c2VQZXJjZW50YWdlPSExO2ZvcihuPWg7bi0tOylhW2M/bjpoLW4tMV0uc2V0U3RhY2tlZFBvaW50cygpOw0KICAgIGZvcihuPWg7bi0tOyllPWFbYz9uOmgtbi0xXSxlLnNldFN0YWNrQ2xpZmZzJiZlLnNldFN0YWNrQ2xpZmZzKCk7aWYodGhpcy51c2VQZXJjZW50YWdlKWZvcihuPTA7bjxoO24rKylhW25dLnNldFBlcmNlbnRTdGFja3MoKX19O3oucHJvdG90eXBlLnJlbmRlclN0YWNrVG90YWxzPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jaGFydCxlPWEucmVuZGVyZXIsYz10aGlzLnN0YWNrcyxoLGwsYj10aGlzLnN0YWNrVG90YWxHcm91cDtifHwodGhpcy5zdGFja1RvdGFsR3JvdXA9Yj1lLmcoInN0YWNrLWxhYmVscyIpLmF0dHIoe3Zpc2liaWxpdHk6InZpc2libGUiLHpJbmRleDo2fSkuYWRkKCkpO2IudHJhbnNsYXRlKGEucGxvdExlZnQsYS5wbG90VG9wKTtmb3IoaCBpbiBjKWZvcihsIGluIGE9Y1toXSxhKWFbbF0ucmVuZGVyKGIpfTt6LnByb3RvdHlwZS5yZXNldFN0YWNrcz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuc3RhY2tzLGUsYztpZighdGhpcy5pc1hBeGlzKWZvcihlIGluIGEpZm9yKGMgaW4gYVtlXSlhW2VdW2NdLnRvdWNoZWQ8DQp0aGlzLnN0YWNrc1RvdWNoZWQ/KGFbZV1bY10uZGVzdHJveSgpLGRlbGV0ZSBhW2VdW2NdKTooYVtlXVtjXS50b3RhbD1udWxsLGFbZV1bY10uY3VtPW51bGwpfTt6LnByb3RvdHlwZS5jbGVhblN0YWNrcz1mdW5jdGlvbigpe3ZhciBhLGUsYztpZighdGhpcy5pc1hBeGlzKWZvcihlIGluIHRoaXMub2xkU3RhY2tzJiYoYT10aGlzLnN0YWNrcz10aGlzLm9sZFN0YWNrcyksYSlmb3IoYyBpbiBhW2VdKWFbZV1bY10uY3VtPWFbZV1bY10udG90YWx9O2EucHJvdG90eXBlLnNldFN0YWNrZWRQb2ludHM9ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuc3RhY2tpbmcmJighMD09PXRoaXMudmlzaWJsZXx8ITE9PT10aGlzLmNoYXJ0Lm9wdGlvbnMuY2hhcnQuaWdub3JlSGlkZGVuU2VyaWVzKSl7dmFyIGE9dGhpcy5wcm9jZXNzZWRYRGF0YSxlPXRoaXMucHJvY2Vzc2VkWURhdGEsYz1bXSxoPWUubGVuZ3RoLG49dGhpcy5vcHRpb25zLGI9bi50aHJlc2hvbGQsbT1uLnN0YXJ0RnJvbVRocmVzaG9sZD8NCiAgICBiOjAsZD1uLnN0YWNrLG49bi5zdGFja2luZyxyPXRoaXMuc3RhY2tLZXksdD0iLSIrcix2PXRoaXMubmVnU3RhY2tzLGY9dGhpcy55QXhpcyx5PWYuc3RhY2tzLEc9Zi5vbGRTdGFja3MsRixxLHgseixLLEMsZztmLnN0YWNrc1RvdWNoZWQrPTE7Zm9yKEs9MDtLPGg7SysrKUM9YVtLXSxnPWVbS10sRj10aGlzLmdldFN0YWNrSW5kaWNhdG9yKEYsQyx0aGlzLmluZGV4KSx6PUYua2V5LHg9KHE9diYmZzwobT8wOmIpKT90OnIseVt4XXx8KHlbeF09e30pLHlbeF1bQ118fChHW3hdJiZHW3hdW0NdPyh5W3hdW0NdPUdbeF1bQ10seVt4XVtDXS50b3RhbD1udWxsKTp5W3hdW0NdPW5ldyBCKGYsZi5vcHRpb25zLnN0YWNrTGFiZWxzLHEsQyxkKSkseD15W3hdW0NdLG51bGwhPT1nJiYoeC5wb2ludHNbel09eC5wb2ludHNbdGhpcy5pbmRleF09W2woeC5jdW0sbSldLHUoeC5jdW0pfHwoeC5iYXNlPXopLHgudG91Y2hlZD1mLnN0YWNrc1RvdWNoZWQsMDxGLmluZGV4JiYhMT09PXRoaXMuc2luZ2xlU3RhY2tzJiYNCih4LnBvaW50c1t6XVswXT14LnBvaW50c1t0aGlzLmluZGV4KyIsIitDKyIsMCJdWzBdKSksInBlcmNlbnQiPT09bj8ocT1xP3I6dCx2JiZ5W3FdJiZ5W3FdW0NdPyhxPXlbcV1bQ10seC50b3RhbD1xLnRvdGFsPU1hdGgubWF4KHEudG90YWwseC50b3RhbCkrTWF0aC5hYnMoZyl8fDApOngudG90YWw9RSh4LnRvdGFsKyhNYXRoLmFicyhnKXx8MCkpKTp4LnRvdGFsPUUoeC50b3RhbCsoZ3x8MCkpLHguY3VtPWwoeC5jdW0sbSkrKGd8fDApLG51bGwhPT1nJiYoeC5wb2ludHNbel0ucHVzaCh4LmN1bSksY1tLXT14LmN1bSk7InBlcmNlbnQiPT09biYmKGYudXNlUGVyY2VudGFnZT0hMCk7dGhpcy5zdGFja2VkWURhdGE9YztmLm9sZFN0YWNrcz17fX19O2EucHJvdG90eXBlLnNldFBlcmNlbnRTdGFja3M9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGU9YS5zdGFja0tleSxjPWEueUF4aXMuc3RhY2tzLGg9YS5wcm9jZXNzZWRYRGF0YSxsO24oW2UsIi0iK2VdLGZ1bmN0aW9uKGIpe2Zvcih2YXIgZT0NCiAgICBoLmxlbmd0aCxkLGs7ZS0tOylpZihkPWhbZV0sbD1hLmdldFN0YWNrSW5kaWNhdG9yKGwsZCxhLmluZGV4LGIpLGQ9KGs9Y1tiXSYmY1tiXVtkXSkmJmsucG9pbnRzW2wua2V5XSlrPWsudG90YWw/MTAwL2sudG90YWw6MCxkWzBdPUUoZFswXSprKSxkWzFdPUUoZFsxXSprKSxhLnN0YWNrZWRZRGF0YVtlXT1kWzFdfSl9O2EucHJvdG90eXBlLmdldFN0YWNrSW5kaWNhdG9yPWZ1bmN0aW9uKGEsZSxjLGgpeyF1KGEpfHxhLnghPT1lfHxoJiZhLmtleSE9PWg/YT17eDplLGluZGV4OjAsa2V5Omh9OmEuaW5kZXgrKzthLmtleT1bYyxlLGEuaW5kZXhdLmpvaW4oKTtyZXR1cm4gYX19KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5hZGRFdmVudCx6PWEuYW5pbWF0ZSxDPWEuQXhpcyxFPWEuY3JlYXRlRWxlbWVudCx1PWEuY3NzLGg9YS5kZWZpbmVkLG49YS5lYWNoLHQ9YS5lcmFzZSxsPWEuZXh0ZW5kLGs9YS5maXJlRXZlbnQsZT1hLmluQXJyYXksYz1hLmlzTnVtYmVyLHA9YS5pc09iamVjdCwNCiAgICBIPWEubWVyZ2UsYj1hLnBpY2ssbT1hLlBvaW50LGQ9YS5TZXJpZXMscj1hLnNlcmllc1R5cGVzLEE9YS5zZXRBbmltYXRpb24sdj1hLnNwbGF0O2woYS5DaGFydC5wcm90b3R5cGUse2FkZFNlcmllczpmdW5jdGlvbihhLGMsZCl7dmFyIGYsZT10aGlzO2EmJihjPWIoYywhMCksayhlLCJhZGRTZXJpZXMiLHtvcHRpb25zOmF9LGZ1bmN0aW9uKCl7Zj1lLmluaXRTZXJpZXMoYSk7ZS5pc0RpcnR5TGVnZW5kPSEwO2UubGlua1NlcmllcygpO2MmJmUucmVkcmF3KGQpfSkpO3JldHVybiBmfSxhZGRBeGlzOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBmPWM/InhBeGlzIjoieUF4aXMiLGg9dGhpcy5vcHRpb25zO2E9SChhLHtpbmRleDp0aGlzW2ZdLmxlbmd0aCxpc1g6Y30pO25ldyBDKHRoaXMsYSk7aFtmXT12KGhbZl18fHt9KTtoW2ZdLnB1c2goYSk7YihkLCEwKSYmdGhpcy5yZWRyYXcoZSl9LHNob3dMb2FkaW5nOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYz1iLm9wdGlvbnMsZD1iLmxvYWRpbmdEaXYsDQogICAgZj1jLmxvYWRpbmcsZT1mdW5jdGlvbigpe2QmJnUoZCx7bGVmdDpiLnBsb3RMZWZ0KyJweCIsdG9wOmIucGxvdFRvcCsicHgiLHdpZHRoOmIucGxvdFdpZHRoKyJweCIsaGVpZ2h0OmIucGxvdEhlaWdodCsicHgifSl9O2R8fChiLmxvYWRpbmdEaXY9ZD1FKCJkaXYiLHtjbGFzc05hbWU6ImhpZ2hjaGFydHMtbG9hZGluZyBoaWdoY2hhcnRzLWxvYWRpbmctaGlkZGVuIn0sbnVsbCxiLmNvbnRhaW5lciksYi5sb2FkaW5nU3Bhbj1FKCJzcGFuIix7Y2xhc3NOYW1lOiJoaWdoY2hhcnRzLWxvYWRpbmctaW5uZXIifSxudWxsLGQpLEIoYiwicmVkcmF3IixlKSk7ZC5jbGFzc05hbWU9ImhpZ2hjaGFydHMtbG9hZGluZyI7Yi5sb2FkaW5nU3Bhbi5pbm5lckhUTUw9YXx8Yy5sYW5nLmxvYWRpbmc7dShkLGwoZi5zdHlsZSx7ekluZGV4OjEwfSkpO3UoYi5sb2FkaW5nU3BhbixmLmxhYmVsU3R5bGUpO2IubG9hZGluZ1Nob3dufHwodShkLHtvcGFjaXR5OjAsZGlzcGxheToiIn0pLHooZCx7b3BhY2l0eTpmLnN0eWxlLm9wYWNpdHl8fA0KLjV9LHtkdXJhdGlvbjpmLnNob3dEdXJhdGlvbnx8MH0pKTtiLmxvYWRpbmdTaG93bj0hMDtlKCl9LGhpZGVMb2FkaW5nOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5sb2FkaW5nRGl2O2ImJihiLmNsYXNzTmFtZT0iaGlnaGNoYXJ0cy1sb2FkaW5nIGhpZ2hjaGFydHMtbG9hZGluZy1oaWRkZW4iLHooYix7b3BhY2l0eTowfSx7ZHVyYXRpb246YS5sb2FkaW5nLmhpZGVEdXJhdGlvbnx8MTAwLGNvbXBsZXRlOmZ1bmN0aW9uKCl7dShiLHtkaXNwbGF5OiJub25lIn0pfX0pKTt0aGlzLmxvYWRpbmdTaG93bj0hMX0scHJvcHNSZXF1aXJlRGlydHlCb3g6ImJhY2tncm91bmRDb2xvciBib3JkZXJDb2xvciBib3JkZXJXaWR0aCBtYXJnaW4gbWFyZ2luVG9wIG1hcmdpblJpZ2h0IG1hcmdpbkJvdHRvbSBtYXJnaW5MZWZ0IHNwYWNpbmcgc3BhY2luZ1RvcCBzcGFjaW5nUmlnaHQgc3BhY2luZ0JvdHRvbSBzcGFjaW5nTGVmdCBib3JkZXJSYWRpdXMgcGxvdEJhY2tncm91bmRDb2xvciBwbG90QmFja2dyb3VuZEltYWdlIHBsb3RCb3JkZXJDb2xvciBwbG90Qm9yZGVyV2lkdGggcGxvdFNoYWRvdyBzaGFkb3ciLnNwbGl0KCIgIiksDQogICAgcHJvcHNSZXF1aXJlVXBkYXRlU2VyaWVzOiJjaGFydC5pbnZlcnRlZCBjaGFydC5wb2xhciBjaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMgY2hhcnQudHlwZSBjb2xvcnMgcGxvdE9wdGlvbnMiLnNwbGl0KCIgIiksdXBkYXRlOmZ1bmN0aW9uKGEsZCl7dmFyIGYsaz17Y3JlZGl0czoiYWRkQ3JlZGl0cyIsdGl0bGU6InNldFRpdGxlIixzdWJ0aXRsZToic2V0U3VidGl0bGUifSxtPWEuY2hhcnQsbCxwO2lmKG0pe0goITAsdGhpcy5vcHRpb25zLmNoYXJ0LG0pOyJjbGFzc05hbWUiaW4gbSYmdGhpcy5zZXRDbGFzc05hbWUobS5jbGFzc05hbWUpO2lmKCJpbnZlcnRlZCJpbiBtfHwicG9sYXIiaW4gbSl0aGlzLnByb3BGcm9tU2VyaWVzKCksbD0hMDtmb3IoZiBpbiBtKW0uaGFzT3duUHJvcGVydHkoZikmJigtMSE9PWUoImNoYXJ0LiIrZix0aGlzLnByb3BzUmVxdWlyZVVwZGF0ZVNlcmllcykmJihwPSEwKSwtMSE9PWUoZix0aGlzLnByb3BzUmVxdWlyZURpcnR5Qm94KSYmKHRoaXMuaXNEaXJ0eUJveD0NCiAgICAgICAgITApKTsic3R5bGUiaW4gbSYmdGhpcy5yZW5kZXJlci5zZXRTdHlsZShtLnN0eWxlKX1mb3IoZiBpbiBhKXtpZih0aGlzW2ZdJiYiZnVuY3Rpb24iPT09dHlwZW9mIHRoaXNbZl0udXBkYXRlKXRoaXNbZl0udXBkYXRlKGFbZl0sITEpO2Vsc2UgaWYoImZ1bmN0aW9uIj09PXR5cGVvZiB0aGlzW2tbZl1dKXRoaXNba1tmXV0oYVtmXSk7ImNoYXJ0IiE9PWYmJi0xIT09ZShmLHRoaXMucHJvcHNSZXF1aXJlVXBkYXRlU2VyaWVzKSYmKHA9ITApfWEuY29sb3JzJiYodGhpcy5vcHRpb25zLmNvbG9ycz1hLmNvbG9ycyk7YS5wbG90T3B0aW9ucyYmSCghMCx0aGlzLm9wdGlvbnMucGxvdE9wdGlvbnMsYS5wbG90T3B0aW9ucyk7bihbInhBeGlzIiwieUF4aXMiLCJzZXJpZXMiXSxmdW5jdGlvbihiKXthW2JdJiZuKHYoYVtiXSksZnVuY3Rpb24oYSxjKXsoYz1oKGEuaWQpJiZ0aGlzLmdldChhLmlkKXx8dGhpc1tiXVtjXSkmJmMuY29sbD09PWImJmMudXBkYXRlKGEsITEpfSx0aGlzKX0sdGhpcyk7DQogICAgICAgIGwmJm4odGhpcy5heGVzLGZ1bmN0aW9uKGEpe2EudXBkYXRlKHt9LCExKX0pO3AmJm4odGhpcy5zZXJpZXMsZnVuY3Rpb24oYSl7YS51cGRhdGUoe30sITEpfSk7YS5sb2FkaW5nJiZIKCEwLHRoaXMub3B0aW9ucy5sb2FkaW5nLGEubG9hZGluZyk7Zj1tJiZtLndpZHRoO209bSYmbS5oZWlnaHQ7YyhmKSYmZiE9PXRoaXMuY2hhcnRXaWR0aHx8YyhtKSYmbSE9PXRoaXMuY2hhcnRIZWlnaHQ/dGhpcy5zZXRTaXplKGYsbSk6YihkLCEwKSYmdGhpcy5yZWRyYXcoKX0sc2V0U3VidGl0bGU6ZnVuY3Rpb24oYSl7dGhpcy5zZXRUaXRsZSh2b2lkIDAsYSl9fSk7bChtLnByb3RvdHlwZSx7dXBkYXRlOmZ1bmN0aW9uKGEsYyxkLGUpe2Z1bmN0aW9uIGYoKXtoLmFwcGx5T3B0aW9ucyhhKTtudWxsPT09aC55JiZrJiYoaC5ncmFwaGljPWsuZGVzdHJveSgpKTtwKGEsITApJiYoayYmay5lbGVtZW50JiZhJiZhLm1hcmtlciYmYS5tYXJrZXIuc3ltYm9sJiYoaC5ncmFwaGljPWsuZGVzdHJveSgpKSwNCmEmJmEuZGF0YUxhYmVscyYmaC5kYXRhTGFiZWwmJihoLmRhdGFMYWJlbD1oLmRhdGFMYWJlbC5kZXN0cm95KCkpKTtsPWguaW5kZXg7bS51cGRhdGVQYXJhbGxlbEFycmF5cyhoLGwpO24uZGF0YVtsXT1wKG4uZGF0YVtsXSwhMCl8fHAoYSwhMCk/aC5vcHRpb25zOmE7bS5pc0RpcnR5PW0uaXNEaXJ0eURhdGE9ITA7IW0uZml4ZWRCb3gmJm0uaGFzQ2FydGVzaWFuU2VyaWVzJiYoZy5pc0RpcnR5Qm94PSEwKTsicG9pbnQiPT09bi5sZWdlbmRUeXBlJiYoZy5pc0RpcnR5TGVnZW5kPSEwKTtjJiZnLnJlZHJhdyhkKX12YXIgaD10aGlzLG09aC5zZXJpZXMsaz1oLmdyYXBoaWMsbCxnPW0uY2hhcnQsbj1tLm9wdGlvbnM7Yz1iKGMsITApOyExPT09ZT9mKCk6aC5maXJlUG9pbnRFdmVudCgidXBkYXRlIix7b3B0aW9uczphfSxmKX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7dGhpcy5zZXJpZXMucmVtb3ZlUG9pbnQoZSh0aGlzLHRoaXMuc2VyaWVzLmRhdGEpLGEsYil9fSk7bChkLnByb3RvdHlwZSwNCiAgICB7YWRkUG9pbnQ6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGY9dGhpcy5vcHRpb25zLGg9dGhpcy5kYXRhLG09dGhpcy5jaGFydCxrPXRoaXMueEF4aXMsaz1rJiZrLmhhc05hbWVzJiZrLm5hbWVzLGw9Zi5kYXRhLGcscCxuPXRoaXMueERhdGEscix2O2M9YihjLCEwKTtnPXtzZXJpZXM6dGhpc307dGhpcy5wb2ludENsYXNzLnByb3RvdHlwZS5hcHBseU9wdGlvbnMuYXBwbHkoZyxbYV0pO3Y9Zy54O3I9bi5sZW5ndGg7aWYodGhpcy5yZXF1aXJlU29ydGluZyYmdjxuW3ItMV0pZm9yKHA9ITA7ciYmbltyLTFdPnY7KXItLTt0aGlzLnVwZGF0ZVBhcmFsbGVsQXJyYXlzKGcsInNwbGljZSIsciwwLDApO3RoaXMudXBkYXRlUGFyYWxsZWxBcnJheXMoZyxyKTtrJiZnLm5hbWUmJihrW3ZdPWcubmFtZSk7bC5zcGxpY2UociwwLGEpO3AmJih0aGlzLmRhdGEuc3BsaWNlKHIsMCxudWxsKSx0aGlzLnByb2Nlc3NEYXRhKCkpOyJwb2ludCI9PT1mLmxlZ2VuZFR5cGUmJnRoaXMuZ2VuZXJhdGVQb2ludHMoKTsNCiAgICAgICAgZCYmKGhbMF0mJmhbMF0ucmVtb3ZlP2hbMF0ucmVtb3ZlKCExKTooaC5zaGlmdCgpLHRoaXMudXBkYXRlUGFyYWxsZWxBcnJheXMoZywic2hpZnQiKSxsLnNoaWZ0KCkpKTt0aGlzLmlzRGlydHlEYXRhPXRoaXMuaXNEaXJ0eT0hMDtjJiZtLnJlZHJhdyhlKX0scmVtb3ZlUG9pbnQ6ZnVuY3Rpb24oYSxjLGQpe3ZhciBmPXRoaXMsZT1mLmRhdGEsaD1lW2FdLG09Zi5wb2ludHMsaz1mLmNoYXJ0LGw9ZnVuY3Rpb24oKXttJiZtLmxlbmd0aD09PWUubGVuZ3RoJiZtLnNwbGljZShhLDEpO2Uuc3BsaWNlKGEsMSk7Zi5vcHRpb25zLmRhdGEuc3BsaWNlKGEsMSk7Zi51cGRhdGVQYXJhbGxlbEFycmF5cyhofHx7c2VyaWVzOmZ9LCJzcGxpY2UiLGEsMSk7aCYmaC5kZXN0cm95KCk7Zi5pc0RpcnR5PSEwO2YuaXNEaXJ0eURhdGE9ITA7YyYmay5yZWRyYXcoKX07QShkLGspO2M9YihjLCEwKTtoP2guZmlyZVBvaW50RXZlbnQoInJlbW92ZSIsbnVsbCxsKTpsKCl9LHJlbW92ZTpmdW5jdGlvbihhLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMsZCl7ZnVuY3Rpb24gZigpe2UuZGVzdHJveSgpO2guaXNEaXJ0eUxlZ2VuZD1oLmlzRGlydHlCb3g9ITA7aC5saW5rU2VyaWVzKCk7YihhLCEwKSYmaC5yZWRyYXcoYyl9dmFyIGU9dGhpcyxoPWUuY2hhcnQ7ITEhPT1kP2soZSwicmVtb3ZlIixudWxsLGYpOmYoKX0sdXBkYXRlOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9dGhpcyxmPXRoaXMuY2hhcnQsZT10aGlzLnVzZXJPcHRpb25zLGg9dGhpcy5vbGRUeXBlfHx0aGlzLnR5cGUsbT1hLnR5cGV8fGUudHlwZXx8Zi5vcHRpb25zLmNoYXJ0LnR5cGUsaz1yW2hdLnByb3RvdHlwZSxwPVsiZ3JvdXAiLCJtYXJrZXJHcm91cCIsImRhdGFMYWJlbHNHcm91cCJdLGc7aWYobSYmbSE9PWh8fHZvaWQgMCE9PWEuekluZGV4KXAubGVuZ3RoPTA7bihwLGZ1bmN0aW9uKGEpe3BbYV09ZFthXTtkZWxldGUgZFthXX0pO2E9SChlLHthbmltYXRpb246ITEsaW5kZXg6dGhpcy5pbmRleCxwb2ludFN0YXJ0OnRoaXMueERhdGFbMF19LHtkYXRhOnRoaXMub3B0aW9ucy5kYXRhfSwNCiAgICAgICAgYSk7dGhpcy5yZW1vdmUoITEsbnVsbCwhMSk7Zm9yKGcgaW4gayl0aGlzW2ddPXZvaWQgMDtsKHRoaXMsclttfHxoXS5wcm90b3R5cGUpO24ocCxmdW5jdGlvbihhKXtkW2FdPXBbYV19KTt0aGlzLmluaXQoZixhKTt0aGlzLm9sZFR5cGU9aDtmLmxpbmtTZXJpZXMoKTtiKGMsITApJiZmLnJlZHJhdyghMSl9fSk7bChDLnByb3RvdHlwZSx7dXBkYXRlOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9dGhpcy5jaGFydDthPWQub3B0aW9uc1t0aGlzLmNvbGxdW3RoaXMub3B0aW9ucy5pbmRleF09SCh0aGlzLnVzZXJPcHRpb25zLGEpO3RoaXMuZGVzdHJveSghMCk7dGhpcy5pbml0KGQsbChhLHtldmVudHM6dm9pZCAwfSkpO2QuaXNEaXJ0eUJveD0hMDtiKGMsITApJiZkLnJlZHJhdygpfSxyZW1vdmU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBjPXRoaXMuY2hhcnQsZD10aGlzLmNvbGwsZj10aGlzLnNlcmllcyxlPWYubGVuZ3RoO2UtLTspZltlXSYmZltlXS5yZW1vdmUoITEpO3QoYy5heGVzLHRoaXMpOw0KICAgIHQoY1tkXSx0aGlzKTtjLm9wdGlvbnNbZF0uc3BsaWNlKHRoaXMub3B0aW9ucy5pbmRleCwxKTtuKGNbZF0sZnVuY3Rpb24oYSxiKXthLm9wdGlvbnMuaW5kZXg9Yn0pO3RoaXMuZGVzdHJveSgpO2MuaXNEaXJ0eUJveD0hMDtiKGEsITApJiZjLnJlZHJhdygpfSxzZXRUaXRsZTpmdW5jdGlvbihhLGIpe3RoaXMudXBkYXRlKHt0aXRsZTphfSxiKX0sc2V0Q2F0ZWdvcmllczpmdW5jdGlvbihhLGIpe3RoaXMudXBkYXRlKHtjYXRlZ29yaWVzOmF9LGIpfX0pfSkoSSk7KGZ1bmN0aW9uKGEpe3ZhciBCPWEuY29sb3Isej1hLmVhY2gsQz1hLm1hcCxFPWEucGljayx1PWEuU2VyaWVzLGg9YS5zZXJpZXNUeXBlO2goImFyZWEiLCJsaW5lIix7c29mdFRocmVzaG9sZDohMSx0aHJlc2hvbGQ6MH0se3NpbmdsZVN0YWNrczohMSxnZXRTdGFja1BvaW50czpmdW5jdGlvbigpe3ZhciBhPVtdLGg9W10sbD10aGlzLnhBeGlzLGs9dGhpcy55QXhpcyxlPWsuc3RhY2tzW3RoaXMuc3RhY2tLZXldLGM9e30sDQogICAgcD10aGlzLnBvaW50cyx1PXRoaXMuaW5kZXgsYj1rLnNlcmllcyxtPWIubGVuZ3RoLGQscj1FKGsub3B0aW9ucy5yZXZlcnNlZFN0YWNrcywhMCk/MTotMSxBLHY7aWYodGhpcy5vcHRpb25zLnN0YWNraW5nKXtmb3IoQT0wO0E8cC5sZW5ndGg7QSsrKWNbcFtBXS54XT1wW0FdO2Zvcih2IGluIGUpbnVsbCE9PWVbdl0udG90YWwmJmgucHVzaCh2KTtoLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS1ifSk7ZD1DKGIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52aXNpYmxlfSk7eihoLGZ1bmN0aW9uKGIscCl7dmFyIGY9MCxuLHE7aWYoY1tiXSYmIWNbYl0uaXNOdWxsKWEucHVzaChjW2JdKSx6KFstMSwxXSxmdW5jdGlvbihhKXt2YXIgZj0xPT09YT8icmlnaHROdWxsIjoibGVmdE51bGwiLGs9MCxsPWVbaFtwK2FdXTtpZihsKWZvcihBPXU7MDw9QSYmQTxtOyluPWwucG9pbnRzW0FdLG58fChBPT09dT9jW2JdW2ZdPSEwOmRbQV0mJihxPWVbYl0ucG9pbnRzW0FdKSYmKGstPXFbMV0tDQogICAgICAgIHFbMF0pKSxBKz1yO2NbYl1bMT09PWE/InJpZ2h0Q2xpZmYiOiJsZWZ0Q2xpZmYiXT1rfSk7ZWxzZXtmb3IoQT11OzA8PUEmJkE8bTspe2lmKG49ZVtiXS5wb2ludHNbQV0pe2Y9blsxXTticmVha31BKz1yfWY9ay50cmFuc2xhdGUoZiwwLDEsMCwxKTthLnB1c2goe2lzTnVsbDohMCxwbG90WDpsLnRyYW5zbGF0ZShiLDAsMCwwLDEpLHg6YixwbG90WTpmLHlCb3R0b206Zn0pfX0pfXJldHVybiBhfSxnZXRHcmFwaFBhdGg6ZnVuY3Rpb24oYSl7dmFyIGg9dS5wcm90b3R5cGUuZ2V0R3JhcGhQYXRoLGw9dGhpcy5vcHRpb25zLGs9bC5zdGFja2luZyxlPXRoaXMueUF4aXMsYyxwLG49W10sYj1bXSxtPXRoaXMuaW5kZXgsZCxyPWUuc3RhY2tzW3RoaXMuc3RhY2tLZXldLEE9bC50aHJlc2hvbGQsdj1lLmdldFRocmVzaG9sZChsLnRocmVzaG9sZCksZixsPWwuY29ubmVjdE51bGxzfHwicGVyY2VudCI9PT1rLHk9ZnVuY3Rpb24oYyxmLGgpe3ZhciBsPWFbY107Yz1rJiZyW2wueF0ucG9pbnRzW21dOw0KICAgIHZhciBwPWxbaCsiTnVsbCJdfHwwO2g9bFtoKyJDbGlmZiJdfHwwO3ZhciBxLHQsbD0hMDtofHxwPyhxPShwP2NbMF06Y1sxXSkraCx0PWNbMF0raCxsPSEhcCk6IWsmJmFbZl0mJmFbZl0uaXNOdWxsJiYocT10PUEpO3ZvaWQgMCE9PXEmJihiLnB1c2goe3Bsb3RYOmQscGxvdFk6bnVsbD09PXE/djplLmdldFRocmVzaG9sZChxKSxpc051bGw6bCxpc0NsaWZmOiEwfSksbi5wdXNoKHtwbG90WDpkLHBsb3RZOm51bGw9PT10P3Y6ZS5nZXRUaHJlc2hvbGQodCksZG9DdXJ2ZTohMX0pKX07YT1hfHx0aGlzLnBvaW50cztrJiYoYT10aGlzLmdldFN0YWNrUG9pbnRzKCkpO2ZvcihjPTA7YzxhLmxlbmd0aDtjKyspaWYocD1hW2NdLmlzTnVsbCxkPUUoYVtjXS5yZWN0UGxvdFgsYVtjXS5wbG90WCksZj1FKGFbY10ueUJvdHRvbSx2KSwhcHx8bClsfHx5KGMsYy0xLCJsZWZ0IikscCYmIWsmJmx8fChiLnB1c2goYVtjXSksbi5wdXNoKHt4OmMscGxvdFg6ZCxwbG90WTpmfSkpLGx8fHkoYyxjKw0KICAgIDEsInJpZ2h0Iik7Yz1oLmNhbGwodGhpcyxiLCEwLCEwKTtuLnJldmVyc2VkPSEwO3A9aC5jYWxsKHRoaXMsbiwhMCwhMCk7cC5sZW5ndGgmJihwWzBdPSJMIik7cD1jLmNvbmNhdChwKTtoPWguY2FsbCh0aGlzLGIsITEsbCk7cC54TWFwPWMueE1hcDt0aGlzLmFyZWFQYXRoPXA7cmV0dXJuIGh9LGRyYXdHcmFwaDpmdW5jdGlvbigpe3RoaXMuYXJlYVBhdGg9W107dS5wcm90b3R5cGUuZHJhd0dyYXBoLmFwcGx5KHRoaXMpO3ZhciBhPXRoaXMsaD10aGlzLmFyZWFQYXRoLGw9dGhpcy5vcHRpb25zLGs9W1siYXJlYSIsImhpZ2hjaGFydHMtYXJlYSIsdGhpcy5jb2xvcixsLmZpbGxDb2xvcl1dO3oodGhpcy56b25lcyxmdW5jdGlvbihlLGMpe2sucHVzaChbInpvbmUtYXJlYS0iK2MsImhpZ2hjaGFydHMtYXJlYSBoaWdoY2hhcnRzLXpvbmUtYXJlYS0iK2MrIiAiK2UuY2xhc3NOYW1lLGUuY29sb3J8fGEuY29sb3IsZS5maWxsQ29sb3J8fGwuZmlsbENvbG9yXSl9KTt6KGssZnVuY3Rpb24oZSl7dmFyIGM9DQogICAgZVswXSxrPWFbY107az8oay5lbmRYPWgueE1hcCxrLmFuaW1hdGUoe2Q6aH0pKTooaz1hW2NdPWEuY2hhcnQucmVuZGVyZXIucGF0aChoKS5hZGRDbGFzcyhlWzFdKS5hdHRyKHtmaWxsOkUoZVszXSxCKGVbMl0pLnNldE9wYWNpdHkoRShsLmZpbGxPcGFjaXR5LC43NSkpLmdldCgpKSx6SW5kZXg6MH0pLmFkZChhLmdyb3VwKSxrLmlzQXJlYT0hMCk7ay5zdGFydFg9aC54TWFwO2suc2hpZnRVbml0PWwuc3RlcD8yOjF9KX0sZHJhd0xlZ2VuZFN5bWJvbDphLkxlZ2VuZFN5bWJvbE1peGluLmRyYXdSZWN0YW5nbGV9KX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLnBpY2s7YT1hLnNlcmllc1R5cGU7YSgic3BsaW5lIiwibGluZSIse30se2dldFBvaW50U3BsaW5lOmZ1bmN0aW9uKGEsQyxFKXt2YXIgdT1DLnBsb3RYLGg9Qy5wbG90WSxuPWFbRS0xXTtFPWFbRSsxXTt2YXIgdCxsLGssZTtpZihuJiYhbi5pc051bGwmJiExIT09bi5kb0N1cnZlJiYhQy5pc0NsaWZmJiZFJiYhRS5pc051bGwmJg0KICAgICExIT09RS5kb0N1cnZlJiYhQy5pc0NsaWZmKXthPW4ucGxvdFk7az1FLnBsb3RYO0U9RS5wbG90WTt2YXIgYz0wO3Q9KDEuNSp1K24ucGxvdFgpLzIuNTtsPSgxLjUqaCthKS8yLjU7az0oMS41KnUraykvMi41O2U9KDEuNSpoK0UpLzIuNTtrIT09dCYmKGM9KGUtbCkqKGstdSkvKGstdCkraC1lKTtsKz1jO2UrPWM7bD5hJiZsPmg/KGw9TWF0aC5tYXgoYSxoKSxlPTIqaC1sKTpsPGEmJmw8aCYmKGw9TWF0aC5taW4oYSxoKSxlPTIqaC1sKTtlPkUmJmU+aD8oZT1NYXRoLm1heChFLGgpLGw9MipoLWUpOmU8RSYmZTxoJiYoZT1NYXRoLm1pbihFLGgpLGw9MipoLWUpO0MucmlnaHRDb250WD1rO0MucmlnaHRDb250WT1lfUM9WyJDIixCKG4ucmlnaHRDb250WCxuLnBsb3RYKSxCKG4ucmlnaHRDb250WSxuLnBsb3RZKSxCKHQsdSksQihsLGgpLHUsaF07bi5yaWdodENvbnRYPW4ucmlnaHRDb250WT1udWxsO3JldHVybiBDfX0pfSkoSSk7KGZ1bmN0aW9uKGEpe3ZhciBCPWEuc2VyaWVzVHlwZXMuYXJlYS5wcm90b3R5cGUsDQogICAgej1hLnNlcmllc1R5cGU7eigiYXJlYXNwbGluZSIsInNwbGluZSIsYS5kZWZhdWx0UGxvdE9wdGlvbnMuYXJlYSx7Z2V0U3RhY2tQb2ludHM6Qi5nZXRTdGFja1BvaW50cyxnZXRHcmFwaFBhdGg6Qi5nZXRHcmFwaFBhdGgsc2V0U3RhY2tDbGlmZnM6Qi5zZXRTdGFja0NsaWZmcyxkcmF3R3JhcGg6Qi5kcmF3R3JhcGgsZHJhd0xlZ2VuZFN5bWJvbDphLkxlZ2VuZFN5bWJvbE1peGluLmRyYXdSZWN0YW5nbGV9KX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmFuaW1PYmplY3Qsej1hLmNvbG9yLEM9YS5lYWNoLEU9YS5leHRlbmQsdT1hLmlzTnVtYmVyLGg9YS5tZXJnZSxuPWEucGljayx0PWEuU2VyaWVzLGw9YS5zZXJpZXNUeXBlLGs9YS5zdmc7bCgiY29sdW1uIiwibGluZSIse2JvcmRlclJhZGl1czowLGdyb3VwUGFkZGluZzouMixtYXJrZXI6bnVsbCxwb2ludFBhZGRpbmc6LjEsbWluUG9pbnRMZW5ndGg6MCxjcm9wVGhyZXNob2xkOjUwLHBvaW50UmFuZ2U6bnVsbCxzdGF0ZXM6e2hvdmVyOntoYWxvOiExLA0KICAgIGJyaWdodG5lc3M6LjEsc2hhZG93OiExfSxzZWxlY3Q6e2NvbG9yOiIjY2NjY2NjIixib3JkZXJDb2xvcjoiIzAwMDAwMCIsc2hhZG93OiExfX0sZGF0YUxhYmVsczp7YWxpZ246bnVsbCx2ZXJ0aWNhbEFsaWduOm51bGwseTpudWxsfSxzb2Z0VGhyZXNob2xkOiExLHN0YXJ0RnJvbVRocmVzaG9sZDohMCxzdGlja3lUcmFja2luZzohMSx0b29sdGlwOntkaXN0YW5jZTo2fSx0aHJlc2hvbGQ6MCxib3JkZXJDb2xvcjoiI2ZmZmZmZiJ9LHtjcm9wU2hvdWxkZXI6MCxkaXJlY3RUb3VjaDohMCx0cmFja2VyR3JvdXBzOlsiZ3JvdXAiLCJkYXRhTGFiZWxzR3JvdXAiXSxuZWdTdGFja3M6ITAsaW5pdDpmdW5jdGlvbigpe3QucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMsYz1hLmNoYXJ0O2MuaGFzUmVuZGVyZWQmJkMoYy5zZXJpZXMsZnVuY3Rpb24oYyl7Yy50eXBlPT09YS50eXBlJiYoYy5pc0RpcnR5PSEwKX0pfSxnZXRDb2x1bW5NZXRyaWNzOmZ1bmN0aW9uKCl7dmFyIGE9DQogICAgdGhpcyxjPWEub3B0aW9ucyxoPWEueEF4aXMsaz1hLnlBeGlzLGI9aC5yZXZlcnNlZCxtLGQ9e30sbD0wOyExPT09Yy5ncm91cGluZz9sPTE6QyhhLmNoYXJ0LnNlcmllcyxmdW5jdGlvbihiKXt2YXIgYz1iLm9wdGlvbnMsZj1iLnlBeGlzLGU7Yi50eXBlPT09YS50eXBlJiZiLnZpc2libGUmJmsubGVuPT09Zi5sZW4mJmsucG9zPT09Zi5wb3MmJihjLnN0YWNraW5nPyhtPWIuc3RhY2tLZXksdm9pZCAwPT09ZFttXSYmKGRbbV09bCsrKSxlPWRbbV0pOiExIT09Yy5ncm91cGluZyYmKGU9bCsrKSxiLmNvbHVtbkluZGV4PWUpfSk7dmFyIHQ9TWF0aC5taW4oTWF0aC5hYnMoaC50cmFuc0EpKihoLm9yZGluYWxTbG9wZXx8Yy5wb2ludFJhbmdlfHxoLmNsb3Nlc3RQb2ludFJhbmdlfHxoLnRpY2tJbnRlcnZhbHx8MSksaC5sZW4pLHY9dCpjLmdyb3VwUGFkZGluZyxmPSh0LTIqdikvKGx8fDEpLGM9TWF0aC5taW4oYy5tYXhQb2ludFdpZHRofHxoLmxlbixuKGMucG9pbnRXaWR0aCxmKigxLQ0KICAgIDIqYy5wb2ludFBhZGRpbmcpKSk7YS5jb2x1bW5NZXRyaWNzPXt3aWR0aDpjLG9mZnNldDooZi1jKS8yKyh2KygoYS5jb2x1bW5JbmRleHx8MCkrKGI/MTowKSkqZi10LzIpKihiPy0xOjEpfTtyZXR1cm4gYS5jb2x1bW5NZXRyaWNzfSxjcmlzcENvbDpmdW5jdGlvbihhLGMsaCxrKXt2YXIgYj10aGlzLmNoYXJ0LGU9dGhpcy5ib3JkZXJXaWR0aCxkPS0oZSUyPy41OjApLGU9ZSUyPy41OjE7Yi5pbnZlcnRlZCYmYi5yZW5kZXJlci5pc1ZNTCYmKGUrPTEpO2g9TWF0aC5yb3VuZChhK2gpK2Q7YT1NYXRoLnJvdW5kKGEpK2Q7az1NYXRoLnJvdW5kKGMraykrZTtkPS41Pj1NYXRoLmFicyhjKSYmLjU8aztjPU1hdGgucm91bmQoYykrZTtrLT1jO2QmJmsmJigtLWMsays9MSk7cmV0dXJue3g6YSx5OmMsd2lkdGg6aC1hLGhlaWdodDprfX0sdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcyxjPWEuY2hhcnQsaD1hLm9wdGlvbnMsaz1hLmRlbnNlPTI+YS5jbG9zZXN0UG9pbnRSYW5nZSoNCiAgICBhLnhBeGlzLnRyYW5zQSxrPWEuYm9yZGVyV2lkdGg9bihoLmJvcmRlcldpZHRoLGs/MDoxKSxiPWEueUF4aXMsbT1hLnRyYW5zbGF0ZWRUaHJlc2hvbGQ9Yi5nZXRUaHJlc2hvbGQoaC50aHJlc2hvbGQpLGQ9bihoLm1pblBvaW50TGVuZ3RoLDUpLGw9YS5nZXRDb2x1bW5NZXRyaWNzKCksdT1sLndpZHRoLHY9YS5iYXJXPU1hdGgubWF4KHUsMSsyKmspLGY9YS5wb2ludFhPZmZzZXQ9bC5vZmZzZXQ7Yy5pbnZlcnRlZCYmKG0tPS41KTtoLnBvaW50UGFkZGluZyYmKHY9TWF0aC5jZWlsKHYpKTt0LnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkoYSk7QyhhLnBvaW50cyxmdW5jdGlvbihlKXt2YXIgaD1uKGUueUJvdHRvbSxtKSxrPTk5OStNYXRoLmFicyhoKSxrPU1hdGgubWluKE1hdGgubWF4KC1rLGUucGxvdFkpLGIubGVuK2spLGw9ZS5wbG90WCtmLHA9dixyPU1hdGgubWluKGssaCksdCx5PU1hdGgubWF4KGssaCktcjtNYXRoLmFicyh5KTxkJiZkJiYoeT1kLHQ9IWIucmV2ZXJzZWQmJg0KICAgICFlLm5lZ2F0aXZlfHxiLnJldmVyc2VkJiZlLm5lZ2F0aXZlLHI9TWF0aC5hYnMoci1tKT5kP2gtZDptLSh0P2Q6MCkpO2UuYmFyWD1sO2UucG9pbnRXaWR0aD11O2UudG9vbHRpcFBvcz1jLmludmVydGVkP1tiLmxlbitiLnBvcy1jLnBsb3RMZWZ0LWssYS54QXhpcy5sZW4tbC1wLzIseV06W2wrcC8yLGsrYi5wb3MtYy5wbG90VG9wLHldO2Uuc2hhcGVUeXBlPSJyZWN0IjtlLnNoYXBlQXJncz1hLmNyaXNwQ29sLmFwcGx5KGEsZS5pc051bGw/W2UucGxvdFgsYi5sZW4vMiwwLDBdOltsLHIscCx5XSl9KX0sZ2V0U3ltYm9sOmEubm9vcCxkcmF3TGVnZW5kU3ltYm9sOmEuTGVnZW5kU3ltYm9sTWl4aW4uZHJhd1JlY3RhbmdsZSxkcmF3R3JhcGg6ZnVuY3Rpb24oKXt0aGlzLmdyb3VwW3RoaXMuZGVuc2U/ImFkZENsYXNzIjoicmVtb3ZlQ2xhc3MiXSgiaGlnaGNoYXJ0cy1kZW5zZS1kYXRhIil9LHBvaW50QXR0cmliczpmdW5jdGlvbihhLGMpe3ZhciBlPXRoaXMub3B0aW9ucyxrLGI9dGhpcy5wb2ludEF0dHJUb09wdGlvbnN8fA0KICAgIHt9O2s9Yi5zdHJva2V8fCJib3JkZXJDb2xvciI7dmFyIG09Ylsic3Ryb2tlLXdpZHRoIl18fCJib3JkZXJXaWR0aCIsZD1hJiZhLmNvbG9yfHx0aGlzLmNvbG9yLGw9YVtrXXx8ZVtrXXx8dGhpcy5jb2xvcnx8ZCxuPWFbbV18fGVbbV18fHRoaXNbbV18fDAsYj1lLmRhc2hTdHlsZTthJiZ0aGlzLnpvbmVzLmxlbmd0aCYmKGQ9KGQ9YS5nZXRab25lKCkpJiZkLmNvbG9yfHxhLm9wdGlvbnMuY29sb3J8fHRoaXMuY29sb3IpO2MmJihhPWgoZS5zdGF0ZXNbY10sYS5vcHRpb25zLnN0YXRlcyYmYS5vcHRpb25zLnN0YXRlc1tjXXx8e30pLGM9YS5icmlnaHRuZXNzLGQ9YS5jb2xvcnx8dm9pZCAwIT09YyYmeihkKS5icmlnaHRlbihhLmJyaWdodG5lc3MpLmdldCgpfHxkLGw9YVtrXXx8bCxuPWFbbV18fG4sYj1hLmRhc2hTdHlsZXx8Yik7az17ZmlsbDpkLHN0cm9rZTpsLCJzdHJva2Utd2lkdGgiOm59O2UuYm9yZGVyUmFkaXVzJiYoay5yPWUuYm9yZGVyUmFkaXVzKTtiJiYoay5kYXNoc3R5bGU9DQogICAgYik7cmV0dXJuIGt9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGM9dGhpcy5jaGFydCxrPWEub3B0aW9ucyxsPWMucmVuZGVyZXIsYj1rLmFuaW1hdGlvbkxpbWl0fHwyNTAsbTtDKGEucG9pbnRzLGZ1bmN0aW9uKGQpe3ZhciBlPWQuZ3JhcGhpYztpZih1KGQucGxvdFkpJiZudWxsIT09ZC55KXttPWQuc2hhcGVBcmdzO2lmKGUpZVtjLnBvaW50Q291bnQ8Yj8iYW5pbWF0ZSI6ImF0dHIiXShoKG0pKTtlbHNlIGQuZ3JhcGhpYz1lPWxbZC5zaGFwZVR5cGVdKG0pLmFkZChkLmdyb3VwfHxhLmdyb3VwKTtlLmF0dHIoYS5wb2ludEF0dHJpYnMoZCxkLnNlbGVjdGVkJiYic2VsZWN0IikpLnNoYWRvdyhrLnNoYWRvdyxudWxsLGsuc3RhY2tpbmcmJiFrLmJvcmRlclJhZGl1cyk7ZS5hZGRDbGFzcyhkLmdldENsYXNzTmFtZSgpLCEwKX1lbHNlIGUmJihkLmdyYXBoaWM9ZS5kZXN0cm95KCkpfSl9LGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcyxlPXRoaXMueUF4aXMsDQogICAgaD1jLm9wdGlvbnMsYj10aGlzLmNoYXJ0LmludmVydGVkLG09e307ayYmKGE/KG0uc2NhbGVZPS4wMDEsYT1NYXRoLm1pbihlLnBvcytlLmxlbixNYXRoLm1heChlLnBvcyxlLnRvUGl4ZWxzKGgudGhyZXNob2xkKSkpLGI/bS50cmFuc2xhdGVYPWEtZS5sZW46bS50cmFuc2xhdGVZPWEsYy5ncm91cC5hdHRyKG0pKToobVtiPyJ0cmFuc2xhdGVYIjoidHJhbnNsYXRlWSJdPWUucG9zLGMuZ3JvdXAuYW5pbWF0ZShtLEUoQihjLm9wdGlvbnMuYW5pbWF0aW9uKSx7c3RlcDpmdW5jdGlvbihhLGIpe2MuZ3JvdXAuYXR0cih7c2NhbGVZOk1hdGgubWF4KC4wMDEsYi5wb3MpfSl9fSkpLGMuYW5pbWF0ZT1udWxsKSl9LHJlbW92ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYz1hLmNoYXJ0O2MuaGFzUmVuZGVyZWQmJkMoYy5zZXJpZXMsZnVuY3Rpb24oYyl7Yy50eXBlPT09YS50eXBlJiYoYy5pc0RpcnR5PSEwKX0pO3QucHJvdG90eXBlLnJlbW92ZS5hcHBseShhLGFyZ3VtZW50cyl9fSl9KShJKTsNCiAgICAoZnVuY3Rpb24oYSl7YT1hLnNlcmllc1R5cGU7YSgiYmFyIiwiY29sdW1uIixudWxsLHtpbnZlcnRlZDohMH0pfSkoSSk7KGZ1bmN0aW9uKGEpe3ZhciBCPWEuU2VyaWVzO2E9YS5zZXJpZXNUeXBlO2EoInNjYXR0ZXIiLCJsaW5lIix7bGluZVdpZHRoOjAsbWFya2VyOntlbmFibGVkOiEwfSx0b29sdGlwOntoZWFkZXJGb3JtYXQ6J1x4M2NzcGFuIHN0eWxlXHgzZCJjb2xvcjp7cG9pbnQuY29sb3J9Ilx4M2VcdTI1Y2ZceDNjL3NwYW5ceDNlIFx4M2NzcGFuIHN0eWxlXHgzZCJmb250LXNpemU6IDAuODVlbSJceDNlIHtzZXJpZXMubmFtZX1ceDNjL3NwYW5ceDNlXHgzY2JyL1x4M2UnLHBvaW50Rm9ybWF0OiJ4OiBceDNjYlx4M2V7cG9pbnQueH1ceDNjL2JceDNlXHgzY2JyL1x4M2V5OiBceDNjYlx4M2V7cG9pbnQueX1ceDNjL2JceDNlXHgzY2JyL1x4M2UifX0se3NvcnRlZDohMSxyZXF1aXJlU29ydGluZzohMSxub1NoYXJlZFRvb2x0aXA6ITAsdHJhY2tlckdyb3VwczpbImdyb3VwIiwNCiAgICAgICAgIm1hcmtlckdyb3VwIiwiZGF0YUxhYmVsc0dyb3VwIl0sdGFrZU9yZGluYWxQb3NpdGlvbjohMSxrZERpbWVuc2lvbnM6MixkcmF3R3JhcGg6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMubGluZVdpZHRoJiZCLnByb3RvdHlwZS5kcmF3R3JhcGguY2FsbCh0aGlzKX19KX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLnBpY2ssej1hLnJlbGF0aXZlTGVuZ3RoO2EuQ2VudGVyZWRTZXJpZXNNaXhpbj17Z2V0Q2VudGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLEU9dGhpcy5jaGFydCx1PTIqKGEuc2xpY2VkT2Zmc2V0fHwwKSxoPUUucGxvdFdpZHRoLTIqdSxFPUUucGxvdEhlaWdodC0yKnUsbj1hLmNlbnRlcixuPVtCKG5bMF0sIjUwJSIpLEIoblsxXSwiNTAlIiksYS5zaXplfHwiMTAwJSIsYS5pbm5lclNpemV8fDBdLHQ9TWF0aC5taW4oaCxFKSxsLGs7Zm9yKGw9MDs0Pmw7KytsKWs9bltsXSxhPTI+bHx8Mj09PWwmJi8lJC8udGVzdChrKSxuW2xdPXooayxbaCxFLHQsblsyXV1bbF0pKw0KICAgICAgICAoYT91OjApO25bM10+blsyXSYmKG5bM109blsyXSk7cmV0dXJuIG59fX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmFkZEV2ZW50LHo9YS5kZWZpbmVkLEM9YS5lYWNoLEU9YS5leHRlbmQsdT1hLmluQXJyYXksaD1hLm5vb3Asbj1hLnBpY2ssdD1hLlBvaW50LGw9YS5TZXJpZXMsaz1hLnNlcmllc1R5cGUsZT1hLnNldEFuaW1hdGlvbjtrKCJwaWUiLCJsaW5lIix7Y2VudGVyOltudWxsLG51bGxdLGNsaXA6ITEsY29sb3JCeVBvaW50OiEwLGRhdGFMYWJlbHM6e2Rpc3RhbmNlOjMwLGVuYWJsZWQ6ITAsZm9ybWF0dGVyOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PT10aGlzLnk/dm9pZCAwOnRoaXMucG9pbnQubmFtZX0seDowfSxpZ25vcmVIaWRkZW5Qb2ludDohMCxsZWdlbmRUeXBlOiJwb2ludCIsbWFya2VyOm51bGwsc2l6ZTpudWxsLHNob3dJbkxlZ2VuZDohMSxzbGljZWRPZmZzZXQ6MTAsc3RpY2t5VHJhY2tpbmc6ITEsdG9vbHRpcDp7Zm9sbG93UG9pbnRlcjohMH0sYm9yZGVyQ29sb3I6IiNmZmZmZmYiLA0KICAgICAgICBib3JkZXJXaWR0aDoxLHN0YXRlczp7aG92ZXI6e2JyaWdodG5lc3M6LjEsc2hhZG93OiExfX19LHtpc0NhcnRlc2lhbjohMSxyZXF1aXJlU29ydGluZzohMSxkaXJlY3RUb3VjaDohMCxub1NoYXJlZFRvb2x0aXA6ITAsdHJhY2tlckdyb3VwczpbImdyb3VwIiwiZGF0YUxhYmVsc0dyb3VwIl0sYXhpc1R5cGVzOltdLHBvaW50QXR0cmliczphLnNlcmllc1R5cGVzLmNvbHVtbi5wcm90b3R5cGUucG9pbnRBdHRyaWJzLGFuaW1hdGU6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcyxlPWMucG9pbnRzLGI9Yy5zdGFydEFuZ2xlUmFkO2F8fChDKGUsZnVuY3Rpb24oYSl7dmFyIGQ9YS5ncmFwaGljLGU9YS5zaGFwZUFyZ3M7ZCYmKGQuYXR0cih7cjphLnN0YXJ0Unx8Yy5jZW50ZXJbM10vMixzdGFydDpiLGVuZDpifSksZC5hbmltYXRlKHtyOmUucixzdGFydDplLnN0YXJ0LGVuZDplLmVuZH0sYy5vcHRpb25zLmFuaW1hdGlvbikpfSksYy5hbmltYXRlPW51bGwpfSx1cGRhdGVUb3RhbHM6ZnVuY3Rpb24oKXt2YXIgYSwNCiAgICAgICAgZT0wLGg9dGhpcy5wb2ludHMsYj1oLmxlbmd0aCxrLGQ9dGhpcy5vcHRpb25zLmlnbm9yZUhpZGRlblBvaW50O2ZvcihhPTA7YTxiO2ErKylrPWhbYV0sMD5rLnkmJihrLnk9bnVsbCksZSs9ZCYmIWsudmlzaWJsZT8wOmsueTt0aGlzLnRvdGFsPWU7Zm9yKGE9MDthPGI7YSsrKWs9aFthXSxrLnBlcmNlbnRhZ2U9MDxlJiYoay52aXNpYmxlfHwhZCk/ay55L2UqMTAwOjAsay50b3RhbD1lfSxnZW5lcmF0ZVBvaW50czpmdW5jdGlvbigpe2wucHJvdG90eXBlLmdlbmVyYXRlUG9pbnRzLmNhbGwodGhpcyk7dGhpcy51cGRhdGVUb3RhbHMoKX0sdHJhbnNsYXRlOmZ1bmN0aW9uKGEpe3RoaXMuZ2VuZXJhdGVQb2ludHMoKTt2YXIgYz0wLGU9dGhpcy5vcHRpb25zLGI9ZS5zbGljZWRPZmZzZXQsaD1iKyhlLmJvcmRlcldpZHRofHwwKSxkLGssbCx2PWUuc3RhcnRBbmdsZXx8MCxmPXRoaXMuc3RhcnRBbmdsZVJhZD1NYXRoLlBJLzE4MCoodi05MCksdj0odGhpcy5lbmRBbmdsZVJhZD1NYXRoLlBJLw0KICAgICAgICAgICAgMTgwKihuKGUuZW5kQW5nbGUsdiszNjApLTkwKSktZix0PXRoaXMucG9pbnRzLHU9ZS5kYXRhTGFiZWxzLmRpc3RhbmNlLGU9ZS5pZ25vcmVIaWRkZW5Qb2ludCxGLHE9dC5sZW5ndGgseDthfHwodGhpcy5jZW50ZXI9YT10aGlzLmdldENlbnRlcigpKTt0aGlzLmdldFg9ZnVuY3Rpb24oYixjKXtsPU1hdGguYXNpbihNYXRoLm1pbigoYi1hWzFdKS8oYVsyXS8yK3UpLDEpKTtyZXR1cm4gYVswXSsoYz8tMToxKSpNYXRoLmNvcyhsKSooYVsyXS8yK3UpfTtmb3IoRj0wO0Y8cTtGKyspe3g9dFtGXTtkPWYrYyp2O2lmKCFlfHx4LnZpc2libGUpYys9eC5wZXJjZW50YWdlLzEwMDtrPWYrYyp2O3guc2hhcGVUeXBlPSJhcmMiO3guc2hhcGVBcmdzPXt4OmFbMF0seTphWzFdLHI6YVsyXS8yLGlubmVyUjphWzNdLzIsc3RhcnQ6TWF0aC5yb3VuZCgxRTMqZCkvMUUzLGVuZDpNYXRoLnJvdW5kKDFFMyprKS8xRTN9O2w9KGsrZCkvMjtsPjEuNSpNYXRoLlBJP2wtPTIqTWF0aC5QSTpsPC1NYXRoLlBJLw0KICAgICAgICAyJiYobCs9MipNYXRoLlBJKTt4LnNsaWNlZFRyYW5zbGF0aW9uPXt0cmFuc2xhdGVYOk1hdGgucm91bmQoTWF0aC5jb3MobCkqYiksdHJhbnNsYXRlWTpNYXRoLnJvdW5kKE1hdGguc2luKGwpKmIpfTtkPU1hdGguY29zKGwpKmFbMl0vMjtrPU1hdGguc2luKGwpKmFbMl0vMjt4LnRvb2x0aXBQb3M9W2FbMF0rLjcqZCxhWzFdKy43KmtdO3guaGFsZj1sPC1NYXRoLlBJLzJ8fGw+TWF0aC5QSS8yPzE6MDt4LmFuZ2xlPWw7aD1NYXRoLm1pbihoLHUvNSk7eC5sYWJlbFBvcz1bYVswXStkK01hdGguY29zKGwpKnUsYVsxXStrK01hdGguc2luKGwpKnUsYVswXStkK01hdGguY29zKGwpKmgsYVsxXStrK01hdGguc2luKGwpKmgsYVswXStkLGFbMV0raywwPnU/ImNlbnRlciI6eC5oYWxmPyJyaWdodCI6ImxlZnQiLGxdfX0sZHJhd0dyYXBoOm51bGwsZHJhd1BvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMsZT1hLmNoYXJ0LnJlbmRlcmVyLGgsYixrLGQsbD1hLm9wdGlvbnMuc2hhZG93O2wmJg0KICAgICFhLnNoYWRvd0dyb3VwJiYoYS5zaGFkb3dHcm91cD1lLmcoInNoYWRvdyIpLmFkZChhLmdyb3VwKSk7QyhhLnBvaW50cyxmdW5jdGlvbihjKXtpZihudWxsIT09Yy55KXtiPWMuZ3JhcGhpYztkPWMuc2hhcGVBcmdzO2g9Yy5nZXRUcmFuc2xhdGUoKTt2YXIgbT1jLnNoYWRvd0dyb3VwO2wmJiFtJiYobT1jLnNoYWRvd0dyb3VwPWUuZygic2hhZG93IikuYWRkKGEuc2hhZG93R3JvdXApKTttJiZtLmF0dHIoaCk7az1hLnBvaW50QXR0cmlicyhjLGMuc2VsZWN0ZWQmJiJzZWxlY3QiKTtiP2Iuc2V0UmFkaWFsUmVmZXJlbmNlKGEuY2VudGVyKS5hdHRyKGspLmFuaW1hdGUoRShkLGgpKTooYy5ncmFwaGljPWI9ZVtjLnNoYXBlVHlwZV0oZCkuc2V0UmFkaWFsUmVmZXJlbmNlKGEuY2VudGVyKS5hdHRyKGgpLmFkZChhLmdyb3VwKSxjLnZpc2libGV8fGIuYXR0cih7dmlzaWJpbGl0eToiaGlkZGVuIn0pLGIuYXR0cihrKS5hdHRyKHsic3Ryb2tlLWxpbmVqb2luIjoicm91bmQifSkuc2hhZG93KGwsDQogICAgICAgICAgICBtKSk7Yi5hZGRDbGFzcyhjLmdldENsYXNzTmFtZSgpKX19KX0sc2VhcmNoUG9pbnQ6aCxzb3J0QnlBbmdsZTpmdW5jdGlvbihhLGUpe2Euc29ydChmdW5jdGlvbihhLGIpe3JldHVybiB2b2lkIDAhPT1hLmFuZ2xlJiYoYi5hbmdsZS1hLmFuZ2xlKSplfSl9LGRyYXdMZWdlbmRTeW1ib2w6YS5MZWdlbmRTeW1ib2xNaXhpbi5kcmF3UmVjdGFuZ2xlLGdldENlbnRlcjphLkNlbnRlcmVkU2VyaWVzTWl4aW4uZ2V0Q2VudGVyLGdldFN5bWJvbDpofSx7aW5pdDpmdW5jdGlvbigpe3QucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBhPXRoaXMsZTthLm5hbWU9bihhLm5hbWUsIlNsaWNlIik7ZT1mdW5jdGlvbihjKXthLnNsaWNlKCJzZWxlY3QiPT09Yy50eXBlKX07QihhLCJzZWxlY3QiLGUpO0IoYSwidW5zZWxlY3QiLGUpO3JldHVybiBhfSxzZXRWaXNpYmxlOmZ1bmN0aW9uKGEsZSl7dmFyIGM9dGhpcyxiPWMuc2VyaWVzLGg9Yi5jaGFydCxkPWIub3B0aW9ucy5pZ25vcmVIaWRkZW5Qb2ludDsNCiAgICAgICAgZT1uKGUsZCk7YSE9PWMudmlzaWJsZSYmKGMudmlzaWJsZT1jLm9wdGlvbnMudmlzaWJsZT1hPXZvaWQgMD09PWE/IWMudmlzaWJsZTphLGIub3B0aW9ucy5kYXRhW3UoYyxiLmRhdGEpXT1jLm9wdGlvbnMsQyhbImdyYXBoaWMiLCJkYXRhTGFiZWwiLCJjb25uZWN0b3IiLCJzaGFkb3dHcm91cCJdLGZ1bmN0aW9uKGIpe2lmKGNbYl0pY1tiXVthPyJzaG93IjoiaGlkZSJdKCEwKX0pLGMubGVnZW5kSXRlbSYmaC5sZWdlbmQuY29sb3JpemVJdGVtKGMsYSksYXx8ImhvdmVyIiE9PWMuc3RhdGV8fGMuc2V0U3RhdGUoIiIpLGQmJihiLmlzRGlydHk9ITApLGUmJmgucmVkcmF3KCkpfSxzbGljZTpmdW5jdGlvbihhLGgsayl7dmFyIGI9dGhpcy5zZXJpZXM7ZShrLGIuY2hhcnQpO24oaCwhMCk7dGhpcy5zbGljZWQ9dGhpcy5vcHRpb25zLnNsaWNlZD16KGEpP2E6IXRoaXMuc2xpY2VkO2Iub3B0aW9ucy5kYXRhW3UodGhpcyxiLmRhdGEpXT10aGlzLm9wdGlvbnM7dGhpcy5ncmFwaGljLmFuaW1hdGUodGhpcy5nZXRUcmFuc2xhdGUoKSk7DQogICAgICAgIHRoaXMuc2hhZG93R3JvdXAmJnRoaXMuc2hhZG93R3JvdXAuYW5pbWF0ZSh0aGlzLmdldFRyYW5zbGF0ZSgpKX0sZ2V0VHJhbnNsYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2xpY2VkP3RoaXMuc2xpY2VkVHJhbnNsYXRpb246e3RyYW5zbGF0ZVg6MCx0cmFuc2xhdGVZOjB9fSxoYWxvUGF0aDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLnNoYXBlQXJncztyZXR1cm4gdGhpcy5zbGljZWR8fCF0aGlzLnZpc2libGU/W106dGhpcy5zZXJpZXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmMoYy54LGMueSxjLnIrYSxjLnIrYSx7aW5uZXJSOnRoaXMuc2hhcGVBcmdzLnIsc3RhcnQ6Yy5zdGFydCxlbmQ6Yy5lbmR9KX19KX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmFkZEV2ZW50LHo9YS5hcnJheU1heCxDPWEuZGVmaW5lZCxFPWEuZWFjaCx1PWEuZXh0ZW5kLGg9YS5mb3JtYXQsbj1hLm1hcCx0PWEubWVyZ2UsbD1hLm5vb3Asaz1hLnBpY2ssZT1hLnJlbGF0aXZlTGVuZ3RoLGM9YS5TZXJpZXMsDQogICAgICAgIHA9YS5zZXJpZXNUeXBlcyxIPWEuc3RhYmxlU29ydDthLmRpc3RyaWJ1dGU9ZnVuY3Rpb24oYSxjKXtmdW5jdGlvbiBiKGEsYil7cmV0dXJuIGEudGFyZ2V0LWIudGFyZ2V0fXZhciBlLGg9ITAsaz1hLGY9W10sbDtsPTA7Zm9yKGU9YS5sZW5ndGg7ZS0tOylsKz1hW2VdLnNpemU7aWYobD5jKXtIKGEsZnVuY3Rpb24oYSxiKXtyZXR1cm4oYi5yYW5rfHwwKS0oYS5yYW5rfHwwKX0pO2ZvcihsPWU9MDtsPD1jOylsKz1hW2VdLnNpemUsZSsrO2Y9YS5zcGxpY2UoZS0xLGEubGVuZ3RoKX1IKGEsYik7Zm9yKGE9bihhLGZ1bmN0aW9uKGEpe3JldHVybntzaXplOmEuc2l6ZSx0YXJnZXRzOlthLnRhcmdldF19fSk7aDspe2ZvcihlPWEubGVuZ3RoO2UtLTspaD1hW2VdLGw9KE1hdGgubWluLmFwcGx5KDAsaC50YXJnZXRzKStNYXRoLm1heC5hcHBseSgwLGgudGFyZ2V0cykpLzIsaC5wb3M9TWF0aC5taW4oTWF0aC5tYXgoMCxsLWguc2l6ZS8yKSxjLWguc2l6ZSk7ZT1hLmxlbmd0aDtmb3IoaD0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgITE7ZS0tOykwPGUmJmFbZS0xXS5wb3MrYVtlLTFdLnNpemU+YVtlXS5wb3MmJihhW2UtMV0uc2l6ZSs9YVtlXS5zaXplLGFbZS0xXS50YXJnZXRzPWFbZS0xXS50YXJnZXRzLmNvbmNhdChhW2VdLnRhcmdldHMpLGFbZS0xXS5wb3MrYVtlLTFdLnNpemU+YyYmKGFbZS0xXS5wb3M9Yy1hW2UtMV0uc2l6ZSksYS5zcGxpY2UoZSwxKSxoPSEwKX1lPTA7RShhLGZ1bmN0aW9uKGEpe3ZhciBiPTA7RShhLnRhcmdldHMsZnVuY3Rpb24oKXtrW2VdLnBvcz1hLnBvcytiO2IrPWtbZV0uc2l6ZTtlKyt9KX0pO2sucHVzaC5hcHBseShrLGYpO0goayxiKX07Yy5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGM9YS5vcHRpb25zLGQ9Yy5kYXRhTGFiZWxzLGU9YS5wb2ludHMsbCxuLGY9YS5oYXNSZW5kZXJlZHx8MCxwLHUsRj1rKGQuZGVmZXIsITApLHE9YS5jaGFydC5yZW5kZXJlcjtpZihkLmVuYWJsZWR8fGEuX2hhc1BvaW50TGFiZWxzKWEuZGxQcm9jZXNzT3B0aW9ucyYmDQogICAgYS5kbFByb2Nlc3NPcHRpb25zKGQpLHU9YS5wbG90R3JvdXAoImRhdGFMYWJlbHNHcm91cCIsImRhdGEtbGFiZWxzIixGJiYhZj8iaGlkZGVuIjoidmlzaWJsZSIsZC56SW5kZXh8fDYpLEYmJih1LmF0dHIoe29wYWNpdHk6K2Z9KSxmfHxCKGEsImFmdGVyQW5pbWF0ZSIsZnVuY3Rpb24oKXthLnZpc2libGUmJnUuc2hvdyghMCk7dVtjLmFuaW1hdGlvbj8iYW5pbWF0ZSI6ImF0dHIiXSh7b3BhY2l0eToxfSx7ZHVyYXRpb246MjAwfSl9KSksbj1kLEUoZSxmdW5jdGlvbihiKXt2YXIgZixlPWIuZGF0YUxhYmVsLG0sZyxyLHY9Yi5jb25uZWN0b3IseT0hZSx4O2w9Yi5kbE9wdGlvbnN8fGIub3B0aW9ucyYmYi5vcHRpb25zLmRhdGFMYWJlbHM7aWYoZj1rKGwmJmwuZW5hYmxlZCxuLmVuYWJsZWQpJiZudWxsIT09Yi55KWZvcihnIGluIGQ9dChuLGwpLG09Yi5nZXRMYWJlbENvbmZpZygpLHA9ZC5mb3JtYXQ/aChkLmZvcm1hdCxtKTpkLmZvcm1hdHRlci5jYWxsKG0sZCkseD1kLnN0eWxlLA0KICAgICAgICByPWQucm90YXRpb24seC5jb2xvcj1rKGQuY29sb3IseC5jb2xvcixhLmNvbG9yLCIjMDAwMDAwIiksImNvbnRyYXN0Ij09PXguY29sb3ImJih4LmNvbG9yPWQuaW5zaWRlfHwwPmQuZGlzdGFuY2V8fGMuc3RhY2tpbmc/cS5nZXRDb250cmFzdChiLmNvbG9yfHxhLmNvbG9yKToiIzAwMDAwMCIpLGMuY3Vyc29yJiYoeC5jdXJzb3I9Yy5jdXJzb3IpLG09e2ZpbGw6ZC5iYWNrZ3JvdW5kQ29sb3Isc3Ryb2tlOmQuYm9yZGVyQ29sb3IsInN0cm9rZS13aWR0aCI6ZC5ib3JkZXJXaWR0aCxyOmQuYm9yZGVyUmFkaXVzfHwwLHJvdGF0aW9uOnIscGFkZGluZzpkLnBhZGRpbmcsekluZGV4OjF9LG0pdm9pZCAwPT09bVtnXSYmZGVsZXRlIG1bZ107IWV8fGYmJkMocCk/ZiYmQyhwKSYmKGU/bS50ZXh0PXA6KGU9Yi5kYXRhTGFiZWw9cVtyPyJ0ZXh0IjoibGFiZWwiXShwLDAsLTk5OTksZC5zaGFwZSxudWxsLG51bGwsZC51c2VIVE1MLG51bGwsImRhdGEtbGFiZWwiKSxlLmFkZENsYXNzKCJoaWdoY2hhcnRzLWRhdGEtbGFiZWwtY29sb3ItIisNCiAgICAgICAgICAgICAgICBiLmNvbG9ySW5kZXgrIiAiKyhkLmNsYXNzTmFtZXx8IiIpKyhkLnVzZUhUTUw/ImhpZ2hjaGFydHMtdHJhY2tlciI6IiIpKSksZS5hdHRyKG0pLGUuY3NzKHgpLnNoYWRvdyhkLnNoYWRvdyksZS5hZGRlZHx8ZS5hZGQodSksYS5hbGlnbkRhdGFMYWJlbChiLGUsZCxudWxsLHkpKTooYi5kYXRhTGFiZWw9ZS5kZXN0cm95KCksdiYmKGIuY29ubmVjdG9yPXYuZGVzdHJveSgpKSl9KX07Yy5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWw9ZnVuY3Rpb24oYSxjLGQsZSxoKXt2YXIgYj10aGlzLmNoYXJ0LGY9Yi5pbnZlcnRlZCxsPWsoYS5wbG90WCwtOTk5OSksbT1rKGEucGxvdFksLTk5OTkpLG49Yy5nZXRCQm94KCkscSxwPWQucm90YXRpb24scj1kLmFsaWduLHQ9dGhpcy52aXNpYmxlJiYoYS5zZXJpZXMuZm9yY2VETHx8Yi5pc0luc2lkZVBsb3QobCxNYXRoLnJvdW5kKG0pLGYpfHxlJiZiLmlzSW5zaWRlUGxvdChsLGY/ZS54KzE6ZS55K2UuaGVpZ2h0LTEsZikpLEE9Imp1c3RpZnkiPT09DQogICAgICAgIGsoZC5vdmVyZmxvdywianVzdGlmeSIpO3QmJihxPWQuc3R5bGUuZm9udFNpemUscT1iLnJlbmRlcmVyLmZvbnRNZXRyaWNzKHEsYykuYixlPXUoe3g6Zj9iLnBsb3RXaWR0aC1tOmwseTpNYXRoLnJvdW5kKGY/Yi5wbG90SGVpZ2h0LWw6bSksd2lkdGg6MCxoZWlnaHQ6MH0sZSksdShkLHt3aWR0aDpuLndpZHRoLGhlaWdodDpuLmhlaWdodH0pLHA/KEE9ITEsZj1iLnJlbmRlcmVyLnJvdENvcnIocSxwKSxmPXt4OmUueCtkLngrZS53aWR0aC8yK2YueCx5OmUueStkLnkre3RvcDowLG1pZGRsZTouNSxib3R0b206MX1bZC52ZXJ0aWNhbEFsaWduXSplLmhlaWdodH0sY1toPyJhdHRyIjoiYW5pbWF0ZSJdKGYpLmF0dHIoe2FsaWduOnJ9KSxsPShwKzcyMCklMzYwLGw9MTgwPGwmJjM2MD5sLCJsZWZ0Ij09PXI/Zi55LT1sP24uaGVpZ2h0OjA6ImNlbnRlciI9PT1yPyhmLngtPW4ud2lkdGgvMixmLnktPW4uaGVpZ2h0LzIpOiJyaWdodCI9PT1yJiYoZi54LT1uLndpZHRoLGYueS09bD8wOg0KICAgICAgICAgICAgICAgICAgICBuLmhlaWdodCkpOihjLmFsaWduKGQsbnVsbCxlKSxmPWMuYWxpZ25BdHRyKSxBP3RoaXMuanVzdGlmeURhdGFMYWJlbChjLGQsZixuLGUsaCk6ayhkLmNyb3AsITApJiYodD1iLmlzSW5zaWRlUGxvdChmLngsZi55KSYmYi5pc0luc2lkZVBsb3QoZi54K24ud2lkdGgsZi55K24uaGVpZ2h0KSksZC5zaGFwZSYmIXAmJmMuYXR0cih7YW5jaG9yWDphLnBsb3RYLGFuY2hvclk6YS5wbG90WX0pKTt0fHwoYy5hdHRyKHt5Oi05OTk5fSksYy5wbGFjZWQ9ITEpfTtjLnByb3RvdHlwZS5qdXN0aWZ5RGF0YUxhYmVsPWZ1bmN0aW9uKGEsYyxkLGUsaCxrKXt2YXIgYj10aGlzLmNoYXJ0LGw9Yy5hbGlnbixtPWMudmVydGljYWxBbGlnbixuLHEscD1hLmJveD8wOmEucGFkZGluZ3x8MDtuPWQueCtwOzA+biYmKCJyaWdodCI9PT1sP2MuYWxpZ249ImxlZnQiOmMueD0tbixxPSEwKTtuPWQueCtlLndpZHRoLXA7bj5iLnBsb3RXaWR0aCYmKCJsZWZ0Ij09PWw/Yy5hbGlnbj0icmlnaHQiOmMueD1iLnBsb3RXaWR0aC0NCiAgICAgICAgICAgIG4scT0hMCk7bj1kLnkrcDswPm4mJigiYm90dG9tIj09PW0/Yy52ZXJ0aWNhbEFsaWduPSJ0b3AiOmMueT0tbixxPSEwKTtuPWQueStlLmhlaWdodC1wO24+Yi5wbG90SGVpZ2h0JiYoInRvcCI9PT1tP2MudmVydGljYWxBbGlnbj0iYm90dG9tIjpjLnk9Yi5wbG90SGVpZ2h0LW4scT0hMCk7cSYmKGEucGxhY2VkPSFrLGEuYWxpZ24oYyxudWxsLGgpKX07cC5waWUmJihwLnBpZS5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHM9ZnVuY3Rpb24oKXt2YXIgYj10aGlzLGU9Yi5kYXRhLGQsaD1iLmNoYXJ0LGw9Yi5vcHRpb25zLmRhdGFMYWJlbHMscD1rKGwuY29ubmVjdG9yUGFkZGluZywxMCksZj1rKGwuY29ubmVjdG9yV2lkdGgsMSksdD1oLnBsb3RXaWR0aCx1PWgucGxvdEhlaWdodCxGLHE9bC5kaXN0YW5jZSx4PWIuY2VudGVyLEI9eFsyXS8yLEM9eFsxXSxIPTA8cSxnLEQsSSxNLFI9W1tdLFtdXSxOLHcsTyxRLFA9WzAsMCwwLDBdO2IudmlzaWJsZSYmKGwuZW5hYmxlZHx8Yi5faGFzUG9pbnRMYWJlbHMpJiYNCiAgICAoRShlLGZ1bmN0aW9uKGEpe2EuZGF0YUxhYmVsJiZhLnZpc2libGUmJmEuZGF0YUxhYmVsLnNob3J0ZW5lZCYmKGEuZGF0YUxhYmVsLmF0dHIoe3dpZHRoOiJhdXRvIn0pLmNzcyh7d2lkdGg6ImF1dG8iLHRleHRPdmVyZmxvdzoiY2xpcCJ9KSxhLmRhdGFMYWJlbC5zaG9ydGVuZWQ9ITEpfSksYy5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHMuYXBwbHkoYiksRShlLGZ1bmN0aW9uKGEpe2EuZGF0YUxhYmVsJiZhLnZpc2libGUmJihSW2EuaGFsZl0ucHVzaChhKSxhLmRhdGFMYWJlbC5fcG9zPW51bGwpfSksRShSLGZ1bmN0aW9uKGMsZil7dmFyIGUsayxtPWMubGVuZ3RoLHIsdix5O2lmKG0pZm9yKGIuc29ydEJ5QW5nbGUoYyxmLS41KSwwPHEmJihlPU1hdGgubWF4KDAsQy1CLXEpLGs9TWF0aC5taW4oQytCK3EsaC5wbG90SGVpZ2h0KSxyPW4oYyxmdW5jdGlvbihhKXtpZihhLmRhdGFMYWJlbClyZXR1cm4geT1hLmRhdGFMYWJlbC5nZXRCQm94KCkuaGVpZ2h0fHwyMSx7dGFyZ2V0OmEubGFiZWxQb3NbMV0tDQogICAgZSt5LzIsc2l6ZTp5LHJhbms6YS55fX0pLGEuZGlzdHJpYnV0ZShyLGsreS1lKSksUT0wO1E8bTtRKyspZD1jW1FdLEk9ZC5sYWJlbFBvcyxnPWQuZGF0YUxhYmVsLE89ITE9PT1kLnZpc2libGU/ImhpZGRlbiI6ImluaGVyaXQiLHY9SVsxXSxyP3ZvaWQgMD09PXJbUV0ucG9zP089ImhpZGRlbiI6KE09cltRXS5zaXplLHc9ZStyW1FdLnBvcyk6dz12LE49bC5qdXN0aWZ5P3hbMF0rKGY/LTE6MSkqKEIrcSk6Yi5nZXRYKHc8ZSsyfHx3PmstMj92OncsZiksZy5fYXR0cj17dmlzaWJpbGl0eTpPLGFsaWduOklbNl19LGcuX3Bvcz17eDpOK2wueCsoe2xlZnQ6cCxyaWdodDotcH1bSVs2XV18fDApLHk6dytsLnktMTB9LEkueD1OLEkueT13LG51bGw9PT1iLm9wdGlvbnMuc2l6ZSYmKEQ9Zy5nZXRCQm94KCkud2lkdGgsdj1udWxsLE4tRDxwPyh2PU1hdGgucm91bmQoRC1OK3ApLFBbM109TWF0aC5tYXgodixQWzNdKSk6TitEPnQtcCYmKHY9TWF0aC5yb3VuZChOK0QtdCtwKSxQWzFdPU1hdGgubWF4KHYsDQogICAgICAgICAgICBQWzFdKSksMD53LU0vMj9QWzBdPU1hdGgubWF4KE1hdGgucm91bmQoLXcrTS8yKSxQWzBdKTp3K00vMj51JiYoUFsyXT1NYXRoLm1heChNYXRoLnJvdW5kKHcrTS8yLXUpLFBbMl0pKSxnLnNpZGVPdmVyZmxvdz12KX0pLDA9PT16KFApfHx0aGlzLnZlcmlmeURhdGFMYWJlbE92ZXJmbG93KFApKSYmKHRoaXMucGxhY2VEYXRhTGFiZWxzKCksSCYmZiYmRSh0aGlzLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgYztGPWEuY29ubmVjdG9yO2lmKChnPWEuZGF0YUxhYmVsKSYmZy5fcG9zJiZhLnZpc2libGUpe089Zy5fYXR0ci52aXNpYmlsaXR5O2lmKGM9IUYpYS5jb25uZWN0b3I9Rj1oLnJlbmRlcmVyLnBhdGgoKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1kYXRhLWxhYmVsLWNvbm5lY3RvciBoaWdoY2hhcnRzLWNvbG9yLSIrYS5jb2xvckluZGV4KS5hZGQoYi5kYXRhTGFiZWxzR3JvdXApLEYuYXR0cih7InN0cm9rZS13aWR0aCI6ZixzdHJva2U6bC5jb25uZWN0b3JDb2xvcnx8YS5jb2xvcnx8DQogICAgIiM2NjY2NjYifSk7RltjPyJhdHRyIjoiYW5pbWF0ZSJdKHtkOmIuY29ubmVjdG9yUGF0aChhLmxhYmVsUG9zKX0pO0YuYXR0cigidmlzaWJpbGl0eSIsTyl9ZWxzZSBGJiYoYS5jb25uZWN0b3I9Ri5kZXN0cm95KCkpfSkpfSxwLnBpZS5wcm90b3R5cGUuY29ubmVjdG9yUGF0aD1mdW5jdGlvbihhKXt2YXIgYj1hLngsYz1hLnk7cmV0dXJuIGsodGhpcy5vcHRpb25zLmRhdGFMYWJlbHMuc29mdENvbm5lY3RvciwhMCk/WyJNIixiKygibGVmdCI9PT1hWzZdPzU6LTUpLGMsIkMiLGIsYywyKmFbMl0tYVs0XSwyKmFbM10tYVs1XSxhWzJdLGFbM10sIkwiLGFbNF0sYVs1XV06WyJNIixiKygibGVmdCI9PT1hWzZdPzU6LTUpLGMsIkwiLGFbMl0sYVszXSwiTCIsYVs0XSxhWzVdXX0scC5waWUucHJvdG90eXBlLnBsYWNlRGF0YUxhYmVscz1mdW5jdGlvbigpe0UodGhpcy5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGI9YS5kYXRhTGFiZWw7YiYmYS52aXNpYmxlJiYoKGE9Yi5fcG9zKT8oYi5zaWRlT3ZlcmZsb3cmJg0KICAgICAgICAoYi5fYXR0ci53aWR0aD1iLmdldEJCb3goKS53aWR0aC1iLnNpZGVPdmVyZmxvdyxiLmNzcyh7d2lkdGg6Yi5fYXR0ci53aWR0aCsicHgiLHRleHRPdmVyZmxvdzoiZWxsaXBzaXMifSksYi5zaG9ydGVuZWQ9ITApLGIuYXR0cihiLl9hdHRyKSxiW2IubW92ZWQ/ImFuaW1hdGUiOiJhdHRyIl0oYSksYi5tb3ZlZD0hMCk6YiYmYi5hdHRyKHt5Oi05OTk5fSkpfSx0aGlzKX0scC5waWUucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsPWwscC5waWUucHJvdG90eXBlLnZlcmlmeURhdGFMYWJlbE92ZXJmbG93PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY2VudGVyLGM9dGhpcy5vcHRpb25zLGg9Yy5jZW50ZXIsaz1jLm1pblNpemV8fDgwLGwsZjtudWxsIT09aFswXT9sPU1hdGgubWF4KGJbMl0tTWF0aC5tYXgoYVsxXSxhWzNdKSxrKToobD1NYXRoLm1heChiWzJdLWFbMV0tYVszXSxrKSxiWzBdKz0oYVszXS1hWzFdKS8yKTtudWxsIT09aFsxXT9sPU1hdGgubWF4KE1hdGgubWluKGwsYlsyXS0NCiAgICAgICAgICAgIE1hdGgubWF4KGFbMF0sYVsyXSkpLGspOihsPU1hdGgubWF4KE1hdGgubWluKGwsYlsyXS1hWzBdLWFbMl0pLGspLGJbMV0rPShhWzBdLWFbMl0pLzIpO2w8YlsyXT8oYlsyXT1sLGJbM109TWF0aC5taW4oZShjLmlubmVyU2l6ZXx8MCxsKSxsKSx0aGlzLnRyYW5zbGF0ZShiKSx0aGlzLmRyYXdEYXRhTGFiZWxzJiZ0aGlzLmRyYXdEYXRhTGFiZWxzKCkpOmY9ITA7cmV0dXJuIGZ9KTtwLmNvbHVtbiYmKHAuY29sdW1uLnByb3RvdHlwZS5hbGlnbkRhdGFMYWJlbD1mdW5jdGlvbihhLGUsZCxoLGwpe3ZhciBiPXRoaXMuY2hhcnQuaW52ZXJ0ZWQsZj1hLnNlcmllcyxtPWEuZGxCb3h8fGEuc2hhcGVBcmdzLG49ayhhLmJlbG93LGEucGxvdFk+ayh0aGlzLnRyYW5zbGF0ZWRUaHJlc2hvbGQsZi55QXhpcy5sZW4pKSxwPWsoZC5pbnNpZGUsISF0aGlzLm9wdGlvbnMuc3RhY2tpbmcpO20mJihoPXQobSksMD5oLnkmJihoLmhlaWdodCs9aC55LGgueT0wKSxtPWgueStoLmhlaWdodC1mLnlBeGlzLmxlbiwNCiAgICAwPG0mJihoLmhlaWdodC09bSksYiYmKGg9e3g6Zi55QXhpcy5sZW4taC55LWguaGVpZ2h0LHk6Zi54QXhpcy5sZW4taC54LWgud2lkdGgsd2lkdGg6aC5oZWlnaHQsaGVpZ2h0Omgud2lkdGh9KSxwfHwoYj8oaC54Kz1uPzA6aC53aWR0aCxoLndpZHRoPTApOihoLnkrPW4/aC5oZWlnaHQ6MCxoLmhlaWdodD0wKSkpO2QuYWxpZ249ayhkLmFsaWduLCFifHxwPyJjZW50ZXIiOm4/InJpZ2h0IjoibGVmdCIpO2QudmVydGljYWxBbGlnbj1rKGQudmVydGljYWxBbGlnbixifHxwPyJtaWRkbGUiOm4/InRvcCI6ImJvdHRvbSIpO2MucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsLmNhbGwodGhpcyxhLGUsZCxoLGwpfSl9KShJKTsoZnVuY3Rpb24oYSl7dmFyIEI9YS5DaGFydCx6PWEuZWFjaCxDPWEucGljayxFPWEuYWRkRXZlbnQ7Qi5wcm90b3R5cGUuY2FsbGJhY2tzLnB1c2goZnVuY3Rpb24oYSl7ZnVuY3Rpb24gaCgpe3ZhciBoPVtdO3ooYS5zZXJpZXN8fFtdLGZ1bmN0aW9uKGEpe3ZhciBsPQ0KICAgICAgICBhLm9wdGlvbnMuZGF0YUxhYmVscyxrPWEuZGF0YUxhYmVsQ29sbGVjdGlvbnN8fFsiZGF0YUxhYmVsIl07KGwuZW5hYmxlZHx8YS5faGFzUG9pbnRMYWJlbHMpJiYhbC5hbGxvd092ZXJsYXAmJmEudmlzaWJsZSYmeihrLGZ1bmN0aW9uKGUpe3ooYS5wb2ludHMsZnVuY3Rpb24oYSl7YVtlXSYmKGFbZV0ubGFiZWxyYW5rPUMoYS5sYWJlbHJhbmssYS5zaGFwZUFyZ3MmJmEuc2hhcGVBcmdzLmhlaWdodCksaC5wdXNoKGFbZV0pKX0pfSl9KTthLmhpZGVPdmVybGFwcGluZ0xhYmVscyhoKX1oKCk7RShhLCJyZWRyYXciLGgpfSk7Qi5wcm90b3R5cGUuaGlkZU92ZXJsYXBwaW5nTGFiZWxzPWZ1bmN0aW9uKGEpe3ZhciBoPWEubGVuZ3RoLG4sdCxsLGssZSxjLHAsdSxiLG09ZnVuY3Rpb24oYSxiLGMsZSxmLGgsayxsKXtyZXR1cm4hKGY+YStjfHxmK2s8YXx8aD5iK2V8fGgrbDxiKX07Zm9yKHQ9MDt0PGg7dCsrKWlmKG49YVt0XSluLm9sZE9wYWNpdHk9bi5vcGFjaXR5LG4ubmV3T3BhY2l0eT0NCiAgICAgICAgMTthLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4oYi5sYWJlbHJhbmt8fDApLShhLmxhYmVscmFua3x8MCl9KTtmb3IodD0wO3Q8aDt0KyspZm9yKGw9YVt0XSxuPXQrMTtuPGg7KytuKWlmKGs9YVtuXSxsJiZrJiZsLnBsYWNlZCYmay5wbGFjZWQmJjAhPT1sLm5ld09wYWNpdHkmJjAhPT1rLm5ld09wYWNpdHkmJihlPWwuYWxpZ25BdHRyLGM9ay5hbGlnbkF0dHIscD1sLnBhcmVudEdyb3VwLHU9ay5wYXJlbnRHcm91cCxiPTIqKGwuYm94PzA6bC5wYWRkaW5nKSxlPW0oZS54K3AudHJhbnNsYXRlWCxlLnkrcC50cmFuc2xhdGVZLGwud2lkdGgtYixsLmhlaWdodC1iLGMueCt1LnRyYW5zbGF0ZVgsYy55K3UudHJhbnNsYXRlWSxrLndpZHRoLWIsay5oZWlnaHQtYikpKShsLmxhYmVscmFuazxrLmxhYmVscmFuaz9sOmspLm5ld09wYWNpdHk9MDt6KGEsZnVuY3Rpb24oYSl7dmFyIGIsYzthJiYoYz1hLm5ld09wYWNpdHksYS5vbGRPcGFjaXR5IT09YyYmYS5wbGFjZWQmJihjP2Euc2hvdyghMCk6DQogICAgICAgIGI9ZnVuY3Rpb24oKXthLmhpZGUoKX0sYS5hbGlnbkF0dHIub3BhY2l0eT1jLGFbYS5pc09sZD8iYW5pbWF0ZSI6ImF0dHIiXShhLmFsaWduQXR0cixudWxsLGIpKSxhLmlzT2xkPSEwKX0pfX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLmFkZEV2ZW50LHo9YS5DaGFydCxDPWEuY3JlYXRlRWxlbWVudCxFPWEuY3NzLHU9YS5kZWZhdWx0T3B0aW9ucyxoPWEuZGVmYXVsdFBsb3RPcHRpb25zLG49YS5lYWNoLHQ9YS5leHRlbmQsbD1hLmZpcmVFdmVudCxrPWEuaGFzVG91Y2gsZT1hLmluQXJyYXksYz1hLmlzT2JqZWN0LHA9YS5MZWdlbmQsSD1hLm1lcmdlLGI9YS5waWNrLG09YS5Qb2ludCxkPWEuU2VyaWVzLHI9YS5zZXJpZXNUeXBlcyxBPWEuc3ZnO2E9YS5UcmFja2VyTWl4aW49e2RyYXdUcmFja2VyUG9pbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9YS5jaGFydC5wb2ludGVyLGM9ZnVuY3Rpb24oYSl7dmFyIGM9Yi5nZXRQb2ludEZyb21FdmVudChhKTtpZih2b2lkIDAhPT1jKWMub25Nb3VzZU92ZXIoYSl9Ow0KICAgICAgICBuKGEucG9pbnRzLGZ1bmN0aW9uKGEpe2EuZ3JhcGhpYyYmKGEuZ3JhcGhpYy5lbGVtZW50LnBvaW50PWEpO2EuZGF0YUxhYmVsJiYoYS5kYXRhTGFiZWwuZGl2P2EuZGF0YUxhYmVsLmRpdi5wb2ludD1hOmEuZGF0YUxhYmVsLmVsZW1lbnQucG9pbnQ9YSl9KTthLl9oYXNUcmFja2luZ3x8KG4oYS50cmFja2VyR3JvdXBzLGZ1bmN0aW9uKGQpe2lmKGFbZF0pe2FbZF0uYWRkQ2xhc3MoImhpZ2hjaGFydHMtdHJhY2tlciIpLm9uKCJtb3VzZW92ZXIiLGMpLm9uKCJtb3VzZW91dCIsZnVuY3Rpb24oYSl7Yi5vblRyYWNrZXJNb3VzZU91dChhKX0pO2lmKGspYVtkXS5vbigidG91Y2hzdGFydCIsYyk7YS5vcHRpb25zLmN1cnNvciYmYVtkXS5jc3MoRSkuY3NzKHtjdXJzb3I6YS5vcHRpb25zLmN1cnNvcn0pfX0pLGEuX2hhc1RyYWNraW5nPSEwKX0sZHJhd1RyYWNrZXJHcmFwaDpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLm9wdGlvbnMsYz1iLnRyYWNrQnlBcmVhLGQ9W10uY29uY2F0KGM/DQogICAgICAgIGEuYXJlYVBhdGg6YS5ncmFwaFBhdGgpLGU9ZC5sZW5ndGgsaD1hLmNoYXJ0LGw9aC5wb2ludGVyLG09aC5yZW5kZXJlcixwPWgub3B0aW9ucy50b29sdGlwLnNuYXAsdD1hLnRyYWNrZXIsZyxyPWZ1bmN0aW9uKCl7aWYoaC5ob3ZlclNlcmllcyE9PWEpYS5vbk1vdXNlT3ZlcigpfSx1PSJyZ2JhKDE5MiwxOTIsMTkyLCIrKEE/LjAwMDE6LjAwMikrIikiO2lmKGUmJiFjKWZvcihnPWUrMTtnLS07KSJNIj09PWRbZ10mJmQuc3BsaWNlKGcrMSwwLGRbZysxXS1wLGRbZysyXSwiTCIpLChnJiYiTSI9PT1kW2ddfHxnPT09ZSkmJmQuc3BsaWNlKGcsMCwiTCIsZFtnLTJdK3AsZFtnLTFdKTt0P3QuYXR0cih7ZDpkfSk6YS5ncmFwaCYmKGEudHJhY2tlcj1tLnBhdGgoZCkuYXR0cih7InN0cm9rZS1saW5lam9pbiI6InJvdW5kIix2aXNpYmlsaXR5OmEudmlzaWJsZT8idmlzaWJsZSI6ImhpZGRlbiIsc3Ryb2tlOnUsZmlsbDpjP3U6Im5vbmUiLCJzdHJva2Utd2lkdGgiOmEuZ3JhcGguc3Ryb2tlV2lkdGgoKSsNCiAgICAgICAgKGM/MDoyKnApLHpJbmRleDoyfSkuYWRkKGEuZ3JvdXApLG4oW2EudHJhY2tlcixhLm1hcmtlckdyb3VwXSxmdW5jdGlvbihhKXthLmFkZENsYXNzKCJoaWdoY2hhcnRzLXRyYWNrZXIiKS5vbigibW91c2VvdmVyIixyKS5vbigibW91c2VvdXQiLGZ1bmN0aW9uKGEpe2wub25UcmFja2VyTW91c2VPdXQoYSl9KTtiLmN1cnNvciYmYS5jc3Moe2N1cnNvcjpiLmN1cnNvcn0pO2lmKGspYS5vbigidG91Y2hzdGFydCIscil9KSl9fTtyLmNvbHVtbiYmKHIuY29sdW1uLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1hLmRyYXdUcmFja2VyUG9pbnQpO3IucGllJiYoci5waWUucHJvdG90eXBlLmRyYXdUcmFja2VyPWEuZHJhd1RyYWNrZXJQb2ludCk7ci5zY2F0dGVyJiYoci5zY2F0dGVyLnByb3RvdHlwZS5kcmF3VHJhY2tlcj1hLmRyYXdUcmFja2VyUG9pbnQpO3QocC5wcm90b3R5cGUse3NldEl0ZW1FdmVudHM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT1kLmNoYXJ0LnJlbmRlcmVyLmJveFdyYXBwZXIsDQogICAgICAgIGY9ImhpZ2hjaGFydHMtbGVnZW5kLSIrKGEuc2VyaWVzPyJwb2ludCI6InNlcmllcyIpKyItYWN0aXZlIjsoYz9iOmEubGVnZW5kR3JvdXApLm9uKCJtb3VzZW92ZXIiLGZ1bmN0aW9uKCl7YS5zZXRTdGF0ZSgiaG92ZXIiKTtlLmFkZENsYXNzKGYpO2IuY3NzKGQub3B0aW9ucy5pdGVtSG92ZXJTdHlsZSl9KS5vbigibW91c2VvdXQiLGZ1bmN0aW9uKCl7Yi5jc3MoYS52aXNpYmxlP2QuaXRlbVN0eWxlOmQuaXRlbUhpZGRlblN0eWxlKTtlLnJlbW92ZUNsYXNzKGYpO2Euc2V0U3RhdGUoKX0pLm9uKCJjbGljayIsZnVuY3Rpb24oYil7dmFyIGM9ZnVuY3Rpb24oKXthLnNldFZpc2libGUmJmEuc2V0VmlzaWJsZSgpfTtiPXticm93c2VyRXZlbnQ6Yn07YS5maXJlUG9pbnRFdmVudD9hLmZpcmVQb2ludEV2ZW50KCJsZWdlbmRJdGVtQ2xpY2siLGIsYyk6bChhLCJsZWdlbmRJdGVtQ2xpY2siLGIsYyl9KX0sY3JlYXRlQ2hlY2tib3hGb3JJdGVtOmZ1bmN0aW9uKGEpe2EuY2hlY2tib3g9QygiaW5wdXQiLA0KICAgICAgICB7dHlwZToiY2hlY2tib3giLGNoZWNrZWQ6YS5zZWxlY3RlZCxkZWZhdWx0Q2hlY2tlZDphLnNlbGVjdGVkfSx0aGlzLm9wdGlvbnMuaXRlbUNoZWNrYm94U3R5bGUsdGhpcy5jaGFydC5jb250YWluZXIpO0IoYS5jaGVja2JveCwiY2xpY2siLGZ1bmN0aW9uKGIpe2woYS5zZXJpZXN8fGEsImNoZWNrYm94Q2xpY2siLHtjaGVja2VkOmIudGFyZ2V0LmNoZWNrZWQsaXRlbTphfSxmdW5jdGlvbigpe2Euc2VsZWN0KCl9KX0pfX0pO3UubGVnZW5kLml0ZW1TdHlsZS5jdXJzb3I9InBvaW50ZXIiO3Qoei5wcm90b3R5cGUse3Nob3dSZXNldFpvb206ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGI9dS5sYW5nLGM9YS5vcHRpb25zLmNoYXJ0LnJlc2V0Wm9vbUJ1dHRvbixkPWMudGhlbWUsZT1kLnN0YXRlcyxoPSJjaGFydCI9PT1jLnJlbGF0aXZlVG8/bnVsbDoicGxvdEJveCI7dGhpcy5yZXNldFpvb21CdXR0b249YS5yZW5kZXJlci5idXR0b24oYi5yZXNldFpvb20sbnVsbCxudWxsLGZ1bmN0aW9uKCl7YS56b29tT3V0KCl9LA0KICAgICAgICBkLGUmJmUuaG92ZXIpLmF0dHIoe2FsaWduOmMucG9zaXRpb24uYWxpZ24sdGl0bGU6Yi5yZXNldFpvb21UaXRsZX0pLmFkZENsYXNzKCJoaWdoY2hhcnRzLXJlc2V0LXpvb20iKS5hZGQoKS5hbGlnbihjLnBvc2l0aW9uLCExLGgpfSx6b29tT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcztsKGEsInNlbGVjdGlvbiIse3Jlc2V0U2VsZWN0aW9uOiEwfSxmdW5jdGlvbigpe2Euem9vbSgpfSl9LHpvb206ZnVuY3Rpb24oYSl7dmFyIGQsZT10aGlzLnBvaW50ZXIsaD0hMSxrOyFhfHxhLnJlc2V0U2VsZWN0aW9uP24odGhpcy5heGVzLGZ1bmN0aW9uKGEpe2Q9YS56b29tKCl9KTpuKGEueEF4aXMuY29uY2F0KGEueUF4aXMpLGZ1bmN0aW9uKGEpe3ZhciBiPWEuYXhpcztlW2IuaXNYQXhpcz8iem9vbVgiOiJ6b29tWSJdJiYoZD1iLnpvb20oYS5taW4sYS5tYXgpLGIuZGlzcGxheUJ0biYmKGg9ITApKX0pO2s9dGhpcy5yZXNldFpvb21CdXR0b247aCYmIWs/dGhpcy5zaG93UmVzZXRab29tKCk6DQogICAgICAgICFoJiZjKGspJiYodGhpcy5yZXNldFpvb21CdXR0b249ay5kZXN0cm95KCkpO2QmJnRoaXMucmVkcmF3KGIodGhpcy5vcHRpb25zLmNoYXJ0LmFuaW1hdGlvbixhJiZhLmFuaW1hdGlvbiwxMDA+dGhpcy5wb2ludENvdW50KSl9LHBhbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD1jLmhvdmVyUG9pbnRzLGU7ZCYmbihkLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pO24oInh5Ij09PWI/WzEsMF06WzFdLGZ1bmN0aW9uKGIpe2I9Y1tiPyJ4QXhpcyI6InlBeGlzIl1bMF07dmFyIGQ9Yi5ob3JpeixmPWFbZD8iY2hhcnRYIjoiY2hhcnRZIl0sZD1kPyJtb3VzZURvd25YIjoibW91c2VEb3duWSIsaD1jW2RdLGs9KGIucG9pbnRSYW5nZXx8MCkvMixnPWIuZ2V0RXh0cmVtZXMoKSxsPWIudG9WYWx1ZShoLWYsITApK2ssaz1iLnRvVmFsdWUoaCtiLmxlbi1mLCEwKS1rLG09azxsLGg9bT9rOmwsbD1tP2w6ayxtPWIudG9WYWx1ZShiLnRvUGl4ZWxzKGcubWluKS1iLm1pblBpeGVsUGFkZGluZyksDQogICAgICAgIGs9Yi50b1ZhbHVlKGIudG9QaXhlbHMoZy5tYXgpK2IubWluUGl4ZWxQYWRkaW5nKSxtPU1hdGgubWluKGcuZGF0YU1pbixtKS1oLGc9bC1NYXRoLm1heChnLmRhdGFNYXgsayk7Yi5zZXJpZXMubGVuZ3RoJiYwPm0mJjA+ZyYmKGIuc2V0RXh0cmVtZXMoaCxsLCExLCExLHt0cmlnZ2VyOiJwYW4ifSksZT0hMCk7Y1tkXT1mfSk7ZSYmYy5yZWRyYXcoITEpO0UoYy5jb250YWluZXIse2N1cnNvcjoibW92ZSJ9KX19KTt0KG0ucHJvdG90eXBlLHtzZWxlY3Q6ZnVuY3Rpb24oYSxjKXt2YXIgZD10aGlzLGY9ZC5zZXJpZXMsaD1mLmNoYXJ0O2E9YihhLCFkLnNlbGVjdGVkKTtkLmZpcmVQb2ludEV2ZW50KGE/InNlbGVjdCI6InVuc2VsZWN0Iix7YWNjdW11bGF0ZTpjfSxmdW5jdGlvbigpe2Quc2VsZWN0ZWQ9ZC5vcHRpb25zLnNlbGVjdGVkPWE7Zi5vcHRpb25zLmRhdGFbZShkLGYuZGF0YSldPWQub3B0aW9ucztkLnNldFN0YXRlKGEmJiJzZWxlY3QiKTtjfHxuKGguZ2V0U2VsZWN0ZWRQb2ludHMoKSwNCiAgICAgICAgZnVuY3Rpb24oYSl7YS5zZWxlY3RlZCYmYSE9PWQmJihhLnNlbGVjdGVkPWEub3B0aW9ucy5zZWxlY3RlZD0hMSxmLm9wdGlvbnMuZGF0YVtlKGEsZi5kYXRhKV09YS5vcHRpb25zLGEuc2V0U3RhdGUoIiIpLGEuZmlyZVBvaW50RXZlbnQoInVuc2VsZWN0IikpfSl9KX0sb25Nb3VzZU92ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zZXJpZXMuY2hhcnQucG9pbnRlcjt0aGlzLmZpcmVQb2ludEV2ZW50KCJtb3VzZU92ZXIiKTtiLnJ1blBvaW50QWN0aW9ucyhhLHRoaXMpfSxvbk1vdXNlT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5zZXJpZXMuY2hhcnQ7dGhpcy5maXJlUG9pbnRFdmVudCgibW91c2VPdXQiKTtuKGEuaG92ZXJQb2ludHN8fFtdLGZ1bmN0aW9uKGEpe2Euc2V0U3RhdGUoKX0pO2EuaG92ZXJQb2ludHM9YS5ob3ZlclBvaW50PW51bGx9LGltcG9ydEV2ZW50czpmdW5jdGlvbigpe2lmKCF0aGlzLmhhc0ltcG9ydGVkRXZlbnRzKXt2YXIgYT1IKHRoaXMuc2VyaWVzLm9wdGlvbnMucG9pbnQsDQogICAgICAgIHRoaXMub3B0aW9ucykuZXZlbnRzLGI7dGhpcy5ldmVudHM9YTtmb3IoYiBpbiBhKUIodGhpcyxiLGFbYl0pO3RoaXMuaGFzSW1wb3J0ZWRFdmVudHM9ITB9fSxzZXRTdGF0ZTpmdW5jdGlvbihhLGMpe3ZhciBkPU1hdGguZmxvb3IodGhpcy5wbG90WCksZT10aGlzLnBsb3RZLGY9dGhpcy5zZXJpZXMsaz1mLm9wdGlvbnMuc3RhdGVzW2FdfHx7fSxsPWhbZi50eXBlXS5tYXJrZXImJmYub3B0aW9ucy5tYXJrZXIsbT1sJiYhMT09PWwuZW5hYmxlZCxuPWwmJmwuc3RhdGVzJiZsLnN0YXRlc1thXXx8e30scD0hMT09PW4uZW5hYmxlZCxnPWYuc3RhdGVNYXJrZXJHcmFwaGljLHI9dGhpcy5tYXJrZXJ8fHt9LHU9Zi5jaGFydCx2PWYuaGFsbyx6LEE9bCYmZi5tYXJrZXJBdHRyaWJzO2E9YXx8IiI7aWYoIShhPT09dGhpcy5zdGF0ZSYmIWN8fHRoaXMuc2VsZWN0ZWQmJiJzZWxlY3QiIT09YXx8ITE9PT1rLmVuYWJsZWR8fGEmJihwfHxtJiYhMT09PW4uZW5hYmxlZCl8fGEmJnIuc3RhdGVzJiYNCiAgICAgICAgci5zdGF0ZXNbYV0mJiExPT09ci5zdGF0ZXNbYV0uZW5hYmxlZCkpe0EmJih6PWYubWFya2VyQXR0cmlicyh0aGlzLGEpKTtpZih0aGlzLmdyYXBoaWMpdGhpcy5zdGF0ZSYmdGhpcy5ncmFwaGljLnJlbW92ZUNsYXNzKCJoaWdoY2hhcnRzLXBvaW50LSIrdGhpcy5zdGF0ZSksYSYmdGhpcy5ncmFwaGljLmFkZENsYXNzKCJoaWdoY2hhcnRzLXBvaW50LSIrYSksdGhpcy5ncmFwaGljLmF0dHIoZi5wb2ludEF0dHJpYnModGhpcyxhKSkseiYmdGhpcy5ncmFwaGljLmFuaW1hdGUoeixiKHUub3B0aW9ucy5jaGFydC5hbmltYXRpb24sbi5hbmltYXRpb24sbC5hbmltYXRpb24pKSxnJiZnLmhpZGUoKTtlbHNle2lmKGEmJm4pe2w9ci5zeW1ib2x8fGYuc3ltYm9sO2cmJmcuY3VycmVudFN5bWJvbCE9PWwmJihnPWcuZGVzdHJveSgpKTtpZihnKWdbYz8iYW5pbWF0ZSI6ImF0dHIiXSh7eDp6LngseTp6Lnl9KTtlbHNlIGwmJihmLnN0YXRlTWFya2VyR3JhcGhpYz1nPXUucmVuZGVyZXIuc3ltYm9sKGwsDQogICAgICAgIHoueCx6Lnksei53aWR0aCx6LmhlaWdodCkuYWRkKGYubWFya2VyR3JvdXApLGcuY3VycmVudFN5bWJvbD1sKTtnJiZnLmF0dHIoZi5wb2ludEF0dHJpYnModGhpcyxhKSl9ZyYmKGdbYSYmdS5pc0luc2lkZVBsb3QoZCxlLHUuaW52ZXJ0ZWQpPyJzaG93IjoiaGlkZSJdKCksZy5lbGVtZW50LnBvaW50PXRoaXMpfShkPWsuaGFsbykmJmQuc2l6ZT8odnx8KGYuaGFsbz12PXUucmVuZGVyZXIucGF0aCgpLmFkZChBP2YubWFya2VyR3JvdXA6Zi5ncm91cCkpLHZbYz8iYW5pbWF0ZSI6ImF0dHIiXSh7ZDp0aGlzLmhhbG9QYXRoKGQuc2l6ZSl9KSx2LmF0dHIoeyJjbGFzcyI6ImhpZ2hjaGFydHMtaGFsbyBoaWdoY2hhcnRzLWNvbG9yLSIrYih0aGlzLmNvbG9ySW5kZXgsZi5jb2xvckluZGV4KX0pLHYucG9pbnQ9dGhpcyx2LmF0dHIodCh7ZmlsbDp0aGlzLmNvbG9yfHxmLmNvbG9yLCJmaWxsLW9wYWNpdHkiOmQub3BhY2l0eSx6SW5kZXg6LTF9LGQuYXR0cmlidXRlcykpKTp2JiZ2LnBvaW50JiYNCiAgICAgICAgdi5wb2ludC5oYWxvUGF0aCYmdi5hbmltYXRlKHtkOnYucG9pbnQuaGFsb1BhdGgoMCl9KTt0aGlzLnN0YXRlPWF9fSxoYWxvUGF0aDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5zZXJpZXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5jaXJjbGUoTWF0aC5mbG9vcih0aGlzLnBsb3RYKS1hLHRoaXMucGxvdFktYSwyKmEsMiphKX19KTt0KGQucHJvdG90eXBlLHtvbk1vdXNlT3ZlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQsYj1hLmhvdmVyU2VyaWVzO2lmKGImJmIhPT10aGlzKWIub25Nb3VzZU91dCgpO3RoaXMub3B0aW9ucy5ldmVudHMubW91c2VPdmVyJiZsKHRoaXMsIm1vdXNlT3ZlciIpO3RoaXMuc2V0U3RhdGUoImhvdmVyIik7YS5ob3ZlclNlcmllcz10aGlzfSxvbk1vdXNlT3V0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGI9dGhpcy5jaGFydCxjPWIudG9vbHRpcCxkPWIuaG92ZXJQb2ludDtiLmhvdmVyU2VyaWVzPW51bGw7aWYoZClkLm9uTW91c2VPdXQoKTsNCiAgICAgICAgdGhpcyYmYS5ldmVudHMubW91c2VPdXQmJmwodGhpcywibW91c2VPdXQiKTshY3x8YS5zdGlja3lUcmFja2luZ3x8Yy5zaGFyZWQmJiF0aGlzLm5vU2hhcmVkVG9vbHRpcHx8Yy5oaWRlKCk7dGhpcy5zZXRTdGF0ZSgpfSxzZXRTdGF0ZTpmdW5jdGlvbihhKXt2YXIgYz10aGlzLGQ9Yy5vcHRpb25zLGU9Yy5ncmFwaCxoPWQuc3RhdGVzLGs9ZC5saW5lV2lkdGgsZD0wO2E9YXx8IiI7aWYoYy5zdGF0ZSE9PWEmJihuKFtjLmdyb3VwLGMubWFya2VyR3JvdXAsYy5kYXRhTGFiZWxzR3JvdXBdLGZ1bmN0aW9uKGIpe2ImJihjLnN0YXRlJiZiLnJlbW92ZUNsYXNzKCJoaWdoY2hhcnRzLXNlcmllcy0iK2Muc3RhdGUpLGEmJmIuYWRkQ2xhc3MoImhpZ2hjaGFydHMtc2VyaWVzLSIrYSkpfSksYy5zdGF0ZT1hLCFoW2FdfHwhMSE9PWhbYV0uZW5hYmxlZCkmJihhJiYoaz1oW2FdLmxpbmVXaWR0aHx8aysoaFthXS5saW5lV2lkdGhQbHVzfHwwKSksZSYmIWUuZGFzaHN0eWxlKSlmb3Ioaz17InN0cm9rZS13aWR0aCI6a30sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmFuaW1hdGUoayxiKGMuY2hhcnQub3B0aW9ucy5jaGFydC5hbmltYXRpb24saFthXSYmaFthXS5hbmltYXRpb24pKTtjWyJ6b25lLWdyYXBoLSIrZF07KWNbInpvbmUtZ3JhcGgtIitkXS5hdHRyKGspLGQrPTF9LHNldFZpc2libGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLGQ9Yy5jaGFydCxlPWMubGVnZW5kSXRlbSxmLGg9ZC5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllcyxrPWMudmlzaWJsZTtmPShjLnZpc2libGU9YT1jLm9wdGlvbnMudmlzaWJsZT1jLnVzZXJPcHRpb25zLnZpc2libGU9dm9pZCAwPT09YT8hazphKT8ic2hvdyI6ImhpZGUiO24oWyJncm91cCIsImRhdGFMYWJlbHNHcm91cCIsIm1hcmtlckdyb3VwIiwidHJhY2tlciIsInR0Il0sZnVuY3Rpb24oYSl7aWYoY1thXSljW2FdW2ZdKCl9KTtpZihkLmhvdmVyU2VyaWVzPT09Y3x8KGQuaG92ZXJQb2ludCYmZC5ob3ZlclBvaW50LnNlcmllcyk9PT1jKWMub25Nb3VzZU91dCgpO2UmJmQubGVnZW5kLmNvbG9yaXplSXRlbShjLA0KICAgICAgICBhKTtjLmlzRGlydHk9ITA7Yy5vcHRpb25zLnN0YWNraW5nJiZuKGQuc2VyaWVzLGZ1bmN0aW9uKGEpe2Eub3B0aW9ucy5zdGFja2luZyYmYS52aXNpYmxlJiYoYS5pc0RpcnR5PSEwKX0pO24oYy5saW5rZWRTZXJpZXMsZnVuY3Rpb24oYil7Yi5zZXRWaXNpYmxlKGEsITEpfSk7aCYmKGQuaXNEaXJ0eUJveD0hMCk7ITEhPT1iJiZkLnJlZHJhdygpO2woYyxmKX0sc2hvdzpmdW5jdGlvbigpe3RoaXMuc2V0VmlzaWJsZSghMCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLnNldFZpc2libGUoITEpfSxzZWxlY3Q6ZnVuY3Rpb24oYSl7dGhpcy5zZWxlY3RlZD1hPXZvaWQgMD09PWE/IXRoaXMuc2VsZWN0ZWQ6YTt0aGlzLmNoZWNrYm94JiYodGhpcy5jaGVja2JveC5jaGVja2VkPWEpO2wodGhpcyxhPyJzZWxlY3QiOiJ1bnNlbGVjdCIpfSxkcmF3VHJhY2tlcjphLmRyYXdUcmFja2VyR3JhcGh9KX0pKEkpOyhmdW5jdGlvbihhKXt2YXIgQj1hLkNoYXJ0LHo9YS5lYWNoLEM9YS5pbkFycmF5LEU9DQogICAgICAgIGEuaXNBcnJheSx1PWEuaXNPYmplY3QsaD1hLnBpY2ssbj1hLnNwbGF0O0IucHJvdG90eXBlLnNldFJlc3BvbnNpdmU9ZnVuY3Rpb24oaCl7dmFyIGw9dGhpcy5vcHRpb25zLnJlc3BvbnNpdmUsaz1bXSxlPXRoaXMuY3VycmVudFJlc3BvbnNpdmU7bCYmbC5ydWxlcyYmeihsLnJ1bGVzLGZ1bmN0aW9uKGMpe3ZvaWQgMD09PWMuX2lkJiYoYy5faWQ9YS51bmlxdWVLZXkoKSk7dGhpcy5tYXRjaFJlc3BvbnNpdmVSdWxlKGMsayxoKX0sdGhpcyk7dmFyIGM9YS5tZXJnZS5hcHBseSgwLGEubWFwKGssZnVuY3Rpb24oYyl7cmV0dXJuIGEuZmluZChsLnJ1bGVzLGZ1bmN0aW9uKGEpe3JldHVybiBhLl9pZD09PWN9KS5jaGFydE9wdGlvbnN9KSksaz1rLnRvU3RyaW5nKCl8fHZvaWQgMDtrIT09KGUmJmUucnVsZUlkcykmJihlJiZ0aGlzLnVwZGF0ZShlLnVuZG9PcHRpb25zLGgpLGs/KHRoaXMuY3VycmVudFJlc3BvbnNpdmU9e3J1bGVJZHM6ayxtZXJnZWRPcHRpb25zOmMsdW5kb09wdGlvbnM6dGhpcy5jdXJyZW50T3B0aW9ucyhjKX0sDQogICAgICAgICAgICB0aGlzLnVwZGF0ZShjLGgpKTp0aGlzLmN1cnJlbnRSZXNwb25zaXZlPXZvaWQgMCl9O0IucHJvdG90eXBlLm1hdGNoUmVzcG9uc2l2ZVJ1bGU9ZnVuY3Rpb24oYSxsKXt2YXIgaz1hLmNvbmRpdGlvbjsoay5jYWxsYmFja3x8ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jaGFydFdpZHRoPD1oKGsubWF4V2lkdGgsTnVtYmVyLk1BWF9WQUxVRSkmJnRoaXMuY2hhcnRIZWlnaHQ8PWgoay5tYXhIZWlnaHQsTnVtYmVyLk1BWF9WQUxVRSkmJnRoaXMuY2hhcnRXaWR0aD49aChrLm1pbldpZHRoLDApJiZ0aGlzLmNoYXJ0SGVpZ2h0Pj1oKGsubWluSGVpZ2h0LDApfSkuY2FsbCh0aGlzKSYmbC5wdXNoKGEuX2lkKX07Qi5wcm90b3R5cGUuY3VycmVudE9wdGlvbnM9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gaChhLGMsayxsKXt2YXIgYixlO2ZvcihiIGluIGEpaWYoIWwmJi0xPEMoYixbInNlcmllcyIsInhBeGlzIiwieUF4aXMiXSkpZm9yKGFbYl09bihhW2JdKSxrW2JdPVtdLGU9MDtlPGFbYl0ubGVuZ3RoO2UrKyljW2JdW2VdJiYNCiAgICAoa1tiXVtlXT17fSxoKGFbYl1bZV0sY1tiXVtlXSxrW2JdW2VdLGwrMSkpO2Vsc2UgdShhW2JdKT8oa1tiXT1FKGFbYl0pP1tdOnt9LGgoYVtiXSxjW2JdfHx7fSxrW2JdLGwrMSkpOmtbYl09Y1tiXXx8bnVsbH12YXIgaz17fTtoKGEsdGhpcy5vcHRpb25zLGssMCk7cmV0dXJuIGt9fSkoSSk7cmV0dXJuIEl9KTsKLyoNCiBIaWdoY2hhcnRzIEpTIHY1LjAuNiAoMjAxNi0xMi0wNykNCg0KIDNEIGZlYXR1cmVzIGZvciBIaWdoY2hhcnRzIEpTDQoNCiBAbGljZW5zZTogd3d3LmhpZ2hjaGFydHMuY29tL2xpY2Vuc2UNCiovDQooZnVuY3Rpb24oRCl7Im9iamVjdCI9PT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1EOkQoSGlnaGNoYXJ0cyl9KShmdW5jdGlvbihEKXsoZnVuY3Rpb24oYSl7dmFyIHE9YS5kZWcycmFkLGs9YS5waWNrO2EucGVyc3BlY3RpdmU9ZnVuY3Rpb24ocCxuLHUpe3ZhciBtPW4ub3B0aW9ucy5jaGFydC5vcHRpb25zM2QsZj11P24uaW52ZXJ0ZWQ6ITEsZz1uLnBsb3RXaWR0aC8yLHI9bi5wbG90SGVpZ2h0LzIsZD1tLmRlcHRoLzIsZT1rKG0uZGVwdGgsMSkqayhtLnZpZXdEaXN0YW5jZSwwKSxjPW4uc2NhbGUzZHx8MSxiPXEqbS5iZXRhKihmPy0xOjEpLG09cSptLmFscGhhKihmPy0xOjEpLGg9TWF0aC5jb3MobSksdj1NYXRoLmNvcygtYikseD1NYXRoLnNpbihtKSx5PU1hdGguc2luKC1iKTt1fHwoZys9bi5wbG90TGVmdCxyKz1uLnBsb3RUb3ApO3JldHVybiBhLm1hcChwLGZ1bmN0aW9uKGIpe3ZhciBhLG07bT0oZj9iLnk6Yi54KS1nO3ZhciBuPShmPw0KYi54OmIueSktcixrPShiLnp8fDApLWQ7YT12Km0teSprO2I9LXgqeSptK2gqbi12KngqazttPWgqeSptK3gqbitoKnYqaztuPTA8ZSYmZTxOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk/ZS8obStkK2UpOjE7YT1hKm4qYytnO2I9YipuKmMrcjtyZXR1cm57eDpmP2I6YSx5OmY/YTpiLHo6bSpjK2R9fSl9O2EucG9pbnRDYW1lcmFEaXN0YW5jZT1mdW5jdGlvbihhLG4pe3ZhciBwPW4ub3B0aW9ucy5jaGFydC5vcHRpb25zM2QsbT1uLnBsb3RXaWR0aC8yO249bi5wbG90SGVpZ2h0LzI7cD1rKHAuZGVwdGgsMSkqayhwLnZpZXdEaXN0YW5jZSwwKStwLmRlcHRoO3JldHVybiBNYXRoLnNxcnQoTWF0aC5wb3cobS1hLnBsb3RYLDIpK01hdGgucG93KG4tYS5wbG90WSwyKStNYXRoLnBvdyhwLWEucGxvdFosMikpfX0pKEQpOyhmdW5jdGlvbihhKXtmdW5jdGlvbiBxKGIpe3ZhciBhPTAsbCxjO2ZvcihsPTA7bDxiLmxlbmd0aDtsKyspYz0obCsxKSViLmxlbmd0aCxhKz1iW2xdLngqYltjXS55LQ0KYltjXS54KmJbbF0ueTtyZXR1cm4gYS8yfWZ1bmN0aW9uIGsoYil7dmFyIGM9MCxsO2ZvcihsPTA7bDxiLmxlbmd0aDtsKyspYys9YltsXS56O3JldHVybiBiLmxlbmd0aD9jL2IubGVuZ3RoOjB9ZnVuY3Rpb24gcChiLGMsbCxhLGgsZCxGLGUpe3ZhciBmPVtdLEg9ZC1oO3JldHVybiBkPmgmJmQtaD5NYXRoLlBJLzIrLjAwMDE/KGY9Zi5jb25jYXQocChiLGMsbCxhLGgsaCtNYXRoLlBJLzIsRixlKSksZj1mLmNvbmNhdChwKGIsYyxsLGEsaCtNYXRoLlBJLzIsZCxGLGUpKSk6ZDxoJiZoLWQ+TWF0aC5QSS8yKy4wMDAxPyhmPWYuY29uY2F0KHAoYixjLGwsYSxoLGgtTWF0aC5QSS8yLEYsZSkpLGY9Zi5jb25jYXQocChiLGMsbCxhLGgtTWF0aC5QSS8yLGQsRixlKSkpOlsiQyIsYitsKk1hdGguY29zKGgpLWwqdCpIKk1hdGguc2luKGgpK0YsYythKk1hdGguc2luKGgpK2EqdCpIKk1hdGguY29zKGgpK2UsYitsKk1hdGguY29zKGQpK2wqdCpIKk1hdGguc2luKGQpK0YsYythKk1hdGguc2luKGQpLQ0KYSp0KkgqTWF0aC5jb3MoZCkrZSxiK2wqTWF0aC5jb3MoZCkrRixjK2EqTWF0aC5zaW4oZCkrZV19dmFyIG49TWF0aC5jb3MsdT1NYXRoLlBJLG09TWF0aC5zaW4sZj1hLmFuaW1PYmplY3QsZz1hLmNoYXJ0cyxyPWEuY29sb3IsZD1hLmRlZmluZWQsZT1hLmRlZzJyYWQsYz1hLmVhY2gsYj1hLmV4dGVuZCxoPWEuaW5BcnJheSx2PWEubWFwLHg9YS5tZXJnZSx5PWEucGVyc3BlY3RpdmUsRT1hLnBpY2ssQT1hLlNWR0VsZW1lbnQsRz1hLlNWR1JlbmRlcmVyLEI9YS53cmFwLHQ9NCooTWF0aC5zcXJ0KDIpLTEpLzMvKHUvMik7Ry5wcm90b3R5cGUudG9MaW5lUGF0aD1mdW5jdGlvbihiLGEpe3ZhciBsPVtdO2MoYixmdW5jdGlvbihiKXtsLnB1c2goIkwiLGIueCxiLnkpfSk7Yi5sZW5ndGgmJihsWzBdPSJNIixhJiZsLnB1c2goIloiKSk7cmV0dXJuIGx9O0cucHJvdG90eXBlLmN1Ym9pZD1mdW5jdGlvbihiKXt2YXIgYz10aGlzLmcoKTtiPXRoaXMuY3Vib2lkUGF0aChiKTtjLmF0dHIoeyJzdHJva2UtbGluZWpvaW4iOiJyb3VuZCJ9KTsNCmMuZnJvbnQ9dGhpcy5wYXRoKGJbMF0pLmF0dHIoeyJjbGFzcyI6ImhpZ2hjaGFydHMtM2QtZnJvbnQiLHpJbmRleDpiWzNdfSkuYWRkKGMpO2MudG9wPXRoaXMucGF0aChiWzFdKS5hdHRyKHsiY2xhc3MiOiJoaWdoY2hhcnRzLTNkLXRvcCIsekluZGV4OmJbNF19KS5hZGQoYyk7Yy5zaWRlPXRoaXMucGF0aChiWzJdKS5hdHRyKHsiY2xhc3MiOiJoaWdoY2hhcnRzLTNkLXNpZGUiLHpJbmRleDpiWzVdfSkuYWRkKGMpO2MuZmlsbFNldHRlcj1mdW5jdGlvbihiKXt0aGlzLmZyb250LmF0dHIoe2ZpbGw6Yn0pO3RoaXMudG9wLmF0dHIoe2ZpbGw6cihiKS5icmlnaHRlbiguMSkuZ2V0KCl9KTt0aGlzLnNpZGUuYXR0cih7ZmlsbDpyKGIpLmJyaWdodGVuKC0uMSkuZ2V0KCl9KTt0aGlzLmNvbG9yPWI7cmV0dXJuIHRoaXN9O2Mub3BhY2l0eVNldHRlcj1mdW5jdGlvbihiKXt0aGlzLmZyb250LmF0dHIoe29wYWNpdHk6Yn0pO3RoaXMudG9wLmF0dHIoe29wYWNpdHk6Yn0pO3RoaXMuc2lkZS5hdHRyKHtvcGFjaXR5OmJ9KTsNCnJldHVybiB0aGlzfTtjLmF0dHI9ZnVuY3Rpb24oYil7aWYoYi5zaGFwZUFyZ3N8fGQoYi54KSliPXRoaXMucmVuZGVyZXIuY3Vib2lkUGF0aChiLnNoYXBlQXJnc3x8YiksdGhpcy5mcm9udC5hdHRyKHtkOmJbMF0sekluZGV4OmJbM119KSx0aGlzLnRvcC5hdHRyKHtkOmJbMV0sekluZGV4OmJbNF19KSx0aGlzLnNpZGUuYXR0cih7ZDpiWzJdLHpJbmRleDpiWzVdfSk7ZWxzZSByZXR1cm4gYS5TVkdFbGVtZW50LnByb3RvdHlwZS5hdHRyLmNhbGwodGhpcyxiKTtyZXR1cm4gdGhpc307Yy5hbmltYXRlPWZ1bmN0aW9uKGIsYyxhKXtkKGIueCkmJmQoYi55KT8oYj10aGlzLnJlbmRlcmVyLmN1Ym9pZFBhdGgoYiksdGhpcy5mcm9udC5hdHRyKHt6SW5kZXg6YlszXX0pLmFuaW1hdGUoe2Q6YlswXX0sYyxhKSx0aGlzLnRvcC5hdHRyKHt6SW5kZXg6Yls0XX0pLmFuaW1hdGUoe2Q6YlsxXX0sYyxhKSx0aGlzLnNpZGUuYXR0cih7ekluZGV4OmJbNV19KS5hbmltYXRlKHtkOmJbMl19LGMsYSksDQp0aGlzLmF0dHIoe3pJbmRleDotYls2XX0pKTpiLm9wYWNpdHk/KHRoaXMuZnJvbnQuYW5pbWF0ZShiLGMsYSksdGhpcy50b3AuYW5pbWF0ZShiLGMsYSksdGhpcy5zaWRlLmFuaW1hdGUoYixjLGEpKTpBLnByb3RvdHlwZS5hbmltYXRlLmNhbGwodGhpcyxiLGMsYSk7cmV0dXJuIHRoaXN9O2MuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuZnJvbnQuZGVzdHJveSgpO3RoaXMudG9wLmRlc3Ryb3koKTt0aGlzLnNpZGUuZGVzdHJveSgpO3JldHVybiBudWxsfTtjLmF0dHIoe3pJbmRleDotYls2XX0pO3JldHVybiBjfTtHLnByb3RvdHlwZS5jdWJvaWRQYXRoPWZ1bmN0aW9uKGIpe2Z1bmN0aW9uIGMoYil7cmV0dXJuIG1bYl19dmFyIGE9Yi54LGg9Yi55LGQ9Yi56LGU9Yi5oZWlnaHQsZj1iLndpZHRoLHI9Yi5kZXB0aCxtPVt7eDphLHk6aCx6OmR9LHt4OmErZix5OmgsejpkfSx7eDphK2YseTpoK2UsejpkfSx7eDphLHk6aCtlLHo6ZH0se3g6YSx5OmgrZSx6OmQrcn0se3g6YStmLHk6aCsNCmUsejpkK3J9LHt4OmErZix5OmgsejpkK3J9LHt4OmEseTpoLHo6ZCtyfV0sbT15KG0sZ1t0aGlzLmNoYXJ0SW5kZXhdLGIuaW5zaWRlUGxvdEFyZWEpLGQ9ZnVuY3Rpb24oYixhKXt2YXIgaD1bXTtiPXYoYixjKTthPXYoYSxjKTswPnEoYik/aD1iOjA+cShhKSYmKGg9YSk7cmV0dXJuIGh9O2I9ZChbMywyLDEsMF0sWzcsNiw1LDRdKTthPVs0LDUsMiwzXTtoPWQoWzEsNiw3LDBdLGEpO2Q9ZChbMSwyLDUsNl0sWzAsNyw0LDNdKTtyZXR1cm5bdGhpcy50b0xpbmVQYXRoKGIsITApLHRoaXMudG9MaW5lUGF0aChoLCEwKSx0aGlzLnRvTGluZVBhdGgoZCwhMCksayhiKSxrKGgpLGsoZCksOUU5KmsodihhLGMpKV19O2EuU1ZHUmVuZGVyZXIucHJvdG90eXBlLmFyYzNkPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGQoYil7dmFyIGE9ITEsYz17fSxkO2ZvcihkIGluIGIpLTEhPT1oKGQsdikmJihjW2RdPWJbZF0sZGVsZXRlIGJbZF0sYT0hMCk7cmV0dXJuIGE/YzohMX12YXIgbD10aGlzLmcoKSwNCm09bC5yZW5kZXJlcix2PSJ4IHkgciBpbm5lclIgc3RhcnQgZW5kIi5zcGxpdCgiICIpO2E9eChhKTthLmFscGhhKj1lO2EuYmV0YSo9ZTtsLnRvcD1tLnBhdGgoKTtsLnNpZGUxPW0ucGF0aCgpO2wuc2lkZTI9bS5wYXRoKCk7bC5pbm49bS5wYXRoKCk7bC5vdXQ9bS5wYXRoKCk7bC5vbkFkZD1mdW5jdGlvbigpe3ZhciBiPWwucGFyZW50R3JvdXAsYT1sLmF0dHIoImNsYXNzIik7bC50b3AuYWRkKGwpO2MoWyJvdXQiLCJpbm4iLCJzaWRlMSIsInNpZGUyIl0sZnVuY3Rpb24oYyl7bFtjXS5hZGRDbGFzcyhhKyIgaGlnaGNoYXJ0cy0zZC1zaWRlIikuYWRkKGIpfSl9O2wuc2V0UGF0aHM9ZnVuY3Rpb24oYil7dmFyIGE9bC5yZW5kZXJlci5hcmMzZFBhdGgoYiksYz0xMDAqYS56VG9wO2wuYXR0cmlicz1iO2wudG9wLmF0dHIoe2Q6YS50b3AsekluZGV4OmEuelRvcH0pO2wuaW5uLmF0dHIoe2Q6YS5pbm4sekluZGV4OmEueklubn0pO2wub3V0LmF0dHIoe2Q6YS5vdXQsekluZGV4OmEuek91dH0pOw0KbC5zaWRlMS5hdHRyKHtkOmEuc2lkZTEsekluZGV4OmEuelNpZGUxfSk7bC5zaWRlMi5hdHRyKHtkOmEuc2lkZTIsekluZGV4OmEuelNpZGUyfSk7bC56SW5kZXg9YztsLmF0dHIoe3pJbmRleDpjfSk7Yi5jZW50ZXImJihsLnRvcC5zZXRSYWRpYWxSZWZlcmVuY2UoYi5jZW50ZXIpLGRlbGV0ZSBiLmNlbnRlcil9O2wuc2V0UGF0aHMoYSk7bC5maWxsU2V0dGVyPWZ1bmN0aW9uKGIpe3ZhciBhPXIoYikuYnJpZ2h0ZW4oLS4xKS5nZXQoKTt0aGlzLmZpbGw9Yjt0aGlzLnNpZGUxLmF0dHIoe2ZpbGw6YX0pO3RoaXMuc2lkZTIuYXR0cih7ZmlsbDphfSk7dGhpcy5pbm4uYXR0cih7ZmlsbDphfSk7dGhpcy5vdXQuYXR0cih7ZmlsbDphfSk7dGhpcy50b3AuYXR0cih7ZmlsbDpifSk7cmV0dXJuIHRoaXN9O2MoWyJvcGFjaXR5IiwidHJhbnNsYXRlWCIsInRyYW5zbGF0ZVkiLCJ2aXNpYmlsaXR5Il0sZnVuY3Rpb24oYil7bFtiKyJTZXR0ZXIiXT1mdW5jdGlvbihiLGEpe2xbYV09YjtjKFsib3V0IiwNCiJpbm4iLCJzaWRlMSIsInNpZGUyIiwidG9wIl0sZnVuY3Rpb24oYyl7bFtjXS5hdHRyKGEsYil9KX19KTtCKGwsImF0dHIiLGZ1bmN0aW9uKGEsYyl7dmFyIGg7Im9iamVjdCI9PT10eXBlb2YgYyYmKGg9ZChjKSkmJihiKGwuYXR0cmlicyxoKSxsLnNldFBhdGhzKGwuYXR0cmlicykpO3JldHVybiBhLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7QihsLCJhbmltYXRlIixmdW5jdGlvbihiLGEsYyxoKXt2YXIgbCxlPXRoaXMuYXR0cmlicyxtO2RlbGV0ZSBhLmNlbnRlcjtkZWxldGUgYS56O2RlbGV0ZSBhLmRlcHRoO2RlbGV0ZSBhLmFscGhhO2RlbGV0ZSBhLmJldGE7bT1mKEUoYyx0aGlzLnJlbmRlcmVyLmdsb2JhbEFuaW1hdGlvbikpO20uZHVyYXRpb24mJihhPXgoYSksbD1kKGEpLGEuZHVtbXk9MSxsJiYobS5zdGVwPWZ1bmN0aW9uKGIsYSl7ZnVuY3Rpb24gYyhiKXtyZXR1cm4gZVtiXSsoRShsW2JdLGVbYl0pLWVbYl0pKmEucG9zfSJkdW1teSI9PT0NCmEucHJvcCYmYS5lbGVtLnNldFBhdGhzKHgoZSx7eDpjKCJ4IikseTpjKCJ5IikscjpjKCJyIiksaW5uZXJSOmMoImlubmVyUiIpLHN0YXJ0OmMoInN0YXJ0IiksZW5kOmMoImVuZCIpfSkpfSksYz1tKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxjLGgpfSk7bC5kZXN0cm95PWZ1bmN0aW9uKCl7dGhpcy50b3AuZGVzdHJveSgpO3RoaXMub3V0LmRlc3Ryb3koKTt0aGlzLmlubi5kZXN0cm95KCk7dGhpcy5zaWRlMS5kZXN0cm95KCk7dGhpcy5zaWRlMi5kZXN0cm95KCk7QS5wcm90b3R5cGUuZGVzdHJveS5jYWxsKHRoaXMpfTtsLmhpZGU9ZnVuY3Rpb24oKXt0aGlzLnRvcC5oaWRlKCk7dGhpcy5vdXQuaGlkZSgpO3RoaXMuaW5uLmhpZGUoKTt0aGlzLnNpZGUxLmhpZGUoKTt0aGlzLnNpZGUyLmhpZGUoKX07bC5zaG93PWZ1bmN0aW9uKCl7dGhpcy50b3Auc2hvdygpO3RoaXMub3V0LnNob3coKTt0aGlzLmlubi5zaG93KCk7dGhpcy5zaWRlMS5zaG93KCk7dGhpcy5zaWRlMi5zaG93KCl9Ow0KcmV0dXJuIGx9O0cucHJvdG90eXBlLmFyYzNkUGF0aD1mdW5jdGlvbihiKXtmdW5jdGlvbiBhKGIpe2IlPTIqTWF0aC5QSTtiPk1hdGguUEkmJihiPTIqTWF0aC5QSS1iKTtyZXR1cm4gYn12YXIgYz1iLngsaD1iLnksZD1iLnN0YXJ0LGU9Yi5lbmQtLjAwMDAxLGY9Yi5yLHI9Yi5pbm5lclIsdj1iLmRlcHRoLGc9Yi5hbHBoYSxrPWIuYmV0YSx4PU1hdGguY29zKGQpLHE9TWF0aC5zaW4oZCk7Yj1NYXRoLmNvcyhlKTt2YXIgeT1NYXRoLnNpbihlKSx3PWYqTWF0aC5jb3MoayksZj1mKk1hdGguY29zKGcpLHQ9cipNYXRoLmNvcyhrKSxCPXIqTWF0aC5jb3MoZykscj12Kk1hdGguc2luKGspLHo9dipNYXRoLnNpbihnKSx2PVsiTSIsYyt3KngsaCtmKnFdLHY9di5jb25jYXQocChjLGgsdyxmLGQsZSwwLDApKSx2PXYuY29uY2F0KFsiTCIsYyt0KmIsaCtCKnldKSx2PXYuY29uY2F0KHAoYyxoLHQsQixlLGQsMCwwKSksdj12LmNvbmNhdChbIloiXSksRT0wPGs/TWF0aC5QSS8yOjAsaz0wPA0KZz8wOk1hdGguUEkvMixFPWQ+LUU/ZDplPi1FPy1FOmQsQz1lPHUtaz9lOmQ8dS1rP3UtazplLEE9Mip1LWssZz1bIk0iLGMrdypuKEUpLGgrZiptKEUpXSxnPWcuY29uY2F0KHAoYyxoLHcsZixFLEMsMCwwKSk7ZT5BJiZkPEE/KGc9Zy5jb25jYXQoWyJMIixjK3cqbihDKStyLGgrZiptKEMpK3pdKSxnPWcuY29uY2F0KHAoYyxoLHcsZixDLEEscix6KSksZz1nLmNvbmNhdChbIkwiLGMrdypuKEEpLGgrZiptKEEpXSksZz1nLmNvbmNhdChwKGMsaCx3LGYsQSxlLDAsMCkpLGc9Zy5jb25jYXQoWyJMIixjK3cqbihlKStyLGgrZiptKGUpK3pdKSxnPWcuY29uY2F0KHAoYyxoLHcsZixlLEEscix6KSksZz1nLmNvbmNhdChbIkwiLGMrdypuKEEpLGgrZiptKEEpXSksZz1nLmNvbmNhdChwKGMsaCx3LGYsQSxDLDAsMCkpKTplPnUtayYmZDx1LWsmJihnPWcuY29uY2F0KFsiTCIsYyt3Kk1hdGguY29zKEMpK3IsaCtmKk1hdGguc2luKEMpK3pdKSxnPWcuY29uY2F0KHAoYyxoLHcsZixDLGUsDQpyLHopKSxnPWcuY29uY2F0KFsiTCIsYyt3Kk1hdGguY29zKGUpLGgrZipNYXRoLnNpbihlKV0pLGc9Zy5jb25jYXQocChjLGgsdyxmLGUsQywwLDApKSk7Zz1nLmNvbmNhdChbIkwiLGMrdypNYXRoLmNvcyhDKStyLGgrZipNYXRoLnNpbihDKSt6XSk7Zz1nLmNvbmNhdChwKGMsaCx3LGYsQyxFLHIseikpO2c9Zy5jb25jYXQoWyJaIl0pO2s9WyJNIixjK3QqeCxoK0IqcV07az1rLmNvbmNhdChwKGMsaCx0LEIsZCxlLDAsMCkpO2s9ay5jb25jYXQoWyJMIixjK3QqTWF0aC5jb3MoZSkrcixoK0IqTWF0aC5zaW4oZSkrel0pO2s9ay5jb25jYXQocChjLGgsdCxCLGUsZCxyLHopKTtrPWsuY29uY2F0KFsiWiJdKTt4PVsiTSIsYyt3KngsaCtmKnEsIkwiLGMrdyp4K3IsaCtmKnEreiwiTCIsYyt0KngrcixoK0IqcSt6LCJMIixjK3QqeCxoK0IqcSwiWiJdO2M9WyJNIixjK3cqYixoK2YqeSwiTCIsYyt3KmIrcixoK2YqeSt6LCJMIixjK3QqYityLGgrQip5K3osIkwiLGMrdCpiLGgrQip5LCJaIl07DQp5PU1hdGguYXRhbjIoeiwtcik7aD1NYXRoLmFicyhlK3kpO2I9TWF0aC5hYnMoZCt5KTtkPU1hdGguYWJzKChkK2UpLzIreSk7aD1hKGgpO2I9YShiKTtkPWEoZCk7ZCo9MUU1O2U9MUU1KmI7aCo9MUU1O3JldHVybnt0b3A6dix6VG9wOjFFNSpNYXRoLlBJKzEsb3V0Omcsek91dDpNYXRoLm1heChkLGUsaCksaW5uOmsseklubjpNYXRoLm1heChkLGUsaCksc2lkZTE6eCx6U2lkZTE6Ljk5Kmgsc2lkZTI6Yyx6U2lkZTI6Ljk5KmV9fX0pKEQpOyhmdW5jdGlvbihhKXtmdW5jdGlvbiBxKGEsZCl7dmFyIGU9YS5wbG90TGVmdCxjPWEucGxvdFdpZHRoK2UsYj1hLnBsb3RUb3AsaD1hLnBsb3RIZWlnaHQrYixmPWUrYS5wbG90V2lkdGgvMixnPWIrYS5wbG90SGVpZ2h0LzIscj1OdW1iZXIuTUFYX1ZBTFVFLG09LU51bWJlci5NQVhfVkFMVUUsaz1OdW1iZXIuTUFYX1ZBTFVFLG49LU51bWJlci5NQVhfVkFMVUUscSx0PTE7cT1be3g6ZSx5OmIsejowfSx7eDplLHk6Yix6OmR9XTtwKFswLDFdLA0KZnVuY3Rpb24oYil7cS5wdXNoKHt4OmMseTpxW2JdLnksejpxW2JdLnp9KX0pO3AoWzAsMSwyLDNdLGZ1bmN0aW9uKGIpe3EucHVzaCh7eDpxW2JdLngseTpoLHo6cVtiXS56fSl9KTtxPXUocSxhLCExKTtwKHEsZnVuY3Rpb24oYil7cj1NYXRoLm1pbihyLGIueCk7bT1NYXRoLm1heChtLGIueCk7az1NYXRoLm1pbihrLGIueSk7bj1NYXRoLm1heChuLGIueSl9KTtlPnImJih0PU1hdGgubWluKHQsMS1NYXRoLmFicygoZStmKS8ocitmKSklMSkpO2M8bSYmKHQ9TWF0aC5taW4odCwoYy1mKS8obS1mKSkpO2I+ayYmKHQ9MD5rP01hdGgubWluKHQsKGIrZykvKC1rK2IrZykpOk1hdGgubWluKHQsMS0oYitnKS8oaytnKSUxKSk7aDxuJiYodD1NYXRoLm1pbih0LE1hdGguYWJzKChoLWcpLyhuLWcpKSkpO3JldHVybiB0fXZhciBrPWEuQ2hhcnQscD1hLmVhY2gsbj1hLm1lcmdlLHU9YS5wZXJzcGVjdGl2ZSxtPWEucGljayxmPWEud3JhcDtrLnByb3RvdHlwZS5pczNkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5jaGFydC5vcHRpb25zM2QmJg0KdGhpcy5vcHRpb25zLmNoYXJ0Lm9wdGlvbnMzZC5lbmFibGVkfTtrLnByb3RvdHlwZS5wcm9wc1JlcXVpcmVEaXJ0eUJveC5wdXNoKCJjaGFydC5vcHRpb25zM2QiKTtrLnByb3RvdHlwZS5wcm9wc1JlcXVpcmVVcGRhdGVTZXJpZXMucHVzaCgiY2hhcnQub3B0aW9uczNkIik7YS53cmFwKGEuQ2hhcnQucHJvdG90eXBlLCJpc0luc2lkZVBsb3QiLGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmlzM2QoKXx8YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO3ZhciBnPWEuZ2V0T3B0aW9ucygpO24oITAsZyx7Y2hhcnQ6e29wdGlvbnMzZDp7ZW5hYmxlZDohMSxhbHBoYTowLGJldGE6MCxkZXB0aDoxMDAsZml0VG9QbG90OiEwLHZpZXdEaXN0YW5jZToyNSxmcmFtZTp7Ym90dG9tOntzaXplOjF9LHNpZGU6e3NpemU6MX0sYmFjazp7c2l6ZToxfX19fX0pO2Yoay5wcm90b3R5cGUsInNldENsYXNzTmFtZSIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLA0KMSkpO3RoaXMuaXMzZCgpJiYodGhpcy5jb250YWluZXIuY2xhc3NOYW1lKz0iIGhpZ2hjaGFydHMtM2QtY2hhcnQiKX0pO2Eud3JhcChhLkNoYXJ0LnByb3RvdHlwZSwic2V0Q2hhcnRTaXplIixmdW5jdGlvbihhKXt2YXIgZD10aGlzLm9wdGlvbnMuY2hhcnQub3B0aW9uczNkO2EuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7aWYodGhpcy5pczNkKCkpe3ZhciBlPXRoaXMuaW52ZXJ0ZWQsYz10aGlzLmNsaXBCb3gsYj10aGlzLm1hcmdpbjtjW2U/InkiOiJ4Il09LShiWzNdfHwwKTtjW2U/IngiOiJ5Il09LShiWzBdfHwwKTtjW2U/ImhlaWdodCI6IndpZHRoIl09dGhpcy5jaGFydFdpZHRoKyhiWzNdfHwwKSsoYlsxXXx8MCk7Y1tlPyJ3aWR0aCI6ImhlaWdodCJdPXRoaXMuY2hhcnRIZWlnaHQrKGJbMF18fDApKyhiWzJdfHwwKTt0aGlzLnNjYWxlM2Q9MTshMD09PWQuZml0VG9QbG90JiYodGhpcy5zY2FsZTNkPXEodGhpcyxkLmRlcHRoKSl9fSk7ZihrLnByb3RvdHlwZSwNCiJyZWRyYXciLGZ1bmN0aW9uKGEpe3RoaXMuaXMzZCgpJiYodGhpcy5pc0RpcnR5Qm94PSEwKTthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7ZihrLnByb3RvdHlwZSwicmVuZGVyU2VyaWVzIixmdW5jdGlvbihhKXt2YXIgZD10aGlzLnNlcmllcy5sZW5ndGg7aWYodGhpcy5pczNkKCkpZm9yKDtkLS07KWE9dGhpcy5zZXJpZXNbZF0sYS50cmFuc2xhdGUoKSxhLnJlbmRlcigpO2Vsc2UgYS5jYWxsKHRoaXMpfSk7ay5wcm90b3R5cGUucmV0cmlldmVTdGFja3M9ZnVuY3Rpb24oYSl7dmFyIGQ9dGhpcy5zZXJpZXMsZT17fSxjLGI9MTtwKHRoaXMuc2VyaWVzLGZ1bmN0aW9uKGgpe2M9bShoLm9wdGlvbnMuc3RhY2ssYT8wOmQubGVuZ3RoLTEtaC5pbmRleCk7ZVtjXT9lW2NdLnNlcmllcy5wdXNoKGgpOihlW2NdPXtzZXJpZXM6W2hdLHBvc2l0aW9uOmJ9LGIrKyl9KTtlLnRvdGFsU3RhY2tzPWIrMTtyZXR1cm4gZX19KShEKTsoZnVuY3Rpb24oYSl7dmFyIHEsDQprPWEuQXhpcyxwPWEuQ2hhcnQsbj1hLmVhY2gsdT1hLmV4dGVuZCxtPWEubWVyZ2UsZj1hLnBlcnNwZWN0aXZlLGc9YS5waWNrLHI9YS5zcGxhdCxkPWEuVGljayxlPWEud3JhcDtlKGsucHJvdG90eXBlLCJzZXRPcHRpb25zIixmdW5jdGlvbihhLGIpe2EuY2FsbCh0aGlzLGIpO3RoaXMuY2hhcnQuaXMzZCgpJiYoYT10aGlzLm9wdGlvbnMsYS50aWNrV2lkdGg9ZyhhLnRpY2tXaWR0aCwwKSxhLmdyaWRMaW5lV2lkdGg9ZyhhLmdyaWRMaW5lV2lkdGgsMSkpfSk7ZShrLnByb3RvdHlwZSwicmVuZGVyIixmdW5jdGlvbihhKXthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKHRoaXMuY2hhcnQuaXMzZCgpKXt2YXIgYj10aGlzLmNoYXJ0LGM9Yi5yZW5kZXJlcixkPWIub3B0aW9ucy5jaGFydC5vcHRpb25zM2QsZT1kLmZyYW1lLGY9ZS5ib3R0b20sZz1lLmJhY2ssZT1lLnNpZGUsaz1kLmRlcHRoLG09dGhpcy5oZWlnaHQscj10aGlzLndpZHRoLG49dGhpcy5sZWZ0LA0KcD10aGlzLnRvcDt0aGlzLmlzWkF4aXN8fCh0aGlzLmhvcml6PyhnPXt4Om4seTpwKyhiLnhBeGlzWzBdLm9wcG9zaXRlPy1mLnNpemU6bSksejowLHdpZHRoOnIsaGVpZ2h0OmYuc2l6ZSxkZXB0aDprLGluc2lkZVBsb3RBcmVhOiExfSx0aGlzLmJvdHRvbUZyYW1lP3RoaXMuYm90dG9tRnJhbWUuYW5pbWF0ZShnKToodGhpcy5ib3R0b21GcmFtZT1jLmN1Ym9pZChnKS5hdHRyKHsiY2xhc3MiOiJoaWdoY2hhcnRzLTNkLWZyYW1lIGhpZ2hjaGFydHMtM2QtZnJhbWUtYm90dG9tIix6SW5kZXg6Yi55QXhpc1swXS5yZXZlcnNlZCYmMDxkLmFscGhhPzQ6LTF9KS5hZGQoKSx0aGlzLmJvdHRvbUZyYW1lLmF0dHIoe2ZpbGw6Zi5jb2xvcnx8Im5vbmUiLHN0cm9rZTpmLmNvbG9yfHwibm9uZSJ9KSkpOihkPXt4Om4rKGIueUF4aXNbMF0ub3Bwb3NpdGU/MDotZS5zaXplKSx5OnArKGIueEF4aXNbMF0ub3Bwb3NpdGU/LWYuc2l6ZTowKSx6Omssd2lkdGg6citlLnNpemUsaGVpZ2h0Om0rZi5zaXplLA0KZGVwdGg6Zy5zaXplLGluc2lkZVBsb3RBcmVhOiExfSx0aGlzLmJhY2tGcmFtZT90aGlzLmJhY2tGcmFtZS5hbmltYXRlKGQpOih0aGlzLmJhY2tGcmFtZT1jLmN1Ym9pZChkKS5hdHRyKHsiY2xhc3MiOiJoaWdoY2hhcnRzLTNkLWZyYW1lIGhpZ2hjaGFydHMtM2QtZnJhbWUtYmFjayIsekluZGV4Oi0zfSkuYWRkKCksdGhpcy5iYWNrRnJhbWUuYXR0cih7ZmlsbDpnLmNvbG9yfHwibm9uZSIsc3Ryb2tlOmcuY29sb3J8fCJub25lIn0pKSxiPXt4Om4rKGIueUF4aXNbMF0ub3Bwb3NpdGU/cjotZS5zaXplKSx5OnArKGIueEF4aXNbMF0ub3Bwb3NpdGU/LWYuc2l6ZTowKSx6OjAsd2lkdGg6ZS5zaXplLGhlaWdodDptK2Yuc2l6ZSxkZXB0aDprLGluc2lkZVBsb3RBcmVhOiExfSx0aGlzLnNpZGVGcmFtZT90aGlzLnNpZGVGcmFtZS5hbmltYXRlKGIpOih0aGlzLnNpZGVGcmFtZT1jLmN1Ym9pZChiKS5hdHRyKHsiY2xhc3MiOiJoaWdoY2hhcnRzLTNkLWZyYW1lIGhpZ2hjaGFydHMtM2QtZnJhbWUtc2lkZSIsDQp6SW5kZXg6LTJ9KS5hZGQoKSx0aGlzLnNpZGVGcmFtZS5hdHRyKHtmaWxsOmUuY29sb3J8fCJub25lIixzdHJva2U6ZS5jb2xvcnx8Im5vbmUifSkpKSl9fSk7ZShrLnByb3RvdHlwZSwiZ2V0UGxvdExpbmVQYXRoIixmdW5jdGlvbihhKXt2YXIgYj1hLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKCF0aGlzLmNoYXJ0LmlzM2QoKXx8bnVsbD09PWIpcmV0dXJuIGI7dmFyIGM9dGhpcy5jaGFydCxkPWMub3B0aW9ucy5jaGFydC5vcHRpb25zM2QsYz10aGlzLmlzWkF4aXM/Yy5wbG90V2lkdGg6ZC5kZXB0aCxkPXRoaXMub3Bwb3NpdGU7dGhpcy5ob3JpeiYmKGQ9IWQpO2I9W3RoaXMuc3dhcFooe3g6YlsxXSx5OmJbMl0sejpkP2M6MH0pLHRoaXMuc3dhcFooe3g6YlsxXSx5OmJbMl0sejpjfSksdGhpcy5zd2FwWih7eDpiWzRdLHk6Yls1XSx6OmN9KSx0aGlzLnN3YXBaKHt4OmJbNF0seTpiWzVdLHo6ZD8wOmN9KV07Yj1mKGIsdGhpcy5jaGFydCwhMSk7cmV0dXJuIGI9DQp0aGlzLmNoYXJ0LnJlbmRlcmVyLnRvTGluZVBhdGgoYiwhMSl9KTtlKGsucHJvdG90eXBlLCJnZXRMaW5lUGF0aCIsZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY2hhcnQuaXMzZCgpP1tdOmEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTtlKGsucHJvdG90eXBlLCJnZXRQbG90QmFuZFBhdGgiLGZ1bmN0aW9uKGEpe2lmKCF0aGlzLmNoYXJ0LmlzM2QoKSlyZXR1cm4gYS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTt2YXIgYj1hcmd1bWVudHMsYz1iWzFdLGI9dGhpcy5nZXRQbG90TGluZVBhdGgoYlsyXSk7KGM9dGhpcy5nZXRQbG90TGluZVBhdGgoYykpJiZiP2MucHVzaCgiTCIsYlsxMF0sYlsxMV0sIkwiLGJbN10sYls4XSwiTCIsYls0XSxiWzVdLCJMIixiWzFdLGJbMl0pOmM9bnVsbDtyZXR1cm4gY30pO2UoZC5wcm90b3R5cGUsImdldE1hcmtQYXRoIixmdW5jdGlvbihhKXt2YXIgYj1hLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsDQoxKSk7aWYoIXRoaXMuYXhpcy5jaGFydC5pczNkKCkpcmV0dXJuIGI7Yj1bdGhpcy5heGlzLnN3YXBaKHt4OmJbMV0seTpiWzJdLHo6MH0pLHRoaXMuYXhpcy5zd2FwWih7eDpiWzRdLHk6Yls1XSx6OjB9KV07Yj1mKGIsdGhpcy5heGlzLmNoYXJ0LCExKTtyZXR1cm4gYj1bIk0iLGJbMF0ueCxiWzBdLnksIkwiLGJbMV0ueCxiWzFdLnldfSk7ZShkLnByb3RvdHlwZSwiZ2V0TGFiZWxQb3NpdGlvbiIsZnVuY3Rpb24oYSl7dmFyIGI9YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTt0aGlzLmF4aXMuY2hhcnQuaXMzZCgpJiYoYj1mKFt0aGlzLmF4aXMuc3dhcFooe3g6Yi54LHk6Yi55LHo6MH0pXSx0aGlzLmF4aXMuY2hhcnQsITEpWzBdKTtyZXR1cm4gYn0pO2Eud3JhcChrLnByb3RvdHlwZSwiZ2V0VGl0bGVQb3NpdGlvbiIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydC5pczNkKCksYyxkO2ImJihkPXRoaXMuYXhpc1RpdGxlTWFyZ2luLHRoaXMuYXhpc1RpdGxlTWFyZ2luPQ0KMCk7Yz1hLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2ImJihjPWYoW3RoaXMuc3dhcFooe3g6Yy54LHk6Yy55LHo6MH0pXSx0aGlzLmNoYXJ0LCExKVswXSxjW3RoaXMuaG9yaXo/InkiOiJ4Il0rPSh0aGlzLmhvcml6PzE6LTEpKih0aGlzLm9wcG9zaXRlPy0xOjEpKmQsdGhpcy5heGlzVGl0bGVNYXJnaW49ZCk7cmV0dXJuIGN9KTtlKGsucHJvdG90eXBlLCJkcmF3Q3Jvc3NoYWlyIixmdW5jdGlvbihhKXt2YXIgYj1hcmd1bWVudHM7dGhpcy5jaGFydC5pczNkKCkmJmJbMl0mJihiWzJdPXtwbG90WDpiWzJdLnBsb3RYb2xkfHxiWzJdLnBsb3RYLHBsb3RZOmJbMl0ucGxvdFlvbGR8fGJbMl0ucGxvdFl9KTthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChiLDEpKX0pO2sucHJvdG90eXBlLnN3YXBaPWZ1bmN0aW9uKGEsYil7aWYodGhpcy5pc1pBeGlzKXtiPWI/MDp0aGlzLmNoYXJ0LnBsb3RMZWZ0O3ZhciBjPXRoaXMuY2hhcnQ7cmV0dXJue3g6YisoYy55QXhpc1swXS5vcHBvc2l0ZT8NCmEuejpjLnhBeGlzWzBdLndpZHRoLWEueikseTphLnksejphLngtYn19cmV0dXJuIGF9O3E9YS5aQXhpcz1mdW5jdGlvbigpe3RoaXMuaXNaQXhpcz0hMDt0aGlzLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt1KHEucHJvdG90eXBlLGsucHJvdG90eXBlKTt1KHEucHJvdG90eXBlLHtzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe2E9bSh7b2Zmc2V0OjAsbGluZVdpZHRoOjB9LGEpO2sucHJvdG90eXBlLnNldE9wdGlvbnMuY2FsbCh0aGlzLGEpO3RoaXMuY29sbD0iekF4aXMifSxzZXRBeGlzU2l6ZTpmdW5jdGlvbigpe2sucHJvdG90eXBlLnNldEF4aXNTaXplLmNhbGwodGhpcyk7dGhpcy53aWR0aD10aGlzLmxlbj10aGlzLmNoYXJ0Lm9wdGlvbnMuY2hhcnQub3B0aW9uczNkLmRlcHRoO3RoaXMucmlnaHQ9dGhpcy5jaGFydC5jaGFydFdpZHRoLXRoaXMud2lkdGgtdGhpcy5sZWZ0fSxnZXRTZXJpZXNFeHRyZW1lczpmdW5jdGlvbigpe3ZhciBhPXRoaXMsYj1hLmNoYXJ0O2EuaGFzVmlzaWJsZVNlcmllcz0NCiExO2EuZGF0YU1pbj1hLmRhdGFNYXg9YS5pZ25vcmVNaW5QYWRkaW5nPWEuaWdub3JlTWF4UGFkZGluZz1udWxsO2EuYnVpbGRTdGFja3MmJmEuYnVpbGRTdGFja3MoKTtuKGEuc2VyaWVzLGZ1bmN0aW9uKGMpe2lmKGMudmlzaWJsZXx8IWIub3B0aW9ucy5jaGFydC5pZ25vcmVIaWRkZW5TZXJpZXMpYS5oYXNWaXNpYmxlU2VyaWVzPSEwLGM9Yy56RGF0YSxjLmxlbmd0aCYmKGEuZGF0YU1pbj1NYXRoLm1pbihnKGEuZGF0YU1pbixjWzBdKSxNYXRoLm1pbi5hcHBseShudWxsLGMpKSxhLmRhdGFNYXg9TWF0aC5tYXgoZyhhLmRhdGFNYXgsY1swXSksTWF0aC5tYXguYXBwbHkobnVsbCxjKSkpfSl9fSk7ZShwLnByb3RvdHlwZSwiZ2V0QXhlcyIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcyxjPXRoaXMub3B0aW9ucyxjPWMuekF4aXM9cihjLnpBeGlzfHx7fSk7YS5jYWxsKHRoaXMpO2IuaXMzZCgpJiYodGhpcy56QXhpcz1bXSxuKGMsZnVuY3Rpb24oYSxjKXthLmluZGV4PWM7YS5pc1g9ITA7DQoobmV3IHEoYixhKSkuc2V0U2NhbGUoKX0pKX0pfSkoRCk7KGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIHEoYSl7dmFyIGQ9YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTt0aGlzLmNoYXJ0LmlzM2QoKSYmKGQuc3Ryb2tlPXRoaXMub3B0aW9ucy5lZGdlQ29sb3J8fGQuZmlsbCxkWyJzdHJva2Utd2lkdGgiXT11KHRoaXMub3B0aW9ucy5lZGdlV2lkdGgsMSkpO3JldHVybiBkfWZ1bmN0aW9uIGsoYSl7aWYodGhpcy5jaGFydC5pczNkKCkpe3ZhciBkPXRoaXMuY2hhcnQub3B0aW9ucy5wbG90T3B0aW9ucy5jb2x1bW4uZ3JvdXBpbmc7dm9pZCAwPT09ZHx8ZHx8dm9pZCAwPT09dGhpcy5ncm91cC56SW5kZXh8fHRoaXMuekluZGV4U2V0fHwodGhpcy5ncm91cC5hdHRyKHt6SW5kZXg6MTAqdGhpcy5ncm91cC56SW5kZXh9KSx0aGlzLnpJbmRleFNldD0hMCl9YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX12YXIgcD1hLmVhY2gsbj1hLnBlcnNwZWN0aXZlLA0KdT1hLnBpY2ssbT1hLlNlcmllcyxmPWEuc2VyaWVzVHlwZXMsZz1hLnN2ZzthPWEud3JhcDthKGYuY29sdW1uLnByb3RvdHlwZSwidHJhbnNsYXRlIixmdW5jdGlvbihhKXthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKHRoaXMuY2hhcnQuaXMzZCgpKXt2YXIgZD10aGlzLmNoYXJ0LGU9dGhpcy5vcHRpb25zLGM9ZS5kZXB0aHx8MjUsYj0oZS5zdGFja2luZz9lLnN0YWNrfHwwOnRoaXMuX2kpKihjKyhlLmdyb3VwWlBhZGRpbmd8fDEpKTshMSE9PWUuZ3JvdXBpbmcmJihiPTApO2IrPWUuZ3JvdXBaUGFkZGluZ3x8MTtwKHRoaXMuZGF0YSxmdW5jdGlvbihhKXtpZihudWxsIT09YS55KXt2YXIgZT1hLnNoYXBlQXJncyxoPWEudG9vbHRpcFBvczthLnNoYXBlVHlwZT0iY3Vib2lkIjtlLno9YjtlLmRlcHRoPWM7ZS5pbnNpZGVQbG90QXJlYT0hMDtoPW4oW3t4OmhbMF0seTpoWzFdLHo6Yn1dLGQsITApWzBdO2EudG9vbHRpcFBvcz1baC54LGgueV19fSk7DQp0aGlzLno9Yn19KTthKGYuY29sdW1uLnByb3RvdHlwZSwiYW5pbWF0ZSIsZnVuY3Rpb24oYSl7aWYodGhpcy5jaGFydC5pczNkKCkpe3ZhciBkPWFyZ3VtZW50c1sxXSxlPXRoaXMueUF4aXMsYz10aGlzLGI9dGhpcy55QXhpcy5yZXZlcnNlZDtnJiYoZD9wKGMuZGF0YSxmdW5jdGlvbihhKXtudWxsIT09YS55JiYoYS5oZWlnaHQ9YS5zaGFwZUFyZ3MuaGVpZ2h0LGEuc2hhcGV5PWEuc2hhcGVBcmdzLnksYS5zaGFwZUFyZ3MuaGVpZ2h0PTEsYnx8KGEuc2hhcGVBcmdzLnk9YS5zdGFja1k/YS5wbG90WStlLnRyYW5zbGF0ZShhLnN0YWNrWSk6YS5wbG90WSsoYS5uZWdhdGl2ZT8tYS5oZWlnaHQ6YS5oZWlnaHQpKSl9KToocChjLmRhdGEsZnVuY3Rpb24oYSl7bnVsbCE9PWEueSYmKGEuc2hhcGVBcmdzLmhlaWdodD1hLmhlaWdodCxhLnNoYXBlQXJncy55PWEuc2hhcGV5LGEuZ3JhcGhpYyYmYS5ncmFwaGljLmFuaW1hdGUoYS5zaGFwZUFyZ3MsYy5vcHRpb25zLmFuaW1hdGlvbikpfSksDQp0aGlzLmRyYXdEYXRhTGFiZWxzKCksYy5hbmltYXRlPW51bGwpKX1lbHNlIGEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTthKGYuY29sdW1uLnByb3RvdHlwZSwiaW5pdCIsZnVuY3Rpb24oYSl7YS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTtpZih0aGlzLmNoYXJ0LmlzM2QoKSl7dmFyIGQ9dGhpcy5vcHRpb25zLGU9ZC5ncm91cGluZyxjPWQuc3RhY2tpbmcsYj11KHRoaXMueUF4aXMub3B0aW9ucy5yZXZlcnNlZFN0YWNrcywhMCksZj0wO2lmKHZvaWQgMD09PWV8fGUpe2U9dGhpcy5jaGFydC5yZXRyaWV2ZVN0YWNrcyhjKTtmPWQuc3RhY2t8fDA7Zm9yKGM9MDtjPGVbZl0uc2VyaWVzLmxlbmd0aCYmZVtmXS5zZXJpZXNbY10hPT10aGlzO2MrKyk7Zj0xMCooZS50b3RhbFN0YWNrcy1lW2ZdLnBvc2l0aW9uKSsoYj9jOi1jKTt0aGlzLnhBeGlzLnJldmVyc2VkfHwoZj0xMCplLnRvdGFsU3RhY2tzLWYpfWQuekluZGV4PWZ9fSk7DQphKGYuY29sdW1uLnByb3RvdHlwZSwicG9pbnRBdHRyaWJzIixxKTtmLmNvbHVtbnJhbmdlJiZhKGYuY29sdW1ucmFuZ2UucHJvdG90eXBlLCJwb2ludEF0dHJpYnMiLHEpO2EobS5wcm90b3R5cGUsImFsaWduRGF0YUxhYmVsIixmdW5jdGlvbihhKXtpZih0aGlzLmNoYXJ0LmlzM2QoKSYmKCJjb2x1bW4iPT09dGhpcy50eXBlfHwiY29sdW1ucmFuZ2UiPT09dGhpcy50eXBlKSl7dmFyIGQ9YXJndW1lbnRzWzRdLGU9e3g6ZC54LHk6ZC55LHo6dGhpcy56fSxlPW4oW2VdLHRoaXMuY2hhcnQsITApWzBdO2QueD1lLng7ZC55PWUueX1hLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSk7Zi5jb2x1bW5yYW5nZSYmYShmLmNvbHVtbnJhbmdlLnByb3RvdHlwZSwiZHJhd1BvaW50cyIsayk7YShmLmNvbHVtbi5wcm90b3R5cGUsImRyYXdQb2ludHMiLGspfSkoRCk7KGZ1bmN0aW9uKGEpe3ZhciBxPWEuZGVnMnJhZCxrPWEuZWFjaCxwPWEucGljayxuPWEuc2VyaWVzVHlwZXMsDQp1PWEuc3ZnO2E9YS53cmFwO2Eobi5waWUucHJvdG90eXBlLCJ0cmFuc2xhdGUiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7aWYodGhpcy5jaGFydC5pczNkKCkpe3ZhciBmPXRoaXMsZz1mLm9wdGlvbnMsbT1nLmRlcHRofHwwLGQ9Zi5jaGFydC5vcHRpb25zLmNoYXJ0Lm9wdGlvbnMzZCxlPWQuYWxwaGEsYz1kLmJldGEsYj1nLnN0YWNraW5nPyhnLnN0YWNrfHwwKSptOmYuX2kqbSxiPWIrbS8yOyExIT09Zy5ncm91cGluZyYmKGI9MCk7ayhmLmRhdGEsZnVuY3Rpb24oYSl7dmFyIGQ9YS5zaGFwZUFyZ3M7YS5zaGFwZVR5cGU9ImFyYzNkIjtkLno9YjtkLmRlcHRoPS43NSptO2QuYWxwaGE9ZTtkLmJldGE9YztkLmNlbnRlcj1mLmNlbnRlcjtkPShkLmVuZCtkLnN0YXJ0KS8yO2Euc2xpY2VkVHJhbnNsYXRpb249e3RyYW5zbGF0ZVg6TWF0aC5yb3VuZChNYXRoLmNvcyhkKSpnLnNsaWNlZE9mZnNldCpNYXRoLmNvcyhlKnEpKSx0cmFuc2xhdGVZOk1hdGgucm91bmQoTWF0aC5zaW4oZCkqDQpnLnNsaWNlZE9mZnNldCpNYXRoLmNvcyhlKnEpKX19KX19KTthKG4ucGllLnByb3RvdHlwZS5wb2ludENsYXNzLnByb3RvdHlwZSwiaGFsb1BhdGgiLGZ1bmN0aW9uKGEpe3ZhciBmPWFyZ3VtZW50cztyZXR1cm4gdGhpcy5zZXJpZXMuY2hhcnQuaXMzZCgpP1tdOmEuY2FsbCh0aGlzLGZbMV0pfSk7YShuLnBpZS5wcm90b3R5cGUsInBvaW50QXR0cmlicyIsZnVuY3Rpb24oYSxmLGcpe2E9YS5jYWxsKHRoaXMsZixnKTtnPXRoaXMub3B0aW9uczt0aGlzLmNoYXJ0LmlzM2QoKSYmKGEuc3Ryb2tlPWcuZWRnZUNvbG9yfHxmLmNvbG9yfHx0aGlzLmNvbG9yLGFbInN0cm9rZS13aWR0aCJdPXAoZy5lZGdlV2lkdGgsMSkpO3JldHVybiBhfSk7YShuLnBpZS5wcm90b3R5cGUsImRyYXdQb2ludHMiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7dGhpcy5jaGFydC5pczNkKCkmJmsodGhpcy5wb2ludHMsZnVuY3Rpb24oYSl7dmFyIGY9YS5ncmFwaGljOw0KaWYoZilmW2EueSYmYS52aXNpYmxlPyJzaG93IjoiaGlkZSJdKCl9KX0pO2Eobi5waWUucHJvdG90eXBlLCJkcmF3RGF0YUxhYmVscyIsZnVuY3Rpb24oYSl7aWYodGhpcy5jaGFydC5pczNkKCkpe3ZhciBmPXRoaXMuY2hhcnQub3B0aW9ucy5jaGFydC5vcHRpb25zM2Q7ayh0aGlzLmRhdGEsZnVuY3Rpb24oYSl7dmFyIGc9YS5zaGFwZUFyZ3MsZD1nLnIsZT0oZy5zdGFydCtnLmVuZCkvMixjPWEubGFiZWxQb3MsYj0tZCooMS1NYXRoLmNvcygoZy5hbHBoYXx8Zi5hbHBoYSkqcSkpKk1hdGguc2luKGUpLGg9ZCooTWF0aC5jb3MoKGcuYmV0YXx8Zi5iZXRhKSpxKS0xKSpNYXRoLmNvcyhlKTtrKFswLDIsNF0sZnVuY3Rpb24oYSl7Y1thXSs9aDtjW2ErMV0rPWJ9KX0pfWEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSl9KTthKG4ucGllLnByb3RvdHlwZSwiYWRkUG9pbnQiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7DQp0aGlzLmNoYXJ0LmlzM2QoKSYmdGhpcy51cGRhdGUodGhpcy51c2VyT3B0aW9ucywhMCl9KTthKG4ucGllLnByb3RvdHlwZSwiYW5pbWF0ZSIsZnVuY3Rpb24oYSl7aWYodGhpcy5jaGFydC5pczNkKCkpe3ZhciBmPWFyZ3VtZW50c1sxXSxnPXRoaXMub3B0aW9ucy5hbmltYXRpb24saz10aGlzLmNlbnRlcixkPXRoaXMuZ3JvdXAsZT10aGlzLm1hcmtlckdyb3VwO3UmJighMD09PWcmJihnPXt9KSxmPyhkLm9sZHRyYW5zbGF0ZVg9ZC50cmFuc2xhdGVYLGQub2xkdHJhbnNsYXRlWT1kLnRyYW5zbGF0ZVksZj17dHJhbnNsYXRlWDprWzBdLHRyYW5zbGF0ZVk6a1sxXSxzY2FsZVg6LjAwMSxzY2FsZVk6LjAwMX0sZC5hdHRyKGYpLGUmJihlLmF0dHJTZXR0ZXJzPWQuYXR0clNldHRlcnMsZS5hdHRyKGYpKSk6KGY9e3RyYW5zbGF0ZVg6ZC5vbGR0cmFuc2xhdGVYLHRyYW5zbGF0ZVk6ZC5vbGR0cmFuc2xhdGVZLHNjYWxlWDoxLHNjYWxlWToxfSxkLmFuaW1hdGUoZixnKSxlJiZlLmFuaW1hdGUoZiwNCmcpLHRoaXMuYW5pbWF0ZT1udWxsKSl9ZWxzZSBhLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpfSl9KShEKTsoZnVuY3Rpb24oYSl7dmFyIHE9YS5wZXJzcGVjdGl2ZSxrPWEucGljayxwPWEuUG9pbnQsbj1hLnNlcmllc1R5cGVzLHU9YS53cmFwO3Uobi5zY2F0dGVyLnByb3RvdHlwZSwidHJhbnNsYXRlIixmdW5jdGlvbihhKXthLmFwcGx5KHRoaXMsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpO2lmKHRoaXMuY2hhcnQuaXMzZCgpKXt2YXIgZj10aGlzLmNoYXJ0LGc9ayh0aGlzLnpBeGlzLGYub3B0aW9ucy56QXhpc1swXSksbT1bXSxkLGUsYztmb3IoYz0wO2M8dGhpcy5kYXRhLmxlbmd0aDtjKyspZD10aGlzLmRhdGFbY10sZT1nLmlzTG9nJiZnLnZhbDJsaW4/Zy52YWwybGluKGQueik6ZC56LGQucGxvdFo9Zy50cmFuc2xhdGUoZSksZC5pc0luc2lkZT1kLmlzSW5zaWRlP2U+PWcubWluJiZlPD1nLm1heDohMSxtLnB1c2goe3g6ZC5wbG90WCx5OmQucGxvdFksDQp6OmQucGxvdFp9KTtmPXEobSxmLCEwKTtmb3IoYz0wO2M8dGhpcy5kYXRhLmxlbmd0aDtjKyspZD10aGlzLmRhdGFbY10sZz1mW2NdLGQucGxvdFhvbGQ9ZC5wbG90WCxkLnBsb3RZb2xkPWQucGxvdFksZC5wbG90Wm9sZD1kLnBsb3RaLGQucGxvdFg9Zy54LGQucGxvdFk9Zy55LGQucGxvdFo9Zy56fX0pO3Uobi5zY2F0dGVyLnByb3RvdHlwZSwiaW5pdCIsZnVuY3Rpb24oYSxmLGcpe2YuaXMzZCgpJiYodGhpcy5heGlzVHlwZXM9WyJ4QXhpcyIsInlBeGlzIiwiekF4aXMiXSx0aGlzLnBvaW50QXJyYXlNYXA9WyJ4IiwieSIsInoiXSx0aGlzLnBhcmFsbGVsQXJyYXlzPVsieCIsInkiLCJ6Il0sdGhpcy5kaXJlY3RUb3VjaD0hMCk7YT1hLmFwcGx5KHRoaXMsW2YsZ10pO3RoaXMuY2hhcnQuaXMzZCgpJiYodGhpcy50b29sdGlwT3B0aW9ucy5wb2ludEZvcm1hdD10aGlzLnVzZXJPcHRpb25zLnRvb2x0aXA/dGhpcy51c2VyT3B0aW9ucy50b29sdGlwLnBvaW50Rm9ybWF0fHwieDogXHgzY2JceDNle3BvaW50Lnh9XHgzYy9iXHgzZVx4M2Nici9ceDNleTogXHgzY2JceDNle3BvaW50Lnl9XHgzYy9iXHgzZVx4M2Nici9ceDNlejogXHgzY2JceDNle3BvaW50Lnp9XHgzYy9iXHgzZVx4M2Nici9ceDNlIjoNCiJ4OiBceDNjYlx4M2V7cG9pbnQueH1ceDNjL2JceDNlXHgzY2JyL1x4M2V5OiBceDNjYlx4M2V7cG9pbnQueX1ceDNjL2JceDNlXHgzY2JyL1x4M2V6OiBceDNjYlx4M2V7cG9pbnQuen1ceDNjL2JceDNlXHgzY2JyL1x4M2UiKTtyZXR1cm4gYX0pO3Uobi5zY2F0dGVyLnByb3RvdHlwZSwicG9pbnRBdHRyaWJzIixmdW5jdGlvbihrLGYpe3ZhciBnPWsuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7dGhpcy5jaGFydC5pczNkKCkmJmYmJihnLnpJbmRleD1hLnBvaW50Q2FtZXJhRGlzdGFuY2UoZix0aGlzLmNoYXJ0KSk7cmV0dXJuIGd9KTt1KHAucHJvdG90eXBlLCJhcHBseU9wdGlvbnMiLGZ1bmN0aW9uKGEpe3ZhciBmPWEuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7dGhpcy5zZXJpZXMuY2hhcnQuaXMzZCgpJiZ2b2lkIDA9PT1mLnomJihmLno9MCk7cmV0dXJuIGZ9KX0pKEQpOyhmdW5jdGlvbihhKXt2YXIgcT1hLkF4aXMsaz1hLlNWR1JlbmRlcmVyLA0KcD1hLlZNTFJlbmRlcmVyO3AmJihhLnNldE9wdGlvbnMoe2FuaW1hdGU6ITF9KSxwLnByb3RvdHlwZS5jdWJvaWQ9ay5wcm90b3R5cGUuY3Vib2lkLHAucHJvdG90eXBlLmN1Ym9pZFBhdGg9ay5wcm90b3R5cGUuY3Vib2lkUGF0aCxwLnByb3RvdHlwZS50b0xpbmVQYXRoPWsucHJvdG90eXBlLnRvTGluZVBhdGgscC5wcm90b3R5cGUuY3JlYXRlRWxlbWVudDNEPWsucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQzRCxwLnByb3RvdHlwZS5hcmMzZD1mdW5jdGlvbihhKXthPWsucHJvdG90eXBlLmFyYzNkLmNhbGwodGhpcyxhKTthLmNzcyh7ekluZGV4OmEuekluZGV4fSk7cmV0dXJuIGF9LGEuVk1MUmVuZGVyZXIucHJvdG90eXBlLmFyYzNkUGF0aD1hLlNWR1JlbmRlcmVyLnByb3RvdHlwZS5hcmMzZFBhdGgsYS53cmFwKHEucHJvdG90eXBlLCJyZW5kZXIiLGZ1bmN0aW9uKGEpe2EuYXBwbHkodGhpcyxbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7dGhpcy5zaWRlRnJhbWUmJih0aGlzLnNpZGVGcmFtZS5jc3Moe3pJbmRleDowfSksDQp0aGlzLnNpZGVGcmFtZS5mcm9udC5hdHRyKHtmaWxsOnRoaXMuc2lkZUZyYW1lLmNvbG9yfSkpO3RoaXMuYm90dG9tRnJhbWUmJih0aGlzLmJvdHRvbUZyYW1lLmNzcyh7ekluZGV4OjF9KSx0aGlzLmJvdHRvbUZyYW1lLmZyb250LmF0dHIoe2ZpbGw6dGhpcy5ib3R0b21GcmFtZS5jb2xvcn0pKTt0aGlzLmJhY2tGcmFtZSYmKHRoaXMuYmFja0ZyYW1lLmNzcyh7ekluZGV4OjB9KSx0aGlzLmJhY2tGcmFtZS5mcm9udC5hdHRyKHtmaWxsOnRoaXMuYmFja0ZyYW1lLmNvbG9yfSkpfSkpfSkoRCl9KTsNCgovKg0KIEhpZ2hjaGFydHMgSlMgdjUuMC45ICgyMDE3LTAzLTA4KQ0KDQogKGMpIDIwMDktMjAxNiBUb3JzdGVpbiBIb25zaQ0KDQogTGljZW5zZTogd3d3LmhpZ2hjaGFydHMuY29tL2xpY2Vuc2UNCiAqLw0KKGZ1bmN0aW9uKHcpeyJvYmplY3QiPT09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9dzp3KEhpZ2hjaGFydHMpfSkoZnVuY3Rpb24odyl7KGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIHAoYSxiLGQpe3RoaXMuaW5pdChhLGIsZCl9dmFyIHU9YS5lYWNoLHY9YS5leHRlbmQsbD1hLm1lcmdlLHI9YS5zcGxhdDt2KHAucHJvdG90eXBlLHtpbml0OmZ1bmN0aW9uKGEsYixkKXt2YXIgZz10aGlzLG09Zy5kZWZhdWx0T3B0aW9ucztnLmNoYXJ0PWI7Zy5vcHRpb25zPWE9bChtLGIuYW5ndWxhcj97YmFja2dyb3VuZDp7fX06dm9pZCAwLGEpOyhhPWEuYmFja2dyb3VuZCkmJnUoW10uY29uY2F0KHIoYSkpLnJldmVyc2UoKSxmdW5jdGlvbihiKXt2YXIgYyxtPWQudXNlck9wdGlvbnM7Yz1sKGcuZGVmYXVsdEJhY2tncm91bmRPcHRpb25zLGIpO2IuYmFja2dyb3VuZENvbG9yJiYoYy5iYWNrZ3JvdW5kQ29sb3I9Yi5iYWNrZ3JvdW5kQ29sb3IpO2MuY29sb3I9Yy5iYWNrZ3JvdW5kQ29sb3I7DQogICAgZC5vcHRpb25zLnBsb3RCYW5kcy51bnNoaWZ0KGMpO20ucGxvdEJhbmRzPW0ucGxvdEJhbmRzfHxbXTttLnBsb3RCYW5kcyE9PWQub3B0aW9ucy5wbG90QmFuZHMmJm0ucGxvdEJhbmRzLnVuc2hpZnQoYyl9KX0sZGVmYXVsdE9wdGlvbnM6e2NlbnRlcjpbIjUwJSIsIjUwJSJdLHNpemU6Ijg1JSIsc3RhcnRBbmdsZTowfSxkZWZhdWx0QmFja2dyb3VuZE9wdGlvbnM6e2NsYXNzTmFtZToiaGlnaGNoYXJ0cy1wYW5lIixzaGFwZToiY2lyY2xlIixib3JkZXJXaWR0aDoxLGJvcmRlckNvbG9yOiIjY2NjY2NjIixiYWNrZ3JvdW5kQ29sb3I6e2xpbmVhckdyYWRpZW50Ont4MTowLHkxOjAseDI6MCx5MjoxfSxzdG9wczpbWzAsIiNmZmZmZmYiXSxbMSwiI2U2ZTZlNiJdXX0sZnJvbTotTnVtYmVyLk1BWF9WQUxVRSxpbm5lclJhZGl1czowLHRvOk51bWJlci5NQVhfVkFMVUUsb3V0ZXJSYWRpdXM6IjEwNSUifX0pO2EuUGFuZT1wfSkodyk7KGZ1bmN0aW9uKGEpe3ZhciBwPWEuQ2VudGVyZWRTZXJpZXNNaXhpbiwNCiAgICB1PWEuZWFjaCx2PWEuZXh0ZW5kLGw9YS5tYXAscj1hLm1lcmdlLGU9YS5ub29wLGI9YS5QYW5lLGQ9YS5waWNrLGc9YS5wSW50LG09YS5zcGxhdCxuPWEud3JhcCxjLGssaD1hLkF4aXMucHJvdG90eXBlO2E9YS5UaWNrLnByb3RvdHlwZTtjPXtnZXRPZmZzZXQ6ZSxyZWRyYXc6ZnVuY3Rpb24oKXt0aGlzLmlzRGlydHk9ITF9LHJlbmRlcjpmdW5jdGlvbigpe3RoaXMuaXNEaXJ0eT0hMX0sc2V0U2NhbGU6ZSxzZXRDYXRlZ29yaWVzOmUsc2V0VGl0bGU6ZX07az17ZGVmYXVsdFJhZGlhbEdhdWdlT3B0aW9uczp7bGFiZWxzOnthbGlnbjoiY2VudGVyIix4OjAseTpudWxsfSxtaW5vckdyaWRMaW5lV2lkdGg6MCxtaW5vclRpY2tJbnRlcnZhbDoiYXV0byIsbWlub3JUaWNrTGVuZ3RoOjEwLG1pbm9yVGlja1Bvc2l0aW9uOiJpbnNpZGUiLG1pbm9yVGlja1dpZHRoOjEsdGlja0xlbmd0aDoxMCx0aWNrUG9zaXRpb246Imluc2lkZSIsdGlja1dpZHRoOjIsdGl0bGU6e3JvdGF0aW9uOjB9LHpJbmRleDoyfSwNCiAgICBkZWZhdWx0UmFkaWFsWE9wdGlvbnM6e2dyaWRMaW5lV2lkdGg6MSxsYWJlbHM6e2FsaWduOm51bGwsZGlzdGFuY2U6MTUseDowLHk6bnVsbH0sbWF4UGFkZGluZzowLG1pblBhZGRpbmc6MCxzaG93TGFzdExhYmVsOiExLHRpY2tMZW5ndGg6MH0sZGVmYXVsdFJhZGlhbFlPcHRpb25zOntncmlkTGluZUludGVycG9sYXRpb246ImNpcmNsZSIsbGFiZWxzOnthbGlnbjoicmlnaHQiLHg6LTMseTotMn0sc2hvd0xhc3RMYWJlbDohMSx0aXRsZTp7eDo0LHRleHQ6bnVsbCxyb3RhdGlvbjo5MH19LHNldE9wdGlvbnM6ZnVuY3Rpb24oZCl7ZD10aGlzLm9wdGlvbnM9cih0aGlzLmRlZmF1bHRPcHRpb25zLHRoaXMuZGVmYXVsdFJhZGlhbE9wdGlvbnMsZCk7ZC5wbG90QmFuZHN8fChkLnBsb3RCYW5kcz1bXSl9LGdldE9mZnNldDpmdW5jdGlvbigpe2guZ2V0T2Zmc2V0LmNhbGwodGhpcyk7dGhpcy5jaGFydC5heGlzT2Zmc2V0W3RoaXMuc2lkZV09MDt0aGlzLmNlbnRlcj10aGlzLnBhbmUuY2VudGVyPQ0KICAgICAgICBwLmdldENlbnRlci5jYWxsKHRoaXMucGFuZSl9LGdldExpbmVQYXRoOmZ1bmN0aW9uKGIsZil7Yj10aGlzLmNlbnRlcjt2YXIgYz10aGlzLmNoYXJ0LGc9ZChmLGJbMl0vMi10aGlzLm9mZnNldCk7dGhpcy5pc0NpcmN1bGFyfHx2b2lkIDAhPT1mP2Y9dGhpcy5jaGFydC5yZW5kZXJlci5zeW1ib2xzLmFyYyh0aGlzLmxlZnQrYlswXSx0aGlzLnRvcCtiWzFdLGcsZyx7c3RhcnQ6dGhpcy5zdGFydEFuZ2xlUmFkLGVuZDp0aGlzLmVuZEFuZ2xlUmFkLG9wZW46ITAsaW5uZXJSOjB9KTooZj10aGlzLnBvc3RUcmFuc2xhdGUodGhpcy5hbmdsZVJhZCxnKSxmPVsiTSIsYlswXStjLnBsb3RMZWZ0LGJbMV0rYy5wbG90VG9wLCJMIixmLngsZi55XSk7cmV0dXJuIGZ9LHNldEF4aXNUcmFuc2xhdGlvbjpmdW5jdGlvbigpe2guc2V0QXhpc1RyYW5zbGF0aW9uLmNhbGwodGhpcyk7dGhpcy5jZW50ZXImJih0aGlzLnRyYW5zQT10aGlzLmlzQ2lyY3VsYXI/KHRoaXMuZW5kQW5nbGVSYWQtdGhpcy5zdGFydEFuZ2xlUmFkKS8NCiAgICAgICAgKHRoaXMubWF4LXRoaXMubWlufHwxKTp0aGlzLmNlbnRlclsyXS8yLyh0aGlzLm1heC10aGlzLm1pbnx8MSksdGhpcy5taW5QaXhlbFBhZGRpbmc9dGhpcy5pc1hBeGlzP3RoaXMudHJhbnNBKnRoaXMubWluUG9pbnRPZmZzZXQ6MCl9LGJlZm9yZVNldFRpY2tQb3NpdGlvbnM6ZnVuY3Rpb24oKXtpZih0aGlzLmF1dG9Db25uZWN0PXRoaXMuaXNDaXJjdWxhciYmdm9pZCAwPT09ZCh0aGlzLnVzZXJNYXgsdGhpcy5vcHRpb25zLm1heCkmJnRoaXMuZW5kQW5nbGVSYWQtdGhpcy5zdGFydEFuZ2xlUmFkPT09MipNYXRoLlBJKXRoaXMubWF4Kz10aGlzLmNhdGVnb3JpZXMmJjF8fHRoaXMucG9pbnRSYW5nZXx8dGhpcy5jbG9zZXN0UG9pbnRSYW5nZXx8MH0sc2V0QXhpc1NpemU6ZnVuY3Rpb24oKXtoLnNldEF4aXNTaXplLmNhbGwodGhpcyk7dGhpcy5pc1JhZGlhbCYmKHRoaXMuY2VudGVyPXRoaXMucGFuZS5jZW50ZXI9cC5nZXRDZW50ZXIuY2FsbCh0aGlzLnBhbmUpLHRoaXMuaXNDaXJjdWxhciYmDQogICAgKHRoaXMuc2VjdG9yPXRoaXMuZW5kQW5nbGVSYWQtdGhpcy5zdGFydEFuZ2xlUmFkKSx0aGlzLmxlbj10aGlzLndpZHRoPXRoaXMuaGVpZ2h0PXRoaXMuY2VudGVyWzJdKmQodGhpcy5zZWN0b3IsMSkvMil9LGdldFBvc2l0aW9uOmZ1bmN0aW9uKGIsZil7cmV0dXJuIHRoaXMucG9zdFRyYW5zbGF0ZSh0aGlzLmlzQ2lyY3VsYXI/dGhpcy50cmFuc2xhdGUoYik6dGhpcy5hbmdsZVJhZCxkKHRoaXMuaXNDaXJjdWxhcj9mOnRoaXMudHJhbnNsYXRlKGIpLHRoaXMuY2VudGVyWzJdLzIpLXRoaXMub2Zmc2V0KX0scG9zdFRyYW5zbGF0ZTpmdW5jdGlvbihiLGYpe3ZhciBkPXRoaXMuY2hhcnQsYz10aGlzLmNlbnRlcjtiPXRoaXMuc3RhcnRBbmdsZVJhZCtiO3JldHVybnt4OmQucGxvdExlZnQrY1swXStNYXRoLmNvcyhiKSpmLHk6ZC5wbG90VG9wK2NbMV0rTWF0aC5zaW4oYikqZn19LGdldFBsb3RCYW5kUGF0aDpmdW5jdGlvbihiLGYsYyl7dmFyIG09dGhpcy5jZW50ZXIsdD10aGlzLnN0YXJ0QW5nbGVSYWQsDQogICAgICAgIGg9bVsyXS8yLGE9W2QoYy5vdXRlclJhZGl1cywiMTAwJSIpLGMuaW5uZXJSYWRpdXMsZChjLnRoaWNrbmVzcywxMCldLHE9TWF0aC5taW4odGhpcy5vZmZzZXQsMCksaz0vJSQvLG4sZT10aGlzLmlzQ2lyY3VsYXI7InBvbHlnb24iPT09dGhpcy5vcHRpb25zLmdyaWRMaW5lSW50ZXJwb2xhdGlvbj9tPXRoaXMuZ2V0UGxvdExpbmVQYXRoKGIpLmNvbmNhdCh0aGlzLmdldFBsb3RMaW5lUGF0aChmLCEwKSk6KGI9TWF0aC5tYXgoYix0aGlzLm1pbiksZj1NYXRoLm1pbihmLHRoaXMubWF4KSxlfHwoYVswXT10aGlzLnRyYW5zbGF0ZShiKSxhWzFdPXRoaXMudHJhbnNsYXRlKGYpKSxhPWwoYSxmdW5jdGlvbihiKXtrLnRlc3QoYikmJihiPWcoYiwxMCkqaC8xMDApO3JldHVybiBifSksImNpcmNsZSIhPT1jLnNoYXBlJiZlPyhiPXQrdGhpcy50cmFuc2xhdGUoYiksZj10K3RoaXMudHJhbnNsYXRlKGYpKTooYj0tTWF0aC5QSS8yLGY9MS41Kk1hdGguUEksbj0hMCksYVswXS09cSxhWzJdLT0NCiAgICAgICAgICAgIHEsbT10aGlzLmNoYXJ0LnJlbmRlcmVyLnN5bWJvbHMuYXJjKHRoaXMubGVmdCttWzBdLHRoaXMudG9wK21bMV0sYVswXSxhWzBdLHtzdGFydDpNYXRoLm1pbihiLGYpLGVuZDpNYXRoLm1heChiLGYpLGlubmVyUjpkKGFbMV0sYVswXS1hWzJdKSxvcGVuOm59KSk7cmV0dXJuIG19LGdldFBsb3RMaW5lUGF0aDpmdW5jdGlvbihiLGYpe3ZhciBkPXRoaXMsYz1kLmNlbnRlcixnPWQuY2hhcnQsbT1kLmdldFBvc2l0aW9uKGIpLGEsaCxrO2QuaXNDaXJjdWxhcj9rPVsiTSIsY1swXStnLnBsb3RMZWZ0LGNbMV0rZy5wbG90VG9wLCJMIixtLngsbS55XToiY2lyY2xlIj09PWQub3B0aW9ucy5ncmlkTGluZUludGVycG9sYXRpb24/KGI9ZC50cmFuc2xhdGUoYikpJiYoaz1kLmdldExpbmVQYXRoKDAsYikpOih1KGcueEF4aXMsZnVuY3Rpb24oYil7Yi5wYW5lPT09ZC5wYW5lJiYoYT1iKX0pLGs9W10sYj1kLnRyYW5zbGF0ZShiKSxjPWEudGlja1Bvc2l0aW9ucyxhLmF1dG9Db25uZWN0JiYoYz0NCiAgICAgICAgICAgICAgICBjLmNvbmNhdChbY1swXV0pKSxmJiYoYz1bXS5jb25jYXQoYykucmV2ZXJzZSgpKSx1KGMsZnVuY3Rpb24oZCxjKXtoPWEuZ2V0UG9zaXRpb24oZCxiKTtrLnB1c2goYz8iTCI6Ik0iLGgueCxoLnkpfSkpO3JldHVybiBrfSxnZXRUaXRsZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5jZW50ZXIsZD10aGlzLmNoYXJ0LGM9dGhpcy5vcHRpb25zLnRpdGxlO3JldHVybnt4OmQucGxvdExlZnQrYlswXSsoYy54fHwwKSx5OmQucGxvdFRvcCtiWzFdLXtoaWdoOi41LG1pZGRsZTouMjUsbG93OjB9W2MuYWxpZ25dKmJbMl0rKGMueXx8MCl9fX07bihoLCJpbml0IixmdW5jdGlvbihnLGYsYSl7dmFyIGg9Zi5hbmd1bGFyLG49Zi5wb2xhcix0PWEuaXNYLHE9aCYmdCxlLHk9Zi5vcHRpb25zLGw9YS5wYW5lfHwwO2lmKGgpe2lmKHYodGhpcyxxP2M6ayksZT0hdCl0aGlzLmRlZmF1bHRSYWRpYWxPcHRpb25zPXRoaXMuZGVmYXVsdFJhZGlhbEdhdWdlT3B0aW9uc31lbHNlIG4mJih2KHRoaXMsDQogICAgayksdGhpcy5kZWZhdWx0UmFkaWFsT3B0aW9ucz0oZT10KT90aGlzLmRlZmF1bHRSYWRpYWxYT3B0aW9uczpyKHRoaXMuZGVmYXVsdFlBeGlzT3B0aW9ucyx0aGlzLmRlZmF1bHRSYWRpYWxZT3B0aW9ucykpO2h8fG4/KHRoaXMuaXNSYWRpYWw9ITAsZi5pbnZlcnRlZD0hMSx5LmNoYXJ0Lnpvb21UeXBlPW51bGwpOnRoaXMuaXNSYWRpYWw9ITE7Zy5jYWxsKHRoaXMsZixhKTtxfHwhaCYmIW58fChnPXRoaXMub3B0aW9ucyxmLnBhbmVzfHwoZi5wYW5lcz1bXSksdGhpcy5wYW5lPWY9Zi5wYW5lc1tsXT1mLnBhbmVzW2xdfHxuZXcgYihtKHkucGFuZSlbbF0sZix0aGlzKSxmPWYub3B0aW9ucyx0aGlzLmFuZ2xlUmFkPShnLmFuZ2xlfHwwKSpNYXRoLlBJLzE4MCx0aGlzLnN0YXJ0QW5nbGVSYWQ9KGYuc3RhcnRBbmdsZS05MCkqTWF0aC5QSS8xODAsdGhpcy5lbmRBbmdsZVJhZD0oZChmLmVuZEFuZ2xlLGYuc3RhcnRBbmdsZSszNjApLTkwKSpNYXRoLlBJLzE4MCx0aGlzLm9mZnNldD1nLm9mZnNldHx8DQogICAgMCx0aGlzLmlzQ2lyY3VsYXI9ZSl9KTtuKGgsImF1dG9MYWJlbEFsaWduIixmdW5jdGlvbihiKXtpZighdGhpcy5pc1JhZGlhbClyZXR1cm4gYi5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO24oYSwiZ2V0UG9zaXRpb24iLGZ1bmN0aW9uKGIsZCxjLGcsYSl7dmFyIGY9dGhpcy5heGlzO3JldHVybiBmLmdldFBvc2l0aW9uP2YuZ2V0UG9zaXRpb24oYyk6Yi5jYWxsKHRoaXMsZCxjLGcsYSl9KTtuKGEsImdldExhYmVsUG9zaXRpb24iLGZ1bmN0aW9uKGIsYyxnLGEsbSxoLGssbixlKXt2YXIgZj10aGlzLmF4aXMsdD1oLnkscT0yMCx6PWguYWxpZ24seT0oZi50cmFuc2xhdGUodGhpcy5wb3MpK2Yuc3RhcnRBbmdsZVJhZCtNYXRoLlBJLzIpL01hdGguUEkqMTgwJTM2MDtmLmlzUmFkaWFsPyhiPWYuZ2V0UG9zaXRpb24odGhpcy5wb3MsZi5jZW50ZXJbMl0vMitkKGguZGlzdGFuY2UsLTI1KSksImF1dG8iPT09aC5yb3RhdGlvbj9hLmF0dHIoe3JvdGF0aW9uOnl9KToNCiAgICAgICAgbnVsbD09PXQmJih0PWYuY2hhcnQucmVuZGVyZXIuZm9udE1ldHJpY3MoYS5zdHlsZXMuZm9udFNpemUpLmItYS5nZXRCQm94KCkuaGVpZ2h0LzIpLG51bGw9PT16JiYoZi5pc0NpcmN1bGFyPyh0aGlzLmxhYmVsLmdldEJCb3goKS53aWR0aD5mLmxlbipmLnRpY2tJbnRlcnZhbC8oZi5tYXgtZi5taW4pJiYocT0wKSx6PXk+cSYmeTwxODAtcT8ibGVmdCI6eT4xODArcSYmeTwzNjAtcT8icmlnaHQiOiJjZW50ZXIiKTp6PSJjZW50ZXIiLGEuYXR0cih7YWxpZ246en0pKSxiLngrPWgueCxiLnkrPXQpOmI9Yi5jYWxsKHRoaXMsYyxnLGEsbSxoLGssbixlKTtyZXR1cm4gYn0pO24oYSwiZ2V0TWFya1BhdGgiLGZ1bmN0aW9uKGIsYyxkLGcsYSxtLGgpe3ZhciBmPXRoaXMuYXhpcztmLmlzUmFkaWFsPyhiPWYuZ2V0UG9zaXRpb24odGhpcy5wb3MsZi5jZW50ZXJbMl0vMitnKSxjPVsiTSIsYyxkLCJMIixiLngsYi55XSk6Yz1iLmNhbGwodGhpcyxjLGQsZyxhLG0saCk7cmV0dXJuIGN9KX0pKHcpOw0KICAgIChmdW5jdGlvbihhKXt2YXIgcD1hLmVhY2gsdT1hLm5vb3Asdj1hLnBpY2ssbD1hLlNlcmllcyxyPWEuc2VyaWVzVHlwZSxlPWEuc2VyaWVzVHlwZXM7cigiYXJlYXJhbmdlIiwiYXJlYSIse2xpbmVXaWR0aDoxLG1hcmtlcjpudWxsLHRocmVzaG9sZDpudWxsLHRvb2x0aXA6e3BvaW50Rm9ybWF0OidceDNjc3BhbiBzdHlsZVx4M2QiY29sb3I6e3Nlcmllcy5jb2xvcn0iXHgzZVx1MjVjZlx4M2Mvc3Bhblx4M2Uge3Nlcmllcy5uYW1lfTogXHgzY2JceDNle3BvaW50Lmxvd31ceDNjL2JceDNlIC0gXHgzY2JceDNle3BvaW50LmhpZ2h9XHgzYy9iXHgzZVx4M2Nici9ceDNlJ30sdHJhY2tCeUFyZWE6ITAsZGF0YUxhYmVsczp7YWxpZ246bnVsbCx2ZXJ0aWNhbEFsaWduOm51bGwseExvdzowLHhIaWdoOjAseUxvdzowLHlIaWdoOjB9LHN0YXRlczp7aG92ZXI6e2hhbG86ITF9fX0se3BvaW50QXJyYXlNYXA6WyJsb3ciLCJoaWdoIl0sZGF0YUxhYmVsQ29sbGVjdGlvbnM6WyJkYXRhTGFiZWwiLA0KICAgICAgICAiZGF0YUxhYmVsVXBwZXIiXSx0b1lEYXRhOmZ1bmN0aW9uKGIpe3JldHVybltiLmxvdyxiLmhpZ2hdfSxwb2ludFZhbEtleToibG93IixkZWZlclRyYW5zbGF0ZVBvbGFyOiEwLGhpZ2hUb1hZOmZ1bmN0aW9uKGIpe3ZhciBkPXRoaXMuY2hhcnQsZz10aGlzLnhBeGlzLnBvc3RUcmFuc2xhdGUoYi5yZWN0UGxvdFgsdGhpcy55QXhpcy5sZW4tYi5wbG90SGlnaCk7Yi5wbG90SGlnaFg9Zy54LWQucGxvdExlZnQ7Yi5wbG90SGlnaD1nLnktZC5wbG90VG9wfSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLGQ9Yi55QXhpcyxnPSEhYi5tb2RpZnlWYWx1ZTtlLmFyZWEucHJvdG90eXBlLnRyYW5zbGF0ZS5hcHBseShiKTtwKGIucG9pbnRzLGZ1bmN0aW9uKGEpe3ZhciBtPWEubG93LGM9YS5oaWdoLGs9YS5wbG90WTtudWxsPT09Y3x8bnVsbD09PW0/YS5pc051bGw9ITA6KGEucGxvdExvdz1rLGEucGxvdEhpZ2g9ZC50cmFuc2xhdGUoZz9iLm1vZGlmeVZhbHVlKGMsYSk6YywwLDEsDQogICAgICAgICAgICAwLDEpLGcmJihhLnlCb3R0b209YS5wbG90SGlnaCkpfSk7dGhpcy5jaGFydC5wb2xhciYmcCh0aGlzLnBvaW50cyxmdW5jdGlvbihkKXtiLmhpZ2hUb1hZKGQpfSl9LGdldEdyYXBoUGF0aDpmdW5jdGlvbihiKXt2YXIgZD1bXSxnPVtdLGEsbj1lLmFyZWEucHJvdG90eXBlLmdldEdyYXBoUGF0aCxjLGssaDtoPXRoaXMub3B0aW9uczt2YXIgcT10aGlzLmNoYXJ0LnBvbGFyJiYhMSE9PWguY29ubmVjdEVuZHMsZj1oLnN0ZXA7Yj1ifHx0aGlzLnBvaW50cztmb3IoYT1iLmxlbmd0aDthLS07KWM9YlthXSxjLmlzTnVsbHx8cXx8YlthKzFdJiYhYlthKzFdLmlzTnVsbHx8Zy5wdXNoKHtwbG90WDpjLnBsb3RYLHBsb3RZOmMucGxvdFksZG9DdXJ2ZTohMX0pLGs9e3BvbGFyUGxvdFk6Yy5wb2xhclBsb3RZLHJlY3RQbG90WDpjLnJlY3RQbG90WCx5Qm90dG9tOmMueUJvdHRvbSxwbG90WDp2KGMucGxvdEhpZ2hYLGMucGxvdFgpLHBsb3RZOmMucGxvdEhpZ2gsaXNOdWxsOmMuaXNOdWxsfSwNCiAgICAgICAgZy5wdXNoKGspLGQucHVzaChrKSxjLmlzTnVsbHx8cXx8YlthLTFdJiYhYlthLTFdLmlzTnVsbHx8Zy5wdXNoKHtwbG90WDpjLnBsb3RYLHBsb3RZOmMucGxvdFksZG9DdXJ2ZTohMX0pO2I9bi5jYWxsKHRoaXMsYik7ZiYmKCEwPT09ZiYmKGY9ImxlZnQiKSxoLnN0ZXA9e2xlZnQ6InJpZ2h0IixjZW50ZXI6ImNlbnRlciIscmlnaHQ6ImxlZnQifVtmXSk7ZD1uLmNhbGwodGhpcyxkKTtnPW4uY2FsbCh0aGlzLGcpO2guc3RlcD1mO2g9W10uY29uY2F0KGIsZCk7dGhpcy5jaGFydC5wb2xhcnx8Ik0iIT09Z1swXXx8KGdbMF09IkwiKTt0aGlzLmdyYXBoUGF0aD1oO3RoaXMuYXJlYVBhdGg9dGhpcy5hcmVhUGF0aC5jb25jYXQoYixnKTtoLmlzQXJlYT0hMDtoLnhNYXA9Yi54TWFwO3RoaXMuYXJlYVBhdGgueE1hcD1iLnhNYXA7cmV0dXJuIGh9LGRyYXdEYXRhTGFiZWxzOmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5kYXRhLGQ9Yi5sZW5ndGgsYSxtPVtdLG49bC5wcm90b3R5cGUsYz10aGlzLm9wdGlvbnMuZGF0YUxhYmVscywNCiAgICAgICAgaz1jLmFsaWduLGg9Yy52ZXJ0aWNhbEFsaWduLHE9Yy5pbnNpZGUsZix0LGU9dGhpcy5jaGFydC5pbnZlcnRlZDtpZihjLmVuYWJsZWR8fHRoaXMuX2hhc1BvaW50TGFiZWxzKXtmb3IoYT1kO2EtLTspaWYoZj1iW2FdKXQ9cT9mLnBsb3RIaWdoPGYucGxvdExvdzpmLnBsb3RIaWdoPmYucGxvdExvdyxmLnk9Zi5oaWdoLGYuX3Bsb3RZPWYucGxvdFksZi5wbG90WT1mLnBsb3RIaWdoLG1bYV09Zi5kYXRhTGFiZWwsZi5kYXRhTGFiZWw9Zi5kYXRhTGFiZWxVcHBlcixmLmJlbG93PXQsZT9rfHwoYy5hbGlnbj10PyJyaWdodCI6ImxlZnQiKTpofHwoYy52ZXJ0aWNhbEFsaWduPXQ/InRvcCI6ImJvdHRvbSIpLGMueD1jLnhIaWdoLGMueT1jLnlIaWdoO24uZHJhd0RhdGFMYWJlbHMmJm4uZHJhd0RhdGFMYWJlbHMuYXBwbHkodGhpcyxhcmd1bWVudHMpO2ZvcihhPWQ7YS0tOylpZihmPWJbYV0pdD1xP2YucGxvdEhpZ2g8Zi5wbG90TG93OmYucGxvdEhpZ2g+Zi5wbG90TG93LGYuZGF0YUxhYmVsVXBwZXI9DQogICAgICAgIGYuZGF0YUxhYmVsLGYuZGF0YUxhYmVsPW1bYV0sZi55PWYubG93LGYucGxvdFk9Zi5fcGxvdFksZi5iZWxvdz0hdCxlP2t8fChjLmFsaWduPXQ/ImxlZnQiOiJyaWdodCIpOmh8fChjLnZlcnRpY2FsQWxpZ249dD8iYm90dG9tIjoidG9wIiksYy54PWMueExvdyxjLnk9Yy55TG93O24uZHJhd0RhdGFMYWJlbHMmJm4uZHJhd0RhdGFMYWJlbHMuYXBwbHkodGhpcyxhcmd1bWVudHMpfWMuYWxpZ249aztjLnZlcnRpY2FsQWxpZ249aH0sYWxpZ25EYXRhTGFiZWw6ZnVuY3Rpb24oKXtlLmNvbHVtbi5wcm90b3R5cGUuYWxpZ25EYXRhTGFiZWwuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRTdGFja2VkUG9pbnRzOnUsZ2V0U3ltYm9sOnUsZHJhd1BvaW50czp1fSl9KSh3KTsoZnVuY3Rpb24oYSl7dmFyIHA9YS5zZXJpZXNUeXBlO3AoImFyZWFzcGxpbmVyYW5nZSIsImFyZWFyYW5nZSIsbnVsbCx7Z2V0UG9pbnRTcGxpbmU6YS5zZXJpZXNUeXBlcy5zcGxpbmUucHJvdG90eXBlLmdldFBvaW50U3BsaW5lfSl9KSh3KTsNCiAgICAoZnVuY3Rpb24oYSl7dmFyIHA9YS5kZWZhdWx0UGxvdE9wdGlvbnMsdT1hLmVhY2gsdj1hLm1lcmdlLGw9YS5ub29wLHI9YS5waWNrLGU9YS5zZXJpZXNUeXBlLGI9YS5zZXJpZXNUeXBlcy5jb2x1bW4ucHJvdG90eXBlO2UoImNvbHVtbnJhbmdlIiwiYXJlYXJhbmdlIix2KHAuY29sdW1uLHAuYXJlYXJhbmdlLHtsaW5lV2lkdGg6MSxwb2ludFJhbmdlOm51bGx9KSx7dHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcyxhPWQueUF4aXMsbT1kLnhBeGlzLG49bS5zdGFydEFuZ2xlUmFkLGMsaz1kLmNoYXJ0LGg9ZC54QXhpcy5pc1JhZGlhbCxxO2IudHJhbnNsYXRlLmFwcGx5KGQpO3UoZC5wb2ludHMsZnVuY3Rpb24oYil7dmFyIGY9Yi5zaGFwZUFyZ3MsZz1kLm9wdGlvbnMubWluUG9pbnRMZW5ndGgsZSx4O2IucGxvdEhpZ2g9cT1hLnRyYW5zbGF0ZShiLmhpZ2gsMCwxLDAsMSk7Yi5wbG90TG93PWIucGxvdFk7eD1xO2U9cihiLnJlY3RQbG90WSxiLnBsb3RZKS1xO01hdGguYWJzKGUpPA0KICAgIGc/KGctPWUsZSs9Zyx4LT1nLzIpOjA+ZSYmKGUqPS0xLHgtPWUpO2g/KGM9Yi5iYXJYK24sYi5zaGFwZVR5cGU9InBhdGgiLGIuc2hhcGVBcmdzPXtkOmQucG9sYXJBcmMoeCtlLHgsYyxjK2IucG9pbnRXaWR0aCl9KTooZi5oZWlnaHQ9ZSxmLnk9eCxiLnRvb2x0aXBQb3M9ay5pbnZlcnRlZD9bYS5sZW4rYS5wb3Mtay5wbG90TGVmdC14LWUvMixtLmxlbittLnBvcy1rLnBsb3RUb3AtZi54LWYud2lkdGgvMixlXTpbbS5sZWZ0LWsucGxvdExlZnQrZi54K2Yud2lkdGgvMixhLnBvcy1rLnBsb3RUb3AreCtlLzIsZV0pfSl9LGRpcmVjdFRvdWNoOiEwLHRyYWNrZXJHcm91cHM6WyJncm91cCIsImRhdGFMYWJlbHNHcm91cCJdLGRyYXdHcmFwaDpsLGNyaXNwQ29sOmIuY3Jpc3BDb2wsZHJhd1BvaW50czpiLmRyYXdQb2ludHMsZHJhd1RyYWNrZXI6Yi5kcmF3VHJhY2tlcixnZXRDb2x1bW5NZXRyaWNzOmIuZ2V0Q29sdW1uTWV0cmljcyxhbmltYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGIuYW5pbWF0ZS5hcHBseSh0aGlzLA0KICAgICAgICBhcmd1bWVudHMpfSxwb2xhckFyYzpmdW5jdGlvbigpe3JldHVybiBiLnBvbGFyQXJjLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scG9pbnRBdHRyaWJzOmIucG9pbnRBdHRyaWJzfSl9KSh3KTsoZnVuY3Rpb24oYSl7dmFyIHA9YS5lYWNoLHU9YS5pc051bWJlcix2PWEubWVyZ2UsbD1hLnBpY2sscj1hLnBJbnQsZT1hLlNlcmllcyxiPWEuc2VyaWVzVHlwZSxkPWEuVHJhY2tlck1peGluO2IoImdhdWdlIiwibGluZSIse2RhdGFMYWJlbHM6e2VuYWJsZWQ6ITAsZGVmZXI6ITEseToxNSxib3JkZXJSYWRpdXM6Myxjcm9wOiExLHZlcnRpY2FsQWxpZ246InRvcCIsekluZGV4OjIsYm9yZGVyV2lkdGg6MSxib3JkZXJDb2xvcjoiI2NjY2NjYyJ9LGRpYWw6e30scGl2b3Q6e30sdG9vbHRpcDp7aGVhZGVyRm9ybWF0OiIifSxzaG93SW5MZWdlbmQ6ITF9LHthbmd1bGFyOiEwLGRpcmVjdFRvdWNoOiEwLGRyYXdHcmFwaDphLm5vb3AsZml4ZWRCb3g6ITAsZm9yY2VETDohMCxub1NoYXJlZFRvb2x0aXA6ITAsDQogICAgICAgIHRyYWNrZXJHcm91cHM6WyJncm91cCIsImRhdGFMYWJlbHNHcm91cCJdLHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBiPXRoaXMueUF4aXMsZD10aGlzLm9wdGlvbnMsYT1iLmNlbnRlcjt0aGlzLmdlbmVyYXRlUG9pbnRzKCk7cCh0aGlzLnBvaW50cyxmdW5jdGlvbihjKXt2YXIgZz12KGQuZGlhbCxjLmRpYWwpLGg9cihsKGcucmFkaXVzLDgwKSkqYVsyXS8yMDAsbT1yKGwoZy5iYXNlTGVuZ3RoLDcwKSkqaC8xMDAsZj1yKGwoZy5yZWFyTGVuZ3RoLDEwKSkqaC8xMDAsbj1nLmJhc2VXaWR0aHx8MyxlPWcudG9wV2lkdGh8fDEscD1kLm92ZXJzaG9vdCx4PWIuc3RhcnRBbmdsZVJhZCtiLnRyYW5zbGF0ZShjLnksbnVsbCxudWxsLG51bGwsITApO3UocCk/KHA9cC8xODAqTWF0aC5QSSx4PU1hdGgubWF4KGIuc3RhcnRBbmdsZVJhZC1wLE1hdGgubWluKGIuZW5kQW5nbGVSYWQrcCx4KSkpOiExPT09ZC53cmFwJiYoeD1NYXRoLm1heChiLnN0YXJ0QW5nbGVSYWQsTWF0aC5taW4oYi5lbmRBbmdsZVJhZCwNCiAgICAgICAgICAgICAgICB4KSkpO3g9MTgwKngvTWF0aC5QSTtjLnNoYXBlVHlwZT0icGF0aCI7Yy5zaGFwZUFyZ3M9e2Q6Zy5wYXRofHxbIk0iLC1mLC1uLzIsIkwiLG0sLW4vMixoLC1lLzIsaCxlLzIsbSxuLzIsLWYsbi8yLCJ6Il0sdHJhbnNsYXRlWDphWzBdLHRyYW5zbGF0ZVk6YVsxXSxyb3RhdGlvbjp4fTtjLnBsb3RYPWFbMF07Yy5wbG90WT1hWzFdfSl9LGRyYXdQb2ludHM6ZnVuY3Rpb24oKXt2YXIgYj10aGlzLGE9Yi55QXhpcy5jZW50ZXIsZD1iLnBpdm90LGM9Yi5vcHRpb25zLGs9Yy5waXZvdCxoPWIuY2hhcnQucmVuZGVyZXI7cChiLnBvaW50cyxmdW5jdGlvbihhKXt2YXIgZD1hLmdyYXBoaWMsZz1hLnNoYXBlQXJncyxrPWcuZCxtPXYoYy5kaWFsLGEuZGlhbCk7ZD8oZC5hbmltYXRlKGcpLGcuZD1rKTooYS5ncmFwaGljPWhbYS5zaGFwZVR5cGVdKGcpLmF0dHIoe3JvdGF0aW9uOmcucm90YXRpb24sekluZGV4OjF9KS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1kaWFsIikuYWRkKGIuZ3JvdXApLGEuZ3JhcGhpYy5hdHRyKHtzdHJva2U6bS5ib3JkZXJDb2xvcnx8DQogICAgICAgICAgICAibm9uZSIsInN0cm9rZS13aWR0aCI6bS5ib3JkZXJXaWR0aHx8MCxmaWxsOm0uYmFja2dyb3VuZENvbG9yfHwiIzAwMDAwMCJ9KSl9KTtkP2QuYW5pbWF0ZSh7dHJhbnNsYXRlWDphWzBdLHRyYW5zbGF0ZVk6YVsxXX0pOihiLnBpdm90PWguY2lyY2xlKDAsMCxsKGsucmFkaXVzLDUpKS5hdHRyKHt6SW5kZXg6Mn0pLmFkZENsYXNzKCJoaWdoY2hhcnRzLXBpdm90IikudHJhbnNsYXRlKGFbMF0sYVsxXSkuYWRkKGIuZ3JvdXApLGIucGl2b3QuYXR0cih7InN0cm9rZS13aWR0aCI6ay5ib3JkZXJXaWR0aHx8MCxzdHJva2U6ay5ib3JkZXJDb2xvcnx8IiNjY2NjY2MiLGZpbGw6ay5iYWNrZ3JvdW5kQ29sb3J8fCIjMDAwMDAwIn0pKX0sYW5pbWF0ZTpmdW5jdGlvbihiKXt2YXIgYT10aGlzO2J8fChwKGEucG9pbnRzLGZ1bmN0aW9uKGIpe3ZhciBkPWIuZ3JhcGhpYztkJiYoZC5hdHRyKHtyb3RhdGlvbjoxODAqYS55QXhpcy5zdGFydEFuZ2xlUmFkL01hdGguUEl9KSxkLmFuaW1hdGUoe3JvdGF0aW9uOmIuc2hhcGVBcmdzLnJvdGF0aW9ufSwNCiAgICAgICAgICAgIGEub3B0aW9ucy5hbmltYXRpb24pKX0pLGEuYW5pbWF0ZT1udWxsKX0scmVuZGVyOmZ1bmN0aW9uKCl7dGhpcy5ncm91cD10aGlzLnBsb3RHcm91cCgiZ3JvdXAiLCJzZXJpZXMiLHRoaXMudmlzaWJsZT8idmlzaWJsZSI6ImhpZGRlbiIsdGhpcy5vcHRpb25zLnpJbmRleCx0aGlzLmNoYXJ0LnNlcmllc0dyb3VwKTtlLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTt0aGlzLmdyb3VwLmNsaXAodGhpcy5jaGFydC5jbGlwUmVjdCl9LHNldERhdGE6ZnVuY3Rpb24oYixhKXtlLnByb3RvdHlwZS5zZXREYXRhLmNhbGwodGhpcyxiLCExKTt0aGlzLnByb2Nlc3NEYXRhKCk7dGhpcy5nZW5lcmF0ZVBvaW50cygpO2woYSwhMCkmJnRoaXMuY2hhcnQucmVkcmF3KCl9LGRyYXdUcmFja2VyOmQmJmQuZHJhd1RyYWNrZXJQb2ludH0se3NldFN0YXRlOmZ1bmN0aW9uKGIpe3RoaXMuc3RhdGU9Yn19KX0pKHcpOyhmdW5jdGlvbihhKXt2YXIgcD1hLmVhY2gsdT1hLm5vb3Asdj1hLnBpY2ssbD1hLnNlcmllc1R5cGUsDQogICAgICAgIHI9YS5zZXJpZXNUeXBlcztsKCJib3hwbG90IiwiY29sdW1uIix7dGhyZXNob2xkOm51bGwsdG9vbHRpcDp7cG9pbnRGb3JtYXQ6J1x4M2NzcGFuIHN0eWxlXHgzZCJjb2xvcjp7cG9pbnQuY29sb3J9Ilx4M2VcdTI1Y2ZceDNjL3NwYW5ceDNlIFx4M2NiXHgzZSB7c2VyaWVzLm5hbWV9XHgzYy9iXHgzZVx4M2Nici9ceDNlTWF4aW11bToge3BvaW50LmhpZ2h9XHgzY2JyL1x4M2VVcHBlciBxdWFydGlsZToge3BvaW50LnEzfVx4M2Nici9ceDNlTWVkaWFuOiB7cG9pbnQubWVkaWFufVx4M2Nici9ceDNlTG93ZXIgcXVhcnRpbGU6IHtwb2ludC5xMX1ceDNjYnIvXHgzZU1pbmltdW06IHtwb2ludC5sb3d9XHgzY2JyL1x4M2UnfSx3aGlza2VyTGVuZ3RoOiI1MCUiLGZpbGxDb2xvcjoiI2ZmZmZmZiIsbGluZVdpZHRoOjEsbWVkaWFuV2lkdGg6MixzdGF0ZXM6e2hvdmVyOnticmlnaHRuZXNzOi0uM319LHdoaXNrZXJXaWR0aDoyfSx7cG9pbnRBcnJheU1hcDpbImxvdyIsInExIiwibWVkaWFuIiwNCiAgICAgICAgInEzIiwiaGlnaCJdLHRvWURhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuW2EubG93LGEucTEsYS5tZWRpYW4sYS5xMyxhLmhpZ2hdfSxwb2ludFZhbEtleToiaGlnaCIscG9pbnRBdHRyaWJzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxkPWEmJmEuY29sb3J8fHRoaXMuY29sb3I7cmV0dXJue2ZpbGw6YS5maWxsQ29sb3J8fGIuZmlsbENvbG9yfHxkLHN0cm9rZTpiLmxpbmVDb2xvcnx8ZCwic3Ryb2tlLXdpZHRoIjpiLmxpbmVXaWR0aHx8MH19LGRyYXdEYXRhTGFiZWxzOnUsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55QXhpcyxiPXRoaXMucG9pbnRBcnJheU1hcDtyLmNvbHVtbi5wcm90b3R5cGUudHJhbnNsYXRlLmFwcGx5KHRoaXMpO3AodGhpcy5wb2ludHMsZnVuY3Rpb24oZCl7cChiLGZ1bmN0aW9uKGIpe251bGwhPT1kW2JdJiYoZFtiKyJQbG90Il09YS50cmFuc2xhdGUoZFtiXSwwLDEsMCwxKSl9KX0pfSxkcmF3UG9pbnRzOmZ1bmN0aW9uKCl7dmFyIGE9DQogICAgICAgIHRoaXMsYj1hLm9wdGlvbnMsZD1hLmNoYXJ0LnJlbmRlcmVyLGcsbSxuLGMsayxoLHE9MCxmLHQsbCxyLHg9ITEhPT1hLmRvUXVhcnRpbGVzLHUsQT1hLm9wdGlvbnMud2hpc2tlckxlbmd0aDtwKGEucG9pbnRzLGZ1bmN0aW9uKGUpe3ZhciBwPWUuZ3JhcGhpYyx6PXA/ImFuaW1hdGUiOiJhdHRyIix5PWUuc2hhcGVBcmdzLHc9e30sQz17fSxIPXt9LEk9ZS5jb2xvcnx8YS5jb2xvcjt2b2lkIDAhPT1lLnBsb3RZJiYoZj15LndpZHRoLHQ9TWF0aC5mbG9vcih5LngpLGw9dCtmLHI9TWF0aC5yb3VuZChmLzIpLGc9TWF0aC5mbG9vcih4P2UucTFQbG90OmUubG93UGxvdCksbT1NYXRoLmZsb29yKHg/ZS5xM1Bsb3Q6ZS5sb3dQbG90KSxuPU1hdGguZmxvb3IoZS5oaWdoUGxvdCksYz1NYXRoLmZsb29yKGUubG93UGxvdCkscHx8KGUuZ3JhcGhpYz1wPWQuZygicG9pbnQiKS5hZGQoYS5ncm91cCksZS5zdGVtPWQucGF0aCgpLmFkZENsYXNzKCJoaWdoY2hhcnRzLWJveHBsb3Qtc3RlbSIpLmFkZChwKSwNCiAgICBBJiYoZS53aGlza2Vycz1kLnBhdGgoKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1ib3hwbG90LXdoaXNrZXIiKS5hZGQocCkpLHgmJihlLmJveD1kLnBhdGgodm9pZCAwKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1ib3hwbG90LWJveCIpLmFkZChwKSksZS5tZWRpYW5TaGFwZT1kLnBhdGgodm9pZCAwKS5hZGRDbGFzcygiaGlnaGNoYXJ0cy1ib3hwbG90LW1lZGlhbiIpLmFkZChwKSx3LnN0cm9rZT1lLnN0ZW1Db2xvcnx8Yi5zdGVtQ29sb3J8fEksd1sic3Ryb2tlLXdpZHRoIl09dihlLnN0ZW1XaWR0aCxiLnN0ZW1XaWR0aCxiLmxpbmVXaWR0aCksdy5kYXNoc3R5bGU9ZS5zdGVtRGFzaFN0eWxlfHxiLnN0ZW1EYXNoU3R5bGUsZS5zdGVtLmF0dHIodyksQSYmKEMuc3Ryb2tlPWUud2hpc2tlckNvbG9yfHxiLndoaXNrZXJDb2xvcnx8SSxDWyJzdHJva2Utd2lkdGgiXT12KGUud2hpc2tlcldpZHRoLGIud2hpc2tlcldpZHRoLGIubGluZVdpZHRoKSxlLndoaXNrZXJzLmF0dHIoQykpLHgmJihwPQ0KICAgICAgICBhLnBvaW50QXR0cmlicyhlKSxlLmJveC5hdHRyKHApKSxILnN0cm9rZT1lLm1lZGlhbkNvbG9yfHxiLm1lZGlhbkNvbG9yfHxJLEhbInN0cm9rZS13aWR0aCJdPXYoZS5tZWRpYW5XaWR0aCxiLm1lZGlhbldpZHRoLGIubGluZVdpZHRoKSxlLm1lZGlhblNoYXBlLmF0dHIoSCkpLGg9ZS5zdGVtLnN0cm9rZVdpZHRoKCklMi8yLHE9dCtyK2gsZS5zdGVtW3pdKHtkOlsiTSIscSxtLCJMIixxLG4sIk0iLHEsZywiTCIscSxjXX0pLHgmJihoPWUuYm94LnN0cm9rZVdpZHRoKCklMi8yLGc9TWF0aC5mbG9vcihnKStoLG09TWF0aC5mbG9vcihtKStoLHQrPWgsbCs9aCxlLmJveFt6XSh7ZDpbIk0iLHQsbSwiTCIsdCxnLCJMIixsLGcsIkwiLGwsbSwiTCIsdCxtLCJ6Il19KSksQSYmKGg9ZS53aGlza2Vycy5zdHJva2VXaWR0aCgpJTIvMixuKz1oLGMrPWgsdT0vJSQvLnRlc3QoQSk/cipwYXJzZUZsb2F0KEEpLzEwMDpBLzIsZS53aGlza2Vyc1t6XSh7ZDpbIk0iLHEtdSxuLCJMIixxK3UsbiwNCiAgICAgICAgIk0iLHEtdSxjLCJMIixxK3UsY119KSksaz1NYXRoLnJvdW5kKGUubWVkaWFuUGxvdCksaD1lLm1lZGlhblNoYXBlLnN0cm9rZVdpZHRoKCklMi8yLGsrPWgsZS5tZWRpYW5TaGFwZVt6XSh7ZDpbIk0iLHQsaywiTCIsbCxrXX0pKX0pfSxzZXRTdGFja2VkUG9pbnRzOnV9KX0pKHcpOyhmdW5jdGlvbihhKXt2YXIgcD1hLmVhY2gsdT1hLm5vb3Asdj1hLnNlcmllc1R5cGUsbD1hLnNlcmllc1R5cGVzO3YoImVycm9yYmFyIiwiYm94cGxvdCIse2NvbG9yOiIjMDAwMDAwIixncm91cGluZzohMSxsaW5rZWRUbzoiOnByZXZpb3VzIix0b29sdGlwOntwb2ludEZvcm1hdDonXHgzY3NwYW4gc3R5bGVceDNkImNvbG9yOntwb2ludC5jb2xvcn0iXHgzZVx1MjVjZlx4M2Mvc3Bhblx4M2Uge3Nlcmllcy5uYW1lfTogXHgzY2JceDNle3BvaW50Lmxvd31ceDNjL2JceDNlIC0gXHgzY2JceDNle3BvaW50LmhpZ2h9XHgzYy9iXHgzZVx4M2Nici9ceDNlJ30sd2hpc2tlcldpZHRoOm51bGx9LHt0eXBlOiJlcnJvcmJhciIsDQogICAgICAgIHBvaW50QXJyYXlNYXA6WyJsb3ciLCJoaWdoIl0sdG9ZRGF0YTpmdW5jdGlvbihhKXtyZXR1cm5bYS5sb3csYS5oaWdoXX0scG9pbnRWYWxLZXk6ImhpZ2giLGRvUXVhcnRpbGVzOiExLGRyYXdEYXRhTGFiZWxzOmwuYXJlYXJhbmdlP2Z1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb2ludFZhbEtleTtsLmFyZWFyYW5nZS5wcm90b3R5cGUuZHJhd0RhdGFMYWJlbHMuY2FsbCh0aGlzKTtwKHRoaXMuZGF0YSxmdW5jdGlvbihlKXtlLnk9ZVthXX0pfTp1LGdldENvbHVtbk1ldHJpY3M6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saW5rZWRQYXJlbnQmJnRoaXMubGlua2VkUGFyZW50LmNvbHVtbk1ldHJpY3N8fGwuY29sdW1uLnByb3RvdHlwZS5nZXRDb2x1bW5NZXRyaWNzLmNhbGwodGhpcyl9fSl9KSh3KTsoZnVuY3Rpb24oYSl7dmFyIHA9YS5jb3JyZWN0RmxvYXQsdT1hLmlzTnVtYmVyLHY9YS5waWNrLGw9YS5Qb2ludCxyPWEuU2VyaWVzLGU9YS5zZXJpZXNUeXBlLGI9YS5zZXJpZXNUeXBlczsNCiAgICAgICAgZSgid2F0ZXJmYWxsIiwiY29sdW1uIix7ZGF0YUxhYmVsczp7aW5zaWRlOiEwfSxsaW5lV2lkdGg6MSxsaW5lQ29sb3I6IiMzMzMzMzMiLGRhc2hTdHlsZToiZG90Iixib3JkZXJDb2xvcjoiIzMzMzMzMyIsc3RhdGVzOntob3Zlcjp7bGluZVdpZHRoUGx1czowfX19LHtwb2ludFZhbEtleToieSIsdHJhbnNsYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcHRpb25zLGc9dGhpcy55QXhpcyxtLGUsYyxrLGgscSxmLHQsbCxyPXYoYS5taW5Qb2ludExlbmd0aCw1KSx4PXIvMix1PWEudGhyZXNob2xkLHc9YS5zdGFja2luZyx5O2IuY29sdW1uLnByb3RvdHlwZS50cmFuc2xhdGUuYXBwbHkodGhpcyk7Zj10PXU7ZT10aGlzLnBvaW50czttPTA7Zm9yKGE9ZS5sZW5ndGg7bTxhO20rKyljPWVbbV0scT10aGlzLnByb2Nlc3NlZFlEYXRhW21dLGs9Yy5zaGFwZUFyZ3MsaD13JiZnLnN0YWNrc1sodGhpcy5uZWdTdGFja3MmJnE8dT8iLSI6IiIpK3RoaXMuc3RhY2tLZXldLHk9dGhpcy5nZXRTdGFja0luZGljYXRvcih5LA0KICAgICAgICAgICAgYy54KSxsPWg/aFtjLnhdLnBvaW50c1t0aGlzLmluZGV4KyIsIittKyIsIit5LmluZGV4XTpbMCxxXSxjLmlzU3VtP2MueT1wKHEpOmMuaXNJbnRlcm1lZGlhdGVTdW0mJihjLnk9cChxLXQpKSxoPU1hdGgubWF4KGYsZitjLnkpK2xbMF0say55PWcudG9QaXhlbHMoaCwhMCksYy5pc1N1bT8oay55PWcudG9QaXhlbHMobFsxXSwhMCksay5oZWlnaHQ9TWF0aC5taW4oZy50b1BpeGVscyhsWzBdLCEwKSxnLmxlbiktay55KTpjLmlzSW50ZXJtZWRpYXRlU3VtPyhrLnk9Zy50b1BpeGVscyhsWzFdLCEwKSxrLmhlaWdodD1NYXRoLm1pbihnLnRvUGl4ZWxzKHQsITApLGcubGVuKS1rLnksdD1sWzFdKTooay5oZWlnaHQ9MDxxP2cudG9QaXhlbHMoZiwhMCktay55OmcudG9QaXhlbHMoZiwhMCktZy50b1BpeGVscyhmLXEsITApLGYrPXEpLDA+ay5oZWlnaHQmJihrLnkrPWsuaGVpZ2h0LGsuaGVpZ2h0Kj0tMSksYy5wbG90WT1rLnk9TWF0aC5yb3VuZChrLnkpLXRoaXMuYm9yZGVyV2lkdGglDQogICAgICAgICAgICAyLzIsay5oZWlnaHQ9TWF0aC5tYXgoTWF0aC5yb3VuZChrLmhlaWdodCksLjAwMSksYy55Qm90dG9tPWsueStrLmhlaWdodCxrLmhlaWdodDw9ciYmIWMuaXNOdWxsPyhrLmhlaWdodD1yLGsueS09eCxjLnBsb3RZPWsueSxjLm1pblBvaW50TGVuZ3RoT2Zmc2V0PTA+Yy55Py14OngpOmMubWluUG9pbnRMZW5ndGhPZmZzZXQ9MCxrPWMucGxvdFkrKGMubmVnYXRpdmU/ay5oZWlnaHQ6MCksdGhpcy5jaGFydC5pbnZlcnRlZD9jLnRvb2x0aXBQb3NbMF09Zy5sZW4tazpjLnRvb2x0aXBQb3NbMV09a30scHJvY2Vzc0RhdGE6ZnVuY3Rpb24oYil7dmFyIGE9dGhpcy55RGF0YSxkPXRoaXMub3B0aW9ucy5kYXRhLGUsYz1hLmxlbmd0aCxrLGgscSxmLHQsbDtoPWs9cT1mPXRoaXMub3B0aW9ucy50aHJlc2hvbGR8fDA7Zm9yKGw9MDtsPGM7bCsrKXQ9YVtsXSxlPWQmJmRbbF0/ZFtsXTp7fSwic3VtIj09PXR8fGUuaXNTdW0/YVtsXT1wKGgpOiJpbnRlcm1lZGlhdGVTdW0iPT09dHx8ZS5pc0ludGVybWVkaWF0ZVN1bT8NCiAgICAgICAgICAgICAgICBhW2xdPXAoayk6KGgrPXQsays9dCkscT1NYXRoLm1pbihoLHEpLGY9TWF0aC5tYXgoaCxmKTtyLnByb3RvdHlwZS5wcm9jZXNzRGF0YS5jYWxsKHRoaXMsYik7dGhpcy5kYXRhTWluPXE7dGhpcy5kYXRhTWF4PWZ9LHRvWURhdGE6ZnVuY3Rpb24oYil7cmV0dXJuIGIuaXNTdW0/MD09PWIueD9udWxsOiJzdW0iOmIuaXNJbnRlcm1lZGlhdGVTdW0/MD09PWIueD9udWxsOiJpbnRlcm1lZGlhdGVTdW0iOmIueX0scG9pbnRBdHRyaWJzOmZ1bmN0aW9uKGEsZyl7dmFyIGQ9dGhpcy5vcHRpb25zLnVwQ29sb3I7ZCYmIWEub3B0aW9ucy5jb2xvciYmKGEuY29sb3I9MDxhLnk/ZDpudWxsKTthPWIuY29sdW1uLnByb3RvdHlwZS5wb2ludEF0dHJpYnMuY2FsbCh0aGlzLGEsZyk7ZGVsZXRlIGEuZGFzaHN0eWxlO3JldHVybiBhfSxnZXRHcmFwaFBhdGg6ZnVuY3Rpb24oKXtyZXR1cm5bIk0iLDAsMF19LGdldENyaXNwUGF0aDpmdW5jdGlvbigpe3ZhciBiPXRoaXMuZGF0YSxhPWIubGVuZ3RoLGU9DQogICAgICAgICAgICB0aGlzLmdyYXBoLnN0cm9rZVdpZHRoKCkrdGhpcy5ib3JkZXJXaWR0aCxlPU1hdGgucm91bmQoZSklMi8yLG49W10sYyxrLGg7Zm9yKGg9MTtoPGE7aCsrKWs9YltoXS5zaGFwZUFyZ3MsYz1iW2gtMV0uc2hhcGVBcmdzLGs9WyJNIixjLngrYy53aWR0aCxjLnkrYltoLTFdLm1pblBvaW50TGVuZ3RoT2Zmc2V0K2UsIkwiLGsueCxjLnkrYltoLTFdLm1pblBvaW50TGVuZ3RoT2Zmc2V0K2VdLDA+YltoLTFdLnkmJihrWzJdKz1jLmhlaWdodCxrWzVdKz1jLmhlaWdodCksbj1uLmNvbmNhdChrKTtyZXR1cm4gbn0sZHJhd0dyYXBoOmZ1bmN0aW9uKCl7ci5wcm90b3R5cGUuZHJhd0dyYXBoLmNhbGwodGhpcyk7dGhpcy5ncmFwaC5hdHRyKHtkOnRoaXMuZ2V0Q3Jpc3BQYXRoKCl9KX0sZ2V0RXh0cmVtZXM6YS5ub29wfSx7Z2V0Q2xhc3NOYW1lOmZ1bmN0aW9uKCl7dmFyIGI9bC5wcm90b3R5cGUuZ2V0Q2xhc3NOYW1lLmNhbGwodGhpcyk7dGhpcy5pc1N1bT9iKz0iIGhpZ2hjaGFydHMtc3VtIjoNCiAgICAgICAgICAgIHRoaXMuaXNJbnRlcm1lZGlhdGVTdW0mJihiKz0iIGhpZ2hjaGFydHMtaW50ZXJtZWRpYXRlLXN1bSIpO3JldHVybiBifSxpc1ZhbGlkOmZ1bmN0aW9uKCl7cmV0dXJuIHUodGhpcy55LCEwKXx8dGhpcy5pc1N1bXx8dGhpcy5pc0ludGVybWVkaWF0ZVN1bX19KX0pKHcpOyhmdW5jdGlvbihhKXt2YXIgcD1hLlNlcmllcyx1PWEuc2VyaWVzVHlwZSx2PWEuc2VyaWVzVHlwZXM7dSgicG9seWdvbiIsInNjYXR0ZXIiLHttYXJrZXI6e2VuYWJsZWQ6ITEsc3RhdGVzOntob3Zlcjp7ZW5hYmxlZDohMX19fSxzdGlja3lUcmFja2luZzohMSx0b29sdGlwOntmb2xsb3dQb2ludGVyOiEwLHBvaW50Rm9ybWF0OiIifSx0cmFja0J5QXJlYTohMH0se3R5cGU6InBvbHlnb24iLGdldEdyYXBoUGF0aDpmdW5jdGlvbigpe2Zvcih2YXIgYT1wLnByb3RvdHlwZS5nZXRHcmFwaFBhdGguY2FsbCh0aGlzKSxyPWEubGVuZ3RoKzE7ci0tOykocj09PWEubGVuZ3RofHwiTSI9PT1hW3JdKSYmMDxyJiZhLnNwbGljZShyLA0KICAgICAgICAwLCJ6Iik7cmV0dXJuIHRoaXMuYXJlYVBhdGg9YX0sZHJhd0dyYXBoOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmZpbGxDb2xvcj10aGlzLmNvbG9yO3YuYXJlYS5wcm90b3R5cGUuZHJhd0dyYXBoLmNhbGwodGhpcyl9LGRyYXdMZWdlbmRTeW1ib2w6YS5MZWdlbmRTeW1ib2xNaXhpbi5kcmF3UmVjdGFuZ2xlLGRyYXdUcmFja2VyOnAucHJvdG90eXBlLmRyYXdUcmFja2VyLHNldFN0YWNrZWRQb2ludHM6YS5ub29wfSl9KSh3KTsoZnVuY3Rpb24oYSl7dmFyIHA9YS5hcnJheU1heCx1PWEuYXJyYXlNaW4sdj1hLkF4aXMsbD1hLmNvbG9yLHI9YS5lYWNoLGU9YS5pc051bWJlcixiPWEubm9vcCxkPWEucGljayxnPWEucEludCxtPWEuUG9pbnQsbj1hLlNlcmllcyxjPWEuc2VyaWVzVHlwZSxrPWEuc2VyaWVzVHlwZXM7YygiYnViYmxlIiwic2NhdHRlciIse2RhdGFMYWJlbHM6e2Zvcm1hdHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBvaW50Lnp9LGluc2lkZTohMCx2ZXJ0aWNhbEFsaWduOiJtaWRkbGUifSwNCiAgICAgICAgbWFya2VyOntsaW5lQ29sb3I6bnVsbCxsaW5lV2lkdGg6MSxyYWRpdXM6bnVsbCxzdGF0ZXM6e2hvdmVyOntyYWRpdXNQbHVzOjB9fSxzeW1ib2w6ImNpcmNsZSJ9LG1pblNpemU6OCxtYXhTaXplOiIyMCUiLHNvZnRUaHJlc2hvbGQ6ITEsc3RhdGVzOntob3Zlcjp7aGFsbzp7c2l6ZTo1fX19LHRvb2x0aXA6e3BvaW50Rm9ybWF0OiIoe3BvaW50Lnh9LCB7cG9pbnQueX0pLCBTaXplOiB7cG9pbnQuen0ifSx0dXJib1RocmVzaG9sZDowLHpUaHJlc2hvbGQ6MCx6b25lQXhpczoieiJ9LHtwb2ludEFycmF5TWFwOlsieSIsInoiXSxwYXJhbGxlbEFycmF5czpbIngiLCJ5IiwieiJdLHRyYWNrZXJHcm91cHM6WyJtYXJrZXJHcm91cCIsImRhdGFMYWJlbHNHcm91cCJdLGJ1YmJsZVBhZGRpbmc6ITAsem9uZUF4aXM6InoiLHBvaW50QXR0cmliczpmdW5jdGlvbihiLGEpe3ZhciBjPWQodGhpcy5vcHRpb25zLm1hcmtlci5maWxsT3BhY2l0eSwuNSk7Yj1uLnByb3RvdHlwZS5wb2ludEF0dHJpYnMuY2FsbCh0aGlzLA0KICAgICAgICBiLGEpOzEhPT1jJiYoYi5maWxsPWwoYi5maWxsKS5zZXRPcGFjaXR5KGMpLmdldCgicmdiYSIpKTtyZXR1cm4gYn0sZ2V0UmFkaWk6ZnVuY3Rpb24oYixhLGMsZCl7dmFyIGYsZyxoLGs9dGhpcy56RGF0YSxlPVtdLG09dGhpcy5vcHRpb25zLG49IndpZHRoIiE9PW0uc2l6ZUJ5LHQ9bS56VGhyZXNob2xkLHE9YS1iO2c9MDtmb3IoZj1rLmxlbmd0aDtnPGY7ZysrKWg9a1tnXSxtLnNpemVCeUFic29sdXRlVmFsdWUmJm51bGwhPT1oJiYoaD1NYXRoLmFicyhoLXQpLGE9TWF0aC5tYXgoYS10LE1hdGguYWJzKGItdCkpLGI9MCksbnVsbD09PWg/aD1udWxsOmg8Yj9oPWMvMi0xOihoPTA8cT8oaC1iKS9xOi41LG4mJjA8PWgmJihoPU1hdGguc3FydChoKSksaD1NYXRoLmNlaWwoYytoKihkLWMpKS8yKSxlLnB1c2goaCk7dGhpcy5yYWRpaT1lfSxhbmltYXRlOmZ1bmN0aW9uKGIpe3ZhciBhPXRoaXMub3B0aW9ucy5hbmltYXRpb247Ynx8KHIodGhpcy5wb2ludHMsZnVuY3Rpb24oYil7dmFyIGM9DQogICAgICAgIGIuZ3JhcGhpYyxkO2MmJmMud2lkdGgmJihkPXt4OmMueCx5OmMueSx3aWR0aDpjLndpZHRoLGhlaWdodDpjLmhlaWdodH0sYy5hdHRyKHt4OmIucGxvdFgseTpiLnBsb3RZLHdpZHRoOjEsaGVpZ2h0OjF9KSxjLmFuaW1hdGUoZCxhKSl9KSx0aGlzLmFuaW1hdGU9bnVsbCl9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe3ZhciBiLGM9dGhpcy5kYXRhLGQsZyxtPXRoaXMucmFkaWk7ay5zY2F0dGVyLnByb3RvdHlwZS50cmFuc2xhdGUuY2FsbCh0aGlzKTtmb3IoYj1jLmxlbmd0aDtiLS07KWQ9Y1tiXSxnPW0/bVtiXTowLGUoZykmJmc+PXRoaXMubWluUHhTaXplLzI/KGQubWFya2VyPWEuZXh0ZW5kKGQubWFya2VyLHtyYWRpdXM6Zyx3aWR0aDoyKmcsaGVpZ2h0OjIqZ30pLGQuZGxCb3g9e3g6ZC5wbG90WC1nLHk6ZC5wbG90WS1nLHdpZHRoOjIqZyxoZWlnaHQ6MipnfSk6ZC5zaGFwZUFyZ3M9ZC5wbG90WT1kLmRsQm94PXZvaWQgMH0sYWxpZ25EYXRhTGFiZWw6ay5jb2x1bW4ucHJvdG90eXBlLmFsaWduRGF0YUxhYmVsLA0KICAgICAgICBidWlsZEtEVHJlZTpiLGFwcGx5Wm9uZXM6Yn0se2hhbG9QYXRoOmZ1bmN0aW9uKGIpe3JldHVybiBtLnByb3RvdHlwZS5oYWxvUGF0aC5jYWxsKHRoaXMsMD09PWI/MDoodGhpcy5tYXJrZXI/dGhpcy5tYXJrZXIucmFkaXVzfHwwOjApK2IpfSx0dEJlbG93OiExfSk7di5wcm90b3R5cGUuYmVmb3JlUGFkZGluZz1mdW5jdGlvbigpe3ZhciBiPXRoaXMsYT10aGlzLmxlbixjPXRoaXMuY2hhcnQsaz0wLG09YSxuPXRoaXMuaXNYQXhpcyxsPW4/InhEYXRhIjoieURhdGEiLHY9dGhpcy5taW4sdz17fSx5PU1hdGgubWluKGMucGxvdFdpZHRoLGMucGxvdEhlaWdodCksRD1OdW1iZXIuTUFYX1ZBTFVFLEU9LU51bWJlci5NQVhfVkFMVUUsRj10aGlzLm1heC12LEI9YS9GLEc9W107cih0aGlzLnNlcmllcyxmdW5jdGlvbihhKXt2YXIgZj1hLm9wdGlvbnM7IWEuYnViYmxlUGFkZGluZ3x8IWEudmlzaWJsZSYmYy5vcHRpb25zLmNoYXJ0Lmlnbm9yZUhpZGRlblNlcmllc3x8KGIuYWxsb3dab29tT3V0c2lkZT0NCiAgICAgICAgITAsRy5wdXNoKGEpLG4mJihyKFsibWluU2l6ZSIsIm1heFNpemUiXSxmdW5jdGlvbihiKXt2YXIgYT1mW2JdLGM9LyUkLy50ZXN0KGEpLGE9ZyhhKTt3W2JdPWM/eSphLzEwMDphfSksYS5taW5QeFNpemU9dy5taW5TaXplLGEubWF4UHhTaXplPU1hdGgubWF4KHcubWF4U2l6ZSx3Lm1pblNpemUpLGE9YS56RGF0YSxhLmxlbmd0aCYmKEQ9ZChmLnpNaW4sTWF0aC5taW4oRCxNYXRoLm1heCh1KGEpLCExPT09Zi5kaXNwbGF5TmVnYXRpdmU/Zi56VGhyZXNob2xkOi1OdW1iZXIuTUFYX1ZBTFVFKSkpLEU9ZChmLnpNYXgsTWF0aC5tYXgoRSxwKGEpKSkpKSl9KTtyKEcsZnVuY3Rpb24oYSl7dmFyIGM9YVtsXSxkPWMubGVuZ3RoLGc7biYmYS5nZXRSYWRpaShELEUsYS5taW5QeFNpemUsYS5tYXhQeFNpemUpO2lmKDA8Rilmb3IoO2QtLTspZShjW2RdKSYmYi5kYXRhTWluPD1jW2RdJiZjW2RdPD1iLmRhdGFNYXgmJihnPWEucmFkaWlbZF0saz1NYXRoLm1pbigoY1tkXS12KSpCLWcsayksDQogICAgICAgIG09TWF0aC5tYXgoKGNbZF0tdikqQitnLG0pKX0pO0cubGVuZ3RoJiYwPEYmJiF0aGlzLmlzTG9nJiYobS09YSxCKj0oYStrLW0pL2EscihbWyJtaW4iLCJ1c2VyTWluIixrXSxbIm1heCIsInVzZXJNYXgiLG1dXSxmdW5jdGlvbihhKXt2b2lkIDA9PT1kKGIub3B0aW9uc1thWzBdXSxiW2FbMV1dKSYmKGJbYVswXV0rPWFbMl0vQil9KSl9fSkodyk7KGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIHAoYixhKXt2YXIgZD10aGlzLmNoYXJ0LGU9dGhpcy5vcHRpb25zLmFuaW1hdGlvbixuPXRoaXMuZ3JvdXAsYz10aGlzLm1hcmtlckdyb3VwLGs9dGhpcy54QXhpcy5jZW50ZXIsaD1kLnBsb3RMZWZ0LGw9ZC5wbG90VG9wO2QucG9sYXI/ZC5yZW5kZXJlci5pc1NWRyYmKCEwPT09ZSYmKGU9e30pLGE/KGI9e3RyYW5zbGF0ZVg6a1swXStoLHRyYW5zbGF0ZVk6a1sxXStsLHNjYWxlWDouMDAxLHNjYWxlWTouMDAxfSxuLmF0dHIoYiksYyYmYy5hdHRyKGIpKTooYj17dHJhbnNsYXRlWDpoLHRyYW5zbGF0ZVk6bCwNCiAgICAgICAgICAgICAgICBzY2FsZVg6MSxzY2FsZVk6MX0sbi5hbmltYXRlKGIsZSksYyYmYy5hbmltYXRlKGIsZSksdGhpcy5hbmltYXRlPW51bGwpKTpiLmNhbGwodGhpcyxhKX12YXIgdT1hLmVhY2gsdj1hLnBpY2ssbD1hLnNlcmllc1R5cGVzLHI9YS53cmFwLGU9YS5TZXJpZXMucHJvdG90eXBlO2E9YS5Qb2ludGVyLnByb3RvdHlwZTtlLnNlYXJjaFBvaW50QnlBbmdsZT1mdW5jdGlvbihiKXt2YXIgYT10aGlzLmNoYXJ0LGc9dGhpcy54QXhpcy5wYW5lLmNlbnRlcjtyZXR1cm4gdGhpcy5zZWFyY2hLRFRyZWUoe2NsaWVudFg6MTgwKy0xODAvTWF0aC5QSSpNYXRoLmF0YW4yKGIuY2hhcnRYLWdbMF0tYS5wbG90TGVmdCxiLmNoYXJ0WS1nWzFdLWEucGxvdFRvcCl9KX07cihlLCJidWlsZEtEVHJlZSIsZnVuY3Rpb24oYil7dGhpcy5jaGFydC5wb2xhciYmKHRoaXMua2RCeUFuZ2xlP3RoaXMuc2VhcmNoUG9pbnQ9dGhpcy5zZWFyY2hQb2ludEJ5QW5nbGU6dGhpcy5rZERpbWVuc2lvbnM9Mik7Yi5hcHBseSh0aGlzKX0pOw0KICAgICAgICBlLnRvWFk9ZnVuY3Rpb24oYil7dmFyIGEsZz10aGlzLmNoYXJ0LGU9Yi5wbG90WDthPWIucGxvdFk7Yi5yZWN0UGxvdFg9ZTtiLnJlY3RQbG90WT1hO2E9dGhpcy54QXhpcy5wb3N0VHJhbnNsYXRlKGIucGxvdFgsdGhpcy55QXhpcy5sZW4tYSk7Yi5wbG90WD1iLnBvbGFyUGxvdFg9YS54LWcucGxvdExlZnQ7Yi5wbG90WT1iLnBvbGFyUGxvdFk9YS55LWcucGxvdFRvcDt0aGlzLmtkQnlBbmdsZT8oZz0oZS9NYXRoLlBJKjE4MCt0aGlzLnhBeGlzLnBhbmUub3B0aW9ucy5zdGFydEFuZ2xlKSUzNjAsMD5nJiYoZys9MzYwKSxiLmNsaWVudFg9Zyk6Yi5jbGllbnRYPWIucGxvdFh9O2wuc3BsaW5lJiZyKGwuc3BsaW5lLnByb3RvdHlwZSwiZ2V0UG9pbnRTcGxpbmUiLGZ1bmN0aW9uKGEsZCxnLGUpe3ZhciBiLGMsayxoLG0sZixsO3RoaXMuY2hhcnQucG9sYXI/KGI9Zy5wbG90WCxjPWcucGxvdFksYT1kW2UtMV0saz1kW2UrMV0sdGhpcy5jb25uZWN0RW5kcyYmKGF8fChhPWRbZC5sZW5ndGgtDQogICAgICAgICAgICAyXSksa3x8KGs9ZFsxXSkpLGEmJmsmJihoPWEucGxvdFgsbT1hLnBsb3RZLGQ9ay5wbG90WCxmPWsucGxvdFksaD0oMS41KmIraCkvMi41LG09KDEuNSpjK20pLzIuNSxrPSgxLjUqYitkKS8yLjUsbD0oMS41KmMrZikvMi41LGQ9TWF0aC5zcXJ0KE1hdGgucG93KGgtYiwyKStNYXRoLnBvdyhtLWMsMikpLGY9TWF0aC5zcXJ0KE1hdGgucG93KGstYiwyKStNYXRoLnBvdyhsLWMsMikpLGg9TWF0aC5hdGFuMihtLWMsaC1iKSxtPU1hdGguYXRhbjIobC1jLGstYiksbD1NYXRoLlBJLzIrKGgrbSkvMixNYXRoLmFicyhoLWwpPk1hdGguUEkvMiYmKGwtPU1hdGguUEkpLGg9YitNYXRoLmNvcyhsKSpkLG09YytNYXRoLnNpbihsKSpkLGs9YitNYXRoLmNvcyhNYXRoLlBJK2wpKmYsbD1jK01hdGguc2luKE1hdGguUEkrbCkqZixnLnJpZ2h0Q29udFg9ayxnLnJpZ2h0Q29udFk9bCksZT8oZz1bIkMiLGEucmlnaHRDb250WHx8YS5wbG90WCxhLnJpZ2h0Q29udFl8fGEucGxvdFksaHx8YixtfHwNCiAgICAgICAgICAgICAgICBjLGIsY10sYS5yaWdodENvbnRYPWEucmlnaHRDb250WT1udWxsKTpnPVsiTSIsYixjXSk6Zz1hLmNhbGwodGhpcyxkLGcsZSk7cmV0dXJuIGd9KTtyKGUsInRyYW5zbGF0ZSIsZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jaGFydDthLmNhbGwodGhpcyk7aWYoYi5wb2xhciYmKHRoaXMua2RCeUFuZ2xlPWIudG9vbHRpcCYmYi50b29sdGlwLnNoYXJlZCwhdGhpcy5wcmV2ZW50UG9zdFRyYW5zbGF0ZSkpZm9yKGE9dGhpcy5wb2ludHMsYj1hLmxlbmd0aDtiLS07KXRoaXMudG9YWShhW2JdKX0pO3IoZSwiZ2V0R3JhcGhQYXRoIixmdW5jdGlvbihhLGQpe3ZhciBiPXRoaXMsZSxuO2lmKHRoaXMuY2hhcnQucG9sYXIpe2Q9ZHx8dGhpcy5wb2ludHM7Zm9yKGU9MDtlPGQubGVuZ3RoO2UrKylpZighZFtlXS5pc051bGwpe249ZTticmVha30hMSE9PXRoaXMub3B0aW9ucy5jb25uZWN0RW5kcyYmdm9pZCAwIT09biYmKHRoaXMuY29ubmVjdEVuZHM9ITAsZC5zcGxpY2UoZC5sZW5ndGgsMCxkW25dKSk7DQogICAgICAgICAgICB1KGQsZnVuY3Rpb24oYSl7dm9pZCAwPT09YS5wb2xhclBsb3RZJiZiLnRvWFkoYSl9KX1yZXR1cm4gYS5hcHBseSh0aGlzLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKX0pO3IoZSwiYW5pbWF0ZSIscCk7bC5jb2x1bW4mJihsPWwuY29sdW1uLnByb3RvdHlwZSxsLnBvbGFyQXJjPWZ1bmN0aW9uKGEsZCxnLGUpe3ZhciBiPXRoaXMueEF4aXMuY2VudGVyLGM9dGhpcy55QXhpcy5sZW47cmV0dXJuIHRoaXMuY2hhcnQucmVuZGVyZXIuc3ltYm9scy5hcmMoYlswXSxiWzFdLGMtZCxudWxsLHtzdGFydDpnLGVuZDplLGlubmVyUjpjLXYoYSxjKX0pfSxyKGwsImFuaW1hdGUiLHApLHIobCwidHJhbnNsYXRlIixmdW5jdGlvbihhKXt2YXIgYj10aGlzLnhBeGlzLGc9Yi5zdGFydEFuZ2xlUmFkLGUsbCxjO3RoaXMucHJldmVudFBvc3RUcmFuc2xhdGU9ITA7YS5jYWxsKHRoaXMpO2lmKGIuaXNSYWRpYWwpZm9yKGU9dGhpcy5wb2ludHMsYz1lLmxlbmd0aDtjLS07KWw9ZVtjXSxhPWwuYmFyWCsNCiAgICAgICAgICAgIGcsbC5zaGFwZVR5cGU9InBhdGgiLGwuc2hhcGVBcmdzPXtkOnRoaXMucG9sYXJBcmMobC55Qm90dG9tLGwucGxvdFksYSxhK2wucG9pbnRXaWR0aCl9LHRoaXMudG9YWShsKSxsLnRvb2x0aXBQb3M9W2wucGxvdFgsbC5wbG90WV0sbC50dEJlbG93PWwucGxvdFk+Yi5jZW50ZXJbMV19KSxyKGwsImFsaWduRGF0YUxhYmVsIixmdW5jdGlvbihhLGQsZyxsLG4sYyl7dGhpcy5jaGFydC5wb2xhcj8oYT1kLnJlY3RQbG90WC9NYXRoLlBJKjE4MCxudWxsPT09bC5hbGlnbiYmKGwuYWxpZ249MjA8YSYmMTYwPmE/ImxlZnQiOjIwMDxhJiYzNDA+YT8icmlnaHQiOiJjZW50ZXIiKSxudWxsPT09bC52ZXJ0aWNhbEFsaWduJiYobC52ZXJ0aWNhbEFsaWduPTQ1PmF8fDMxNTxhPyJib3R0b20iOjEzNTxhJiYyMjU+YT8idG9wIjoibWlkZGxlIiksZS5hbGlnbkRhdGFMYWJlbC5jYWxsKHRoaXMsZCxnLGwsbixjKSk6YS5jYWxsKHRoaXMsZCxnLGwsbixjKX0pKTtyKGEsImdldENvb3JkaW5hdGVzIiwNCiAgICAgICAgICAgIGZ1bmN0aW9uKGEsZCl7dmFyIGI9dGhpcy5jaGFydCxlPXt4QXhpczpbXSx5QXhpczpbXX07Yi5wb2xhcj91KGIuYXhlcyxmdW5jdGlvbihhKXt2YXIgYz1hLmlzWEF4aXMsZz1hLmNlbnRlcixoPWQuY2hhcnRYLWdbMF0tYi5wbG90TGVmdCxnPWQuY2hhcnRZLWdbMV0tYi5wbG90VG9wO2VbYz8ieEF4aXMiOiJ5QXhpcyJdLnB1c2goe2F4aXM6YSx2YWx1ZTphLnRyYW5zbGF0ZShjP01hdGguUEktTWF0aC5hdGFuMihoLGcpOk1hdGguc3FydChNYXRoLnBvdyhoLDIpK01hdGgucG93KGcsMikpLCEwKX0pfSk6ZT1hLmNhbGwodGhpcyxkKTtyZXR1cm4gZX0pfSkodyl9KTsKLyoqDQogKiBHcmlkIHRoZW1lIGZvciBIaWdoY2hhcnRzIEpTDQogKiBAYXV0aG9yIFRvcnN0ZWluIEjiiJriiI9uc2kNCiAqLw0KDQpIaWdoY2hhcnRzLnRoZW1lID0gew0KCWNvbG9yczogWycjMDU4REM3JywgJyM1MEI0MzInLCAnI0VENTYxQicsICcjRERERjAwJywgJyMyNENCRTUnLCAnIzY0RTU3MicsICcjRkY5NjU1JywgJyNGRkYyNjMnLCAnIzZBRjlDNCddLA0KCWNoYXJ0OiB7DQoJCWJhY2tncm91bmRDb2xvcjogew0KCQkJbGluZWFyR3JhZGllbnQ6IFswLCAwLCAwLCA1MDBdLA0KCQkJc3RvcHM6IFsNCgkJCQlbMCwgJ3JnYigyNTAsIDI1MCwgMjUwKSddLA0KCQkJCVsxLCAncmdiKDIyMCwgMjIwLCAyNDApJ10NCgkJCV0NCgkJfSwNCgkJYm9yZGVyV2lkdGg6IDAsDQoJCXBsb3RCYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIC45KScsDQoJCXBsb3RTaGFkb3c6IGZhbHNlLA0KCQlwbG90Qm9yZGVyV2lkdGg6IDANCgl9LA0KCXRpdGxlOiB7DQoJCXN0eWxlOiB7IA0KCQkJY29sb3I6ICcjMDAwJywNCgkJCWZvbnQ6ICdib2xkIDE2cHggIlRyZWJ1Y2hldCBNUyIsIFZlcmRhbmEsIHNhbnMtc2VyaWYnDQoJCX0NCgl9LA0KCXN1YnRpdGxlOiB7DQoJCXN0eWxlOiB7IA0KCQkJY29sb3I6ICcjNjY2NjY2JywNCgkJCWZvbnQ6ICdib2xkIDEycHggIlRyZWJ1Y2hldCBNUyIsIFZlcmRhbmEsIHNhbnMtc2VyaWYnDQoJCX0NCgl9LA0KCXhBeGlzOiB7DQoJCWdyaWRMaW5lV2lkdGg6IDAsDQoJCWxpbmVDb2xvcjogJ2xpZ2h0Z3JleScsDQoJCXRpY2tDb2xvcjogJ2lsZ2h0Z3JleScsDQoJCWxhYmVsczogew0KCQkJc3R5bGU6IHsNCgkJCQljb2xvcjogJ2dyZXknLA0KCQkJCWZvbnQ6ICcxMXB4IFRyZWJ1Y2hldCBNUywgVmVyZGFuYSwgc2Fucy1zZXJpZicNCgkJCX0NCgkJfSwNCgkJdGl0bGU6IHsNCgkJCXN0eWxlOiB7DQoJCQkJY29sb3I6ICdncmV5JywNCgkJCQlmb250V2VpZ2h0OiAnYm9sZCcsDQoJCQkJZm9udFNpemU6ICcxMnB4JywNCgkJCQlmb250RmFtaWx5OiAnVHJlYnVjaGV0IE1TLCBWZXJkYW5hLCBzYW5zLXNlcmlmJw0KDQoJCQl9CQkJCQ0KCQl9DQoJfSwNCgl5QXhpczogew0KCQltaW5vclRpY2tJbnRlcnZhbDogMCwNCgkJbWFqb3JUaWNrSW50ZXJ2YWw6IDEwMCwNCgkJbGluZUNvbG9yOiAnbGlnaHRncmV5JywNCgkJbGluZVdpZHRoOiAxLA0KCQl0aWNrV2lkdGg6IDEsDQoJCXRpY2tDb2xvcjogJ2xpZ2h0Z3JleScsDQoJCWxhYmVsczogew0KCQkJc3R5bGU6IHsNCgkJCQljb2xvcjogJ2RhcmtncmV5JywNCgkJCQlmb250OiAnMTFweCBUcmVidWNoZXQgTVMsIFZlcmRhbmEsIHNhbnMtc2VyaWYnDQoJCQl9DQoJCX0sDQoJCXRpdGxlOiB7DQoJCQlzdHlsZTogew0KCQkJCWNvbG9yOiAnIzMzMycsDQoJCQkJZm9udFdlaWdodDogJ2JvbGQnLA0KCQkJCWZvbnRTaXplOiAnMTJweCcsDQoJCQkJZm9udEZhbWlseTogJ1RyZWJ1Y2hldCBNUywgVmVyZGFuYSwgc2Fucy1zZXJpZicNCgkJCX0JCQkJDQoJCX0NCgl9LA0KCWxlZ2VuZDogew0KCQlpdGVtU3R5bGU6IHsJCQkNCgkJCWZvbnQ6ICc5cHQgVHJlYnVjaGV0IE1TLCBWZXJkYW5hLCBzYW5zLXNlcmlmJywNCgkJCWNvbG9yOiAnZ3JleScNCg0KCQl9LA0KCQlpdGVtSG92ZXJTdHlsZTogew0KCQkJY29sb3I6ICcjMDM5Jw0KCQl9LA0KCQlpdGVtSGlkZGVuU3R5bGU6IHsNCgkJCWNvbG9yOiAnZ3JheScNCgkJfSwNCgl9LA0KCWxhYmVsczogew0KCQlzdHlsZTogew0KCQkJY29sb3I6ICcjOTliJw0KCQl9DQoJfSwNCn07DQoNCi8vIEFwcGx5IHRoZSB0aGVtZQ0KdmFyIGhpZ2hjaGFydHNPcHRpb25zID0gSGlnaGNoYXJ0cy5zZXRPcHRpb25zKEhpZ2hjaGFydHMudGhlbWUpOw0KDQoKdmFyIHNpZ25hbCA9IHNpZ25hbCB8fCB7fTsKCi8vIGEgY29udmVuaWVuY2UgZnVuY3Rpb24gZm9yIHBhcnNpbmcgc3RyaW5nIG5hbWVzcGFjZXMgYW5kCi8vIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGluZyBuZXN0ZWQgbmFtZXNwYWNlcwpmdW5jdGlvbiBleHRlbmQoIG5zLCBuc19zdHJpbmcgKSB7CiAgICB2YXIgcGFydHMgPSBuc19zdHJpbmcuc3BsaXQoJy4nKSwKICAgICAgICBwYXJlbnQgPSBucywKICAgICAgICBwbCwgaTsKICAgIGlmIChwYXJ0c1swXSA9PSAic2lnbmFsIikgewogICAgICAgIHBhcnRzID0gcGFydHMuc2xpY2UoMSk7CiAgICB9CiAgICBwbCA9IHBhcnRzLmxlbmd0aDsKICAgIGZvciAoaSA9IDA7IGkgPCBwbDsgaSsrKSB7CiAgICAgICAgLy9jcmVhdGUgYSBwcm9wZXJ0eSBpZiBpdCBkb2VzbnQgZXhpc3QKICAgICAgICBpZiAodHlwZW9mIHBhcmVudFtwYXJ0c1tpXV0gPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgcGFyZW50W3BhcnRzW2ldXSA9IHt9OwogICAgICAgIH0KICAgICAgICBwYXJlbnQgPSBwYXJlbnRbcGFydHNbaV1dOwogICAgfQogICAgcmV0dXJuIHBhcmVudDsKfQoKLy9Qcm90b3R5cGUgbWV0aG9kcwpEYXRlLnByb3RvdHlwZS5hZGREYXlzID0gZnVuY3Rpb24oZGF5cykgewogICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh0aGlzLnZhbHVlT2YoKSk7CiAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyBkYXlzKTsKICAgIHJldHVybiBkYXRlOwp9OwoKQXJyYXkucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKGYpe2YgIT0gdmFsdWV9KTsKfTsKClNDQV9XT1JLRkxPV19TVEFUVVNfRU5VTSA9IHsgTkVXOiAnTmV3JywKICAgIEFTU09DSUFURV9SRVZJRVdFRDogJ0Fzc29jaWF0ZVJldmlld2VkJywKICAgIFBIWVNJQ0lBTl9SRVZJRVdFRDogJ1BoeXNpY2lhblJldmlld2VkJywKICAgIFJFUVVJUkVEX0VWQUxVQVRJT046ICdSZXF1aXJlZEV2YWx1YXRpb24nLAogICAgQ09OVElOVUVEX01PTklUT1JJTkc6ICdDb250aW51ZWRNb25pdG9yaW5nJwp9OwoKU0NBX0RJU1BPU0lUSU9OX0VOVU0gPSB7CiAgICBWQUxJREFURURfU0lHTkFMIDogJ1ZhbGlkYXRlZFNpZ25hbCcsCiAgICBWQUxJREFURURfTk9OX0NPTkZJUk1FRF9TSUdOQUwgOiAnVmFsaWRhdGVkTm9uQ29uZmlybWVkU2lnbmFsJywKICAgIFZBTElEQVRFRF9VTkRFUl9JTlZFU1RJR0FUSU9OIDogJ1ZhbGlkYXRlZFVuZGVySW52ZXN0aWdhdGlvbicsCiAgICBDT01NVU5JQ0FURURfU0lHTkFMIDogJ0NvbW11bmljYXRlZFNpZ25hbCcsCiAgICBOT05fVkFMSUQ6ICdOb25WYWxpZCcKfTsKClNDQV9QUklPUklUWV9FTlVNID0gewogICAgSElHSDogIkhpZ2giLAogICAgTUVESVVNOiAiTWVkaXVtIiwKICAgIExPVzogIkxPVyIKfTsKCkRBVEVfRk1UX1RaID0gIllZWVktTU0tREQiOwoKc2lnbmFsLnV0aWxzID0gKGZ1bmN0aW9uKCkgewoKICAgIHZhciBzdGFja2VkID0gZnVuY3Rpb24odG9wVmFsdWUsIGJvdHRvbVZhbHVlKSB7CiAgICAgICAgdmFyIHRvcENvbXAgPSAiIjsKICAgICAgICB2YXIgYm90dG9tQ29tcCA9ICIiOwoKICAgICAgICBpZihfLmlzRnVuY3Rpb24odG9wVmFsdWUpKSB7CiAgICAgICAgICAgIHRvcENvbXAgPSB0b3BWYWx1ZSgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdG9wQ29tcCA9ICc8ZGl2IGNsYXNzPSJzdGFja2VkLWNlbGwtY2VudGVyLXRvcCI+JyArIHRvcFZhbHVlICsgJzwvZGl2PicKICAgICAgICB9CgogICAgICAgIGlmIChfLmlzRnVuY3Rpb24oYm90dG9tVmFsdWUpKSB7CiAgICAgICAgICAgIGJvdHRvbUNvbXAgPSBib3R0b21WYWx1ZSgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYm90dG9tQ29tcCA9ICc8ZGl2IGNsYXNzPSJzdGFja2VkLWNlbGwtY2VudGVyLWJvdHRvbSI+JyArIGJvdHRvbVZhbHVlICsgJzwvZGl2PicKICAgICAgICB9CgogICAgICAgIHJldHVybiB0b3BDb21wICsgYm90dG9tQ29tcAogICAgfTsKCiAgICAvLyBBbmQgdGhpcyBpcyB0aGUgZGVmaW5pdGlvbiBvZiB0aGUgY3VzdG9tIGZ1bmN0aW9uIOKAiwogICAgdmFyIHJlbmRlciA9IGZ1bmN0aW9uKHRtcGxfbmFtZSwgdG1wbF9kYXRhKSB7CgogICAgICAgIGlmICggIXJlbmRlci50bXBsX2NhY2hlICkgewoKCgogICAgICAgICAgICByZW5kZXIudG1wbF9jYWNoZSA9IHt9OwogICAgICAgIH0KICAgICAgICBpZiAoIXJlbmRlci50bXBsX2NhY2hlW3RtcGxfbmFtZV0pIHsKICAgICAgICAgICAgdmFyIHRtcGxfZGlyID0gJy9zaWduYWwvYXNzZXRzL2FwcC9wdnMvaGJzLXRlbXBsYXRlcyc7CiAgICAgICAgICAgIHZhciB0bXBsX3VybCA9IHRtcGxfZGlyICsgJy8nICsgdG1wbF9uYW1lICsgJy5oYnMnOwoKICAgICAgICAgICAgdmFyIHRtcGxfc3RyaW5nID0gIiI7CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB1cmw6IHRtcGxfdXJsLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJywKICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB0bXBsX3N0cmluZyA9IGRhdGEKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZW5kZXIudG1wbF9jYWNoZVt0bXBsX25hbWVdID0gSGFuZGxlYmFycy5jb21waWxlKHRtcGxfc3RyaW5nKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZW5kZXIudG1wbF9jYWNoZVt0bXBsX25hbWVdKHRtcGxfZGF0YSkKICAgIH07CgogICAgdmFyIGhic19wYXJ0aWFsID0gZnVuY3Rpb24odG1wbF9uYW1lKSB7CiAgICAgICAgaWYgKCFoYnNfcGFydGlhbC50bXBsX2NhY2hlKSB7CiAgICAgICAgICAgIGhic19wYXJ0aWFsLnRtcGxfY2FjaGUgPSB7fQogICAgICAgIH0KCiAgICAgICAgaWYgKCFoYnNfcGFydGlhbC50bXBsX2NhY2hlW3RtcGxfbmFtZV0pIHsKICAgICAgICAgICAgIHZhciB0bXBsX2RpciA9ICcvc2lnbmFsL2Fzc2V0cy9hcHAvcHZzL2hicy10ZW1wbGF0ZXMnOwogICAgICAgICAgICB2YXIgdG1wbF91cmwgPSB0bXBsX2RpciArICcvJyArIHRtcGxfbmFtZSArICcuaGJzJzsKCiAgICAgICAgICAgIHZhciB0bXBsX3N0cmluZyA9ICIiOwogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiB0bXBsX3VybCwKICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgdG1wbF9zdHJpbmcgPSBkYXRhCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaGJzX3BhcnRpYWwudG1wbF9jYWNoZVt0bXBsX25hbWVdID0gdG1wbF9zdHJpbmcKICAgICAgICB9CgogICAgICAgIHJldHVybiBoYnNfcGFydGlhbC50bXBsX2NhY2hlW3RtcGxfbmFtZV0KICAgIH07CgogICAgdmFyIGNvbXBvc2VVcmwgPSBmdW5jdGlvbihjb250cm9sbGVyLCBhY3Rpb24sIHBhcmFtcykgewogICAgICAgIHZhciB1cmwgPSAiL3NpZ25hbC8iICsgY29udHJvbGxlciArICIvIiArIGFjdGlvbiArIChfLmlzTnVsbChwYXJhbXMpID8gJycgOiAnPycgKyBjb21wb3NlUGFyYW1zKHBhcmFtcykpOwoKICAgICAgICByZXR1cm4gdXJsCiAgICB9OwoKICAgIC8vVE9ETyA6IE5lZWQgdG8gY2hhbmdlIHRoaXMgdG8gaGFuZGxlYmFyIGZvcm0sIFdpbGwgYmUgZG9uZSBsYXRlcgogICAgdmFyIHBvc3RVcmwgPSBmdW5jdGlvbiAocGF0aCwgcGFyYW1zLCBuZXdXaW5kb3cpIHsKCiAgICAgICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTsKICAgICAgICBmb3JtLm1ldGhvZCA9ICJwb3N0IjsKICAgICAgICBmb3JtLmFjdGlvbiA9IHBhdGg7CiAgICAgICAgZm9ybS5lbmN0eXBlID0gImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCI7CiAgICAgICAgaWYgKG5ld1dpbmRvdykgZm9ybS50YXJnZXQgPSAiX2JsYW5rIjsKCiAgICAgICAgdmFyIHRva2VuID0gJCgibWV0YVtuYW1lPSdfY3NyZiddIikuYXR0cigiY29udGVudCIpOwogICAgICAgIHZhciBwYXJhbWV0ZXIgPSAkKCJtZXRhW25hbWU9J19jc3JmX3BhcmFtZXRlciddIikuYXR0cigiY29udGVudCIpOwogICAgICAgIHBhcmFtc1twYXJhbWV0ZXJdID0gdG9rZW47CiAgICAgICAgZm9yIChsZXQga2V5IGluIHBhcmFtcykgewogICAgICAgICAgICBpZiAocGFyYW1zLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGhpZGRlbkZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAgICAgICAgIGhpZGRlbkZpZWxkLnR5cGUgPSAnaGlkZGVuJzsKICAgICAgICAgICAgICAgIGhpZGRlbkZpZWxkLm5hbWUgPSBrZXk7CiAgICAgICAgICAgICAgICBoaWRkZW5GaWVsZC52YWx1ZSA9IHBhcmFtc1trZXldOwogICAgICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChoaWRkZW5GaWVsZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmb3JtKTsKICAgICAgICBmb3JtLnN1Ym1pdCgpOwogICAgfQoKICAgIHZhciBjb21wb3NlUGFyYW1zID0gZnVuY3Rpb24obykgewogICAgICAgIHJldHVybiBfLm1hcChfLnBhaXJzKG8pLCBmdW5jdGlvbihwKXtyZXR1cm4gcC5qb2luKCc9Jyl9ICkuam9pbignJicpCiAgICB9OwoKICAgIHZhciBjYXBpdGFsSXQgPSBmdW5jdGlvbihzKSB7CiAgICAgICAgcmV0dXJuIHMgJiYgc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKTsKICAgIH07CgogICAgdmFyIGJyZWFrSXQgPSBmdW5jdGlvbihzKSB7CiAgICAgICAgcmV0dXJuIHMgPyBzLnNwbGl0KC8oPz1bQS1aXSkvKS5qb2luKCcgJykgOiBzCiAgICB9OwoKICAgIHZhciBlbmFibGVfbG9hZF9idXR0b24gPSBmdW5jdGlvbihlbGUsIGVuYWJsZWQpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXZ0KSB7CiAgICAgICAgICAgIHZhciB0YXJnZXRFbGUgPSBlbGUuZmluZCgnLmdseXBoaWNvbicpOwogICAgICAgICAgICBpZiAoZW5hYmxlZCkgewogICAgICAgICAgICAgICAgJCh0YXJnZXRFbGUpLmFkZENsYXNzKCdyZWZyZXNoLWFuaW1hdGUnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICQodGFyZ2V0RWxlKS5yZW1vdmVDbGFzcygncmVmcmVzaC1hbmltYXRlJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgdmFyIHNldEluTG9jYWxTdG9yYWdlID0gZnVuY3Rpb24ocHJvcCwgZGF0YSkgewogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHByb3AsIGRhdGEpOwogICAgfTsKCiAgICB2YXIgZ2V0RnJvbUxvY2FsU3RvcmFnZSA9IGZ1bmN0aW9uKHByb3ApIHsKICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0ocHJvcCk7CiAgICB9OwoKICAgIHZhciBzZXRKU09OSW5Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbihwcm9wLCBkYXRhKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0ocHJvcCwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgfTsKCiAgICB2YXIgZ2V0SlNPTkZyb21Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbiAocHJvcCkgewogICAgICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHByb3ApKTsKICAgIH07CgogICAgdmFyIGxvY2FsU3RvcmFnZVV0aWwgPSB7CiAgICAgICAgc2V0UHJvcCA6IHNldEluTG9jYWxTdG9yYWdlLAogICAgICAgIGdldFByb3AgOiBnZXRGcm9tTG9jYWxTdG9yYWdlLAogICAgICAgIHNldEpTT04gOiBzZXRKU09OSW5Mb2NhbFN0b3JhZ2UsCiAgICAgICAgZ2V0SlNPTiA6IGdldEpTT05Gcm9tTG9jYWxTdG9yYWdlCiAgICB9OwoKICAgIHZhciBnZXRRdWVyeVN0cmluZyA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBrZXkgPSBmYWxzZSwgcmVzID0ge30sIGl0bSA9IG51bGw7CiAgICAgICAgLy8gZ2V0IHRoZSBxdWVyeSBzdHJpbmcgd2l0aG91dCB0aGUgPwogICAgICAgIHZhciBxcyA9IGxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSk7CiAgICAgICAgLy8gY2hlY2sgZm9yIHRoZSBrZXkgYXMgYW4gYXJndW1lbnQKICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdLmxlbmd0aCA+IDEpCiAgICAgICAgICAgIGtleSA9IGFyZ3VtZW50c1swXTsKICAgICAgICAvLyBtYWtlIGEgcmVnZXggcGF0dGVybiB0byBncmFiIGtleS92YWx1ZQogICAgICAgIHZhciBwYXR0ZXJuID0gLyhbXiY9XSspPShbXiZdKikvZzsKICAgICAgICAvLyBsb29wIHRoZSBpdGVtcyBpbiB0aGUgcXVlcnkgc3RyaW5nLCBlaXRoZXIKICAgICAgICAvLyBmaW5kIGEgbWF0Y2ggdG8gdGhlIGFyZ3VtZW50LCBvciBidWlsZCBhbiBvYmplY3QKICAgICAgICAvLyB3aXRoIGtleS92YWx1ZSBwYWlycwogICAgICAgIHdoaWxlIChpdG0gPSBwYXR0ZXJuLmV4ZWMocXMpKSB7CiAgICAgICAgICAgIGlmIChrZXkgIT09IGZhbHNlICYmIGRlY29kZVVSSUNvbXBvbmVudChpdG1bMV0pID09PSBrZXkpCiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGl0bVsyXSk7CiAgICAgICAgICAgIGVsc2UgaWYgKGtleSA9PT0gZmFsc2UpCiAgICAgICAgICAgICAgICByZXNbZGVjb2RlVVJJQ29tcG9uZW50KGl0bVsxXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KGl0bVsyXSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4ga2V5ID09PSBmYWxzZSA/IHJlcyA6IG51bGw7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgICAgcmVuZGVyIDogcmVuZGVyLAogICAgICAgIHN0YWNrZWQ6IHN0YWNrZWQsCiAgICAgICAgY29tcG9zZVVybDogY29tcG9zZVVybCwKICAgICAgICBwb3N0VXJsOiBwb3N0VXJsLAogICAgICAgIGNvbXBvc2VQYXJhbXM6IGNvbXBvc2VQYXJhbXMsCiAgICAgICAgY2FwaXRhbEl0OiBjYXBpdGFsSXQsCiAgICAgICAgYnJlYWtJdDogYnJlYWtJdCwKICAgICAgICBoYnNfcGFydGlhbDogaGJzX3BhcnRpYWwsCiAgICAgICAgZW5hYmxlX2xvYWRfYnV0dG9uOiBlbmFibGVfbG9hZF9idXR0b24sCiAgICAgICAgbG9jYWxTdG9yYWdlVXRpbDogbG9jYWxTdG9yYWdlVXRpbCwKICAgICAgICBnZXRRdWVyeVN0cmluZzogZ2V0UXVlcnlTdHJpbmcKICAgIH0KfSkoKTsKCnZhciBmZXRjaEFjY2VwdGVkRmlsZUZvcm1hdHMgPSBmdW5jdGlvbigpIHsKICAgICQuYWpheCh7CiAgICAgICAgdXJsOiAnL3NpZ25hbC9hdHRhY2htZW50YWJsZS9mZXRjaEFjY2VwdGVkRmlsZUZvcm1hdHMnICwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICQoIi5hdHRhY2htZW50LWZpbGUiKS5hdHRyKCJhY2NlcHQiICwgcmVzdWx0LmpvaW4oIiwiKSkKICAgICAgICB9LAogICAgfSk7Cn07CgoKSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignaTE4bicsCiAgICBmdW5jdGlvbihzdHIpewogICAgICAgIHJldHVybiAoICh0eXBlb2YgaTE4bikgIT09ICd1bmRlZmluZWQnID8gc3RyIDogc3RyKQogICAgfQopOwoKSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignc2VsZWN0JywgZnVuY3Rpb24obmFtZSwgc2VsZWN0ZWRWYWx1ZSwgb3B0aW9ucywgZGlzcF9maWVsZCwgdmFsdWVfZmllbGQpIHsKICAgIHZhciBvdXQgPSAiPHNlbGVjdCBjbGFzcz0nZm9ybS1jb250cm9sIHNlbGVjdEJveCcgaWQ9XCciICsgbmFtZSArICJcJyBuYW1lPSIgKyBuYW1lICsgIj5cbiI7CiAgICBfLmVhY2gob3B0aW9ucywgZnVuY3Rpb24odikgewogICAgICAgIG91dCArPSAiPG9wdGlvbiB2YWx1ZT0nIiArIHZbdmFsdWVfZmllbGRdICsgIiciICsKICAgICAgICAgICAgKHZbdmFsdWVfZmllbGRdID09IHNlbGVjdGVkVmFsdWVbdmFsdWVfZmllbGRdID8gIiBzZWxlY3RlZCAiIDogIiIpICsgIiA+IiArCiAgICAgICAgICAgIGVzY2FwZUhUTUwodltkaXNwX2ZpZWxkXSkgKyAiPC9vcHRpb24+XG4iCiAgICB9KTsKICAgIG91dCArPSAiPC9zZWxlY3Q+IjsKCiAgICByZXR1cm4gbmV3IEhhbmRsZWJhcnMuU2FmZVN0cmluZyhvdXQpCn0pOwoKSGFuZGxlYmFycy5yZWdpc3RlclBhcnRpYWwoJ2RhdGVfcGlja2VyX3RlbXBsYXRlJywgc2lnbmFsLnV0aWxzLmhic19wYXJ0aWFsKCdkYXRlX3BpY2tlcl90ZW1wbGF0ZScpKTsKCi8vSGFuZGxlYmFyIGhlbHBlciB0byBpbWl0YXRlIHRoZSBpZiBjb25kaXRpb25zCkhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ2lmX2VxJywgZnVuY3Rpb24oYSwgYiwgb3B0cykgewogICAgaWYgKGEgPT0gYikgewogICAgICAgIHJldHVybiBvcHRzLmZuKHRoaXMpOwogICAgfQp9KTsKCi8vSGFuZGxlYmFyIGhlbHBlciB0byBpbWl0YXRlIHRoZSBpZi4uZWxzZSBjb25kaXRpb25zCkhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ2lmX2Vsc2VfZXEnLCBmdW5jdGlvbihhLCBiLCBvcHRzKSB7CiAgICBpZiAoYSA9PSBiKSB7CiAgICAgICAgcmV0dXJuIG9wdHMuZm4odGhpcyk7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBvcHRzLmludmVyc2UodGhpcyk7CiAgICB9Cn0pOwoKSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignaWZfdGFnX2V4aXN0JywgZnVuY3Rpb24oa2V5LCB2YWx1ZSx0YWdzLCBvcHRzKSB7CiAgICBpZih2YWx1ZS50YWdUZXh0ID09IHRhZ3Nba2V5LTFdLnRhZ1RleHQgJiYgdmFsdWUuc3ViVGFnVGV4dCE9bnVsbCAmJiB2YWx1ZS5zdWJUYWdUZXh0ICE9IHRhZ3Nba2V5LTFdLnN1YlRhZ1RleHQpewogICAgICAgIHJldHVybiBvcHRzLmZuKHRoaXMpOwogICAgfSBlbHNlewogICAgICAgIHJldHVybiBvcHRzLmludmVyc2UodGhpcyk7CiAgICB9Cn0pOwoKSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignaWZfZWxzZV9uZXEnLCBmdW5jdGlvbihhLCBiLCBvcHRzKSB7CiAgICBpZiAoYSAhPSBiKSB7CiAgICAgICAgcmV0dXJuIG9wdHMuZm4odGhpcyk7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBvcHRzLmludmVyc2UodGhpcyk7CiAgICB9Cn0pOwoKLy89IHJlcXVpcmUgYXBwL3B2cy9jb21tb24vcnhfaGFuZGxlYmFyX2V4dC5qcwoKdmFyIHNpZ25hbCA9IHNpZ25hbCB8fCB7fTsKCnNpZ25hbC5hbGVydHNfdXRpbHMgPSAoZnVuY3Rpb24oKSB7CiAgICB2YXIgcHJpb3JpdGllczsKICAgIHZhciB3b3JrZmxvd1N0YXRlczsKCiAgICB2YXIgZ2V0X3ByaW9yaXRpZXMgPSBmdW5jdGlvbigpIHsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6ICIvc2lnbmFsL3dvcmtmbG93L3ByaW9yaXRpZXMiLAogICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkgewogICAgICAgICAgICAgICAgcHJpb3JpdGllcyA9IHJlc3VsdAogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBwcmlvcml0aWVzCiAgICB9OwoKICAgIHZhciBnZXRfd29ya2Zsb3dTdGF0ZXMgPSBmdW5jdGlvbihpbml0RGF0YSkgewogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybDogIi9zaWduYWwvd29ya2Zsb3cvd29ya2Zsb3dTdGF0ZSIsCiAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgZGF0YTogaW5pdERhdGEsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkgewogICAgICAgICAgICAgICAgd29ya2Zsb3dTdGF0ZXMgPSByZXN1bHQKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICByZXR1cm4gd29ya2Zsb3dTdGF0ZXMKICAgIH07CgogICAgdmFyIHByaW9yaXRpZXNfc2VsZWN0aW9ucyA9IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgIHZhciBuZXdfc2VsZWN0ID0gJzxkaXY+PHNlbGVjdCBjbGFzcz0iZm9ybS1jb250cm9sIGFkZC1jdXJzb3IiICcgKwogICAgICAgICAgICAnc3R5bGU9ImhlaWdodDogMzBweDsiIG9uY2hhbmdlPSJ1cGRhdGVQcmlvcml0eSh0aGlzLnZhbHVlLCcgKyByb3cuaWQgKyAnKSI+JzsKICAgICAgICB2YXIgcHJpb3JpdHkgPSByb3cucHJpb3JpdHk7CgogICAgICAgIHZhciB0aGVfc2VsZWN0ID0gXy5yZWR1Y2UocHJpb3JpdGllcywgZnVuY3Rpb24obSwgcCl7CiAgICAgICAgICAgIGlmIChwLnZhbHVlID09IHByaW9yaXR5KQogICAgICAgICAgICAgICAgcmV0dXJuIG0gKyAnPG9wdGlvbiB2YWx1ZT0iJyArIHAudmFsdWUgKyAnIiBzZWxlY3RlZD4gJyArIHAuZGlzcGxheU5hbWUgKyAnPC9vcHRpb24+JzsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIG0gKyAnPG9wdGlvbiB2YWx1ZT0iJyArIHAudmFsdWUgKyAnIj4nICsgcC5kaXNwbGF5TmFtZSArICc8L29wdGlvbj4nCiAgICAgICAgfSwgbmV3X3NlbGVjdCk7CiAgICAgICAgdGhlX3NlbGVjdCA9IHRoZV9zZWxlY3QgKyAnPC9zZWxlY3Q+PC9kaXY+JzsKICAgICAgICByZXR1cm4gdGhlX3NlbGVjdDsKICAgIH07CgogICAgdmFyIHdvcmtmbG93X3NlbGVjdGlvbnMgPSBmdW5jdGlvbihkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICB2YXIgbmV3X3NlbGVjdCA9ICc8ZGl2PjxzZWxlY3QgY2xhc3M9ImZvcm0tY29udHJvbCBhZGQtY3Vyc29yIiBzdHlsZT0iaGVpZ2h0OiAzMHB4OyIgb25jaGFuZ2U9InVwZGF0ZVN0YXR1cyh0aGlzLnZhbHVlLCcgKyByb3cuaWQgKyAnKSI+JzsKICAgICAgICB2YXIgd29ya2Zsb3dTdGF0ZSA9IHJvdy53b3JrZmxvd1N0YXRlOwoKICAgICAgICB2YXIgdGhlX3NlbGVjdCA9IF8ucmVkdWNlKHdvcmtmbG93U3RhdGVzLCBmdW5jdGlvbihtLCB3cyl7CiAgICAgICAgICAgIGlmICh3cy52YWx1ZSA9PSB3b3JrZmxvd1N0YXRlKQogICAgICAgICAgICAgICAgcmV0dXJuIG0gKyAnPG9wdGlvbiB2YWx1ZT0iJyArIHdzLnZhbHVlICsgJyIgc2VsZWN0ZWQ+ICcgKyB3cy5kaXNwbGF5TmFtZSArICc8L29wdGlvbj4nOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gbSArICc8b3B0aW9uIHZhbHVlPSInICsgd3MudmFsdWUgKyAnIj4nICsgd3MuZGlzcGxheU5hbWUgKyAnPC9vcHRpb24+JwogICAgICAgIH0sIG5ld19zZWxlY3QpOwogICAgICAgIHRoZV9zZWxlY3QgPSB0aGVfc2VsZWN0ICsgJzwvc2VsZWN0PjwvZGl2Pic7CiAgICAgICAgcmV0dXJuIHRoZV9zZWxlY3Q7CiAgICB9OwoKICAgIHZhciBjb21wb3NlX2VkaXRfc3RhdGVfbGluayA9IGZ1bmN0aW9uKHZhbHVlLCByb3dJZCwgZmlsZWROYW1lKSB7CiAgICAgICAgcmV0dXJuICI8c3Bhbj4iICsgdmFsdWUgKyAiPC9zcGFuPiIgKyAiPGEgaHJlZj0nIycgY2xhc3M9J2VkaXQtc3RhdGUnID4iICsKICAgICAgICAgICAgIjxpIGNsYXNzPSdmYSBmYS1zaGFyZS1hbHQgcHVsbC1yaWdodCcgZGF0YS1maWVsZD0nIiAgKyBmaWxlZE5hbWUgKwogICAgICAgICAgICAiJyBkYXRhLWlkPSciICsgcm93SWQgKyAiJy8+PC9hPiIKICAgIH07CgogICAgdmFyIHN0YXRlX2NoYW5nZWQgPSBmdW5jdGlvbihleHRyYV92YWx1ZXMpIHsKICAgICAgICAkKCIjdmFsdWVTZWxlY3QiKS5jaGFuZ2UoZnVuY3Rpb24oZXZ0KSB7CiAgICAgICAgICAgIHZhciBhdmFpbGFibGVfZXh0cmFfdmFsdWVzID0gZXh0cmFfdmFsdWVzWyQodmFsdWVTZWxlY3QpLnZhbCgpXQogICAgICAgIH0pCiAgICB9OwoKICAgIC8vVE9ETyB0aGlzIGlzIGEgdGVtcCBzb2x1dGlvbiBmb3IgdGhlIEpTT04gZm9ybWF0LiBJdCBzaG91bGQgY29tZSBmcm9tIHNlcnZlciBzaWRlCiAgICAvL0Z1bmN0aW9uIHRoYXQgY29udmVydHMgdGhlIGpzb24gaW5uZXJodG1sIHRvIHRoZSBjc3YgdmFsdWVzLgogICAgLy9JdCBjb252ZXJ0cyB0aGUgcHJvcGVydGllcyB3aGljaCBhcmUgbm90IGlkLgogICAgdmFyIHNob3dfanNvbl9hc19jc3YgPSBmdW5jdGlvbiAoZWxlbWVudENsYXNzKSB7CiAgICAgICAgJCgiLiIgKyBlbGVtZW50Q2xhc3MpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgaWYgKGlzTmFOKCQodGhpcykuaHRtbCgpKSkgewogICAgICAgICAgICAgICAgICB2YXIgbW9kaWZpZWRWYWwgPSAiIjsKICAgICAgICAgICAgICAgICAgdmFyIGpzb25WYWwgPSBKU09OLnBhcnNlKCQodGhpcykuaHRtbCgpKTsKICAgICAgICAgICAgICAgICAgZm9yICh2YXIgb2JqIGluIGpzb25WYWwpIHsKICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb25WYWwuaGFzT3duUHJvcGVydHkob2JqKSkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIGpzb25WYWxbb2JqXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvblZhbFtvYmpdLmhhc093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9wICE9ICdpZCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWRWYWwgPSBtb2RpZmllZFZhbCArIGpzb25WYWxbb2JqXVtwcm9wXSArICIsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgJCh0aGlzKS5odG1sKG1vZGlmaWVkVmFsLnNsaWNlKDAsIC0xKSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgLy9EbyBub3RoaW5nCiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhlcnIpCiAgICAgICAgICAgfQogICAgICAgICAgICQodGhpcykuaHRtbCgpCiAgICAgICAgfSkKICAgIH07CgogICAgdmFyIGluaXRfbWF0Y2hlZF9hbGVydHNfdGFibGUgPSBmdW5jdGlvbih0YWJsZUVsZSwgdXJsKSB7CiAgICAgICAgdmFyIHRhYmxlID0gdGFibGVFbGUuRGF0YVRhYmxlKHsKICAgICAgICAgICAgImxhbmd1YWdlIjogewogICAgICAgICAgICAgICAgInVybCI6ICIvc2lnbmFsL2Fzc2V0cy9pMThuL2RhdGFUYWJsZXNfIiArIHVzZXJMb2NhbGUgKyAiLmpzb24iCiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBhamF4OiB7CiAgICAgICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgICAgIGRhdGFTcmM6ICcnLAogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHhocixzdGF0dXMsZXJyb3Ipe30KICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIGFvQ29sdW1uczpbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbURhdGE6ICduYW1lJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtRGF0YTogJ3Byb2R1Y3RTZWxlY3Rpb24nCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1EYXRhOiAndG9waWMnCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1EYXRhOiAnZGV0ZWN0ZWREYXRlJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtRGF0YTogJ2Rpc3Bvc2l0aW9uJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAogICAgICAgICAgICBkb206ICcnCiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiB0YWJsZQogICAgfTsKCiAgICB2YXIgZ2V0U2lnbmFsTmFtZUxpc3QgPSBmdW5jdGlvbihzaWduYWxzQW5kVG9waWNzKSB7CiAgICAgICAgdmFyIHNpZ25hbEFuZFRvcGljcyA9ICcnOwogICAgICAgICQuZWFjaChzaWduYWxzQW5kVG9waWNzLCBmdW5jdGlvbihpLCBvYmopewogICAgICAgICAgICB2YXIgdXJsID0gc2lnbmFsRGV0YWlsVXJsICsgJz9pZD0nICsgb2JqWydzaWduYWxJZCddOwogICAgICAgICAgICBzaWduYWxBbmRUb3BpY3MgPSBzaWduYWxBbmRUb3BpY3MgKyAnPHNwYW4gY2xhc3M9ImNsaWNrIj48YSBocmVmPSInICsgdXJsICsgJyI+JyArIG9ialsnbmFtZSddICsgJzwvYT48L3NwYW4+Jm5ic3A7JwogICAgICAgICAgICBzaWduYWxBbmRUb3BpY3MgPSBzaWduYWxBbmRUb3BpY3MgKyAiLCIKICAgICAgICB9KTsKICAgICAgICBpZihzaWduYWxBbmRUb3BpY3MubGVuZ3RoID4gMSkKICAgICAgICAgICAgcmV0dXJuICc8ZGl2PicgKyBzaWduYWxBbmRUb3BpY3Muc3Vic3RyaW5nKDAsIHNpZ25hbEFuZFRvcGljcy5sZW5ndGggLSAxKSArICc8L2Rpdj4nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuICctJzsKICAgIH07CgogICAgLy8gRm9yIHNoYXJlZCB3aXRoIG1vZGFsCiAgICB2YXIgaW5pdGlhbGl6ZVNoYXJlV2l0aFNlbGVjdDIgPSBmdW5jdGlvbigpewogICAgICAgICQoJyNzaGFyZVdpdGgnKS5zZWxlY3QyKCkub24oImNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICQoJyNzaGFyZVdpdGgnKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnaGFzLWVycm9yJyk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBpbml0aWFsaXplU2hhcmVXaXRoVmFsdWVzID0gZnVuY3Rpb24oKXsKICAgICAgICAkKCcjc2hhcmVkV2l0aE1vZGFsJykub24oJ3Nob3cuYnMubW9kYWwnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHZhciBleGVjdXRlZENvbmZpZ0lkID0gZS5yZWxhdGVkVGFyZ2V0LmlkOwogICAgICAgICAgICAkKCcjZXhlY3V0ZWRDb25maWdJZCcpLnZhbChleGVjdXRlZENvbmZpZ0lkKTsKICAgICAgICAgICAgJCgnI3NoYXJlZFdpdGgnKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnaGFzLWVycm9yJyk7CgogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLAogICAgICAgICAgICAgICAgdHlwZTogJ0dFVCcsCiAgICAgICAgICAgICAgICB1cmw6IGdldFNoYXJlZFdpdGggKyAnP2lkPScgKyBleGVjdXRlZENvbmZpZ0lkLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJzID0gJyc7CiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHJlc3VsdC51c2VycywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJzICs9IHRoaXMubmFtZSArICc8YnIgLz4nCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgJCgnI3NoYXJlZFdpdGhVc2VyTGlzdCcpLmh0bWwodXNlcnMpOwogICAgICAgICAgICAgICAgICAgIHZhciBncm91cHMgPSAnJzsKICAgICAgICAgICAgICAgICAgICAkLmVhY2gocmVzdWx0Lmdyb3VwcywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwcyArPSAgdGhpcy5uYW1lICsgJyA8YnIgLz4nCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgJCgnI3NoYXJlZFdpdGhHcm91cExpc3QnKS5odG1sKGdyb3Vwcyk7CgogICAgICAgICAgICAgICAgICAgICQuZWFjaChyZXN1bHQuYWxsLCBmdW5jdGlvbihpLCBkYXRhKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IG5ldyBPcHRpb24oZGF0YS5uYW1lLCBkYXRhLmlkLCB0cnVlLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3NoYXJlZFdpdGgnKS5hcHBlbmQob3B0aW9uKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBzaGFyZWRXaXRoTW9kYWxTaG93ID0gdHJ1ZTsKCiAgICAgICAgfSkub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgc2hhcmVkV2l0aE1vZGFsU2hvdyA9IGZhbHNlOwogICAgICAgICAgICAkKCcjc2hhcmVkV2l0aCcpLnZhbChudWxsKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICAgICAgJCgnI3NoYXJlZFdpdGgnKS5maW5kKCdvcHRpb24nKS5yZW1vdmUoKTsKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIGdldFRhZ3NFbGVtZW50ID0gZnVuY3Rpb24odGFncykgewogICAgICAgIHZhciB0YWdzRWxlbWVudCA9ICc8ZGl2IGNsYXNzPSJ0YWctY29udGFpbmVyIGJsb2NrLWVsbGlwc2lzIj48ZGl2IGNsYXNzPSJ0YWctbGVuZ3RoIj4nOwogICAgICAgIHZhciBnbG9iYWxUYWdzQXJyYXkgPSBbXTsKICAgICAgICB2YXIgYWxlcnRUYWdzcnJheSA9IFtdOwogICAgICAgIHZhciBwcml2YXRlVGFnc0FycmF5ID0gW107CiAgICAgICAgJC5lYWNoKHRhZ3MsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZS5wcml2YXRlVXNlciA9PSAnKFApJykgewogICAgICAgICAgICAgICAgcHJpdmF0ZVRhZ3NBcnJheS5wdXNoKHZhbHVlKQogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLnRhZ1R5cGUgPT0gJyhBKScpIHsKICAgICAgICAgICAgICAgIGFsZXJ0VGFnc3JyYXkucHVzaCh2YWx1ZSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGdsb2JhbFRhZ3NBcnJheS5wdXNoKHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0YWdzRWxlbWVudCArPSBzaWduYWwudXRpbHMucmVuZGVyKCd0YWdzX2RldGFpbHMnLCB7CiAgICAgICAgICAgICAgICBrZXk6IGtleSwKICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICAgICAgICAgIHRhZ3M6dGFncywKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIHZpZXdBbGxFbGVtZW50cyA9IGZldGNoVmlld0FsbFRhZ3MoZ2xvYmFsVGFnc0FycmF5ICwgYWxlcnRUYWdzcnJheSAsIHByaXZhdGVUYWdzQXJyYXkpOwoKICAgICAgICB0YWdzRWxlbWVudCArPSAnPGEgdGFiaW5kZXg9IjAiIGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiBkYXRhLXBsYWNlbWVudD0icmlnaHQiIHRpdGxlPSJBZGQvRWRpdCBDYXRlZ29yaWVzIiBjbGFzcz0iZWRpdEFsZXJ0VGFncyBidG4tZWRpdC10YWcgbWlkIj48aSBjbGFzcz0ibWRpIG1kaS1wZW5jaWwtYm94IGZvbnQtMjAgYmx1ZS0xIj48L2k+PC9hPic7CiAgICAgICAgdGFnc0VsZW1lbnQgKz0gJzxhIHRhYmluZGV4PSIwIiB0aXRsZT0iJyArICQuaTE4bi5fKCdhcHBMYWJlbC52aWV3QWxsJykgKyAnIiBjbGFzcz0iaWNvLWRvdHMgdmlldy1hbGwiIG1vcmUtZGF0YT0iJyt2aWV3QWxsRWxlbWVudHMrJyI+PGkgY2xhc3M9Im1kaSBtZGktZG90cy1ob3Jpem9udGFsIGZvbnQtMjAgYmx1ZS0xIj4gPC9pPjwvYT4nOwogICAgICAgIHRhZ3NFbGVtZW50ICs9ICc8L2Rpdj48L2Rpdj4nOwogICAgICAgIHJldHVybiB0YWdzRWxlbWVudAogICAgfTsKCiAgICB2YXIgZmV0Y2hWaWV3QWxsVGFncyA9IGZ1bmN0aW9uKGdsb2JhbFRhZ3NBcnJheSAsIGFsZXJ0VGFnc0FycmF5ICwgcHJpdmF0ZVRhZ3NBcnJheSkgewogICAgICAgIHZhciByZXR1cm5FbGVtZW50ID0gIiI7CiAgICAgICAgaWYgKGdsb2JhbFRhZ3NBcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHJldHVybkVsZW1lbnQgPSAiPHAgY2xhc3M9J3Bicicgc3R5bGU9J21hcmdpbi10b3A6N3B4Jz48Yj5HbG9iYWwgQ2F0ZWdvcnk8L2I+PGhyIGNsYXNzPSd0YWdlaHInPiI7CiAgICAgICAgICAgIHJldHVybkVsZW1lbnQgKz0gc2lnbmFsLnV0aWxzLnJlbmRlcigndGFnc19kZXRhaWxzX3ZpZXdfYWxsJywge3RhZ3M6IGdsb2JhbFRhZ3NBcnJheX0pICsgIjwvcD4iICA7CiAgICAgICAgfQogICAgICAgIGlmIChhbGVydFRhZ3NBcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHJldHVybkVsZW1lbnQgKz0gIjxwIGNsYXNzPSdwYnInIHN0eWxlPSdtYXJnaW4tdG9wOjdweCc+PGI+QWxlcnQgU3BlY2lmaWMgQ2F0ZWdvcnk8L2I+PGhyIGNsYXNzPSd0YWdlaHInPiI7CiAgICAgICAgICAgIHJldHVybkVsZW1lbnQgKz0gc2lnbmFsLnV0aWxzLnJlbmRlcigndGFnc19kZXRhaWxzX3ZpZXdfYWxsJywgewogICAgICAgICAgICAgICAgdGFnczogYWxlcnRUYWdzQXJyYXksCiAgICAgICAgICAgIH0pICArICI8L3A+IiA7CiAgICAgICAgfQogICAgICAgIGlmIChwcml2YXRlVGFnc0FycmF5Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcmV0dXJuRWxlbWVudCArPSAiPHAgY2xhc3M9J3Bicicgc3R5bGU9J21hcmdpbi10b3A6N3B4Jz48Yj5Qcml2YXRlIENhdGVnb3J5PC9iPjxociBjbGFzcz0ndGFnZWhyJz4iOwogICAgICAgICAgICByZXR1cm5FbGVtZW50ICs9IHNpZ25hbC51dGlscy5yZW5kZXIoJ3RhZ3NfZGV0YWlsc192aWV3X2FsbCcsIHt0YWdzOiBwcml2YXRlVGFnc0FycmF5fSkgICsgIjwvcD4iIDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJldHVybkVsZW1lbnQKICAgIH07CiAgICByZXR1cm4gewogICAgICAgIGdldF9wcmlvcml0aWVzOiBnZXRfcHJpb3JpdGllcywKICAgICAgICBwcmlvcml0aWVzX3NlbGVjdGlvbnM6IHByaW9yaXRpZXNfc2VsZWN0aW9ucywKICAgICAgICBnZXRfd29ya2Zsb3dTdGF0ZXM6IGdldF93b3JrZmxvd1N0YXRlcywKICAgICAgICB3b3JrZmxvd19zZWxlY3Rpb25zOiB3b3JrZmxvd19zZWxlY3Rpb25zLAogICAgICAgIGNvbXBvc2VfZWRpdF9zdGF0ZV9saW5rOiBjb21wb3NlX2VkaXRfc3RhdGVfbGluaywKICAgICAgICBzdGF0ZV9jaGFuZ2U6IHN0YXRlX2NoYW5nZWQsCiAgICAgICAgc2hvd19qc29uX2FzX2Nzdjogc2hvd19qc29uX2FzX2NzdiwKICAgICAgICBpbml0X21hdGNoZWRfYWxlcnRzX3RhYmxlOiBpbml0X21hdGNoZWRfYWxlcnRzX3RhYmxlLAogICAgICAgIGdldFNpZ25hbE5hbWVMaXN0OiBnZXRTaWduYWxOYW1lTGlzdCwKICAgICAgICBpbml0aWFsaXplU2hhcmVXaXRoU2VsZWN0MiA6IGluaXRpYWxpemVTaGFyZVdpdGhTZWxlY3QyLAogICAgICAgIGluaXRpYWxpemVTaGFyZVdpdGhWYWx1ZXM6aW5pdGlhbGl6ZVNoYXJlV2l0aFZhbHVlcywKICAgICAgICBnZXRfdGFnc19lbGVtZW50IDogZ2V0VGFnc0VsZW1lbnQKICAgIH0KfSkoKTsKCnZhciBzaWduYWwgPSBzaWduYWwgfHwge307CgpzaWduYWwubGlzdF91dGlscyA9IChmdW5jdGlvbiAoKSB7CiAgICB2YXIgZmxhZ19pdCA9IGZ1bmN0aW9uIChmbGFnLCBpZCkgewogICAgICAgIHZhciB0aGVIdG1sID0gJzxpIGNsYXNzPSJmYSBmYS1mbGFnLW8gdGV4dC1tdXRlZCByeC1saXN0LWZsYWciIGRhdGEtaWQ9IicgKyBpZCArICciPjwvaT4nCiAgICAgICAgaWYgKGZsYWcpIHsKICAgICAgICAgICAgdGhlSHRtbCA9ICc8aSBjbGFzcz0iZmEgZmEtZmxhZyB0ZXh0LXByaW1hcnkgcngtbGlzdC1mbGFnIiBkYXRhLWlkPSInICsgaWQgKyAnIj48L2k+JwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhlSHRtbAogICAgfTsKCiAgICB2YXIgZmxhZ19oYW5kbGVyID0gZnVuY3Rpb24gKGNvbnRyb2xsZXIsIGFjdGlvbikgewogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcucngtbGlzdC1mbGFnJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIGVsZSA9IGUudGFyZ2V0OwogICAgICAgICAgICB2YXIgaWQgPSAkKGVsZSkuYXR0cignZGF0YS1pZCcpOwoKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDogIi9zaWduYWwvIiArIGNvbnRyb2xsZXIgKyAiLyIgKyBhY3Rpb24gKyAiP2lkPSIgKyBpZCwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmZsYWdnZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJChlbGUpLnJlbW92ZUNsYXNzKCdmYS1mbGFnLW8nKS5yZW1vdmVDbGFzcygndGV4dC1tdXRlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAkKGVsZSkuYWRkQ2xhc3MoJ2ZhLWZsYWcnKS5hZGRDbGFzcygndGV4dC1wcmltYXJ5Jyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJChlbGUpLmFkZENsYXNzKCdmYS1mbGFnLW8nKS5hZGRDbGFzcygndGV4dC1tdXRlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAkKGVsZSkucmVtb3ZlQ2xhc3MoJ2ZhLWZsYWcnKS5yZW1vdmVDbGFzcygndGV4dC1wcmltYXJ5JykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgIH07CgogICAgdmFyIHByaW9yaXR5X2xpbmsgPSBmdW5jdGlvbiAocHJpb3JpdHksIGlkKSB7CiAgICAgICAgdmFyIGljb25fdXJsID0gY29tcG9zZV9wcmlvcml0eV9pY29uKHByaW9yaXR5KTsKICAgICAgICByZXR1cm4gJzxhIGhyZWY9IiMiIGNsYXNzPSJjaGFuZ2UtcHJpb3JpdHkiPjxpbWcgZGF0YS1maWVsZD0icHJpb3JpdHkiIGRhdGEtaW5mbz0icm93IiBkYXRhLWlkPSInICsKICAgICAgICAgICAgaWQgKyAnIiBkYXRhLXZhbHVlPSInICsgcHJpb3JpdHkgKyAnIiBzcmM9IicgKyBpY29uX3VybCArICciLz48L2E+JwogICAgfTsKCiAgICB2YXIgY29tcG9zZV9wcmlvcml0eV9pY29uID0gZnVuY3Rpb24gKHByaW9yaXR5KSB7CiAgICAgICAgdmFyIGljb25fdXJsID0gIi9zaWduYWwvYXNzZXRzL2ljb25zL2RlZmF1bHRfcHJpb3JpdHkucG5nIjsKCiAgICAgICAgaWYgKF8uY29udGFpbnMoWydoaWdoJywgJ2xvdycsICdtZWRpdW0nXSwgcHJpb3JpdHkudG9Mb3dlckNhc2UoKSkpIHsKICAgICAgICAgICAgaWNvbl91cmwgPSAiL3NpZ25hbC9hc3NldHMvaWNvbnMvIiArIHByaW9yaXR5LnRvTG93ZXJDYXNlKCkgKyAiX3ByaW9yaXR5LnBuZyI7CiAgICAgICAgfQogICAgICAgIHJldHVybiBpY29uX3VybDsKICAgIH07CgogICAgdmFyIGNoYW5nZV9wcmlvcml0eSA9IGZ1bmN0aW9uIChwcmlvcml0eUVsZSwgcHJpb3JpdHkpIHsKICAgICAgICB2YXIgaWNvbl91cmwgPSBjb21wb3NlX3ByaW9yaXR5X2ljb24ocHJpb3JpdHkpOwogICAgICAgICQocHJpb3JpdHlFbGUpLmF0dHIoInNyYyIsIGljb25fdXJsKTsKICAgICAgICAkKHByaW9yaXR5RWxlKS5hdHRyKCJkYXRhLXZhbHVlIiwgcHJpb3JpdHkpOwogICAgfTsKCiAgICB2YXIgY2hhbmdlX3ByaW9yaXR5VGVzdCA9IGZ1bmN0aW9uIChwcmlvcml0eUVsZSwgcHJpb3JpdHkpIHsKICAgICAgICAkKHByaW9yaXR5RWxlKS5hdHRyKCJkYXRhLXZhbHVlIiwgcHJpb3JpdHkpOwogICAgfTsKCiAgICBjaGFuZ2VfcHJpb3JpdHlUZXN0CgogICAgdmFyIGZpbmRfZmllbGQgPSBmdW5jdGlvbiAodGFibGVfcm93X2VsZSwgYXR0cl9uYW1lKSB7CiAgICAgICAgcmV0dXJuICQodGFibGVfcm93X2VsZSkuZmluZCgiW2RhdGEtYXR0cmlidXRlLW5hbWU9JyIgKyBhdHRyX25hbWUgKyAiJ10iKQogICAgfTsKCiAgICB2YXIgc2V0X3ZhbHVlID0gZnVuY3Rpb24gKHRhYmxlX3Jvd19lbGUsIGF0dHJfbmFtZSwgaWQsIGRhdGFfZnVuLCBhcHBfbmFtZSkgewogICAgICAgIHZhciBlbGUgPSBmaW5kX2ZpZWxkKHRhYmxlX3Jvd19lbGUsIGF0dHJfbmFtZSk7CiAgICAgICAgZWxlLmh0bWwoZGF0YV9mdW4oaWQsIGFwcF9uYW1lKSk7CiAgICB9OwoKICAgIHZhciBnZXRfZHVlX2luID0gZnVuY3Rpb24gKGlkLCBhcHBfbmFtZSkgewogICAgICAgIHZhciBkdWVJbiA9IDA7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdXJsOiAiL3NpZ25hbC9hbGVydC9kdWVJbj9hbGVydElkPSIgKyBpZCArICImYXBwTmFtZT0iICsgYXBwX25hbWUsCiAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIGR1ZUluID0gZGF0YS5yZXN1bHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZHVlSW4KICAgIH07CgogICAgdmFyIGR1ZV9pbl9jb21wID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgaWYgKHZhbHVlIDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuICI8ZGl2IGRhdGEtYXR0cmlidXRlLW5hbWU9J2R1ZUluJyBzdHlsZSA9ICdjb2xvcjpyZWQnPiIgKyB2YWx1ZSArICI8L2Rpdj4iOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAiPGRpdiBkYXRhLWF0dHJpYnV0ZS1uYW1lPSdkdWVJbic+IiArIHZhbHVlICsgIjwvZGl2PiI7CiAgICAgICAgfQogICAgfTsKCiAgICB2YXIgYXNzaWduZWRfdG9fY29tcCA9IGZ1bmN0aW9uIChpZCwgYXNzaWduZWRUbykgewogICAgICAgIHZhciBodG1sID0gJzxkaXYgY2xhc3M9ImFzc2lnbmVkVG9Db250YWluZXIiPjxzZWxlY3QgY2xhc3M9ImFzc2lnbmVkVG9TZWxlY3QgZm9ybS1jb250cm9sIHNlbGVjdDIiPjwvc2VsZWN0PjxpIGNsYXNzPSJtZGkgbWRpLXNwaW4gbWRpLWxvYWRpbmcgYXNzaWduVG9Qcm9jZXNzaW5nIiBzdHlsZT0iZGlzcGxheTogbm9uZSI+PC9pPjwvZGl2Pic7CiAgICAgICAgcmV0dXJuIGh0bWwKICAgIH07CgogICAgdmFyIHRydW5jYXRlVGV4dEFuZFNob3dUb29sdGlwID0gZnVuY3Rpb24gKGN1dG9mZiwgd29yZGJyZWFrLCBlc2NhcGVIdG1sKSB7CiAgICAgICAgdmFyIGVzYyA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICAucmVwbGFjZSgvJi9nLCAnJmFtcDsnKQogICAgICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKQogICAgICAgICAgICAgICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKQogICAgICAgICAgICAgICAgLnJlcGxhY2UoLyIvZywgJyZxdW90OycpOwogICAgICAgIH07CgogICAgICAgIHJldHVybiBmdW5jdGlvbiAoZCwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgIC8vIE9yZGVyLCBzZWFyY2ggYW5kIHR5cGUgZ2V0IHRoZSBvcmlnaW5hbCBkYXRhCiAgICAgICAgICAgIGlmICh0eXBlICE9PSAnZGlzcGxheScpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodHlwZW9mIGQgIT09ICdudW1iZXInICYmIHR5cGVvZiBkICE9PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgcmV0dXJuIGQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGQgPSBkLnRvU3RyaW5nKCk7IC8vIGNhc3QgbnVtYmVycwoKICAgICAgICAgICAgaWYgKGQubGVuZ3RoIDw9IGN1dG9mZikgewogICAgICAgICAgICAgICAgcmV0dXJuIGVzYyhkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHNob3J0ZW5lZCA9IGQuc3Vic3RyKDAsIGN1dG9mZiAtIDEpOwoKICAgICAgICAgICAgLy8gRmluZCB0aGUgbGFzdCB3aGl0ZSBzcGFjZSBjaGFyYWN0ZXIgaW4gdGhlIHN0cmluZwogICAgICAgICAgICBpZiAod29yZGJyZWFrKSB7CiAgICAgICAgICAgICAgICBzaG9ydGVuZWQgPSBzaG9ydGVuZWQucmVwbGFjZSgvXHMoW15cc10qKSQvLCAnJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFByb3RlY3QgYWdhaW5zdCB1bmNvbnRyb2xsZWQgSFRNTCBpbnB1dAogICAgICAgICAgICBpZiAoZXNjYXBlSHRtbCkgewogICAgICAgICAgICAgICAgc2hvcnRlbmVkID0gZXNjKHNob3J0ZW5lZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiAnPHNwYW4gY2xhc3M9ImVsbGlwc2lzIiB0aXRsZT0iJyArIGVzYyhkKSArICciPicgKyBzaG9ydGVuZWQgKyAnJiM4MjMwOzwvc3Bhbj4nOwogICAgICAgIH07CiAgICB9OwoKICAgIHZhciBhZGRfZmlsdGVycyA9IGZ1bmN0aW9uICh0YWJsZSwgZmlsdGVycywgZmlsdGVyX3RvZ2dsZV9idF9jb250YWluZXIpIHsKCiAgICAgICAgdmFyIHlhZGNmX2ZpbHRlcnMgPSBfLmZpbHRlcihmaWx0ZXJzLCBmdW5jdGlvbiAoZikgewogICAgICAgICAgICBpZiAoZlsxXSAhPSAnY3VzdG9taXplZCcpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHZhciBjdXN0X2ZpbHRlcnMgPSBfLmRpZmZlcmVuY2UoZmlsdGVycywgeWFkY2ZfZmlsdGVycyk7CgogICAgICAgIHlhZGNmLmluaXQodGFibGUsIF8ubWFwKHlhZGNmX2ZpbHRlcnMsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIGlmIChpdGVtWzJdID09IHRydWUpCiAgICAgICAgICAgICAgICByZXR1cm4ge2NvbHVtbl9udW1iZXI6IGl0ZW1bMF0sIGZpbHRlcl90eXBlOiBpdGVtWzFdLCBmaWx0ZXJfcmVzZXRfYnV0dG9uX3RleHQ6ICd4J307CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiB7Y29sdW1uX251bWJlcjogaXRlbVswXSwgZmlsdGVyX3R5cGU6IGl0ZW1bMV0sIGZpbHRlcl9yZXNldF9idXR0b25fdGV4dDogZmFsc2V9OwogICAgICAgIH0pKTsKCiAgICAgICAgaWYgKGZpbHRlcl90b2dnbGVfYnRfY29udGFpbmVyKSB7CiAgICAgICAgICAgIGFkZF9maWx0ZXJfdG9nZ2xlX2J1dHRvbignaWR4eHh4eHgnLCBmaWx0ZXJfdG9nZ2xlX2J0X2NvbnRhaW5lcik7CiAgICAgICAgfQoKICAgICAgICBpZiAoY3VzdF9maWx0ZXJzKSB7CiAgICAgICAgICAgIF8uZWFjaChjdXN0X2ZpbHRlcnMsIGZ1bmN0aW9uIChmKSB7CiAgICAgICAgICAgICAgICAkKHRhYmxlLmNvbHVtbihmWzBdKS5oZWFkZXIoKSkuYXBwZW5kKGNyZWF0ZV9zdGFja2VkX2ZpbHRlcihmWzBdKSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGNyZWF0ZV9zdGFja2VkX2ZpbHRlciA9IGZ1bmN0aW9uIChpZHgpIHsKICAgICAgICByZXR1cm4gJCgiPGlucHV0IHR5cGU9J3RleHQnIGRhdGEtaW5kZXg9JyIgKyBpZHggKyAiJyBjbGFzcz0nY29sdW1uLWZpbHRlcicgcGxhY2Vob2xkZXI9J1R5cGUgdG8gZmlsdGVyJz4iICsKICAgICAgICAgICAgIjxpbnB1dCB0eXBlPSd0ZXh0JyBkYXRhLWluZGV4PSciICsgaWR4ICsgIicgY2xhc3M9J2NvbHVtbi1maWx0ZXInIHBsYWNlaG9sZGVyPSdUeXBlIHRvIGZpbHRlcic+Iik7CiAgICB9OwoKICAgIHZhciBhZGRfZmlsdGVyX3RvZ2dsZV9idXR0b24gPSBmdW5jdGlvbiAodGFibGVfaWQsIGNvbnRhaW5lcikgewogICAgICAgICQoJy55YWRjZi1maWx0ZXItd3JhcHBlciwgLmNvbHVtbi1maWx0ZXInKS5oaWRlKCk7CiAgICAgICAgJCgnLmNvbHVtbi1maWx0ZXInKS5jbGljayhmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgICAgJCgnLmNvbHVtbi1maWx0ZXInKS5vbigna2V5dXAnLCBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgICAgIC8vIFBlcmZvcm0gc2VhcmNoCiAgICAgICAgICAgIHZhciBpbmRleCA9ICQodGhpcykuZGF0YSgnaW5kZXgnKTsKICAgICAgICAgICAgJCh0YWJsZV9pZCkuRGF0YVRhYmxlKCkuY29sdW1uKGluZGV4KS5zZWFyY2goJCh0aGlzKS52YWwoKSkuZHJhdygpOwogICAgICAgIH0pOwogICAgICAgIHZhciBmaWx0ZXJUb2dnbGUgPSAiPGkgY2xhc3M9J3RhYmxlLWZpbHRlci10b2dnbGUgZ2x5cGhpY29uIGdseXBoaWNvbi1maWx0ZXInIGRhdGEtdGFibGU9JyIgKyB0YWJsZV9pZCArCiAgICAgICAgICAgICInIG9uY2xpY2s9J3NpZ25hbC5saXN0X3V0aWxzLmhhbmRsZV9maWx0ZXJfdG9nZ2xlJyBkYXRhLXNob3ctZmlsdGVyPSd0cnVlJz48L2k+IjsKICAgICAgICB2YXIgdG9nZ2xlX2J1dHRvbiA9ICQucGFyc2VIVE1MKGZpbHRlclRvZ2dsZSk7CiAgICAgICAgaWYgKCEoXy5pc1VuZGVmaW5lZChjb250YWluZXIpICYmIF8uaXNOdWxsKGNvbnRhaW5lcikpKSB7CiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQodG9nZ2xlX2J1dHRvbik7CiAgICAgICAgfQoKICAgICAgICAkKGRvY3VtZW50KS5vbignZmlsdGVyLXRvZ2dsZS1pbml0JywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgICAgICAkKCcudGFibGUtZmlsdGVyLXRvZ2dsZScpLmNsaWNrKGZ1bmN0aW9uIChldnQpIHsKICAgICAgICAgICAgICAgIHZhciBoaWRlX3Nob3dfZml0bGVyID0gZnVuY3Rpb24gKHRhYmxlSWQsIGhpZGVPclNob3cpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaGlkZU9yU2hvdyA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJCh0YWJsZUlkICsgJ193cmFwcGVyIC55YWRjZi1maWx0ZXItd3JhcHBlciwuY29sdW1uLWZpbHRlcicpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkKHRhYmxlSWQgKyAnX3dyYXBwZXIgLnlhZGNmLWZpbHRlci13cmFwcGVyLC5jb2x1bW4tZmlsdGVyJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgdmFyIHRhcmdldEZpbHRlclRvZ2dsZSA9ICQoZXZ0LnRhcmdldCk7CiAgICAgICAgICAgICAgICB2YXIgdGFibGVJZCA9IHRhcmdldEZpbHRlclRvZ2dsZS5kYXRhKCd0YWJsZScpOwogICAgICAgICAgICAgICAgdmFyIHNob3dGaWx0ZXIgPSB0YXJnZXRGaWx0ZXJUb2dnbGUuZGF0YSgnc2hvdy1maWx0ZXInKTsKICAgICAgICAgICAgICAgIGlmIChzaG93RmlsdGVyID09PSAndHJ1ZScpIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXRGaWx0ZXJUb2dnbGUuZGF0YSgnc2hvd0ZpbHRlcicsICdmYWxzZScpOwogICAgICAgICAgICAgICAgICAgIGhpZGVfc2hvd19maXRsZXIodGFibGVJZCwgZmFsc2UpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXRGaWx0ZXJUb2dnbGUuZGF0YSgnc2hvd0ZpbHRlcicsICd0cnVlJyk7CiAgICAgICAgICAgICAgICAgICAgaGlkZV9zaG93X2ZpdGxlcih0YWJsZUlkLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ2ZpbHRlci10b2dnbGUtaW5pdCcpOwogICAgICAgIHJldHVybiAkKHRvZ2dsZV9idXR0b24pOwogICAgfTsKCiAgICB2YXIgaGFuZGxlX2ZpbHRlcl90b2dnbGUgPSBmdW5jdGlvbiAoZXZ0KSB7CiAgICAgICAgJCh0aGlzKS5hdHRyKCd0YXJnZXQtdGFibGUnKTsKICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgICBmbGFnX2l0OiBmbGFnX2l0LAogICAgICAgIGZsYWdfaGFuZGxlcjogZmxhZ19oYW5kbGVyLAogICAgICAgIHByaW9yaXR5X2xpbms6IHByaW9yaXR5X2xpbmssCiAgICAgICAgY2hhbmdlX3ByaW9yaXR5OiBjaGFuZ2VfcHJpb3JpdHksCiAgICAgICAgZmluZF9maWVsZDogZmluZF9maWVsZCwKICAgICAgICBzZXRfdmFsdWU6IHNldF92YWx1ZSwKICAgICAgICBnZXRfZHVlX2luOiBnZXRfZHVlX2luLAogICAgICAgIGR1ZV9pbl9jb21wOiBkdWVfaW5fY29tcCwKICAgICAgICBhc3NpZ25lZF90b19jb21wOiBhc3NpZ25lZF90b19jb21wLAogICAgICAgIHRydW5jYXRlVGV4dEFuZFNob3dUb29sdGlwOiB0cnVuY2F0ZVRleHRBbmRTaG93VG9vbHRpcCwKICAgICAgICBhZGRfZmlsdGVyczogYWRkX2ZpbHRlcnMsCiAgICAgICAgaGFuZGxlX2ZpbHRlcl90b2dnbGU6IGhhbmRsZV9maWx0ZXJfdG9nZ2xlLAogICAgICAgIGFkZF9maWx0ZXJfdG9nZ2xlX2J1dHRvbjogYWRkX2ZpbHRlcl90b2dnbGVfYnV0dG9uCiAgICB9Cn0pKCk7CnZhciBzaWduYWwgPSBzaWduYWwgfHwge30KCnNpZ25hbC5hY3Rpdml0aWVzX3V0aWxzID0gKGZ1bmN0aW9uKCkgewogICAgdmFyIGFjdGl2aXR5X3RhYmxlOwogICAgdmFyIHNvcnRpbmdDb3VudCA9IDM7CgogICAgdmFyIGluaXRfYWN0aXZpdGllc190YWJsZSA9IGZ1bmN0aW9uKHRhYmxlLCB1cmwsIGFwcFR5cGUpIHsKICAgICAgICB2YXIgY29sdW1ucyA9IGNyZWF0ZV9hY3Rpdml0eV9jb2x1bW5fZGF0YShhcHBUeXBlKTsKICAgICAgICBhY3Rpdml0eV90YWJsZSA9ICQodGFibGUpLkRhdGFUYWJsZSh7CiAgICAgICAgICAgICJzUGFnaW5hdGlvblR5cGUiOiAiYm9vdHN0cmFwIiwKCiAgICAgICAgICAgICJsYW5ndWFnZSI6IHsKICAgICAgICAgICAgICAgICJ1cmwiOiAiLi4vYXNzZXRzL2kxOG4vZGF0YVRhYmxlc18iICsgdXNlckxvY2FsZSArICIuanNvbiIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFqYXgiOiB7CiAgICAgICAgICAgICAgICAidXJsIjogdXJsLAogICAgICAgICAgICAgICAgImRhdGFTcmMiOiAiIgogICAgICAgICAgICB9LAogICAgICAgICAgICBmbkRyYXdDYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgJCgnYVtocmVmPSIjYWN0aXZpdGllcyJdJykub24oInNob3duLmJzLnRhYiIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI2FjdGl2aXRpZXNUYWJsZScpLkRhdGFUYWJsZSgpLmFqYXgudXJsKGdldEFjdGl2aXR5VXJsKCkpLmxvYWQoKTsKICAgICAgICAgICAgICAgICAgICBhZGRHcmlkU2hvcnRjdXRzKCcjYWN0aXZpdGllc1RhYmxlJyk7CiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlR3JpZFNob3J0Y3V0cygnI2FsZXJ0c0RldGFpbHNUYWJsZScpOwogICAgICAgICAgICAgICAgICAgIHJlbW92ZUdyaWRTaG9ydGN1dHMoJyNhcmNoaXZlZEFsZXJ0c1RhYmxlJyk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFhU29ydGluZyI6IFtbc29ydGluZ0NvdW50LCAiZGVzYyJdXSwKICAgICAgICAgICAgImJMZW5ndGhDaGFuZ2UiOiB0cnVlLAogICAgICAgICAgICAiaURpc3BsYXlMZW5ndGgiOiAxMCwKICAgICAgICAgICAgImJBdXRvV2lkdGgiOiBmYWxzZSwKICAgICAgICAgICAgImFvQ29sdW1ucyI6IGNvbHVtbnMsCiAgICAgICAgICAgICJzY3JvbGxYIjogdHJ1ZSwKICAgICAgICAgICAgInNjcm9sbFkiOiJjYWxjKDEwMHZoIC0gMzAxcHgpIiwKICAgICAgICAgICAgImF1dG9XaWR0aCI6dHJ1ZSwKICAgICAgICAgICAgY29sdW1uRGVmczogW3sKICAgICAgICAgICAgICAgICJ0YXJnZXRzIjogJ19hbGwnLAogICAgICAgICAgICAgICAgInJlbmRlciI6ICQuZm4uZGF0YVRhYmxlLnJlbmRlci50ZXh0KCkKICAgICAgICAgICAgfV0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gYWN0aXZpdHlfdGFibGU7CiAgICB9OwoKICAgIHZhciBjcmVhdGVfYWN0aXZpdHlfY29sdW1uX2RhdGEgPSBmdW5jdGlvbihhcHBUeXBlKSB7CiAgICAgICAgdmFyIGFvQ29sdW1ucyA9IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogInR5cGUiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbihkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICBpZihyb3cudHlwZT09J1BFQ0Rpc3NvY2lhdGVkJyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnUEVDIERpc3NvY2lhdGVkJwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihyb3cudHlwZT09J1BFQ0Fzc29jaWF0ZWQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnUEVDIEFzc29jaWF0ZWQnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzaWduYWwudXRpbHMuYnJlYWtJdChyb3cudHlwZSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiZGV0YWlscyIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJvdy5kZXRhaWxzID0gcm93LmRldGFpbHMucmVwbGFjZSgvPGJyPi9nLCdcbicpCiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdy5qdXN0aWZpY2F0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiPHNwYW4gY2xhc3M9J3dvcmQtd3JhcC1icmVhay13b3JkJz4iK2VzY2FwZUhUTUwocm93LmRldGFpbHMpICsgIiAtLSB3aXRoIEp1c3RpZmljYXRpb24gJyIgKyBlc2NhcGVIVE1MKHJvdy5qdXN0aWZpY2F0aW9uKSArICInIisiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uVGV4dCA9IHByb2Nlc3NfZGVzY3JpcHRpb24ocm93LmRldGFpbHMpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIjxzcGFuIGNsYXNzPSd3b3JkLXdyYXAtYnJlYWstd29yZCBjZWxsLWJyZWFrJz4iK2Rlc2NyaXB0aW9uVGV4dCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0yMDAgY29sLW1heC0zMDAnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJwZXJmb3JtZWRCeSIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICBpZihyb3cucGVyZm9ybWVkQnlEZXB0ICYmIHJvdy5wZXJmb3JtZWRCeURlcHQgIT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVzY2FwZUhUTUwocm93LnBlcmZvcm1lZEJ5ICsgIiAoIiArIHJvdy5wZXJmb3JtZWRCeURlcHQgKyAiKSIpCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93LnBlcmZvcm1lZEJ5CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xNTAnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJ0aW1lc3RhbXAiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbihkYXRhLCB0eXBlLCBmdWxsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEKCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTE1MCcKICAgICAgICAgICAgfQogICAgICAgIF07CiAgICAgICAgaWYoYXBwVHlwZSA9PSAnU2luZ2xlIENhc2UgQWxlcnQnKSB7CiAgICAgICAgICAgIGFvQ29sdW1ucy5zcGxpY2UoMCwwLHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjYXNlTnVtYmVyIiwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xMDAnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhb0NvbHVtbnMuc3BsaWNlKDIsMCx7CiAgICAgICAgICAgICAgICAibURhdGEiOiAic3VzcGVjdCIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMjAwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSgzLDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogImV2ZW50TmFtZSIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSg1LDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogImN1cnJlbnRBc3NpZ25tZW50IiwKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHZhciBjdXJyQXNzaWdubWVudAogICAgICAgICAgICAgICAgICAgIGlmIChyb3cuY3VycmVudEFzc2lnbm1lbnREZXB0ICYmIHJvdy5jdXJyZW50QXNzaWdubWVudERlcHQgIT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3VyckFzc2lnbm1lbnQgPSByb3cuY3VycmVudEFzc2lnbm1lbnQgKyAiICgiICsgcm93LmN1cnJlbnRBc3NpZ25tZW50RGVwdCArICIpIgogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJBc3NpZ25tZW50ID0gKHJvdy5jdXJyZW50QXNzaWdubWVudCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVzY2FwZUhUTUwoY3VyckFzc2lnbm1lbnQpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTE1MCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNvcnRpbmdDb3VudCA9IDcKICAgICAgICB9ZWxzZSBpZihhcHBUeXBlID09ICdMaXRlcmF0dXJlIFNlYXJjaCBBbGVydCcpIHsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSgwLDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogImFydGljbGVJZCIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTAwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSgyLDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogInNlYXJjaFN0cmluZyIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTAwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSgzLDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogInByb2R1Y3ROYW1lIiwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0yMDAnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhb0NvbHVtbnMuc3BsaWNlKDQsMCx7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiZXZlbnROYW1lIiwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xNTAnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhb0NvbHVtbnMuc3BsaWNlKDYsMCx7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiY3VycmVudEFzc2lnbm1lbnQiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJBc3NpZ25tZW50CiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdy5jdXJyZW50QXNzaWdubWVudERlcHQgJiYgcm93LmN1cnJlbnRBc3NpZ25tZW50RGVwdCAhPSAnJykgewogICAgICAgICAgICAgICAgICAgICAgICBjdXJyQXNzaWdubWVudCA9IHJvdy5jdXJyZW50QXNzaWdubWVudCArICIgKCIgKyByb3cuY3VycmVudEFzc2lnbm1lbnREZXB0ICsgIikiCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3VyckFzc2lnbm1lbnQgPSAocm93LmN1cnJlbnRBc3NpZ25tZW50KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXNjYXBlSFRNTChjdXJyQXNzaWdubWVudCkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc29ydGluZ0NvdW50ID0gOAogICAgICAgIH0gZWxzZSBpZiAoYXBwVHlwZSA9PSAnQWdncmVnYXRlIENhc2UgQWxlcnQnIHx8IGFwcFR5cGUgPT0gJ0VWREFTIEFsZXJ0JykgewogICAgICAgICAgICBhb0NvbHVtbnMuc3BsaWNlKDEsMCx7CiAgICAgICAgICAgICAgICAibURhdGEiOiAic3VzcGVjdCIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSgyLDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogImV2ZW50TmFtZSIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYW9Db2x1bW5zLnNwbGljZSg0LDAsewogICAgICAgICAgICAgICAgIm1EYXRhIjogImN1cnJlbnRBc3NpZ25tZW50IiwKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHZhciBjdXJyQXNzaWdubWVudAogICAgICAgICAgICAgICAgICAgIGlmIChyb3cuY3VycmVudEFzc2lnbm1lbnREZXB0ICYmIHJvdy5jdXJyZW50QXNzaWdubWVudERlcHQgIT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3VyckFzc2lnbm1lbnQgPSByb3cuY3VycmVudEFzc2lnbm1lbnQgKyAiICgiICsgcm93LmN1cnJlbnRBc3NpZ25tZW50RGVwdCArICIpIgogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJBc3NpZ25tZW50ID0gKHJvdy5jdXJyZW50QXNzaWdubWVudCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVzY2FwZUhUTUwoY3VyckFzc2lnbm1lbnQpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTE1MCcKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNvcnRpbmdDb3VudCA9IDYKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFvQ29sdW1ucwogICAgfTsKCiAgICB2YXIgcmVsb2FkX2FjdGl2aXR5X3RhYmxlID0gZnVuY3Rpb24oKSB7CgogICAgICAgIGlmICh0eXBlb2YgYWN0aXZpdHlfdGFibGUgIT0gInVuZGVmaW5lZCIgJiYgYWN0aXZpdHlfdGFibGUgIT0gbnVsbCkgewogICAgICAgICAgICBhY3Rpdml0eV90YWJsZS5hamF4LnJlbG9hZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcmVsb2FkIHRoZSBhY3Rpdml0eSB0YWJsZS4gUGxlYXNlIHJlZnJlc2ggdGhlIHBhZ2UuIikKICAgICAgICB9CgogICAgfTsKCiAgICB2YXIgcHJvY2Vzc19kZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKGRlc2NyaXB0aW9uU3RyKSB7CiAgICAgICAgaWYgKHR5cGVvZiBkZXNjcmlwdGlvblN0ciAhPSAidW5kZWZpbmVkIiAmJiBkZXNjcmlwdGlvblN0ciAhPSBudWxsKSB7CiAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbnMgPSBkZXNjcmlwdGlvblN0ci5zcGxpdCgnfCcpOwogICAgICAgICAgICAvL3ZhciBmb3JtYXR0ZWRTdHJpbmcgPSAnJwogICAgICAgICAgICB2YXIgZm9ybWF0dGVkU3RyaW5nID0gIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4PGRlc2NyaXB0aW9ucy5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uc1tpbmRleF07CiAgICAgICAgICAgICAgICB2YXIgZGVzY1NwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgICAgICBkZXNjU3Bhbi5pbm5lckhUTUwgPSBlc2NhcGVIVE1MKGRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgICAgIGRlc2NTcGFuLmlubmVySFRNTCA9IGRlc2NTcGFuLmlubmVySFRNTC5yZXBsYWNlKC9cbi9nLCAnPGJyPicpCiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcuYXBwZW5kQ2hpbGQoZGVzY1NwYW4pOwogICAgICAgICAgICAgICAgZm9ybWF0dGVkU3RyaW5nLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZWRTdHJpbmcuaW5uZXJIVE1MOwogICAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgICBpbml0X2FjdGl2aXRpZXNfdGFibGUgOiBpbml0X2FjdGl2aXRpZXNfdGFibGUsCiAgICAgICAgcHJvY2Vzc19kZXNjcmlwdGlvbiA6IHByb2Nlc3NfZGVzY3JpcHRpb24sCiAgICAgICAgcmVsb2FkX2FjdGl2aXR5X3RhYmxlIDogcmVsb2FkX2FjdGl2aXR5X3RhYmxlCiAgICB9Cn0pKCk7CgpmdW5jdGlvbiBnZXRBY3Rpdml0eVVybCgpIHsKICAgIGlmIChhcHBsaWNhdGlvbk5hbWUgPT09IEFMRVJUX0NPTkZJR19UWVBFLkxJVEVSQVRVUkVfU0VBUkNIX0FMRVJUKSB7CiAgICAgICAgcmV0dXJuIGFsZXJ0QWN0aXZpdGllczsKICAgIH0gZWxzZSBpZiAoYXBwbGljYXRpb25OYW1lID09PSBBTEVSVF9DT05GSUdfVFlQRS5TSUdOQUxfTUFOQUdFTUVOVCkgewogICAgICAgIHJldHVybiBhY3Rpdml0eVVybDsKICAgIH0KICAgIHJldHVybiBhbGVydEFjdGl2aXRpZXNVcmwgKyBlbmNvZGVVUkkoJz9leGVjdXRlZElkTGlzdD0nICsgZXhlY3V0ZWRJZExpc3QgKyAiJmFwcFR5cGU9IiArIGFwcGxpY2F0aW9uTmFtZSkKCn0KCgp2YXIgc2lnbmFsID0gc2lnbmFsIHx8IHt9OwoKc2lnbmFsLmFjdGlvbnNfdXRpbHMgPSAoZnVuY3Rpb24oKSB7CiAgICB2YXIgYWN0aW9uX2xpc3RfdGFibGU7CiAgICB2YXIgY3VycmVudF9jcmVhdGVfYnQ7CiAgICB2YXIgYWRob2NfdmFsaWRhdGVkX3RhYmxlOwoKICAgIHZhciBzZXRfYWN0aW9uX2NyZWF0ZV9tb2RhbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjY3JlYXRlQWN0aW9uTW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgJCh0aGlzKQogICAgICAgICAgICAgICAgLmZpbmQoJyNjb25maWcnKS52YWwoJycpLmVuZCgpCiAgICAgICAgICAgICAgICAuZmluZCgnI3R5cGUnKS52YWwoJycpLmVuZCgpCiAgICAgICAgICAgICAgICAuZmluZCgnI21lZXRpbmdFbGVtZW50JykudmFsKCcnKS5lbmQoKQogICAgICAgICAgICAgICAgLmZpbmQoJy5hc3NpZ25lZFRvVmFsdWUnKS52YWwoJycpLnRyaWdnZXIoJ2NoYW5nZScpLmVuZCgpCiAgICAgICAgICAgICAgICAuZmluZCgnLmFzc2lnbmVkVG9WYWx1ZScpLmVtcHR5KCkuZW5kKCkKICAgICAgICAgICAgICAgIC5maW5kKCJpbnB1dFt0eXBlPXRleHRdLHRleHRhcmVhIikudmFsKCcnKQogICAgICAgICAgICAgICAgLmVuZCgpOwoKICAgICAgICAgICAgJCgnI2NyZWF0ZUFjdGlvbk1vZGFsIC5zZWxlY3QyLXNlbGVjdGlvbl9fcmVuZGVyZWQnKS5ob3ZlcihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUF0dHIoJ3RpdGxlJyk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICB9KTsKCiAgICAgICAgJCgnI2FjdGlvbi1lZGl0LW1vZGFsJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGNsZWFyX2VkaXRfZXJyb3JzKCk7CiAgICAgICAgICAgICQodGhpcykKICAgICAgICAgICAgICAgIC5maW5kKCJpbnB1dFt0eXBlPXRleHRdLHRleHRhcmVhLHNlbGVjdCIpCiAgICAgICAgICAgICAgICAudmFsKCcnKQogICAgICAgICAgICAgICAgLmVuZCgpCiAgICAgICAgfSk7CgogICAgICAgICQoJyNlZGl0QWN0aW9uTW9kYWwnKS5vbignaGlkZGVuLmJzLm1vZGFsJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgY2xlYXJfZWRpdF9zaWduYWwoKTsKICAgICAgICAgICAgJCh0aGlzKQogICAgICAgICAgICAgICAgLmZpbmQoImlucHV0W3R5cGU9dGV4dF0sdGV4dGFyZWEsc2VsZWN0IikKICAgICAgICAgICAgICAgIC52YWwoJycpCiAgICAgICAgICAgICAgICAuZW5kKCkKICAgICAgICB9KTsKCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5hY3Rpb24tY3JlYXRlJywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgICAgICB2YXIgc3JjRWxlID0gJChldnQudGFyZ2V0KTsKICAgICAgICAgICAgY3VycmVudF9jcmVhdGVfYnQgPSBzcmNFbGU7CiAgICAgICAgICAgIHZhciBhbGVydElkID0gYWxlcnRJZDsKICAgICAgICAgICAgaWYgKHR5cGVvZiAoc3JjRWxlLmF0dHIoJ2FsZXJ0LWlkJykpICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICAgICAgYWxlcnRJZCA9IHNyY0VsZS5hdHRyKCdhbGVydC1pZCcpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGNyZWF0ZUFjdGlvbk1vZGFsID0gJCgnI2NyZWF0ZUFjdGlvbk1vZGFsJyk7CiAgICAgICAgICAgIHZhciBjcmVhdGVBY3Rpb25CdXR0b24gPSAkKCIjY3JlYXRlLWFjdGlvbi1idG4iKTsKICAgICAgICAgICAgY3JlYXRlQWN0aW9uTW9kYWwuZmluZCgnLmlkLWVsZW1lbnQnKS5hdHRyKCdkYXRhLWlkJywgYWxlcnRJZCk7CgogICAgICAgICAgICAvL1NldCB0aGUgYWxlcnRJZCBpbiB0aGUgaGlkZGVuIGZpZWxkIG9mIHRoZSBtb2RhbC4KICAgICAgICAgICAgaWYgKHR5cGVvZiBhbGVydElkICE9ICJ1bmRlZmluZWQiICYmIGFsZXJ0SWQgIT0gJycpIHsKICAgICAgICAgICAgICAgIGNyZWF0ZUFjdGlvbk1vZGFsLmZpbmQoIi5hbGVydElkIikudmFsKGFsZXJ0SWQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjcmVhdGVBY3Rpb25Nb2RhbC5maW5kKCcjZHVlLWRhdGUtcGlja2VyJykuZGF0ZXBpY2tlcigpOwogICAgICAgICAgICBjcmVhdGVBY3Rpb25CdXR0b24uYXR0cigiZGlzYWJsZWQiLCBmYWxzZSk7CiAgICAgICAgICAgIGNsZWFyX2Vycm9ycygpOwogICAgICAgICAgICAkKCcuYWN0aW9uLXR5cGUtbGlzdCcpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTsKICAgICAgICAgICAgJCgnLm1lZXRpbmctbGlzdCcpLmFkZENsYXNzKCdoaWRkZW4nKTsKICAgICAgICAgICAgY3JlYXRlQWN0aW9uTW9kYWwubW9kYWwoe30pOwoKICAgICAgICAgICAgLy9FdmVudCBiaW5kIHdoZW4gdGhlIHNhdmUvY3JlYXRlIGJ1dHRvbiBpcyBjbGljawogICAgICAgICAgICAvLyBrZWQgaW4gdGhlIGFjdGlvbiBldmVudCBtb2RhbC4KICAgICAgICAgICAgY3JlYXRlQWN0aW9uQnV0dG9uLnVuYmluZCgnY2xpY2snKS5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGNyZWF0ZUFjdGlvbkJ1dHRvbi5hdHRyKCJkaXNhYmxlZCIsIHRydWUpOwogICAgICAgICAgICAgICAgdmFyIGFsZXJ0SWQgPSAkKGV2ZW50LnRhcmdldCkuYXR0cignZGF0YS1pZCcpOwogICAgICAgICAgICAgICAgdmFyIGFjdGlvbk1vZGFsSWQgPSAkKCIjY3JlYXRlQWN0aW9uTW9kYWwgI3RlbXBGb3JtIik7CiAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICB1cmw6ICcvc2lnbmFsL2FjdGlvbi9zYXZlJywKICAgICAgICAgICAgICAgICAgICBkYXRhOiBnZXRBY3Rpb25EZXRhaWxzKGFjdGlvbk1vZGFsSWQpLAogICAgICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UKICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9lcnJvcnMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yTXNnID0gIjxkaXYgY2xhc3M9J2FsZXJ0IGFsZXJ0LWRhbmdlcic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHJlc3BvbnNlLmRhdGEubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlT2JqID0gcmVzcG9uc2UuZGF0YVtpbmRleF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1zZyArPSBlcnJvck1lc3NhZ2VPYmo7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1zZyArPSAnPC9icj4nOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTXNnICs9ICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWN0aW9uTW9kYWwgLm1vZGFsLWJvZHknKS5wcmVwZW5kKGVycm9yTXNnKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlQWN0aW9uQnV0dG9uLmF0dHIoImRpc2FibGVkIiwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUFjdGlvbk1vZGFsLm1vZGFsKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfY3JlYXRlX2J0LnBhcmVudHNVbnRpbCgidGQiKS5maW5kKCcuZGVmYXVsdC12YWx1ZScpLmh0bWwocmVzcG9uc2UuYWN0aW9uQ291bnQpOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcHBsaWNhdGlvbkxhYmVsICE9ICd1bmRlZmluZWQnICYmIGFwcGxpY2F0aW9uTGFiZWwgPT09ICJDYXNlIERldGFpbCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhY3Rpb24tdGFibGUnKS5EYXRhVGFibGUoKS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhbGVydElkICE9ICJ1bmRlZmluZWQiICYmIGFsZXJ0SWQgIT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRldGFpbF90YWJsZSAhPSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxfdGFibGUuYWpheC5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhY3Rpb24tdGFibGUnKS5EYXRhVGFibGUoKS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNtZWV0aW5nLXRhYmxlJykuRGF0YVRhYmxlKCkuYWpheC5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjc2lnbmFsQWN0aXZpdHlUYWJsZScpLkRhdGFUYWJsZSgpLmFqYXgucmVsb2FkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVmcmVzaCB0aGUgYWN0aXZpdHkgdGFibGUKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcHBsaWNhdGlvbkxhYmVsICE9ICd1bmRlZmluZWQnICYmIGFwcGxpY2F0aW9uTGFiZWwgIT09IEFQUExJQ0FUSU9OX0xBQkVMLkNBU0VfREVUQUlMICYmIGFwcGxpY2F0aW9uTGFiZWwgIT09IEFQUExJQ0FUSU9OX0xBQkVMLkVWRU5UX0RFVEFJTCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmFsLmFjdGl2aXRpZXNfdXRpbHMucmVsb2FkX2FjdGl2aXR5X3RhYmxlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXBwbGljYXRpb25MYWJlbCA9PSBBUFBMSUNBVElPTl9MQUJFTC5TSUdOQUxfTUFOQUdFTUVOVCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbC5tZWV0aW5nX3V0aWxzLnJlbG9hZF9tZWV0aW5nX3RhYmxlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyX2Vycm9ycygpOwogICAgICAgICAgICAgICAgICAgIHZhciBlcnJvck1zZyA9ICI8ZGl2IGNsYXNzPSdhbGVydCBhbGVydC1kYW5nZXInPiI7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2cgKz0gIkVycm9yIG9jY3VyZWQgd2hpbGUgc2F2aW5nIEFjdGlvbi4iOwogICAgICAgICAgICAgICAgICAgIGVycm9yTXNnICs9ICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBY3Rpb25Nb2RhbCAubW9kYWwtYm9keScpLnByZXBlbmQoZXJyb3JNc2cpOwogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUFjdGlvbkJ1dHRvbi5hdHRyKCJkaXNhYmxlZCIsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgIH07CgogICAgdmFyIGdldEFjdGlvbkRldGFpbHMgPSBmdW5jdGlvbihtb2RhbElkKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImNvbmZpZyI6IG1vZGFsSWQuZmluZCgiI2NvbmZpZyIpLnZhbCgpLAogICAgICAgICAgICAidHlwZSI6IG1vZGFsSWQuZmluZCgiI3R5cGUiKS52YWwoKSwKICAgICAgICAgICAgImFzc2lnbmVkVG9WYWx1ZSI6IG1vZGFsSWQuZmluZCgiI2Fzc2lnbmVkVG8iKS52YWwoKSwKICAgICAgICAgICAgImR1ZURhdGUiOiBtb2RhbElkLmZpbmQoIiNkdWVEYXRlIikudmFsKCksCiAgICAgICAgICAgICJkZXRhaWxzIjogbW9kYWxJZC5maW5kKCIjZGV0YWlscyIpLnZhbCgpLAogICAgICAgICAgICAiY29tbWVudHMiOiBtb2RhbElkLmZpbmQoIiNjb21tZW50cyIpLnZhbCgpLAogICAgICAgICAgICAiYWxlcnRJZCI6IG1vZGFsSWQuZmluZCgiI2FsZXJ0SWQiKS52YWwoKSwKICAgICAgICAgICAgImFwcFR5cGUiOiBtb2RhbElkLmZpbmQoIiNhcHBUeXBlIikudmFsKCksCiAgICAgICAgICAgICJleGVDb25maWdJZCI6IG1vZGFsSWQuZmluZCgiI2V4ZUNvbmZpZ0lkIikudmFsKCksCiAgICAgICAgICAgICJtZWV0aW5nSWQiOiBtb2RhbElkLmZpbmQoIiNtZWV0aW5nRWxlbWVudCIpLnZhbCgpLAogICAgICAgICAgICAiYWN0aW9uU3RhdHVzIjogbW9kYWxJZC5maW5kKCIjYWN0aW9uU3RhdHVzIikudmFsKCksCiAgICAgICAgICAgICJhY3Rpb25JZCI6IG1vZGFsSWQuZmluZCgiI2FjdGlvbklkIikudmFsKCksCiAgICAgICAgICAgICJpc0FyY2hpdmVkIjogaXNBcmNoaXZlZAogICAgICAgIH0KICAgIH07CgogICAgdmFyIGNsZWFyX2Vycm9ycyA9IGZ1bmN0aW9uKCkgewogICAgICAgICQoJyNjcmVhdGVBY3Rpb25Nb2RhbCAubW9kYWwtYm9keSAuYWxlcnQnKS5yZW1vdmUoKQogICAgfTsKCiAgICB2YXIgY2xlYXJfZWRpdF9lcnJvcnMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgJCgnI2FjdGlvbi1lZGl0LW1vZGFsIC5tb2RhbC1ib2R5IC5hbGVydCcpLnJlbW92ZSgpCiAgICB9OwogICAgdmFyIGNsZWFyX2VkaXRfc2lnbmFsID0gZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNlZGl0QWN0aW9uTW9kYWwgLm1vZGFsLWJvZHkgLmFsZXJ0JykucmVtb3ZlKCkKICAgIH07CgovL1NpbmdsZSBhbmQgQWdncmVnYXRlIEFjdGlvbiBsaXN0IGRhdGEKICAgIHZhciBzZXRfYWN0aW9uX2xpc3RfbW9kYWwgPSBmdW5jdGlvbihjb21wKSB7CiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5saXN0LWFjdGlvbicsIGZ1bmN0aW9uKGV2dCkgewogICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgY29tcC5tb2RhbCgndG9nZ2xlJywgJCh0aGlzKSk7CiAgICAgICAgfSk7CiAgICAgICAgY29tcC5vbignc2hvd24uYnMubW9kYWwnLCBmdW5jdGlvbihldnQpIHsKICAgICAgICAgICAgdmFyIHNyY0VsZSA9IGV2dC5yZWxhdGVkVGFyZ2V0OwogICAgICAgICAgICB2YXIgYWxlcnRJZCA9ICQoc3JjRWxlKS5hdHRyKCdkYXRhLWlkJyk7CiAgICAgICAgICAgIHZhciBhcHBUeXBlID0gJCgiI2NyZWF0ZUFjdGlvbk1vZGFsICN0ZW1wRm9ybSIpLmZpbmQoIiNhcHBUeXBlIikudmFsKCk7CiAgICAgICAgICAgIHZhciBhY3Rpb25VcmwgPSAiL3NpZ25hbC9hY3Rpb24vbGlzdEJ5QWxlcnQ/YWxlcnRJZD0iICsgYWxlcnRJZCArIiZhcHBUeXBlPSIgKyBhcHBUeXBlKyAiJmlzQXJjaGl2ZWQ9IiArIGlzQXJjaGl2ZWQ7CiAgICAgICAgICAgIGFjdGlvbl9saXN0X3RhYmxlID0gJCgnI2FjdGlvbi10YWJsZScpLkRhdGFUYWJsZSh7CiAgICAgICAgICAgICAgICBkZXN0cm95IDogdHJ1ZSwKICAgICAgICAgICAgICAgICJsYW5ndWFnZSI6IHsKICAgICAgICAgICAgICAgICAgICAidXJsIjogIi4uL2Fzc2V0cy9pMThuL2RhdGFUYWJsZXNfIiArIHVzZXJMb2NhbGUgKyAiLmpzb24iCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZm5EcmF3Q2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAkKCcuZWRpdC1hY3Rpb24tbGluaycpLmNsaWNrKGZ1bmN0aW9uKGV2dCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gIi9zaWduYWwvYWN0aW9uL2dldEJ5SWQ/aWQ9IiArICQodGhpcykuYXR0cignZGF0YS1pZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFjdGlvbl90eXBlcyA9IGFjdGlvbl9zZWxlY3RfdmFsdWVzLnR5cGVzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hY3Rpb25fY29uZmlncyA9IGFjdGlvbl9zZWxlY3RfdmFsdWVzLmNvbmZpZ3M7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFsbF9zdGF0dXMgPSBhY3Rpb25fc2VsZWN0X3ZhbHVlcy5hbGxTdGF0dXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFsZXJ0SWQgPSBhbGVydElkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hY3Rpb25TdGF0dXMgPSB7bmFtZTogZGF0YS5hY3Rpb25TdGF0dXN9OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sX2NvbnRlbnQgPSBzaWduYWwudXRpbHMucmVuZGVyKCdhY3Rpb25fZWRpdG9yJywgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXRvci1jb250YWluZXInKS5odG1sKGh0bWxfY29udGVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXRvci1jb250YWluZXIgI2R1ZS1kYXRlLXBpY2tlcicpLmRhdGVwaWNrZXIoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGEuZHVlRGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb21lbnRDb25maWc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VsdHVyZTogdXNlckxvY2FsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHo6IHVzZXJUaW1lWm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBERUZBVUxUX0RBVEVfRElTUExBWV9GT1JNQVQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5rZXlkb3duKHByZXZlbnRFbnRlcktleVN1Ym1pdCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBtb21lbnQoZGF0YS5kdWVEYXRlLCAiREQtTU1NLVlZWVkiKS5mb3JtYXQoREVGQVVMVF9EQVRFX0ZPUk1BVCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXRvci1jb250YWluZXInKS5maW5kKCcjZHVlLWRhdGUtcGlja2VyJykuZmluZCgnI2R1ZURhdGUnKS52YWwoZHVlRGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXRvci1jb250YWluZXInKS5maW5kKCcjYXBwVHlwZScpLnZhbChhcHBUeXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb25fZWRpdG9yID0gJCgnI2FjdGlvbi1lZGl0b3ItY29udGFpbmVyJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdEFjdGlvbk1vZGFsID0gJCgnI2FjdGlvbi1lZGl0LW1vZGFsJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0QWN0aW9uTW9kYWwuZmluZCgnLmlkLWVsZW1lbnQnKS5hdHRyKCdkYXRhLWlkJywgYWxlcnRJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0QWN0aW9uTW9kYWwuZmluZCgnLmFzc2lnbmVkVG9WYWx1ZScpLnZhbChudWxsKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhY3Rpb24tbW9kYWwnKS5tb2RhbCgnaGlkZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEFjdGlvbk1vZGFsLm1vZGFsKHt9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXQtbW9kYWwgI2NhbmNlbC1idCcpLmNsaWNrKGhhbmRsZV9hY3Rpb25fZWRpdG9yX2NhbmNlbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXQtbW9kYWwgI3VwZGF0ZS1idCcpLmNsaWNrKGhhbmRsZV9hY3Rpb25fZWRpdG9yX3VwZGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJmbkluaXRDb21wbGV0ZSI6IGZ1bmN0aW9uKG9TZXR0aW5ncywganNvbikgewogICAgICAgICAgICAgICAgICAgICQoJy5hY3Rpb24tY3JlYXRlJykuYXR0cignZGF0YS1pZCcsIGFsZXJ0SWQpOwogICAgICAgICAgICAgICAgICAgIHNpZ25hbC5hY3Rpb25zX3V0aWxzLnNldF9hY3Rpb25fY3JlYXRlX21vZGFsKCk7CiAgICAgICAgICAgICAgICAgICAgJCgnI2R1ZS1kYXRlLXBpY2tlcicpLmRhdGVwaWNrZXIoKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJhamF4IjogewogICAgICAgICAgICAgICAgICAgICJ1cmwiOiBhY3Rpb25VcmwsCiAgICAgICAgICAgICAgICAgICAgY2FjaGU6ZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgImRhdGFTcmMiOiAiIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJzZWFyY2hpbmciOiB0cnVlLAogICAgICAgICAgICAgICAgImJQcm9jZXNzaW5nIjogdHJ1ZSwKICAgICAgICAgICAgICAgICJiTGVuZ3RoQ2hhbmdlIjogdHJ1ZSwKICAgICAgICAgICAgICAgICJvTGFuZ3VhZ2UiOiB7CiAgICAgICAgICAgICAgICAgICAgInNQcm9jZXNzaW5nIjogJzxkaXYgY2xhc3M9ImdyaWQtbG9hZGluZyI+PGltZyBzcmM9Ii9zaWduYWwvYXNzZXRzL3NwaW5uZXIuZ2lmIiB3aWR0aD0iMzAiIGFsaWduPSJtaWRkbGUiIC8+PC9kaXY+JwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJpRGlzcGxheUxlbmd0aCI6IDUsCiAgICAgICAgICAgICAgICAiYUxlbmd0aE1lbnUiOiBbWzUsIDEwLCAyMCwgLTFdLCBbNSwgMTAsIDIwLCAiQWxsIl1dLAogICAgICAgICAgICAgICAgImFvQ29sdW1ucyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJpZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8YSBocmVmPScjJyBjbGFzcz0nZWRpdC1hY3Rpb24tbGluaycgZGF0YS1pZD0nIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93LmlkICsgIic+IiArIHJvdy5pZCArICI8YT4iCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInR5cGUiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjb25maWciCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJkZXRhaWxzIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ImNvbC1taW4tMjAwIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAiZHVlRGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiJjb2wtbWluLTEwMCIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImFzc2lnbmVkVG8iLAogICAgICAgICAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjoiY29sLW1pbi0xMDAiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSIgOiAiYWN0aW9uU3RhdHVzIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAiY29tcGxldGVkRGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiJjb2wtbWluLTE1MCIsCiAgICAgICAgICAgICAgICAgICAgICAgIG1SZW5kZXI6IGZ1bmN0aW9uKGRhdGEsIHR5cGUscm93KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByb3cuY29tcGxldGVkRGF0ZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHNjcm9sbFg6IHRydWUsCiAgICAgICAgICAgICAgICBjb2x1bW5EZWZzOiBbewogICAgICAgICAgICAgICAgICAgICJ0YXJnZXRzIjogJ19hbGwnLAogICAgICAgICAgICAgICAgICAgICJyZW5kZXIiOiAkLmZuLmRhdGFUYWJsZS5yZW5kZXIudGV4dCgpCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9KQogICAgICAgIH0pOwoKICAgICAgICBjb21wLm9uKCdoaWRkZW4uYnMubW9kYWwnLCBmdW5jdGlvbihldnQpIHsKICAgICAgICAgIGNvbXAuZmluZCgiI2FjdGlvbi10YWJsZSIpLmVtcHR5KCk7CiAgICAgICAgIH0pOwogICAgICAgIHJldHVybiBhY3Rpb25fbGlzdF90YWJsZQogICAgfTsKICAgIHZhciBzZXRFZGl0TW9kYWxWYWx1ZXMgPSBmdW5jdGlvbiAoZWRpdEFjdGlvbk1vZGFsLCBkYXRhKSB7CiAgICAgICAgdmFyIGFjdGlvblR5cGUgPSBkYXRhLnR5cGVPYmouaWQ7CiAgICAgICAgdmFyIG1lZXRpbmdJZCA9IGRhdGEubWVldGluZ0lkOwogICAgICAgIHZhciBvcHRpb24gPSBuZXcgT3B0aW9uKGRhdGEuYXNzaWduZWRUb09iai5mdWxsTmFtZSwgZGF0YS5hc3NpZ25lZFRvT2JqLmlkLCB0cnVlLCB0cnVlKTsKICAgICAgICBlZGl0QWN0aW9uTW9kYWwuZmluZCgiI2Fzc2lnbmVkVG8iKS5hcHBlbmQob3B0aW9uKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICBpZighbWVldGluZ0lkKSB7CiAgICAgICAgICAgIGVkaXRBY3Rpb25Nb2RhbC5maW5kKCIjdHlwZSIpLnZhbChhY3Rpb25UeXBlKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVkaXRBY3Rpb25Nb2RhbC5maW5kKCIjbWVldGluZ0VsZW1lbnQiKS52YWwobWVldGluZ0lkKTsKICAgICAgICAgICAgZWRpdEFjdGlvbk1vZGFsLmZpbmQoIiNtZWV0aW5nVmFsdWUiKS52YWwobWVldGluZ0lkKTsKICAgICAgICB9CiAgICAgICAgZWRpdEFjdGlvbk1vZGFsLmZpbmQoIi5zdGF0dXMtaWNvbiIpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTsKICAgICAgICBlZGl0QWN0aW9uTW9kYWwuZmluZCgiI2NvbmZpZyIpLnZhbChkYXRhLmNvbmZpZ09iai5pZCk7CiAgICAgICAgZWRpdEFjdGlvbk1vZGFsLmZpbmQoIiNhY3Rpb25JZCIpLnZhbChkYXRhLmlkKTsKICAgICAgICB2YXIgZHVlRGF0ZSA9IG1vbWVudChkYXRhLmR1ZURhdGUsIERFRkFVTFRfREFURV9GT1JNQVQpLmZvcm1hdChERUZBVUxUX0RBVEVfRk9STUFUKTsKICAgICAgICBlZGl0QWN0aW9uTW9kYWwuZmluZCgiI2R1ZS1kYXRlLXBpY2tlciIpLmRhdGVwaWNrZXIoewogICAgICAgICAgICBkYXRlOiAkKCIjZHVlLWRhdGUtcGlja2VyIikudmFsKCkgPyBuZXcgRGF0ZSgkKCIjZHVlLWRhdGUtcGlja2VyIikudmFsKCkpIDogbnVsbCwKICAgICAgICAgICAgbW9tZW50Q29uZmlnOiB7CiAgICAgICAgICAgICAgICBjdWx0dXJlOiB1c2VyTG9jYWxlLAogICAgICAgICAgICAgICAgZm9ybWF0OiBERUZBVUxUX0RBVEVfRElTUExBWV9GT1JNQVQKICAgICAgICAgICAgfQogICAgICAgIH0pLmtleXByZXNzKHByZXZlbnRFbnRlcktleVN1Ym1pdCk7CiAgICAgICAgZWRpdEFjdGlvbk1vZGFsLmZpbmQoIiNkdWVEYXRlIikudmFsKGR1ZURhdGUpOwogICAgICAgIGVkaXRBY3Rpb25Nb2RhbC5maW5kKCIjY29tbWVudHMiKS52YWwoZGF0YS5jb21tZW50cyk7CiAgICAgICAgZWRpdEFjdGlvbk1vZGFsLmZpbmQoIiNkZXRhaWxzIikudmFsKGRhdGEuZGV0YWlscyk7CiAgICAgICAgZWRpdEFjdGlvbk1vZGFsLmZpbmQoIiNhY3Rpb25TdGF0dXMiKS52YWwoZGF0YS5hY3Rpb25TdGF0dXMpOwogICAgICAgIGVkaXRBY3Rpb25Nb2RhbC5maW5kKCcuYWN0aW9uLXZhbHVlJykudHJpZ2dlcignY2hhbmdlJyk7CiAgICB9OwogICAgdmFyIGhhbmRsZV9hY3Rpb25fZWRpdG9yX2NhbmNlbCA9IGZ1bmN0aW9uKGV2dCkgewogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHZhciBhY3Rpb25fbGlzdF90YWJsZSA9ICQoJyNhY3Rpb24tdGFibGUnKS5EYXRhVGFibGUoKTsKICAgICAgICBhY3Rpb25fbGlzdF90YWJsZS5hamF4LnJlbG9hZCgpOwogICAgICAgICQoJyNhY3Rpb24tZWRpdC1tb2RhbCcpLm1vZGFsKCdoaWRlJykKICAgIH07CgogICAgdmFyIGhhbmRsZV9hY3Rpb25fZWRpdG9yX3VwZGF0ZSA9IGZ1bmN0aW9uKGV2dCkgewogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGlmICghZXZ0LmhhbmRsZWQpIHsKICAgICAgICAgICAgZXZ0LmhhbmRsZWQgPSB0cnVlOwogICAgICAgICAgICB2YXIganNvbiA9ICQoJyNhY3Rpb24tZWRpdG9yLWNvbnRhaW5lciBmb3JtI2FjdGlvbi1lZGl0b3ItZm9ybScpLnNlcmlhbGl6ZSgpICsgIiZhcHBUeXBlPSIgKyAkKCIjYXBwVHlwZSIpLnZhbCgpICsgIiZleGVDb25maWdJZD0iICsgJCgiI2V4ZUNvbmZpZ0lkIikudmFsKCkgKyAiJmlzQXJjaGl2ZWQ9IiArIGlzQXJjaGl2ZWQ7CgogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiAnL3NpZ25hbC9hY3Rpb24vdXBkYXRlQWN0aW9uJywKICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgICAgICAgZGF0YToganNvbiwKICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9lZGl0X2Vycm9ycygpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JNc2cgPSAiPGRpdiBjbGFzcz0nYWxlcnQgYWxlcnQtZGFuZ2VyJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCByZXNwb25zZS5kYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZU9iaiA9IHJlc3BvbnNlLmRhdGFbaW5kZXhdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2cgKz0gZXJyb3JNZXNzYWdlT2JqOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2cgKz0gJzwvYnI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1zZyArPSAiPC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FjdGlvbi1lZGl0LW1vZGFsIC5tb2RhbC1ib2R5JykucHJlcGVuZChlcnJvck1zZykKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uX2xpc3RfdGFibGUgPSAkKCcjYWN0aW9uLXRhYmxlJykuRGF0YVRhYmxlKCkKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uX2xpc3RfdGFibGUuYWpheC5yZWxvYWQoKQogICAgICAgICAgICAgICAgICAgICAgICAvL1JlZnJlc2ggdGhlIGFjdGl2aXR5IHRhYmxlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBhcHBsaWNhdGlvbkxhYmVsICE9ICd1bmRlZmluZWQnICYmIGFwcGxpY2F0aW9uTGFiZWwgIT09IEFQUExJQ0FUSU9OX0xBQkVMLkNBU0VfREVUQUlMICYmIGFwcGxpY2F0aW9uTGFiZWwgIT09IEFQUExJQ0FUSU9OX0xBQkVMLkVWRU5UX0RFVEFJTCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmFsLmFjdGl2aXRpZXNfdXRpbHMucmVsb2FkX2FjdGl2aXR5X3RhYmxlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FjdGlvbi1lZGl0LW1vZGFsJykubW9kYWwoJ2hpZGUnKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfQogICAgfQogICAgLy9BZC1ob2MgYWxlcnQgYWN0aW9uIGxpc3QgZGF0YQogICAgdmFyIGluaXRfYWN0aW9uX3RhYmxlID0gZnVuY3Rpb24gKHRhYmxlX2lkLCBhcHBUeXBlKSB7CiAgICAgICAgdmFyIGRhdGFVcmwgPSAiL3NpZ25hbC9hY3Rpb24vbGlzdEJ5QWxlcnQ/YWxlcnRJZD0iICsgYWxlcnRJZCArICImYXBwVHlwZT0iICsgYXBwVHlwZSArICImaXNBcmNoaXZlZD0iICsgaXNBcmNoaXZlZDsKICAgICAgICBhZGhvY192YWxpZGF0ZWRfdGFibGUgPSAkKHRhYmxlX2lkKS5EYXRhVGFibGUoewogICAgICAgICAgICAvLyJzUGFnaW5hdGlvblR5cGUiOiAiYm9vdHN0cmFwIiwKCiAgICAgICAgICAgICJsYW5ndWFnZSI6IHsKICAgICAgICAgICAgICAgICJ1cmwiOiAiLi4vYXNzZXRzL2kxOG4vZGF0YVRhYmxlc18iICsgdXNlckxvY2FsZSArICIuanNvbiIKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIGZuRHJhd0NhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkKCcuZWRpdC1hY3Rpb24tbGluaycpLmNsaWNrKGZ1bmN0aW9uKGV2dCkgewogICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiL3NpZ25hbC9hY3Rpb24vZ2V0QnlJZD9pZD0iICsgJCh0aGlzKS5hdHRyKCdkYXRhLWlkJykKICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXBwVHlwZSA9PSAiU2lnbmFsIE1hbmFnZW1lbnQiIHx8IGFwcFR5cGUgPT0gIlRvcGljIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXRBY3Rpb25Nb2RhbCA9ICQoJyNlZGl0QWN0aW9uTW9kYWwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEVkaXRNb2RhbFZhbHVlcyhlZGl0QWN0aW9uTW9kYWwsIGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEFjdGlvbk1vZGFsLm1vZGFsKHt9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRBY3Rpb25Nb2RhbC5maW5kKCcudXBkYXRlLWFjdGlvbicpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uTW9kYWxJZCA9ICQoIiNlZGl0QWN0aW9uTW9kYWwgI3RlbXBGb3JtIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCgnLm1lZXRpbmctZGVjaWRlcicpLnZhbCgpID09ICd0cnVlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSAnL3NpZ25hbC9hY3Rpb24vdXBkYXRlTWVldGluZ0FjdGlvbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gJy9zaWduYWwvYWN0aW9uL3VwZGF0ZUFjdGlvbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZ2V0QWN0aW9uRGV0YWlscyhhY3Rpb25Nb2RhbElkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2VkaXRfc2lnbmFsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yTXNnID0gIjxkaXYgY2xhc3M9J2FsZXJ0IGFsZXJ0LWRhbmdlcic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGluZGV4ID0gMDsgaW5kZXggPCByZXNwb25zZS5kYXRhLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlT2JqID0gcmVzcG9uc2UuZGF0YVtpbmRleF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTXNnICs9IGVycm9yTWVzc2FnZU9iajsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2cgKz0gJzwvYnI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNc2cgKz0gIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2VkaXRBY3Rpb25Nb2RhbCAubW9kYWwtYm9keScpLnByZXBlbmQoZXJyb3JNc2cpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhY3Rpb24tdGFibGUnKS5EYXRhVGFibGUoKS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNtZWV0aW5nLXRhYmxlJykuRGF0YVRhYmxlKCkuYWpheC5yZWxvYWQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZWZyZXNoIHRoZSBhY3Rpdml0eSB0YWJsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBhcHBsaWNhdGlvbkxhYmVsICE9ICd1bmRlZmluZWQnICYmIGFwcGxpY2F0aW9uTGFiZWwgIT09IEFQUExJQ0FUSU9OX0xBQkVMLkNBU0VfREVUQUlMICYmIGFwcGxpY2F0aW9uTGFiZWwgIT09IEFQUExJQ0FUSU9OX0xBQkVMLkVWRU5UX0RFVEFJTCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduYWwuYWN0aXZpdGllc191dGlscy5yZWxvYWRfYWN0aXZpdHlfdGFibGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdEFjdGlvbk1vZGFsLm1vZGFsKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFjdGlvbl90eXBlcyA9IGFjdGlvbl9zZWxlY3RfdmFsdWVzLnR5cGVzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hY3Rpb25fY29uZmlncyA9IGFjdGlvbl9zZWxlY3RfdmFsdWVzLmNvbmZpZ3M7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFsbF9zdGF0dXMgPSBhY3Rpb25fc2VsZWN0X3ZhbHVlcy5hbGxTdGF0dXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmFsZXJ0SWQgPSBhbGVydElkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5hY3Rpb25TdGF0dXMgPSB7bmFtZTogZGF0YS5hY3Rpb25TdGF0dXN9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxfY29udGVudCA9IHNpZ25hbC51dGlscy5yZW5kZXIoJ2FjdGlvbl9lZGl0b3InLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb25fZWRpdG9yID0gJCgnI2FjdGlvbi1lZGl0b3ItY29udGFpbmVyJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25fZWRpdG9yLmh0bWwoaHRtbF9jb250ZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhY3Rpb24tZWRpdG9yLWNvbnRhaW5lciAjZHVlLWRhdGUtcGlja2VyJykuZGF0ZXBpY2tlcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0YS5kdWVEYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbWVudENvbmZpZzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdWx0dXJlOiB1c2VyTG9jYWxlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ejogdXNlclRpbWVab25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IERFRkFVTFRfREFURV9ESVNQTEFZX0ZPUk1BVAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmtleWRvd24ocHJldmVudEVudGVyS2V5U3VibWl0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbl9lZGl0b3IuZmluZCgnI2R1ZS1kYXRlLXBpY2tlcicpLmZpbmQoJyNkdWVEYXRlJykudmFsKGRhdGEuZHVlRGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25fZWRpdG9yLmZpbmQoJyNkdWUtZGF0ZS1waWNrZXInKS5kYXRlcGlja2VyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdEFjdGlvbk1vZGFsID0gJCgnI2FjdGlvbi1lZGl0LW1vZGFsJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0QWN0aW9uTW9kYWwuZmluZCgnLmlkLWVsZW1lbnQnKS5hdHRyKCdkYXRhLWlkJywgYWxlcnRJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0QWN0aW9uTW9kYWwubW9kYWwoe30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FjdGlvbi1lZGl0b3ItY29udGFpbmVyJykuZmluZCgnI2FwcFR5cGUnKS52YWwoYXBwVHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXQtbW9kYWwgI2NhbmNlbC1idCcpLmNsaWNrKGhhbmRsZV9hY3Rpb25fZWRpdG9yX2NhbmNlbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYWN0aW9uLWVkaXQtbW9kYWwgI3VwZGF0ZS1idCcpLmNsaWNrKGhhbmRsZV9hY3Rpb25fZWRpdG9yX3VwZGF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJmbkluaXRDb21wbGV0ZSI6IGZ1bmN0aW9uKG9TZXR0aW5ncywganNvbikgewogICAgICAgICAgICAgICAgJCgnLmFjdGlvbi1jcmVhdGUnKS5hdHRyKCdkYXRhLWlkJywgYWxlcnRJZCkKICAgICAgICAgICAgICAgIHNpZ25hbC5hY3Rpb25zX3V0aWxzLnNldF9hY3Rpb25fY3JlYXRlX21vZGFsKCkKICAgICAgICAgICAgICAgICQoJyNkdWUtZGF0ZS1waWNrZXInKS5kYXRlcGlja2VyKCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFqYXgiOiB7CiAgICAgICAgICAgICAgICAidXJsIjogZGF0YVVybCwKICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICAgICAgICAgIGRhdGFTcmM6ICIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNlYXJjaGluZzogdHJ1ZSwKICAgICAgICAgICAgZG9tOiAnQmZydGlwJywKICAgICAgICAgICAgYnV0dG9uczogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRleHQ6ICdOZXcgQWN0aW9uJywKICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdidG4tcHJpbWFyeSBhY3Rpb24tY3JlYXRlJywKICAgICAgICAgICAgICAgICAgICBhY3Rpb246IGZ1bmN0aW9uICggZSwgZHQsIG5vZGUsIGNvbmZpZyApIHsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIGFhU29ydGluZzogW1swLCAiZGVzYyJdXSwKICAgICAgICAgICAgImJMZW5ndGhDaGFuZ2UiOiB0cnVlLAogICAgICAgICAgICAiaURpc3BsYXlMZW5ndGgiOiAxMCwKICAgICAgICAgICAgImFMZW5ndGhNZW51IjogW1sxMCwgMjAsIDUwLCAtMV0sIFsxMCwgMjAsIDUwLCAiQWxsIl1dLAogICAgICAgICAgICAiYW9Db2x1bW5zIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJpZCIsCiAgICAgICAgICAgICAgICAgICAgbVJlbmRlcjogZnVuY3Rpb24oZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiPGEgaHJlZj0nIycgY2xhc3M9J2VkaXQtYWN0aW9uLWxpbmsnIGRhdGEtaWQ9JyIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93LmlkICsgIic+IiArIHJvdy5pZCArICI8YT4iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogIiIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInR5cGUiLAogICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8c3BhbiBjbGFzcz0nd29yZC13cmFwLWJyZWFrLXdvcmQnPiIgKyBlc2NhcGVIVE1MKHJvdy50eXBlKSArICI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjb25maWciLAogICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8c3BhbiBjbGFzcz0nd29yZC13cmFwLWJyZWFrLXdvcmQnPiIgKyBlc2NhcGVIVE1MKHJvdy5jb25maWcpICsgIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImRldGFpbHMiLAogICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8c3BhbiBjbGFzcz0nd29yZC13cmFwLWJyZWFrLXdvcmQnPiIgKyBlc2NhcGVIVE1MKHJvdy5kZXRhaWxzKSArICI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJkdWVEYXRlIiwKICAgICAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTAwJywKICAgICAgICAgICAgICAgICAgICBtUmVuZGVyOiBmdW5jdGlvbihkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocm93LmFjdGlvblN0YXR1cyA9PT0gJ0Nsb3NlZCcgJiYgcm93LmFjdGlvblN0YXR1cyA9PT0gJ0RlbGV0ZWQnKSAmJiByb3cucGFzc0R1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8ZGl2IGNsYXNzPSdjbG9zZWQnPiIgKyByb3cuZHVlRGF0ZSArICI8L2Rpdj4iCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIjxkaXY+IiArIHJvdy5kdWVEYXRlICsgIjwvZGl2PiIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImFzc2lnbmVkVG8iLAogICAgICAgICAgICAgICAgICAgIG1SZW5kZXI6IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXNjYXBlSFRNTChyb3cuYXNzaWduZWRUbykKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAiY29sLW1pbi0xNTAiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICIiLAogICAgICAgICAgICAgICAgICAgIG1SZW5kZXI6IGZ1bmN0aW9uKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93LmFjdGlvblN0YXR1cwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICIiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjb21wbGV0ZWREYXRlIiwKICAgICAgICAgICAgICAgICAgICBtUmVuZGVyOiBmdW5jdGlvbihkYXRhLCB0eXBlLHJvdyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByb3cuY29tcGxldGVkRGF0ZQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICJjb2wtbWluLTE1MCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICAgICAgc2Nyb2xsWCA6IHRydWUKICAgICAgICB9KTsKICAgICAgICBhZGhvY192YWxpZGF0ZWRfdGFibGUuYnV0dG9uKCkuZGlzYWJsZSgpOwogICAgICAgIHJldHVybiBhZGhvY192YWxpZGF0ZWRfdGFibGUKICAgIH07CgogICAgdmFyIGJ1aWxkX2FjdGlvbl9yZW5kZXIgPSBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgdmFyIGFjdGlvbl9kcm9wX2Rvd25faHRtbCA9IHNpZ25hbC51dGlscy5yZW5kZXIoImFjdGlvbl9kcm9wX2Rvd24iLCBkYXRhKTsKICAgICAgICByZXR1cm4gYWN0aW9uX2Ryb3BfZG93bl9odG1sCiAgICB9OwogICAgdmFyIHJlbG9hZF9hY3Rpb25fdGFibGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHR5cGVvZiBhZGhvY192YWxpZGF0ZWRfdGFibGUgIT0gInVuZGVmaW5lZCIgJiYgYWRob2NfdmFsaWRhdGVkX3RhYmxlICE9IG51bGwpIHsKICAgICAgICAgICAgYWRob2NfdmFsaWRhdGVkX3RhYmxlLmFqYXgucmVsb2FkKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlVuYWJsZSB0byByZWxvYWQgdGhlIGFjdGl2aXR5IHRhYmxlLiBQbGVhc2UgcmVmcmVzaCB0aGUgcGFnZS4iKQogICAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgICBzZXRfYWN0aW9uX2xpc3RfbW9kYWw6IHNldF9hY3Rpb25fbGlzdF9tb2RhbCwKICAgICAgICBzZXRfYWN0aW9uX2NyZWF0ZV9tb2RhbDogc2V0X2FjdGlvbl9jcmVhdGVfbW9kYWwsCiAgICAgICAgYnVpbGRfYWN0aW9uX3JlbmRlcjogYnVpbGRfYWN0aW9uX3JlbmRlciwKICAgICAgICBpbml0X2FjdGlvbl90YWJsZTogaW5pdF9hY3Rpb25fdGFibGUsCiAgICAgICAgcmVsb2FkX2FjdGlvbl90YWJsZSA6IHJlbG9hZF9hY3Rpb25fdGFibGUsCiAgICAgICAgaGFuZGxlX2FjdGlvbl9lZGl0b3JfY2FuY2VsOiBoYW5kbGVfYWN0aW9uX2VkaXRvcl9jYW5jZWwsCiAgICAgICAgaGFuZGxlX2FjdGlvbl9lZGl0b3JfdXBkYXRlOiBoYW5kbGVfYWN0aW9uX2VkaXRvcl91cGRhdGUsCiAgICAgICAgY2xlYXJfZWRpdF9lcnJvcnM6IGNsZWFyX2VkaXRfZXJyb3JzCiAgICB9Cn0pKCk7Cgp2YXIgc2lnbmFsID0gc2lnbmFsIHx8IHt9CgpzaWduYWwuY2FzZURyaWxsRG93biA9IChmdW5jdGlvbigpIHsKCiAgICB2YXIgaW5pdF9jYXNlX2RyaWxsX2Rvd25fdGFibGUgPSBmdW5jdGlvbih1cmwsIGNhc2VEZXRhaWxVcmwpIHsKCiAgICAgICAgdmFyIHRhYmxlID0gJCgnI2Nhc2UtZHJpbGwtZG93bi10YWJsZScpLkRhdGFUYWJsZSh7CiAgICAgICAgICAgIGxhbmd1YWdlOiB7CiAgICAgICAgICAgICAgICAidXJsIjogIi4uL2Fzc2V0cy9pMThuL2RhdGFUYWJsZXNfIiArIHVzZXJMb2NhbGUgKyAiLmpzb24iCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJhamF4IjogewogICAgICAgICAgICAgICAgInVybCI6IHVybCwKICAgICAgICAgICAgICAgICJkYXRhU3JjIjogIiIKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICJiTGVuZ3RoQ2hhbmdlIjogdHJ1ZSwKICAgICAgICAgICAgImlEaXNwbGF5TGVuZ3RoIjogNTAsCiAgICAgICAgICAgICJhTGVuZ3RoTWVudSI6IFtbNTAsIDEwMCwgMjAwLCAxMDAwLCAtMV0sIFs1MCwgMTAwLCAyMDAsIDEwMDAsICJBbGwiXV0sCiAgICAgICAgICAgICJhb0NvbHVtbnMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImNhc2VOdW0iLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSInKyAoY2FzZURldGFpbFVybCArICc/JyArIHNpZ25hbC51dGlscy5jb21wb3NlUGFyYW1zKHtjYXNlTnVtYmVyOiByb3cuY2FzZU51bSwgdmVyc2lvbjogcm93LmNhc2VWZXJzaW9ufSkpKyciPicrIjxzcGFuIGRhdGEtZmllbGQgPSdjYXNlTnVtJyBkYXRhLWlkPSciICsgcm93LmNhc2VOdW0gKyAiJz4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyb3cuY2FzZU51bSkgKyAiPC9zcGFuPjxzcGFuIGRhdGEtZmllbGQgPSdjYXNlVmVyc2lvbicgZGF0YS1pZD0nIiArIHJvdy5jYXNlVmVyc2lvbiArICInPiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvc3Bhbj48L2E+IgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbURhdGE6ICdwcm9kdWN0TmFtZScKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImdlbmVyaWNOYW1lIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAncHQnCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJzb2MiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJsaXN0ZWRuZXNzIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAib3V0Y29tZSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInNlcmlvdXNuZXNzIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAiZGV0ZXJtaW5lZENhdXNhbGl0eSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInJlcG9ydGVkQ2F1c2FsaXR5IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgY29sdW1uRGVmczogW3sKICAgICAgICAgICAgICAgICJ0YXJnZXRzIjogJ19hbGwnLAogICAgICAgICAgICAgICAgInJlbmRlciI6ICQuZm4uZGF0YVRhYmxlLnJlbmRlci50ZXh0KCkKICAgICAgICAgICAgfV0KICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgfTsKCgogICAgdmFyIGJpbmRfZHJpbGxfZG93bl90YWJsZSA9IGZ1bmN0aW9uKGNhc2VEZXRhaWxVcmwpIHsKICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNhc2UtZHJpbGwtZG93bi1saW5rJywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgICAgICAvL1ByZWRlbnQgZGVmYXVsdCB3aWxsIG1ha2Ugc3VyZSB0aGF0IGRlZmF1bHQgZXZlbnQgZG9lcyBub3QgaGFwcGVuLgogICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKQoKICAgICAgICAgICAgdmFyIHNyY0VsZSA9ICQoZXZ0LnRhcmdldCkKICAgICAgICAgICAgJCgnI2Nhc2UtZHJpbGwtZG93bi1tb2RhbCcpLmF0dHIoJ2RhdGEtdXJsJywgc3JjRWxlLmF0dHIoJ2RhdGEtdXJsJykpCiAgICAgICAgICAgICQoJyNjYXNlLWRyaWxsLWRvd24tbW9kYWwnKS5tb2RhbCh7fSkKICAgICAgICB9KQoKICAgICAgICAkKCcjY2FzZS1kcmlsbC1kb3duLW1vZGFsJykub24oJ3Nob3duLmJzLm1vZGFsJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICQoJyNkcmlsbC1kb3duLXRhYmxlLWNvbnRhaW5lcicpLnJlbW92ZSgnI2Nhc2UtZHJpbGwtZG93bi10YWJsZScpCiAgICAgICAgICAgIHZhciBkcmlsbF9kb3duX3RhYmxlID0gc2lnbmFsLnV0aWxzLnJlbmRlcignY2FzZV9kcmlsbF9kb3duX3RhYmxlJywge30pCiAgICAgICAgICAgICQoJyNkcmlsbC1kb3duLXRhYmxlLWNvbnRhaW5lcicpLmh0bWwoZHJpbGxfZG93bl90YWJsZSkKICAgICAgICAgICAgdmFyIHVybCA9ICQoJyNjYXNlLWRyaWxsLWRvd24tbW9kYWwnKS5hdHRyKCdkYXRhLXVybCcpCiAgICAgICAgICAgIHZhciBjYXNlX2RyaWxsX2Rvd25fdGFibGUgPSBpbml0X2Nhc2VfZHJpbGxfZG93bl90YWJsZSh1cmwsIGNhc2VEZXRhaWxVcmwpCiAgICAgICAgfSkKICAgIH0KCiAgICByZXR1cm4gewogICAgICAgIGluaXRfY2FzZV9kcmlsbF9kb3duX3RhYmxlOiBpbml0X2Nhc2VfZHJpbGxfZG93bl90YWJsZSwKICAgICAgICBiaW5kX2RyaWxsX2Rvd25fdGFibGUgOiAgYmluZF9kcmlsbF9kb3duX3RhYmxlCiAgICB9Cn0pKCkKCnZhciBzaWduYWwgPSBzaWduYWwgfHwge30KCnNpZ25hbC5hbGVydENvbW1lbnRzID0gKGZ1bmN0aW9uICgpIHsKCiAgICB2YXIgbGlzdENvbW1lbnRzID0gZnVuY3Rpb24gKGNhc2VKc29uKSB7CgogICAgICAgIC8vTW9kYWwgb2JqZWN0CiAgICAgICAgdmFyIGNvbW1lbnRNb2RhbCA9ICQoJyNjb21tZW50TW9kYWwnKTsKCiAgICAgICAgLy9Qb3B1bGF0ZSB0aGUgZXhpc3RpbmcgY29tbWVudHMgYW5kIGJpbmQgZXZlbnRzIHRvIHRoZW0uCiAgICAgICAgcG9wdWxhdGVDb21tZW50cyhjb21tZW50TW9kYWwsIGNhc2VKc29uKTsKCiAgICAgICAgLy9TZXQgdmFsdWVzIHRvIHRoZSBtb2RhbCBlbGVtZW50cy4KICAgICAgICB2YXIgY29tbWVudE1ldGFJbmZvID0gIiIKICAgICAgICBpZiAoY2FzZUpzb24uYWxlcnRUeXBlID09ICJBZ2dyZWdhdGUgQ2FzZSBBbGVydCIpIHsKICAgICAgICAgICAgY29tbWVudE1ldGFJbmZvID0gJzxzcGFuIGlkPSJwcm9kdWN0TmFtZSI+JyArIGNhc2VKc29uLnByb2R1Y3ROYW1lICsgJzwvc3Bhbj4gLSA8c3BhbiBpZD0iZXZlbnROYW1lIj4nICsgY2FzZUpzb24uZXZlbnROYW1lICsgJzwvc3Bhbj4nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29tbWVudE1ldGFJbmZvID0gJzxzcGFuIGlkPSJjYXNlTnVtYmVyIj4nICsgY2FzZUpzb24uY2FzZU51bWJlciArICc8L3NwYW4+IC0gPHNwYW4gaWQ9InByb2R1Y3RGYW1pbHkiPicgKyBjYXNlSnNvbi5wcm9kdWN0RmFtaWx5ICsgJzwvc3Bhbj4nCiAgICAgICAgfQogICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudC1tZXRhLWluZm8iKS5odG1sKGNvbW1lbnRNZXRhSW5mbyk7CiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNhcHBsaWNhdGlvbiIpLmh0bWwoY2FzZUpzb24uYWxlcnRUeXBlKTsKICAgICAgICBjb21tZW50TW9kYWwubW9kYWwoJ3Nob3cnKTsKICAgICAgICBiaW5kU2F2ZUNvbW1lbnQoY29tbWVudE1vZGFsKTsKICAgIH07CgogICAgdmFyIHBvcHVsYXRlQ29tbWVudHMgPSBmdW5jdGlvbiAoY29tbWVudE1vZGFsLCBjYXNlSnNvbiwgb25TaWduYWxTY3JlZW4pIHsKICAgICAgICB2YXIgdXBkYXRlZENvbW1lbnRzID0gJCgiI2NvbW1lbnRib3giKS52YWwoKTsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6ICIvc2lnbmFsL2FsZXJ0Q29tbWVudC9saXN0Q29tbWVudHMiLAogICAgICAgICAgICBkYXRhOiBjYXNlSnNvbiwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjbm8tY29tbWVudHMiKS5hZGRDbGFzcygiaGlkZSIpOwogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCcjY29tbWVudGJveCcpLnJlbW92ZUNsYXNzKCJoaWRlIik7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5odG1sKCJVcGRhdGUiKTsKICAgICAgICAgICAgICAgICAgICBpZih1cGRhdGVkQ29tbWVudHMubGVuZ3RoID49IHJlc3VsdC5jb21tZW50cy5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwuZmluZCgiI2NvbW1lbnRib3giKS52YWwodXBkYXRlZENvbW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50Ym94IikudmFsKHJlc3VsdC5jb21tZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudElkIikudmFsKHJlc3VsdC5pZCk7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5jcmVhdGVkQnkiKS50ZXh0KCJMYXN0IE1vZGlmaWVkIGJ5ICIgKyByZXN1bHQubW9kaWZpZWRCeSArICIgb24gIiArIHJlc3VsdC5kYXRlVXBkYXRlZCk7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5wcm9wKCJkaXNhYmxlZCIsIHRydWUpOwoKICAgICAgICAgICAgICAgIH1lbHNlIGlmKHR5cGVvZiBpc0NvbW1lbnRBZGRlZCAhPSAndW5kZWZpbmVkJyAmJiBpc0NvbW1lbnRBZGRlZCAmJiBvblNpZ25hbFNjcmVlbil7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50SWQiKS52YWwoJycpOwogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCcuYWRkLWNvbW1lbnRzJykuaHRtbCgiQWRkIik7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50Ym94IikudmFsKCcnKTsKICAgICAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwuZmluZCgiI25vLWNvbW1lbnRzIikucmVtb3ZlQ2xhc3MoImhpZGUiKTsKICAgICAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwuZmluZCgnLmFkZC1jb21tZW50cycpLnByb3AoImRpc2FibGVkIiwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5jcmVhdGVkQnkiKS50ZXh0KCcnKTsKCiAgICAgICAgICAgICAgICB9ZWxzZSBpZih0eXBlb2YgaXNDb21tZW50QWRkZWQgIT0gJ3VuZGVmaW5lZCcgJiYgaXNDb21tZW50QWRkZWQpewogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudElkIikudmFsKCcnKTsKICAgICAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwuZmluZCgnLmFkZC1jb21tZW50cycpLmh0bWwoIkFkZCIpOwogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudGJveCIpLnZhbCgnJyk7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNuby1jb21tZW50cyIpLnJlbW92ZUNsYXNzKCJoaWRlIik7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5wcm9wKCJkaXNhYmxlZCIsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCcjY29tbWVudGJveCcpLmFkZENsYXNzKCJoaWRlIik7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5jcmVhdGVkQnkiKS50ZXh0KCcnKTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudElkIikudmFsKCcnKTsKICAgICAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwuZmluZCgiLmNyZWF0ZWRCeSIpLnRleHQoJycpOwogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCcuYWRkLWNvbW1lbnRzJykuaHRtbCgiQWRkIik7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5wcm9wKCJkaXNhYmxlZCIsIHRydWUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCcjY29tbWVudGJveCcpLm9uKCJrZXl1cCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBpZihjb21tZW50TW9kYWwuZmluZCgiI2NvbW1lbnRJZCIpLnZhbCgpPT0iIiAmJiBjb21tZW50TW9kYWwuZmluZCgnI2NvbW1lbnRib3gnKS52YWwoKT09IiIpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCcuYWRkLWNvbW1lbnRzJykucHJvcCgiZGlzYWJsZWQiLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5wcm9wKCJkaXNhYmxlZCIsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gbG9hZCBwcmV2aW91cyBjb21tZW50cy4iKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgYmluZFNhdmVDb21tZW50ID0gZnVuY3Rpb24gKGNvbW1lbnRNb2RhbCkgewoKICAgICAgICAvL0FkZCBjbGljayBldmVudCB0byB0aGUgYWRkIGNvbW1lbnQgYnV0dG9uLgogICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIuYWRkLWNvbW1lbnRzIikudW5iaW5kKCkuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgY2FzZUpzb25PYmpBcnJheSA9IFtdOwogICAgICAgICAgICB2YXIgYXBwVHlwZSA9ICQoIiNhcHBsaWNhdGlvbiIpLmh0bWwoKTsKICAgICAgICAgICAgdmFyIHZhbGlkYXRlZFNpZ25hbElkID0gJCgiI3ZhbGlkYXRlZFNpZ25hbElkIikuaHRtbCgpOwogICAgICAgICAgICB2YXIgdG9waWNJZCA9ICQoIiN0b3BpY0lkIikuaHRtbCgpOwoKICAgICAgICAgICAgaWYgKGFwcFR5cGUgPT0gJycpIHsKICAgICAgICAgICAgICAgIGFwcFR5cGUgPSBjb21tZW50TW9kYWwuZmluZCgiI2FwcGxpY2F0aW9uIikuaHRtbCgpOwogICAgICAgICAgICAgICAgdmFsaWRhdGVkU2lnbmFsSWQgPSBjb21tZW50TW9kYWwuZmluZCgiI3ZhbGlkYXRlZFNpZ25hbElkIikuaHRtbCgpOwogICAgICAgICAgICAgICAgdG9waWNJZCA9IGNvbW1lbnRNb2RhbC5maW5kKCIjdG9waWNJZCIpLmh0bWwoKQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY2FzZUpzb25PYmo7CiAgICAgICAgICAgIHZhciB1cmw7CiAgICAgICAgICAgIHZhciBkYXRhOwogICAgICAgICAgICAvL0Nhc2UgSlNPTi4KICAgICAgICAgICAgY2FzZUpzb25PYmogPSB7CiAgICAgICAgICAgICAgICAiYWxlcnRUeXBlIjogYXBwVHlwZSwKICAgICAgICAgICAgICAgICJwcm9kdWN0TmFtZSI6IGNvbW1lbnRNb2RhbC5maW5kKCIjcHJvZHVjdE5hbWUiKS5odG1sKCksCiAgICAgICAgICAgICAgICAiZXZlbnROYW1lIjogY29tbWVudE1vZGFsLmZpbmQoIiNldmVudE5hbWUiKS5odG1sKCksCiAgICAgICAgICAgICAgICAiY29tbWVudHMiOiBjb21tZW50TW9kYWwuZmluZCgiI2NvbW1lbnRib3giKS52YWwoKSwKICAgICAgICAgICAgICAgICJ2YWxpZGF0ZWRTaWduYWxJZCI6IHZhbGlkYXRlZFNpZ25hbElkLAogICAgICAgICAgICAgICAgImFzc2lnbmVkVG8iOiBjb21tZW50TW9kYWwuZmluZCgiI2Fzc2lnbmVkVG8iKS5odG1sKCksCiAgICAgICAgICAgICAgICAiZXhlY3V0ZWRDb25maWdJZCI6IGNvbW1lbnRNb2RhbC5maW5kKCIjZXhlY3V0ZWRDb25maWdJZCIpLmh0bWwoKSwKICAgICAgICAgICAgICAgICJjb25maWdJZCIgOiBjb21tZW50TW9kYWwuZmluZCgiI2NvbmZpZ0lkIikuaHRtbCgpLAogICAgICAgICAgICAgICAgInRvcGljSWQiOiBjb21tZW50TW9kYWwuZmluZCgiI3RvcGljSWQiKS5odG1sKCksCiAgICAgICAgICAgICAgICAicHJvZHVjdEZhbWlseSI6IGNvbW1lbnRNb2RhbC5maW5kKCIjcHJvZEZhbWlseSIpLmh0bWwoKSwKICAgICAgICAgICAgICAgICJjYXNlTnVtYmVyIjogY29tbWVudE1vZGFsLmZpbmQoIiNjYXNlTm8iKS5odG1sKCksCiAgICAgICAgICAgICAgICAicHJvZHVjdElkIjogcGFyc2VJbnQoY29tbWVudE1vZGFsLmZpbmQoIiNwcm9kdWN0SWQiKS5odG1sKCkpLAogICAgICAgICAgICAgICAgInB0Q29kZSI6IHBhcnNlSW50KGNvbW1lbnRNb2RhbC5maW5kKCIjcHRDb2RlIikuaHRtbCgpKQoKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY2FzZUpzb25PYmpBcnJheS5wdXNoKGNhc2VKc29uT2JqKTsKICAgICAgICAgICAgaWYoY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50SWQiKS52YWwoKSl7CiAgICAgICAgICAgICAgICB1cmwgPSAiL3NpZ25hbC9hbGVydENvbW1lbnQvdXBkYXRlQ29tbWVudCI7CiAgICAgICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgICAgICJhbGVydFR5cGUiOiBhcHBUeXBlLAogICAgICAgICAgICAgICAgICAgICJjb21tZW50IjogY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50Ym94IikudmFsKCksCiAgICAgICAgICAgICAgICAgICAgImlkIjogY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50SWQiKS52YWwoKSwKICAgICAgICAgICAgICAgICAgICAiZXhlY3V0ZWRDb25maWdJZCI6IGNvbW1lbnRNb2RhbC5maW5kKCIjZXhlY3V0ZWRDb25maWdJZCIpLmh0bWwoKSwKICAgICAgICAgICAgICAgICAgICAidmFsaWRhdGVkU2lnbmFsSWQiOiB2YWxpZGF0ZWRTaWduYWxJZAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICB1cmwgPSAiL3NpZ25hbC9hbGVydENvbW1lbnQvc2F2ZUNvbW1lbnQiOwogICAgICAgICAgICAgICAgZGF0YSA9IHsiY2FzZUpzb25PYmpBcnJheSI6IEpTT04uc3RyaW5naWZ5KGNhc2VKc29uT2JqQXJyYXkpfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdC5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjaXNVcGRhdGVkIikudmFsKCJ0cnVlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVsYXRlQ29tbWVudHMoY29tbWVudE1vZGFsLCBjYXNlSnNvbk9iakFycmF5WzBdKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2NvbW1lbnRib3gnKS52YWwoJycpLmJsdXIoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIGJpbmRFZGl0Q29tbWVudCA9IGZ1bmN0aW9uIChjb21tZW50TW9kYWwpIHsKCiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5wcmV2aW91cy1jb21tZW50cyIpLmZpbmQoJy5lZGl0LWNvbW1lbnQnKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuZmluZCgiLnVwZGF0ZS1jb21tZW50IikucmVtb3ZlQ2xhc3MoImhpZGRlbiIpOwogICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmZpbmQoIi5jb21tZW50LWFyZWEiKS5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTsKICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygiaGlkZGVuIikKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIGJpbmREZWxldGVDb21tZW50ID0gZnVuY3Rpb24gKGNvbW1lbnRNb2RhbCwgY2FzZUpzb24pIHsKCiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5wcmV2aW91cy1jb21tZW50cyIpLmZpbmQoJy5kZWxldGUtY29tbWVudCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGlkID0gewogICAgICAgICAgICAgICAgImlkIjogJCh0aGlzKS5wYXJlbnQoKS5maW5kKCIuY29tbWVudElkIikudmFsKCksCiAgICAgICAgICAgICAgICAidmFsaWRhdGVkU2lnbmFsSWQiOiAkKCIjdmFsaWRhdGVkU2lnbmFsSWQiKS50ZXh0KCksCiAgICAgICAgICAgICAgICAiYWRob2NBbGVydElkIiA6IGNhc2VKc29uLmFkaG9jQWxlcnRJZAogICAgICAgICAgICB9OwogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiAiL3NpZ25hbC9hbGVydENvbW1lbnQvZGVsZXRlQ29tbWVudCIsCiAgICAgICAgICAgICAgICBkYXRhOiBpZCwKICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZUNvbW1lbnRzKGNvbW1lbnRNb2RhbCwgY2FzZUpzb24pOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgYmluZFVwZGF0ZUNvbW1lbnQgPSBmdW5jdGlvbiAoY29tbWVudE1vZGFsLCBjYXNlSnNvbikgewoKCiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5wcmV2aW91cy1jb21tZW50cyIpLmZpbmQoJy51cGRhdGUtY29tbWVudCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuZmluZCgiLmdseXBoaWNvbi1wZW5jaWwiKS5yZW1vdmVDbGFzcygiaGlkZGVuIik7CiAgICAgICAgICAgIHZhciBjb21tZW50RGF0YSA9IHsKICAgICAgICAgICAgICAgICJjb21tZW50IjogJCh0aGlzKS5wYXJlbnQoKS5maW5kKCIuY29tbWVudC1hcmVhIikudmFsKCksCiAgICAgICAgICAgICAgICAiaWQiOiAkKHRoaXMpLnBhcmVudCgpLmZpbmQoIi5jb21tZW50SWQiKS52YWwoKSwKICAgICAgICAgICAgICAgICJ2YWxpZGF0ZWRTaWduYWxJZCI6ICQoIiN2YWxpZGF0ZWRTaWduYWxJZCIpLnRleHQoKSwKICAgICAgICAgICAgICAgICJ0b3BpY0lkIjogJCgiI3RvcGljSWQiKS5odG1sKCksCiAgICAgICAgICAgICAgICAiZXhlY3V0ZWRDb25maWdJZCI6IGNhc2VKc29uLmV4ZWN1dGVkQ29uZmlnSWQsCiAgICAgICAgICAgICAgICAiYWRob2NBbGVydElkIiA6IGNhc2VKc29uLmFkaG9jQWxlcnRJZAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDogIi9zaWduYWwvYWxlcnRDb21tZW50L3VwZGF0ZUNvbW1lbnQiLAogICAgICAgICAgICAgICAgZGF0YTogY29tbWVudERhdGEsCiAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CgogICAgICAgICAgICAgICAgICAgIHBvcHVsYXRlQ29tbWVudHMoY29tbWVudE1vZGFsLCBjYXNlSnNvbik7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgICAgbGlzdF9jb21tZW50czogbGlzdENvbW1lbnRzLAogICAgICAgIHBvcHVsYXRlX2NvbW1lbnRzOiBwb3B1bGF0ZUNvbW1lbnRzLAogICAgICAgIHNhdmVfY29tbWVudDogYmluZFNhdmVDb21tZW50CiAgICB9Cn0pKCk7CgoKdmFyIHNob3dUb3BpY1dpZGdldCA9IGZ1bmN0aW9uICgpIHsKICAgICQoIiN0b3BpYyIpLnNlbGVjdDIoewogICAgICAgIHRhZ3M6IHRydWUsCiAgICAgICAgcGxhY2Vob2xkZXI6ICJTZWxlY3QgdG9waWMiLAogICAgICAgIGFsbG93Q2xlYXI6IHRydWUsCiAgICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgICBjcmVhdGVUYWc6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgICAgdmFyIHRlcm0gPSAkLnRyaW0ocGFyYW1zLnRlcm0pOwogICAgICAgICAgICBpZiAodGVybSAhPSAiIikgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpZDogdGVybSwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXJtCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICB9CiAgICB9KTsKfTsKLy89IHJlcXVpcmUgYXBwL3B2cy9jb21tb24vcnhfY29tbW9uLmpzCi8vPSByZXF1aXJlIGFwcC9wdnMvY29tbW9uL3J4X2xpc3RfdXRpbHMuanMKLy89IHJlcXVpcmUgYXBwL3B2cy9jb21tb24vcnhfaGFuZGxlYmFyX2V4dC5qcwovLz0gcmVxdWlyZSBhcHAvcHZzL3RvcGljL2F0dGFjaEFsZXJ0VG9Ub3BpYy5qcwoKdmFyIHNpZ25hbCA9IHNpZ25hbCB8fCB7fTsKCnZhciB0b3BpY0RhdGE7CnZhciBjb2x1bW5TZXE7CnZhciBpc1ZpZXdJbnN0YW5jZSA9IDE7CnZhciBzaWduYWxBbGVydFR5cGUgPSB7CiAgICBTSU5HTEVfQ0FTRV9BTEVSVDogIlNpbmdsZSBDYXNlIEFsZXJ0IiwKICAgIEFHR1JFR0FURV9BTEVSVDogIkFnZ3JlZ2F0ZSBDYXNlIEFsZXJ0IiwKICAgIEVWREFTX0FMRVJUOiAiRXZkYXMgQWxlcnQiLAogICAgQURIT0NfQUxFUlQ6ICJBZC1Ib2MgQWxlcnQiLAogICAgTElURVJBVFVSRV9TRUFSQ0hfQUxFUlQ6ICJMaXRlcmF0dXJlIFNlYXJjaCBBbGVydCIKfQoKc2lnbmFsLmFsZXJ0UmV2aWV3ID0gKGZ1bmN0aW9uICgpIHsKCiAgICB2YXIgaWRzID0gW107CiAgICB2YXIgcm93cyA9IFtdOwoKICAgIHZhciBhcHBseUJ1c2luZXNzUnVsZXMgPSBmdW5jdGlvbiAocm93LCBkYXRhKSB7CiAgICAgICAgLy9BcHBseSB0aGUgZXVkcmEgcnVsZXMuCiAgICAgICAgaWYgKGRhdGEuZm9ybWF0KSB7CiAgICAgICAgICAgIHZhciBmb3JtYXRzID0gSlNPTi5wYXJzZShkYXRhLmZvcm1hdCk7CiAgICAgICAgICAgICQuZWFjaChmb3JtYXRzLCBmdW5jdGlvbiAoaW5keCwgZm9ybWF0KSB7CiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZm9ybWF0OwogICAgICAgICAgICAgICAgdmFyIHRleHRPYmo7CiAgICAgICAgICAgICAgICAkLmVhY2gob2JqLnRleHQudGMsIGZ1bmN0aW9uIChpbmRleCwgZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHRleHRPYmogPSAkKHJvdykuZmluZCgnLicgKyBkYXRhKTsKICAgICAgICAgICAgICAgICAgICB0ZXh0T2JqLmNzcygnY29sb3InLCBvYmoudGV4dC5jb2xvcik7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai50ZXh0LmJvbGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dE9iai5jc3MoJ2ZvbnQtd2VpZ2h0JywgJzkwMCcpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnRleHQuaXRhbGljKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRPYmouY3NzKCdmb250LXN0eWxlJywgJ2l0YWxpYycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnRleHQudW5kZXJsaW5lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRPYmouY3NzKCd0ZXh0LWRlY29yYXRpb24nLCAndW5kZXJsaW5lJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAkLmVhY2gob2JqLmNlbGwudGMsIGZ1bmN0aW9uIChpbmRleCwgZGF0YSkgewogICAgICAgICAgICAgICAgICAgICQocm93KS5maW5kKCcuJyArIGRhdGEpLnBhcmVudHMoJ3RkJykuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJywgb2JqLmNlbGwuY29sb3IpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGVuYWJsZU1lbnVUb29sdGlwcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCIuZ3JpZC1tZW51LXRvb2x0aXAiKS5tb3VzZW92ZXIoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICB2YXIgdG9vbHRpcFRleHQgPSAkdGhpcy5hdHRyKCJkYXRhLXRpdGxlIik7CiAgICAgICAgICAgICR0aGlzLnRvb2x0aXAoewogICAgICAgICAgICAgICAgdGl0bGU6IHRvb2x0aXBUZXh0LAogICAgICAgICAgICAgICAgcGxhY2VtZW50OiAiYm90dG9tIgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJHRoaXMudG9vbHRpcCgnc2hvdycpOwogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgZGlzYWJsZVRvb2x0aXBzID0gZnVuY3Rpb24gKCkgewogICAgICAgICQoIi5tZGktYWxwaGEtZC1ib3gsIC5tZGktZmlsdGVyLW91dGxpbmUsIC5tZGktdHJlbmRpbmctdXAsIC5tZGktY29udGVudC1zYXZlLCAubWRpLWV4cG9ydCwgLm1kaS1zZXR0aW5ncywgbWRpLXBsdXMtYm94LCBtZGktY2hhcnQtYmFyIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAkKCIudG9vbHRpcCIpLmhpZGUoKTsKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIHNvcnRJY29uSGFuZGxlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdGhBcnJheSA9ICQoJyNhbGVydHNEZXRhaWxzVGFibGUnKS5EYXRhVGFibGUoKS5jb2x1bW5zKCkuaGVhZGVyKCk7CiAgICAgICAgaWYgKGlzVmlld0luc3RhbmNlKSB7CiAgICAgICAgICAgIHZhciBjb2x1bW5OYW1lOwogICAgICAgICAgICB2YXIgaW5kZXhPZkNvbHVtbiA9IDA7CiAgICAgICAgICAgIGNvbHVtblNlcS5ldmVyeShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgc2VxID0gY29sdW1uU2VxW2luZGV4T2ZDb2x1bW5dLnNlcTsKICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSBzZXEpIHsKICAgICAgICAgICAgICAgICAgICBjb2x1bW5OYW1lID0gY29sdW1uU2VxW2luZGV4T2ZDb2x1bW5dLm5hbWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW5kZXhPZkNvbHVtbisrOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgY29sdW1uSW5kZXggPSAkKCcjYWxlcnRzRGV0YWlsc1RhYmxlJykuZmluZCgidGhbZGF0YS1maWVsZD0iICsgY29sdW1uTmFtZSArICJdIikuYXR0cignZGF0YS1jb2x1bW4taW5kZXgnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb2x1bW5JbmRleCA9IGluZGV4OwogICAgICAgIH0KICAgICAgICAkLmVhY2godGhBcnJheSwgZnVuY3Rpb24gKGN1cnJlbnRJbmRleCwgZWxlbWVudCkgewogICAgICAgICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3NvcnRpbmdfYXNjJykpIHsKICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc29ydGluZ19hc2MnKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgic29ydGluZyIpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzb3J0aW5nX2Rlc2MnKSkgewogICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzb3J0aW5nX2Rlc2MnKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgic29ydGluZyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggPT0gY29sdW1uSW5kZXggJiYgIWVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzb3J0aW5nX2Rpc2FibGVkJykpIHsKICAgICAgICAgICAgICAgIGlmIChkaXIgPT0gJ2FzYycpIHsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NvcnRpbmcnKTsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoInNvcnRpbmdfYXNjIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRpciA9PSAnZGVzYycpIHsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NvcnRpbmcnKTsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoInNvcnRpbmdfZGVzYyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIC8qKgogICAgICogVGhlIHJlc2V0IG1vZGFsIHNjcmVlbiBmdW5jdGlvbiB3aGljaCByZXNldHMgdGhlIHBhc3N3b3JkIGRpdiBpbiB0aGUgd29ya2Zsb3cgbW9kYWwgc2NyZWVuLgogICAgICogVGhpcyBpcyBpbnRlcm5hbCBmdW5jdGlvbiB0byBiZSBjYWxsZWQgaW50ZXJuYWxseSBpbiB0aGlzIG9iamVjdCBzY29wZS4KICAgICAqLwogICAgdmFyIHJlc2V0TW9kYWxTY3JlZW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy9DbGVhbiB1cCB0aGUgdGhlIGRpc3Bvc2l0aW9ucyBmaWVsZHMuCiAgICAgICAgJCgnI2VkaXQtc3RhdGUtbW9kYWwnKS5maW5kKCcjZXh0cmEtdmFsdWUtc2VsZWN0JykuaHRtbCgiPG9wdGlvbj48L29wdGlvbj4iKTsKICAgICAgICAvL0hpZGUgdGhlIHBhc3N3b3JkCiAgICAgICAgJCgnI2VkaXQtc3RhdGUtbW9kYWwnKS5maW5kKCcjcGFzc3dvcmREaXYnKS5hZGRDbGFzcygnaGlkZScpOwogICAgICAgICQoJyNlZGl0LXN0YXRlLW1vZGFsJykuZmluZCgnI2lzUGFzc3dvcmRFbmFibGVkJykudmFsKDApOwogICAgfQoKICAgIHZhciBzaG93UGFzc3dvcmRGaWVsZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjZWRpdC1zdGF0ZS1tb2RhbCcpLmZpbmQoJyNwYXNzd29yZERpdicpLnJlbW92ZUNsYXNzKCdoaWRlJyk7CiAgICAgICAgJCgnI2VkaXQtc3RhdGUtbW9kYWwnKS5maW5kKCcjaXNQYXNzd29yZEVuYWJsZWQnKS52YWwoMSk7CiAgICB9CgogICAgdmFyIGNoYW5nZVdvcmtmbG93RWRpdFNjcmVlbiA9IGZ1bmN0aW9uIChhdmFpbGFibGVWYWx1ZXMsIHRhcmdldFZhbCkgewoKICAgICAgICB2YXIgYXZhaWxhYmxlVmFsT2JqID0gXy5maW5kV2hlcmUoYXZhaWxhYmxlVmFsdWVzLCB7dmFsdWU6IHRhcmdldFZhbH0pOwoKICAgICAgICBpZiAodHlwZW9mIGF2YWlsYWJsZVZhbE9iaiAhPSAndW5kZWZpbmVkJyAmJiBhdmFpbGFibGVWYWxPYmopIHsKICAgICAgICAgICAgaWYgKGF2YWlsYWJsZVZhbE9iai5hcHByb3ZhbFJlcXVpcmVkKSB7CiAgICAgICAgICAgICAgICBzaG93UGFzc3dvcmRGaWVsZCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVzZXRNb2RhbFNjcmVlbigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL0NsZWFuIHVwIHRoZSB0aGUgZGlzcG9zaXRpb25zIGZpZWxkcwogICAgICAgICAgICAkKCcjZWRpdC1zdGF0ZS1tb2RhbCcpLmZpbmQoJyNleHRyYS12YWx1ZS1zZWxlY3QnKS5odG1sKCcnKQoKICAgICAgICAgICAgLy9GaWxsIHVwIHRoZSBkaXNwb3NpdGlvbnMgaW4gdGhlIGNvbWJvCiAgICAgICAgICAgICQoJyNlZGl0LXN0YXRlLW1vZGFsJykuZmluZCgnI2V4dHJhLXZhbHVlLXNlbGVjdCcpLmh0bWwoZ2V0RGlzcG9zaXRpb25PcHRpb25zKGF2YWlsYWJsZVZhbE9iaikpCiAgICAgICAgfQogICAgfQoKICAgIHZhciBnZXREaXNwb3NpdGlvbk9wdGlvbnMgPSBmdW5jdGlvbiAoYXZhaWxhYmxlVmFsT2JqKSB7CiAgICAgICAgdmFyIGRpc3Bvc2l0aW9uU3RyID0gIjxvcHRpb24+PC9vcHRpb24+IjsKICAgICAgICBfLmVhY2goYXZhaWxhYmxlVmFsT2JqLmRpc3Bvc2l0aW9ucywgZnVuY3Rpb24gKGRpc3Bvc2l0aW9uKSB7CiAgICAgICAgICAgIGRpc3Bvc2l0aW9uU3RyID0gZGlzcG9zaXRpb25TdHIgKwogICAgICAgICAgICAgICAgIjxvcHRpb24gdmFsdWU9XCIiICsgZGlzcG9zaXRpb24udmFsdWUgKyAiXCI+IiArIGVuY29kZVRvSFRNTChkaXNwb3NpdGlvbi5kaXNwbGF5TmFtZSkgKyAiPC9vcHRpb24+IgogICAgICAgIH0pCiAgICAgICAgcmV0dXJuIGRpc3Bvc2l0aW9uU3RyCiAgICB9CgogICAgdmFyIGF1dGhlbnRpY2F0ZVVzZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHJldHVyblZhbCA9IGZhbHNlCiAgICAgICAgdmFyIHBhc3N3b3JkSnNvbiA9IHsKICAgICAgICAgICAgInBhc3N3b3JkIjogJCgnI2VkaXQtc3RhdGUtbW9kYWwnKS5maW5kKCcjcGFzc3dvcmRBdXRoZW50aWNhdGlvbicpLnZhbCgpCiAgICAgICAgfQoKICAgICAgICB2YXIgYXV0aFVybCA9ICcvc2lnbmFsL3VzZXIvYXV0aGVudGljYXRlJwoKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6IGF1dGhVcmwsCiAgICAgICAgICAgIGRhdGE6IHBhc3N3b3JkSnNvbiwKICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmF1dGhvcml6ZWQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWwgPSB0cnVlCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVyblZhbCA9IGZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm5WYWwgPSBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHJldHVyblZhbAogICAgfQoKICAgIHZhciB0b2dnbGVFcnJvck5vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24pIHsKICAgICAgICBpZiAoYWN0aW9uID09ICdoaWRlJykgewogICAgICAgICAgICAkKCcjZWRpdC1zdGF0ZS1tb2RhbCAuZXJyb3JOb3RpZmljYXRpb24nKS5hZGRDbGFzcygnaGlkZScpOwogICAgICAgICAgICAkKCcjZWRpdC1zdGF0ZS1tb2RhbCcpLmZpbmQoJy5lcnJvck1lc3NhZ2UnKS5odG1sKCcnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkKCcjZWRpdC1zdGF0ZS1tb2RhbCAuZXJyb3JOb3RpZmljYXRpb24nKS5yZW1vdmVDbGFzcygnaGlkZScpCiAgICAgICAgICAgICQoJyNlZGl0LXN0YXRlLW1vZGFsJykuZmluZCgnLmVycm9yTWVzc2FnZScpLmh0bWwoJyBBdXRoZW50aWNhdGlvbiBGYWlsZWQhJyk7CiAgICAgICAgfQogICAgfTsKCiAgICB2YXIgb3BlbkNhc2VIaXN0b3J5TW9kYWwgPSBmdW5jdGlvbiAoKSB7CgogICAgICAgIC8vQmluZCB0aGUgY2xpY2sgZXZlbnQgb24gdGhlIGNhc2UgaGlzdG9yeSBpY29uLgogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2FzZS1oaXN0b3J5LWljb24nLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdmFyIHBhcmVudF9yb3cgPSAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgndHInKTsKICAgICAgICAgICAgdmFyIHNlbGVjdGVkUm93SW5kZXggPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaW5kZXgoKTsKICAgICAgICAgICAgaWYgKGlzQWJzdHJhY3RWaWV3T3JDYXNlVmlldyhzZWxlY3RlZFJvd0luZGV4KSkgewogICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3dJbmRleCA9IHNlbGVjdGVkUm93SW5kZXggLyAyCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGlzU2lnbmFsID0gJCh0aGlzKS5kYXRhKCdzaWduYWwnKTsKCiAgICAgICAgICAgIHZhciByb3dPYmplY3QgPSB7fTsKICAgICAgICAgICAgaWYgKCFpc1NpZ25hbCkgewogICAgICAgICAgICAgICAgcm93T2JqZWN0ID0gdGFibGUucm93cyhzZWxlY3RlZFJvd0luZGV4KS5kYXRhKClbMF07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByb3dPYmplY3QgPSB0YWJsZVNpbmdsZVJldmlldy5yb3coJCh0aGlzKS5wYXJlbnRzKCd0cicpKS5kYXRhKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGNhc2VOdW1iZXIgPSByb3dPYmplY3QuY2FzZU51bWJlcjsKICAgICAgICAgICAgdmFyIHByb2R1Y3RGYW1pbHkgPSByb3dPYmplY3QucHJvZHVjdEZhbWlseTsKICAgICAgICAgICAgdmFyIGNhc2VWZXJzaW9uID0gcm93T2JqZWN0LmNhc2VWZXJzaW9uOwogICAgICAgICAgICB2YXIgcHJvZHVjdE5hbWUgPSByb3dPYmplY3QucHJvZHVjdE5hbWU7CiAgICAgICAgICAgIHZhciBwdCA9IHJvd09iamVjdC5wcmltYXJ5RXZlbnQ7CiAgICAgICAgICAgIHZhciBhbGVydENvbmZpZ0lkID0gcm93T2JqZWN0LmFsZXJ0Q29uZmlnSWQ7CgogICAgICAgICAgICB2YXIgY2FzZUhpc3RvcnlNb2RhbCA9ICQoJyNjYXNlSGlzdG9yeU1vZGFsJyk7CiAgICAgICAgICAgIGNhc2VIaXN0b3J5TW9kYWwuZmluZCgiI2Nhc2VOdW1iZXIiKS5odG1sKGNhc2VOdW1iZXIpOwogICAgICAgICAgICBjYXNlSGlzdG9yeU1vZGFsLmZpbmQoIiNwcm9kdWN0RmFtaWx5IikuaHRtbChwcm9kdWN0RmFtaWx5KTsKICAgICAgICAgICAgY2FzZUhpc3RvcnlNb2RhbC5maW5kKCIjY2FzZVZlcnNpb24iKS52YWwoY2FzZVZlcnNpb24pOwogICAgICAgICAgICBjYXNlSGlzdG9yeU1vZGFsLmZpbmQoIiNwcm9kdWN0TmFtZSIpLnZhbChwcm9kdWN0TmFtZSk7CiAgICAgICAgICAgIGNhc2VIaXN0b3J5TW9kYWwuZmluZCgiI2FsZXJ0Q29uZmlnSWQiKS52YWwoYWxlcnRDb25maWdJZCk7CiAgICAgICAgICAgIGNhc2VIaXN0b3J5TW9kYWwuZmluZCgiI3B0IikudmFsKHB0KTsKICAgICAgICAgICAgY2FzZUhpc3RvcnlNb2RhbC5tb2RhbCgnc2hvdycpOwoKICAgICAgICAgICAgaWYodHlwZW9mIHNpbmdsZUNhc2VVcGRhdGVKdXN0aWZpY2F0aW9uVXJsICE9ICd1bmRlZmluZWQnKQogICAgICAgICAgICAgICAgdXBkYXRlSnVzdGlmaWNhdGlvblVybCA9IHNpbmdsZUNhc2VVcGRhdGVKdXN0aWZpY2F0aW9uVXJsOwoKICAgICAgICAgICAgc2lnbmFsLmNhc2VIaXN0b3J5VGFibGUuaW5pdF9jYXNlX2hpc3RvcnlfdGFibGUoY2FzZUhpc3RvcnlVcmwpOwogICAgICAgICAgICBzaWduYWwuY2FzZUhpc3RvcnlUYWJsZS5pbml0X2Nhc2VfaGlzdG9yeV90YWJsZV9zdXNwZWN0KGNhc2VIaXN0b3J5U3VzcGVjdFVybCk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBvcGVuQWxlcnRDb21tZW50TW9kYWwgPSBmdW5jdGlvbiAoYWxlcnRUeXBlLCBhcHBsaWNhdGlvbk5hbWUpIHsKCiAgICAgICAgLy9Nb2RhbCBvYmplY3QKICAgICAgICB2YXIgY29tbWVudE1vZGFsID0gJCgnI2NvbW1lbnRNb2RhbCcpOwogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY29tbWVudC1pY29uJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIHZhciAkdGhpcyA9IHRoaXM7CiAgICAgICAgICAgIHZhciBkYXRhSW5mbzsKICAgICAgICAgICAgdmFyIGlzQ2FzZURldGFpbDsKICAgICAgICAgICAgdmFyIGFwcFR5cGU7CiAgICAgICAgICAgIHZhciB2YWxpZGF0ZWRTaWduYWxJZDsKICAgICAgICAgICAgdmFyIGNvbW1lbnRBbGVydFR5cGUgPSAkKCR0aGlzKS5kYXRhKCduYW1lJyk7CiAgICAgICAgICAgIHZhciBpc1NpZ25hbCA9ICQoJHRoaXMpLmRhdGEoJ3NpZ25hbCcpOwoKICAgICAgICAgICAgaWYgKGNvbW1lbnRBbGVydFR5cGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgYWxlcnRUeXBlID0gY29tbWVudEFsZXJ0VHlwZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB2YXIgY2FzZUpzb25BcnJheSA9IFtdOwogICAgICAgICAgICBkYXRhSW5mbyA9ICQoZXZlbnQudGFyZ2V0KS5hdHRyKCdkYXRhLWluZm8nKTsKICAgICAgICAgICAgaXNDYXNlRGV0YWlsID0gJChldmVudC50YXJnZXQpLmF0dHIoJ2RhdGEtY29tbWVudCcpOwoKICAgICAgICAgICAgYXBwVHlwZSA9ICQoIiNhcHBsaWNhdGlvbiIpLmh0bWwoKTsKICAgICAgICAgICAgaWYgKGFwcFR5cGUgPT09ICcnKSB7CiAgICAgICAgICAgICAgICBhcHBUeXBlID0gY29tbWVudE1vZGFsLmZpbmQoIiNhcHBsaWNhdGlvbiIpLmh0bWwoKTsKICAgICAgICAgICAgICAgIHZhbGlkYXRlZFNpZ25hbElkID0gY29tbWVudE1vZGFsLmZpbmQoIiN2YWxpZGF0ZWRTaWduYWxJZCIpLmh0bWwoKQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgc2VsZWN0ZWRSb3dDb3VudDsKICAgICAgICAgICAgaWYgKCQoJyNkZXRhaWxlZC12aWV3LWNoZWNrYm94JykuaXMoJzpjaGVja2VkJykpIHsKICAgICAgICAgICAgICAgIHNlbGVjdGVkUm93Q291bnQgPSAkKCd0YWJsZSNhbGVydHNEZXRhaWxzVGFibGUgLmNvcHktc2VsZWN0OmNoZWNrZWQnKS5sZW5ndGg7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZWxlY3RlZFJvd0NvdW50ID0gJCgndGFibGUuRFRGQ19DbG9uZWQgLmNvcHktc2VsZWN0OmNoZWNrZWQnKS5sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNlbGVjdGVkUm93Q291bnQgPiAxICYmICQoJHRoaXMpLmNsb3Nlc3QoJ3RyJykuZmluZCgiLmNvcHktc2VsZWN0IikucHJvcCgiY2hlY2tlZCIpKSB7CiAgICAgICAgICAgICAgICB2YXIgdGV4dFRvRGlzcGxheTsKICAgICAgICAgICAgICAgIHN3aXRjaCAoYXBwbGljYXRpb25OYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnU2luZ2xlIENhc2UgQWxlcnQnOgogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0VG9EaXNwbGF5ID0gJ0Nhc2UnOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdBZ2dyZWdhdGUgQ2FzZSBBbGVydCc6CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRUb0Rpc3BsYXkgPSAnUEVDJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnRVZEQVMgQWxlcnQnOgogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0VG9EaXNwbGF5ID0gJ1BFQyc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ0xpdGVyYXR1cmUgU2VhcmNoIEFsZXJ0JzoKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFRvRGlzcGxheSA9ICdBcnRpY2xlJzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkKGNvbW1lbnRNb2RhbCkuZmluZCgnZGl2LmJ1bGtPcHRpb25zU2VjdGlvbicpLnNob3coKTsKICAgICAgICAgICAgICAgICQoY29tbWVudE1vZGFsKS5maW5kKCdkaXYuYnVsa09wdGlvbnNTZWN0aW9uIHNwYW4uYWxlcnRUeXBlVGV4dCcpLmh0bWwodGV4dFRvRGlzcGxheSk7CiAgICAgICAgICAgICAgICAkKGNvbW1lbnRNb2RhbCkuZmluZCgnZGl2LmJ1bGtPcHRpb25zU2VjdGlvbiBzcGFuLmNvdW50JykuaHRtbChzZWxlY3RlZFJvd0NvdW50KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICQoY29tbWVudE1vZGFsKS5maW5kKCdkaXYuYnVsa09wdGlvbnNTZWN0aW9uJykuaGlkZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkKCdkaXYuYnVsa09wdGlvbnNTZWN0aW9uIGlucHV0W25hbWU9YnVsa09wdGlvbnNdJykudW5iaW5kKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoJCh0aGlzKS52YWwoKSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FsbFNlbGVjdGVkJzoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZUpzb25BcnJheSA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICBpbml0aWF0ZVNpbmdsZUJ1bGtSb3dDb21tZW50UHJvY2VzcyhjYXNlSnNvbkFycmF5LCBjb21tZW50TW9kYWwsIGFsZXJ0VHlwZSwgaXNDYXNlRGV0YWlsLCBpc1NpZ25hbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJpbmRBZGRDb21tZW50cyhjb21tZW50TW9kYWwsIGNhc2VKc29uQXJyYXksICJidWxrIiwgYWxlcnRUeXBlLCB2YWxpZGF0ZWRTaWduYWxJZCwgaXNDYXNlRGV0YWlsKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3VycmVudCc6CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2VKc29uQXJyYXkgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhdGVTaW5nbGVSb3dDb21tZW50UHJvY2VzcygkdGhpcywgY2FzZUpzb25BcnJheSwgY29tbWVudE1vZGFsLCBhbGVydFR5cGUsIGlzQ2FzZURldGFpbCwgaXNTaWduYWwpOwogICAgICAgICAgICAgICAgICAgICAgICBiaW5kQWRkQ29tbWVudHMoY29tbWVudE1vZGFsLCBjYXNlSnNvbkFycmF5LCAicm93IiwgYWxlcnRUeXBlLCB2YWxpZGF0ZWRTaWduYWxJZCwgaXNDYXNlRGV0YWlsKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKGRhdGFJbmZvID09PSAicm93IikgewogICAgICAgICAgICAgICAgaW5pdGlhdGVTaW5nbGVSb3dDb21tZW50UHJvY2VzcygkdGhpcywgY2FzZUpzb25BcnJheSwgY29tbWVudE1vZGFsLCBhbGVydFR5cGUsIGlzQ2FzZURldGFpbCwgaXNTaWduYWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb21tZW50TW9kYWwubW9kYWwoJ3Nob3cnKTsKICAgICAgICAgICAgYmluZEFkZENvbW1lbnRzKGNvbW1lbnRNb2RhbCwgY2FzZUpzb25BcnJheSwgZGF0YUluZm8sIGFsZXJ0VHlwZSwgdmFsaWRhdGVkU2lnbmFsSWQsIGlzQ2FzZURldGFpbCwgJHRoaXMpCiAgICAgICAgfSkKICAgIH07CgogICAgdmFyIGJpbmRBZGRDb21tZW50cyA9IGZ1bmN0aW9uIChjb21tZW50TW9kYWwsIGNhc2VKc29uQXJyYXksIGRhdGFJbmZvLCBhbGVydFR5cGUsIHZhbGlkYXRlZFNpZ25hbElkLCBpc0Nhc2VEZXRhaWwsIGN1cnJlbnRSb3cpIHsKICAgICAgICBjb21tZW50TW9kYWwuZmluZCgiLmFkZC1jb21tZW50cyIpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGNhc2VKc29uOwogICAgICAgICAgICB2YXIgY2FzZUpzb25PYmo7CiAgICAgICAgICAgIHZhciBkYXRhOwogICAgICAgICAgICB2YXIgdXJsOwogICAgICAgICAgICB2YXIgJHRoaXMgPSB0aGlzOwogICAgICAgICAgICB2YXIgY2FzZUpzb25PYmpBcnJheSA9IFtdOwogICAgICAgICAgICBpZiAoZGF0YUluZm8gPT09ICJyb3ciKSB7CiAgICAgICAgICAgICAgICBjYXNlSnNvbiA9IGNhc2VKc29uQXJyYXlbMF07CgogICAgICAgICAgICAgICAgaWYgKGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudElkIikudmFsKCkpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgICAgICAgICAiYWxlcnRUeXBlIjogYWxlcnRUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAiY29tbWVudCI6IGNvbW1lbnRNb2RhbC5maW5kKCIjY29tbWVudGJveCIpLnZhbCgpLAogICAgICAgICAgICAgICAgICAgICAgICAiaWQiOiBjb21tZW50TW9kYWwuZmluZCgiI2NvbW1lbnRJZCIpLnZhbCgpLAogICAgICAgICAgICAgICAgICAgICAgICAidmFsaWRhdGVkU2lnbmFsSWQiOiB2YWxpZGF0ZWRTaWduYWxJZCwKICAgICAgICAgICAgICAgICAgICAgICAgInRvcGljSWQiOiAkKCIjdG9waWNJZCIpLmh0bWwoKSwKICAgICAgICAgICAgICAgICAgICAgICAgImV4ZWN1dGVkQ29uZmlnSWQiOiBjYXNlSnNvbi5leGVjdXRlZENvbmZpZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICAiYWRob2NBbGVydElkIjogY2FzZUpzb24uYWRob2NBbGVydElkLAogICAgICAgICAgICAgICAgICAgICAgICAiY29uZmlnSWQiOiBjYXNlSnNvbi5jb25maWdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgImxpdGVyYXR1cmVBbGVydElkIjogY2FzZUpzb24ubGl0ZXJhdHVyZUFsZXJ0SWQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGlmKGRhdGEuY29tbWVudD09IiIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gIi9zaWduYWwvYWxlcnRDb21tZW50L2RlbGV0ZUNvbW1lbnQiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gIi9zaWduYWwvYWxlcnRDb21tZW50L3VwZGF0ZUNvbW1lbnQiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdXJsID0gIi9zaWduYWwvYWxlcnRDb21tZW50L3NhdmVDb21tZW50IjsKCiAgICAgICAgICAgICAgICAgICAgY2FzZUpzb25PYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhbGVydFR5cGUiOiBhbGVydFR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICJwcm9kdWN0TmFtZSI6IGNhc2VKc29uLnByb2R1Y3ROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAiZXZlbnROYW1lIjogY2FzZUpzb24uZXZlbnROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAicHQiOiBjYXNlSnNvbi5wdCwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbW1lbnRzIjogY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50Ym94IikudmFsKCksCiAgICAgICAgICAgICAgICAgICAgICAgICJjYXNlTnVtYmVyIjogY2FzZUpzb24uY2FzZU51bWJlciwKICAgICAgICAgICAgICAgICAgICAgICAgInByb2R1Y3RGYW1pbHkiOiBjYXNlSnNvbi5wcm9kdWN0RmFtaWx5LAogICAgICAgICAgICAgICAgICAgICAgICAidmFsaWRhdGVkU2lnbmFsSWQiOiB2YWxpZGF0ZWRTaWduYWxJZCwKICAgICAgICAgICAgICAgICAgICAgICAgInRvcGljSWQiOiBjb21tZW50TW9kYWwuZmluZCgiI3RvcGljSWQiKS5odG1sKCksCiAgICAgICAgICAgICAgICAgICAgICAgICJhc3NpZ25lZFRvIjogY2FzZUpzb24uYXNzaWduZWRUbywKICAgICAgICAgICAgICAgICAgICAgICAgImFkaG9jQWxlcnRJZCI6IGNhc2VKc29uLmFkaG9jQWxlcnRJZCwKICAgICAgICAgICAgICAgICAgICAgICAgImV4ZWN1dGVkQ29uZmlnSWQiOiBjYXNlSnNvbi5leGVjdXRlZENvbmZpZ0lkLAogICAgICAgICAgICAgICAgICAgICAgICAicHJvZHVjdElkIjogY2FzZUpzb24ucHJvZHVjdElkLAogICAgICAgICAgICAgICAgICAgICAgICAicHRDb2RlIjogY2FzZUpzb24ucHRDb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAiY29uZmlnSWQiOiBjYXNlSnNvbi5jb25maWdJZCwKICAgICAgICAgICAgICAgICAgICAgICAgImxpdGVyYXR1cmVBbGVydElkIjogY2FzZUpzb24ubGl0ZXJhdHVyZUFsZXJ0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICJhcnRpY2xlSWQiOiBjYXNlSnNvbi5hcnRpY2xlSWQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGNhc2VKc29uT2JqQXJyYXkucHVzaChjYXNlSnNvbk9iaik7CiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZUpzb25PYmpBcnJheTogSlNPTi5zdHJpbmdpZnkoY2FzZUpzb25PYmpBcnJheSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB1cmwgPSAiL3NpZ25hbC9hbGVydENvbW1lbnQvc2F2ZUNvbW1lbnQiOwogICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkUm93Q291bnQ7CiAgICAgICAgICAgICAgICBpZiAoJCgnI2RldGFpbGVkLXZpZXctY2hlY2tib3gnKS5pcygnOmNoZWNrZWQnKSkgewogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkUm93Q291bnQgPSAkKCd0YWJsZSNhbGVydHNEZXRhaWxzVGFibGUgLmNvcHktc2VsZWN0OmNoZWNrZWQnKS5sZW5ndGg7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkUm93Q291bnQgPSAkKCd0YWJsZS5EVEZDX0Nsb25lZCAuY29weS1zZWxlY3Q6Y2hlY2tlZCcpLmxlbmd0aDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBzZWxlY3RlZFJvd0NvdW50OyBpbmRleCsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVkU2lnbmFsSWQgPSAkKCIjdmFsaWRhdGVkU2lnbmFsSWQiKS5odG1sKCk7CiAgICAgICAgICAgICAgICAgICAgY2FzZUpzb24gPSBjYXNlSnNvbkFycmF5W2luZGV4XTsKCiAgICAgICAgICAgICAgICAgICAgLy9DYXNlIEpTT04uCiAgICAgICAgICAgICAgICAgICAgY2FzZUpzb25PYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhbGVydFR5cGUiOiBhbGVydFR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICJwcm9kdWN0TmFtZSI6IGNhc2VKc29uLnByb2R1Y3ROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAiZXZlbnROYW1lIjogY2FzZUpzb24uZXZlbnROYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAicHQiOiBjYXNlSnNvbi5wdCwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbW1lbnRzIjogY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50Ym94IikudmFsKCksCiAgICAgICAgICAgICAgICAgICAgICAgICJjYXNlTnVtYmVyIjogY2FzZUpzb24uY2FzZU51bWJlciwKICAgICAgICAgICAgICAgICAgICAgICAgInByb2R1Y3RGYW1pbHkiOiBjYXNlSnNvbi5wcm9kdWN0RmFtaWx5LAogICAgICAgICAgICAgICAgICAgICAgICAidmFsaWRhdGVkU2lnbmFsSWQiOiB2YWxpZGF0ZWRTaWduYWxJZCwKICAgICAgICAgICAgICAgICAgICAgICAgInRvcGljSWQiOiBjb21tZW50TW9kYWwuZmluZCgiI3RvcGljSWQiKS5odG1sKCksCiAgICAgICAgICAgICAgICAgICAgICAgICJhc3NpZ25lZFRvIjogY2FzZUpzb24uYXNzaWduZWRUbywKICAgICAgICAgICAgICAgICAgICAgICAgImFkaG9jQWxlcnRJZCI6IGNhc2VKc29uLmFkaG9jQWxlcnRJZCwKICAgICAgICAgICAgICAgICAgICAgICAgInByb2R1Y3RJZCI6IGNhc2VKc29uLnByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICAgICAgICAgInB0Q29kZSI6IGNhc2VKc29uLnB0Q29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbmZpZ0lkIjogY2FzZUpzb24uY29uZmlnSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICJsaXRlcmF0dXJlQWxlcnRJZCI6IGNhc2VKc29uLmxpdGVyYXR1cmVBbGVydElkLAogICAgICAgICAgICAgICAgICAgICAgICAiYXJ0aWNsZUlkIjogY2FzZUpzb24uYXJ0aWNsZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhlY3V0ZWRDb25maWdJZCI6IGNhc2VKc29uLmV4ZWN1dGVkQ29uZmlnSWQKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGNhc2VKc29uT2JqQXJyYXkucHVzaChjYXNlSnNvbk9iaikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZUpzb25PYmpBcnJheTogSlNPTi5zdHJpbmdpZnkoY2FzZUpzb25PYmpBcnJheSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9TYXZlIGNvbW1lbnQgY2FsbAogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCJpLmlzUHJvY2Vzc2luZyIpLnNob3coKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoImkuaXNQcm9jZXNzaW5nIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgIC8vUG9wdWxhdGUgdGhlIGNvbW1lbnRzIGFnYWluIGlmIHNpbmdsZSBjb21tZW50IGlzIGFkZGVkLgogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXNDYXNlRGV0YWlsICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFJbmZvID09PSAicm93IikgewogICAgICAgICAgICAgICAgICAgICAgICBzaWduYWwuYWxlcnRDb21tZW50cy5wb3B1bGF0ZV9jb21tZW50cyhjb21tZW50TW9kYWwsIGNhc2VKc29uKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2NvbW1lbnRib3gnKS52YWwoJycpLmJsdXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29tbWVudCAhPSAiIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0NvbW1lbnRJY29uKGN1cnJlbnRSb3cpIDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNvbW1lbnRJY29uKGN1cnJlbnRSb3cpIDsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdtb2RhbC1vcGVuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5tb2RhbC1iYWNrZHJvcCcpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tib3hTZWxlY3RvcjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoJyNkZXRhaWxlZC12aWV3LWNoZWNrYm94JykuaXMoJzpjaGVja2VkJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrYm94U2VsZWN0b3IgPSAndGFibGUjYWxlcnRzRGV0YWlsc1RhYmxlIC5jb3B5LXNlbGVjdDpjaGVja2VkJzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrYm94U2VsZWN0b3IgPSAndGFibGUuRFRGQ19DbG9uZWQgLmNvcHktc2VsZWN0OmNoZWNrZWQnOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaCgkKGNoZWNrYm94U2VsZWN0b3IpLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93Q29tbWVudEljb24odGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkLk5vdGlmaWNhdGlvbi5ub3RpZnkoJ3N1Y2Nlc3MnLCAndG9wIHJpZ2h0JywgIlN1Y2Nlc3MiLCAiQ29tbWVudHMgYWRkZWQgc3VjY2Vzc2Z1bGx5LiIsIHthdXRvSGlkZURlbGF5OiAxMDAwMH0pOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICB9OwoKICAgIHZhciBpbml0aWF0ZVNpbmdsZVJvd0NvbW1lbnRQcm9jZXNzID0gZnVuY3Rpb24gKCR0aGlzLCBjYXNlSnNvbkFycmF5LCBjb21tZW50TW9kYWwsIGFsZXJ0VHlwZSwgaXNDYXNlRGV0YWlsLCBpc1NpZ25hbCkgewogICAgICAgIHZhciBhZGhvY0FsZXJ0SWQ7CiAgICAgICAgdmFyIGxpdGVyYXR1cmVBbGVydElkOwogICAgICAgIHZhciBhcnRpY2xlSWQ7CgogICAgICAgIHZhciByb3dPYmplY3QgPSB7fTsKICAgICAgICBpZiAoKGFsZXJ0VHlwZSA9PT0gJ0FnZ3JlZ2F0ZSBDYXNlIEFsZXJ0JyB8fCBhbGVydFR5cGUgPT09ICdTaW5nbGUgQ2FzZSBBbGVydCcgfHwgYWxlcnRUeXBlID09PSAnRVZEQVMgQWxlcnQnIHx8IGFsZXJ0VHlwZSA9PT0gJ0xpdGVyYXR1cmUgU2VhcmNoIEFsZXJ0JykgJiYgIWlzU2lnbmFsKSB7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZFJvd0luZGV4ID0gJCgkdGhpcykuY2xvc2VzdCgndHInKS5pbmRleCgpOwogICAgICAgICAgICBpZiAoaXNBYnN0cmFjdFZpZXdPckNhc2VWaWV3KHNlbGVjdGVkUm93SW5kZXgpKSB7CiAgICAgICAgICAgICAgICBzZWxlY3RlZFJvd0luZGV4ID0gc2VsZWN0ZWRSb3dJbmRleCAvIDIKICAgICAgICAgICAgfQogICAgICAgICAgICByb3dPYmplY3QgPSB0YWJsZS5yb3coc2VsZWN0ZWRSb3dJbmRleCkuZGF0YSgpOwogICAgICAgIH0gZWxzZSBpZiAoYWxlcnRUeXBlID09PSAnQWdncmVnYXRlIENhc2UgQWxlcnQnKSB7CiAgICAgICAgICAgIHJvd09iamVjdCA9IHRhYmxlQWdnUmV2aWV3LnJvdygkKCR0aGlzKS5wYXJlbnRzKCd0cicpKS5kYXRhKCk7CiAgICAgICAgfSBlbHNlIGlmIChhbGVydFR5cGUgPT09ICdMaXRlcmF0dXJlIFNlYXJjaCBBbGVydCcpIHsKICAgICAgICAgICAgcm93T2JqZWN0ID0gdGFibGVMaXRlcmF0dXJlUmV2aWV3LnJvdygkKCR0aGlzKS5wYXJlbnRzKCd0cicpKS5kYXRhKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcm93T2JqZWN0ID0gdGFibGVTaW5nbGVSZXZpZXcucm93KCQoJHRoaXMpLnBhcmVudHMoJ3RyJykpLmRhdGEoKTsKICAgICAgICB9CgogICAgICAgIHZhciBjYXNlTnVtYmVyID0gcm93T2JqZWN0LmNhc2VOdW1iZXI7CiAgICAgICAgdmFyIHByb2R1Y3RGYW1pbHkgPSByb3dPYmplY3QucHJvZHVjdEZhbWlseTsKICAgICAgICB2YXIgY2FzZVZlcnNpb24gPSByb3dPYmplY3QuY2FzZVZlcnNpb247CiAgICAgICAgdmFyIHByb2R1Y3ROYW1lID0gcm93T2JqZWN0LnByb2R1Y3ROYW1lOwogICAgICAgIHZhciBldmVudE5hbWUgPSByb3dPYmplY3QucHJlZmVycmVkVGVybTsKICAgICAgICB2YXIgcHQgPSByb3dPYmplY3QucHQ7CiAgICAgICAgdmFyIGFzc2lnbmVkVG8gPSByb3dPYmplY3QuYXNzaWduZWRUby5pZDsKICAgICAgICB2YXIgYXNzaWduZWRUb1VzZXIgPSBudWxsOwogICAgICAgICBpZihyb3dPYmplY3QuYXNzaWduZWRUb1VzZXIgIT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgYXNzaWduZWRUb1VzZXIgPSByb3dPYmplY3QuYXNzaWduZWRUb1VzZXIuaWQ7CiAgICAgICAgdmFyIHByb2R1Y3RJZCA9IHJvd09iamVjdC5wcm9kdWN0SWQ7CiAgICAgICAgdmFyIHB0Q29kZSA9IHJvd09iamVjdC5wdENvZGU7CiAgICAgICAgdmFyIGNvbmZpZ0lkID0gcm93T2JqZWN0LmFsZXJ0Q29uZmlnSWQ7CiAgICAgICAgdmFyIGV4ZWN1dGVkQ29uZmlnSWQgPSByb3dPYmplY3QuZXhlY0NvbmZpZ0lkOwoKICAgICAgICBpZiAoYWxlcnRUeXBlID09PSBzaWduYWxBbGVydFR5cGUuQURIT0NfQUxFUlQpIHsKICAgICAgICAgICAgYWRob2NBbGVydElkID0gcm93T2JqZWN0LmlkOwogICAgICAgIH0gZWxzZSBpZiAoYWxlcnRUeXBlID09PSBzaWduYWxBbGVydFR5cGUuTElURVJBVFVSRV9TRUFSQ0hfQUxFUlQpIHsKICAgICAgICAgICAgbGl0ZXJhdHVyZUFsZXJ0SWQgPSByb3dPYmplY3QuaWQ7CiAgICAgICAgICAgIGFydGljbGVJZCA9IHJvd09iamVjdC5hcnRpY2xlSWQKICAgICAgICB9CiAgICAgICAgdmFyIGNhc2VKc29uID0gewogICAgICAgICAgICAiYWxlcnRUeXBlIjogYWxlcnRUeXBlLAogICAgICAgICAgICAicHJvZHVjdEZhbWlseSI6IHByb2R1Y3RGYW1pbHksCiAgICAgICAgICAgICJjYXNlTnVtYmVyIjogY2FzZU51bWJlciwKICAgICAgICAgICAgInByb2R1Y3ROYW1lIjogcHJvZHVjdE5hbWUsCiAgICAgICAgICAgICJldmVudE5hbWUiOiBldmVudE5hbWUsCiAgICAgICAgICAgICJwdCI6IHB0LAogICAgICAgICAgICAicHRDb2RlIjogcHRDb2RlLAogICAgICAgICAgICAicHJvZHVjdElkIjogcHJvZHVjdElkLAogICAgICAgICAgICAiYXNzaWduZWRUbyI6IGFzc2lnbmVkVG8gPyBhc3NpZ25lZFRvIDogYXNzaWduZWRUb1VzZXIsCiAgICAgICAgICAgICJleGVjdXRlZENvbmZpZ0lkIjogZXhlY3V0ZWRDb25maWdJZCwKICAgICAgICAgICAgImNvbmZpZ0lkIjogY29uZmlnSWQsCiAgICAgICAgICAgICJhZGhvY0FsZXJ0SWQiOiBhZGhvY0FsZXJ0SWQsCiAgICAgICAgICAgICJsaXRlcmF0dXJlQWxlcnRJZCI6IGxpdGVyYXR1cmVBbGVydElkLAogICAgICAgICAgICAiYXJ0aWNsZUlkIjogYXJ0aWNsZUlkCiAgICAgICAgfTsKCiAgICAgICAgY2FzZUpzb25BcnJheS5wdXNoKGNhc2VKc29uKTsKICAgICAgICB2YXIgY29tbWVudE1ldGFJbmZvID0gIiI7CgogICAgICAgIGlmIChjYXNlSnNvbi5hbGVydFR5cGUgPT09IHNpZ25hbEFsZXJ0VHlwZS5BR0dSRUdBVEVfQUxFUlQgfHwgY2FzZUpzb24uYWxlcnRUeXBlID09PSBzaWduYWxBbGVydFR5cGUuRVZEQVNfQUxFUlQpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiAoY2FzZUpzb24uZXZlbnROYW1lKSA9PT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIChjYXNlSnNvbi5wcm9kdWN0TmFtZSkgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgICAgICBjb21tZW50TWV0YUluZm8gPSAiIgogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29tbWVudE1ldGFJbmZvID0gJzxzcGFuIGlkPSJwcm9kdWN0TmFtZSI+JyArIGNhc2VKc29uLnByb2R1Y3ROYW1lICsgJzwvc3Bhbj4gLSA8c3BhbiBpZD0iZXZlbnROYW1lIj4nICsgY2FzZUpzb24uZXZlbnROYW1lICsgJzwvc3Bhbj4nICsgJzxzcGFuIGNsYXNzPSJoaWRkZW4iIGlkPSJwcm9kdWN0SWQiPicgKyBjYXNlSnNvbi5wcm9kdWN0SWQgKyAnPC9zcGFuPicgKwogICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz0iaGlkZGVuIiBpZD0icHRDb2RlIj4nICsgY2FzZUpzb24ucHRDb2RlICsgJzwvc3Bhbj4nCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodHlwZW9mIChjYXNlSnNvbi5jYXNlTnVtYmVyKSA9PT0gInVuZGVmaW5lZCIgfHwgdHlwZW9mIChjYXNlSnNvbi5wcm9kdWN0RmFtaWx5KSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgIGNvbW1lbnRNZXRhSW5mbyA9ICIiCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb21tZW50TWV0YUluZm8gPSAnPHNwYW4gaWQ9ImNhc2VOdW1iZXIiPicgKyBjYXNlSnNvbi5jYXNlTnVtYmVyICsgJzwvc3Bhbj4gLSA8c3BhbiBpZD0icHJvZHVjdEZhbWlseSI+JyArIGNhc2VKc29uLnByb2R1Y3RGYW1pbHkgKyAnPC9zcGFuPicKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb21tZW50TW9kYWwuZmluZCgiI2NvbW1lbnQtbWV0YS1pbmZvIikuaHRtbChjb21tZW50TWV0YUluZm8pOwogICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjYXNzaWduZWRUbyIpLmh0bWwoYXNzaWduZWRUbyk7CiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNjb25maWdJZCIpLmh0bWwoY29uZmlnSWQpOwogICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIjYXBwbGljYXRpb24iKS5odG1sKGNhc2VKc29uLmFsZXJ0VHlwZSk7CgogICAgICAgIC8vUG9wdWxhdGUgdGhlIGV4aXN0aW5nIGNvbW1lbnRzIGFuZCBiaW5kIGV2ZW50cyB0byB0aGVtIGluIGNhc2Ugb2Ygc2luZ2xlIGNvbW1lbnQuCiAgICAgICAgaWYgKHR5cGVvZiBpc0Nhc2VEZXRhaWwgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICAgICQoJyNsb2FkaW5nQ29tbWVudHMnKS5odG1sKCcnKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNpZ25hbC5hbGVydENvbW1lbnRzLnBvcHVsYXRlX2NvbW1lbnRzKGNvbW1lbnRNb2RhbCwgY2FzZUpzb24pOwogICAgICAgIH0KICAgICAgICAkKCIjY29tbWVudE1vZGFsIikub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgJCgnI2NvbW1lbnRib3gnKS52YWwoJycpOwogICAgICAgICAgICAkKCcuYWRkLWNvbW1lbnRzJykuaHRtbCgnQWRkJyk7CiAgICAgICAgICAgICQoIi5jcmVhdGVkQnkiKS50ZXh0KCcnKTsKICAgICAgICB9KQogICAgfTsKCiAgICB2YXIgaW5pdGlhdGVTaW5nbGVCdWxrUm93Q29tbWVudFByb2Nlc3MgPSBmdW5jdGlvbiAoY2FzZUpzb25BcnJheSwgY29tbWVudE1vZGFsLCBhbGVydFR5cGUsIGlzQ2FzZURldGFpbCwgaXNTaWduYWwpIHsKICAgICAgICB2YXIgaW5kZXhTZXQgPSBuZXcgU2V0KCk7CiAgICAgICAgdmFyIGNoZWNrYm94U2VsZWN0b3I7CiAgICAgICAgaWYgKCQoJyNkZXRhaWxlZC12aWV3LWNoZWNrYm94JykuaXMoJzpjaGVja2VkJykpIHsKICAgICAgICAgICAgY2hlY2tib3hTZWxlY3RvciA9ICd0YWJsZSNhbGVydHNEZXRhaWxzVGFibGUgLmNvcHktc2VsZWN0OmNoZWNrZWQnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNoZWNrYm94U2VsZWN0b3IgPSAndGFibGUuRFRGQ19DbG9uZWQgLmNvcHktc2VsZWN0OmNoZWNrZWQnOwogICAgICAgIH0KICAgICAgICAkLmVhY2goJChjaGVja2JveFNlbGVjdG9yKSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgc2VsZWN0ZWRSb3dJbmRleCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5pbmRleCgpOwogICAgICAgICAgICBpZiAoaXNBYnN0cmFjdFZpZXdPckNhc2VWaWV3KHNlbGVjdGVkUm93SW5kZXgpKQogICAgICAgICAgICAgICAgc2VsZWN0ZWRSb3dJbmRleCA9IHNlbGVjdGVkUm93SW5kZXggLyAyOwogICAgICAgICAgICBpbmRleFNldC5hZGQoKHNlbGVjdGVkUm93SW5kZXgpKTsKICAgICAgICB9KTsKICAgICAgICBpbmRleFNldC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgICAgICB2YXIgYWRob2NBbGVydElkOwogICAgICAgICAgICB2YXIgbGl0ZXJhdHVyZUFsZXJ0SWQ7CiAgICAgICAgICAgIHZhciBhcnRpY2xlSWQ7CiAgICAgICAgICAgIHZhciByb3dPYmplY3QgPSB7fTsKICAgICAgICAgICAgaWYgKChhbGVydFR5cGUgPT09ICdBZ2dyZWdhdGUgQ2FzZSBBbGVydCcgfHwgYWxlcnRUeXBlID09PSAnU2luZ2xlIENhc2UgQWxlcnQnIHx8IGFsZXJ0VHlwZSA9PT0gJ0VWREFTIEFsZXJ0JyB8fCBhbGVydFR5cGUgPT09ICdMaXRlcmF0dXJlIFNlYXJjaCBBbGVydCcpICYmICFpc1NpZ25hbCkgewogICAgICAgICAgICAgICAgcm93T2JqZWN0ID0gdGFibGUucm93cyhpbmRleCkuZGF0YSgpWzBdOwogICAgICAgICAgICB9IGVsc2UgaWYgKGFsZXJ0VHlwZSA9PT0gJ0FnZ3JlZ2F0ZSBDYXNlIEFsZXJ0JykgewogICAgICAgICAgICAgICAgcm93T2JqZWN0ID0gdGFibGVBZ2dSZXZpZXcucm93cyhpbmRleCkuZGF0YSgpWzBdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcm93T2JqZWN0ID0gdGFibGVTaW5nbGVSZXZpZXcucm93cyhpbmRleCkuZGF0YSgpWzBdOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY2FzZU51bWJlciA9IHJvd09iamVjdC5jYXNlTnVtYmVyOwogICAgICAgICAgICB2YXIgcHJvZHVjdEZhbWlseSA9IHJvd09iamVjdC5wcm9kdWN0RmFtaWx5OwogICAgICAgICAgICB2YXIgY2FzZVZlcnNpb24gPSByb3dPYmplY3QuY2FzZVZlcnNpb247CiAgICAgICAgICAgIHZhciBwcm9kdWN0TmFtZSA9IHJvd09iamVjdC5wcm9kdWN0TmFtZTsKICAgICAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHJvd09iamVjdC5wcmVmZXJyZWRUZXJtOwogICAgICAgICAgICB2YXIgcHQgPSByb3dPYmplY3QucHQ7CiAgICAgICAgICAgIHZhciBhc3NpZ25lZFRvID0gcm93T2JqZWN0LmFzc2lnbmVkVG8uaWQ7CiAgICAgICAgICAgIHZhciBwcm9kdWN0SWQgPSByb3dPYmplY3QucHJvZHVjdElkOwogICAgICAgICAgICB2YXIgcHRDb2RlID0gcm93T2JqZWN0LnB0Q29kZTsKICAgICAgICAgICAgdmFyIGNvbmZpZ0lkID0gcm93T2JqZWN0LmFsZXJ0Q29uZmlnSWQ7CiAgICAgICAgICAgIHZhciBleGVjdXRlZENvbmZpZ0lkID0gcm93T2JqZWN0LmV4ZWNDb25maWdJZDsKCiAgICAgICAgICAgIGlmIChhbGVydFR5cGUgPT09IHNpZ25hbEFsZXJ0VHlwZS5BREhPQ19BTEVSVCkgewogICAgICAgICAgICAgICAgYWRob2NBbGVydElkID0gcm93T2JqZWN0LmlkOwogICAgICAgICAgICB9IGVsc2UgaWYgKGFsZXJ0VHlwZSA9PT0gc2lnbmFsQWxlcnRUeXBlLkxJVEVSQVRVUkVfU0VBUkNIX0FMRVJUKSB7CiAgICAgICAgICAgICAgICBsaXRlcmF0dXJlQWxlcnRJZCA9IHJvd09iamVjdC5pZDsKICAgICAgICAgICAgICAgIGFydGljbGVJZCA9IHJvd09iamVjdC5hcnRpY2xlSWQKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgY2FzZUpzb24gPSB7CiAgICAgICAgICAgICAgICAiYWxlcnRUeXBlIjogYWxlcnRUeXBlLAogICAgICAgICAgICAgICAgInByb2R1Y3RGYW1pbHkiOiBwcm9kdWN0RmFtaWx5LAogICAgICAgICAgICAgICAgImNhc2VOdW1iZXIiOiBjYXNlTnVtYmVyLAogICAgICAgICAgICAgICAgInByb2R1Y3ROYW1lIjogcHJvZHVjdE5hbWUsCiAgICAgICAgICAgICAgICAiZXZlbnROYW1lIjogZXZlbnROYW1lLAogICAgICAgICAgICAgICAgInB0IjogcHQsCiAgICAgICAgICAgICAgICAicHRDb2RlIjogcHRDb2RlLAogICAgICAgICAgICAgICAgInByb2R1Y3RJZCI6IHByb2R1Y3RJZCwKICAgICAgICAgICAgICAgICJhc3NpZ25lZFRvIjogYXNzaWduZWRUbywKICAgICAgICAgICAgICAgICJleGVjdXRlZENvbmZpZ0lkIjogZXhlY3V0ZWRDb25maWdJZCwKICAgICAgICAgICAgICAgICJjb25maWdJZCI6IGNvbmZpZ0lkLAogICAgICAgICAgICAgICAgImFkaG9jQWxlcnRJZCI6IGFkaG9jQWxlcnRJZCwKICAgICAgICAgICAgICAgICJsaXRlcmF0dXJlQWxlcnRJZCI6IGxpdGVyYXR1cmVBbGVydElkLAogICAgICAgICAgICAgICAgImFydGljbGVJZCI6IGFydGljbGVJZAogICAgICAgICAgICB9OwogICAgICAgICAgICBjYXNlSnNvbkFycmF5LnB1c2goY2FzZUpzb24pCiAgICAgICAgfSk7CgogICAgICAgIC8vU2V0IHZhbHVlcyB0byB0aGUgbW9kYWwgZWxlbWVudHMuCiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNsb2FkaW5nQ29tbWVudHMiKS5oaWRlKCk7CiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIiNjb21tZW50LW1ldGEtaW5mbyIpLmh0bWwoIiIpOwogICAgICAgIGNvbW1lbnRNb2RhbC5maW5kKCIucHJldmlvdXMtY29tbWVudHMiKS5odG1sKCIiKTsKICAgICAgICBjb21tZW50TW9kYWwuZmluZCgiI2NvbW1lbnRJZCIpLnZhbCgnJyk7CiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoIi5jcmVhdGVkQnkiKS50ZXh0KCcnKTsKICAgICAgICBpZiAoY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5odG1sKCkgIT0gJ1VwZGF0ZScpIHsKICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5odG1sKCJBZGQiKTsKICAgICAgICB9CiAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5wcm9wKCJkaXNhYmxlZCIsIGZhbHNlKTsKICAgICAgICBjb21tZW50TW9kYWwuZmluZCgnI2NvbW1lbnRib3gnKS5vbigia2V5dXAiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmIChjb21tZW50TW9kYWwuZmluZCgnI2NvbW1lbnRib3gnKS52YWwoKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBjb21tZW50TW9kYWwuZmluZCgnLmFkZC1jb21tZW50cycpLnByb3AoImRpc2FibGVkIiwgZmFsc2UpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29tbWVudE1vZGFsLmZpbmQoJy5hZGQtY29tbWVudHMnKS5wcm9wKCJkaXNhYmxlZCIsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciByZXN0YXJ0UmV2aWV3ID0gZnVuY3Rpb24gKGNhc2VSZXZpZXdQcmV2aW91c1VybCkgewoKICAgICAgICAvL0V2ZW50IHdoZW4gcmV2aWV3IHJlc3RhcnQgaXMgY2xpY2tlZC4KICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNhc2UtcmVzdGFydC1yZXZpZXcnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdmFyIHBhcmVudF9yb3cgPSAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgndHInKTsKICAgICAgICAgICAgdmFyIGNhc2VOdW1iZXIgPSBwYXJlbnRfcm93LmZpbmQoJ3NwYW5bZGF0YS1maWVsZD0iY2FzZU51bWJlciJdJykuYXR0cigiZGF0YS1pZCIpOwogICAgICAgICAgICB2YXIgZm9sbG93VXBOdW1iZXIgPSBwYXJlbnRfcm93LmZpbmQoJ3NwYW5bZGF0YS1maWVsZD0iZm9sbG93VXBOdW1iZXIiXScpLmF0dHIoImRhdGEtaWQiKTsKICAgICAgICAgICAgdmFyIGNhc2VWZXJzaW9uID0gcGFyZW50X3Jvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9ImNhc2VWZXJzaW9uIl0nKS5hdHRyKCJkYXRhLWlkIik7CiAgICAgICAgICAgIHZhciBwcm9kdWN0RmFtaWx5ID0gcGFyZW50X3Jvdy5maW5kKCdpbnB1dFtkYXRhLWZpZWxkPSJwcm9kdWN0RmFtaWx5Il0nKS5hdHRyKCJkYXRhLWlkIik7CiAgICAgICAgICAgIHZhciBmb2xsb3dVcE1vZGFsID0gJCgnI2ZvbGxvd1VwTW9kYWwnKTsKICAgICAgICAgICAgZm9sbG93VXBNb2RhbC5tb2RhbCgnc2hvdycpOwogICAgICAgICAgICBmb2xsb3dVcE1vZGFsLmZpbmQoIi5wcmV2aW91cy1mb2xsb3dVcCIpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBnZXRQcmV2aW91c1N0YXRlID0gY2FzZVJldmlld1ByZXZpb3VzVXJsICsgIj9jYXNlTnVtYmVyPSIgKyBjYXNlTnVtYmVyICsKICAgICAgICAgICAgICAgICAgICAiJmNhc2VWZXJzaW9uPSIgKyBjYXNlVmVyc2lvbiArICImcHJvZHVjdEZhbWlseT0iICsgcHJvZHVjdEZhbWlseSArICImZm9sbG93VXBOdW1iZXI9IiArIGZvbGxvd1VwTnVtYmVyOwogICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICB1cmw6IGdldFByZXZpb3VzU3RhdGUsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfcm93LmZpbmQoJ3NwYW5bZGF0YS1maWVsZD0id29ya2Zsb3dTdGF0ZSJdJykudGV4dChyZXN1bHQucHJldmlvdXNTdGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudF9yb3cuZmluZCgnc3BhbltkYXRhLWZpZWxkPSJkaXNwb3NpdGlvbiJdJykudGV4dChyZXN1bHQucHJldmlvdXNEaXNwb3NpdGlvbik7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudF9yb3cuZmluZCgnc3BhbltkYXRhLWZpZWxkPSJpbmZvLXNpZ24iXScpLmFkZENsYXNzKCJoaWRkZW4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9sbG93VXBNb2RhbC5tb2RhbCgnZGVzdHJveScpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBvcGVuU2ltaWxhckNhc2VzTW9kYWwgPSBmdW5jdGlvbiAoY2FzZUluZm9VcmwpIHsKCiAgICAgICAgLy9FdmVudCB0cmlnZ2VyZWQgd2hlbiBzaW1pbGFyIGNhc2VzIGNvdW50IGlzIGNsaWNrZWQuCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaW1pbGFyLWNhc2VzJywgZnVuY3Rpb24gKGV2ZW50KSB7CgogICAgICAgICAgICB2YXIgc2ltaWxhckNhc2VNb2RhbCA9ICQoJyNzaW1pbGFyQ2FzZU1vZGFsJyk7CiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICB2YXIgcGFyZW50X3JvdyA9ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCJ0ciIpOwoKICAgICAgICAgICAgLy9GZXRjaCB0aGUgdmFsdWVzIG9mIHRoZSBldmVudC4KICAgICAgICAgICAgdmFyIGV2ZW50VmFsID0gJChldmVudC50YXJnZXQpLmF0dHIoJ2RhdGEtZXZlbnQtdmFsJyk7CiAgICAgICAgICAgIHZhciBldmVudFR5cGUgPSAkKGV2ZW50LnRhcmdldCkuYXR0cignZGF0YS1maWVsZCcpOwogICAgICAgICAgICB2YXIgZXhlY3V0ZWRDb25maWdJZCA9ICQoZXZlbnQudGFyZ2V0KS5hdHRyKCJkYXRhLWlkIik7CiAgICAgICAgICAgIHZhciBwdCA9ICQoZXZlbnQudGFyZ2V0KS5hdHRyKCJkYXRhLXB0Iik7CiAgICAgICAgICAgIHZhciBldmVudENvZGU7CiAgICAgICAgICAgIGlmIChldmVudFR5cGUpIHsKICAgICAgICAgICAgICAgIGV2ZW50Q29kZSA9IChldmVudFR5cGUuc3BsaXQoIl9jb2RlIilbMF0pOwogICAgICAgICAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRUeXBlLnNwbGl0KCJfIilbMl07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBjYXNlTnVtYmVyID0gcGFyZW50X3Jvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9ImNhc2VOdW1iZXIiXScpLmF0dHIoImRhdGEtaWQiKTsKICAgICAgICAgICAgdmFyIGNhc2VWZXJzaW9uID0gcGFyZW50X3Jvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9ImNhc2VWZXJzaW9uIl0nKS5hdHRyKCJkYXRhLWlkIik7CgogICAgICAgICAgICAvL1Nob3cgbW9kYWwgYW5kIHNldCBpdHMgdmFsdWVzLgogICAgICAgICAgICBzaW1pbGFyQ2FzZU1vZGFsLm1vZGFsKCdzaG93Jyk7CiAgICAgICAgICAgIHNpbWlsYXJDYXNlTW9kYWwuZmluZCgiI2V2ZW50VHlwZSIpLmh0bWwoZXZlbnRUeXBlKTsKICAgICAgICAgICAgc2ltaWxhckNhc2VNb2RhbC5maW5kKCIjZXZlbnRWYWwiKS5odG1sKGV2ZW50VmFsKTsKICAgICAgICAgICAgc2ltaWxhckNhc2VNb2RhbC5maW5kKCIjY2FzZU51bWJlckluZm8iKS52YWwoY2FzZU51bWJlcik7CiAgICAgICAgICAgIHNpbWlsYXJDYXNlTW9kYWwuZmluZCgiI2V4ZWN1dGVkQ29uZmlnSWQiKS52YWwoZXhlY3V0ZWRDb25maWdJZCk7CiAgICAgICAgICAgIHNpbWlsYXJDYXNlTW9kYWwuZmluZCgiI2Nhc2VDdXJyZW50VmVyc2lvbiIpLnZhbChjYXNlVmVyc2lvbik7CiAgICAgICAgICAgIHNpbWlsYXJDYXNlTW9kYWwuZmluZCgiI2V2ZW50Q29kZSIpLnZhbChldmVudENvZGUpOwogICAgICAgICAgICBzaW1pbGFyQ2FzZU1vZGFsLmZpbmQoIiNldmVudENvZGVWYWwiKS52YWwoZXZlbnRWYWwpOwogICAgICAgICAgICAvL01ha2UgdGhlIG1vZGFsIHRhYmxlIGFzIGRhdGF0YWJsZQoKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBzaWduYWwuc2ltaWxhckNhc2VUYWJsZS5pbml0X3NpbWlsYXJfY2FzZV90YWJsZShjYXNlSW5mb1VybCkKICAgICAgICAgICAgfSwgMTAwKTsKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIG9wZW5BdHRhY2htZW50TW9kYWwgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LWF0dGFjaG1lbnQtaWNvbicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICB2YXIgJHRoaXMgPSB0aGlzOwogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBmZXRjaEFjY2VwdGVkRmlsZUZvcm1hdHMoKTsKICAgICAgICAgICAgLy92YXIgaXNBcmNoaXZlZCA9ICQoIiNpc0FyY2hpdmVkIikudmFsKCk7CiAgICAgICAgICAgIHZhciBwYXJlbnRfcm93ID0gJChldmVudC50YXJnZXQpLmNsb3Nlc3QoJ3RyJyk7CiAgICAgICAgICAgIHZhciBhbGVydElkID0gcGFyZW50X3Jvdy5maW5kKCdhW2RhdGEtZmllbGQ9ImF0dGFjaG1lbnQiXScpLmF0dHIoImRhdGEtaWQiKTsKICAgICAgICAgICAgdmFyIGNhc2VDb250cm9sbGVyID0gcGFyZW50X3Jvdy5maW5kKCdhW2RhdGEtZmllbGQ9ImF0dGFjaG1lbnQiXScpLmF0dHIoImRhdGEtY29udHJvbGxlciIpOwogICAgICAgICAgICB2YXIgdXJsID0gIi9zaWduYWwvIiArIGNhc2VDb250cm9sbGVyICsgIi91cGxvYWQ/aXNBcmNoaXZlZD0iK2lzQXJjaGl2ZWQ7CiAgICAgICAgICAgIHZhciBnZXRBdHRhY2htZW50VXJsID0gIi9zaWduYWwvIiArIGNhc2VDb250cm9sbGVyICsgIi9mZXRjaEF0dGFjaG1lbnQ/YWxlcnRJZD0iICsgYWxlcnRJZCArICImaXNBcmNoaXZlZD0iICsgaXNBcmNoaXZlZDsKICAgICAgICAgICAgJCgnI3Nob3dBdHRhY2htZW50TW9kYWwgI2F0dGFjaG1lbnRGb3JtICNhdHRhY2htZW50Rm9ybUlkJykuYXR0cigndmFsdWUnLCBhbGVydElkKTsKICAgICAgICAgICAgdmFyIGNhc2VIaXN0b3J5TW9kYWwgPSAkKCcjc2hvd0F0dGFjaG1lbnRNb2RhbCcpOwogICAgICAgICAgICBjYXNlSGlzdG9yeU1vZGFsLm1vZGFsKCdzaG93Jyk7CiAgICAgICAgICAgICQoIiNzaG93QXR0YWNobWVudE1vZGFsIGZvcm0jYXR0YWNobWVudEZvcm0iKS51bmJpbmQoJ3N1Ym1pdCcpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEodGhpcyk7CiAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgaWYgKCR0aGlzLmZpbmQoJy5hdHRhY2htZW50LWZpbGUnKS52YWwoKSkgewogICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoIi51cGxvYWQiKS5hdHRyKCJkaXNhYmxlZCIsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBhc3luYzogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoJy5hdHRhY2htZW50LWZpbGUnKS52YWwoJycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0F0dGFjaG1lbnRJY29uKHBhcmVudF9yb3cpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3Nob3dBdHRhY2htZW50TW9kYWwgI2F0dGFjaG1lbnQtdGFibGUnKS5EYXRhVGFibGUoKS5hamF4LnJlbG9hZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuZmluZCgiLnVwbG9hZCIpLmF0dHIoImRpc2FibGVkIiwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuZmluZCgiLnVwbG9hZCIpLmF0dHIoImRpc2FibGVkIiwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5Ob3RpZmljYXRpb24ubm90aWZ5KCdlcnJvcicsICd0b3AgcmlnaHQnLCAiRXJyb3IiLCAiU29ycnksIFRoaXMgRmlsZSBGb3JtYXQgTm90IEFjY2VwdGVkIiwge2F1dG9IaWRlRGVsYXk6IDEwMDAwfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQoJyNzaG93QXR0YWNobWVudE1vZGFsICNhdHRhY2htZW50LXRhYmxlJykuRGF0YVRhYmxlKHsKICAgICAgICAgICAgICAgIGRlc3Ryb3k6IHRydWUsCiAgICAgICAgICAgICAgICBzZWFyY2hpbmc6IGZhbHNlLAogICAgICAgICAgICAgICAgc1BhZ2luYXRpb25UeXBlOiAiYm9vdHN0cmFwIiwKICAgICAgICAgICAgICAgIHJlc3BvbnNpdmU6IGZhbHNlLAogICAgICAgICAgICAgICAgbGFuZ3VhZ2U6IHsKICAgICAgICAgICAgICAgICAgICAidXJsIjogIi4uL2Fzc2V0cy9pMThuL2RhdGFUYWJsZXNfIiArIHVzZXJMb2NhbGUgKyAiLmpzb24iCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgImFqYXgiOiB7CiAgICAgICAgICAgICAgICAgICAgInVybCI6IGdldEF0dGFjaG1lbnRVcmwsCiAgICAgICAgICAgICAgICAgICAgImRhdGFTcmMiOiAiIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGZuRHJhd0NhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLnJlbW92ZS1hdHRhY2htZW50JykuY2xpY2soZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF0dGFjaG1lbnRSb3cgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCd0cicpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0YWNobWVudElkID0gYXR0YWNobWVudFJvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9InJlbW92ZUF0dGFjaG1lbnQiXScpLmF0dHIoImRhdGEtYXR0YWNobWVudElkIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdmVVcmwgPSAnL3NpZ25hbC8nICsgY2FzZUNvbnRyb2xsZXIgKyAnL2RlbGV0ZUF0dGFjaG1lbnQ/YXR0YWNobWVudElkPScgKyBhdHRhY2htZW50SWQgKyAnJmlzQXJjaGl2ZWQ9JyArIGlzQXJjaGl2ZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHJlbW92ZVVybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHthbGVydElkOiBhbGVydElkfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkKCcucmVtb3ZlLWF0dGFjaG1lbnQnKS5sZW5ndGggPT09MSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQXR0YWNobWVudEljb24oJHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNzaG93QXR0YWNobWVudE1vZGFsICNhdHRhY2htZW50LXRhYmxlJykuRGF0YVRhYmxlKCkuYWpheC5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuTm90aWZpY2F0aW9uLm5vdGlmeSgnZXJyb3InLCAndG9wIHJpZ2h0JywgIkVycm9yIiwgIkFsbCBzZWxlY3RlZCBzYWZldHkgb2JzZXJ2YXRpb25zIG11c3QgYmUgaW4gc2FtZSBkaXNwb3NpdGlvbiBmb3IgcGVyZm9ybWluZyB0aGUgYnVsayB1cGRhdGUuIiwge2F1dG9IaWRlRGVsYXk6IDEwMDAwfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAiYW9Db2x1bW5zIjogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogIm5hbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iL3NpZ25hbC9hdHRhY2htZW50YWJsZS9kb3dubG9hZD9pZD0nICsgcm93LmlkICsgJyI+JyArIGVzY2FwZUhUTUwocm93Lm5hbWUpICsgJzwvYT4nCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJkZXNjcmlwdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAnY2VsbC1icmVhaycsCiAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAidGltZVN0YW1wIgogICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogIm1vZGlmaWVkQnkiCiAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAiaWQiLAogICAgICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4gdGFiaW5kZXg9IjAiIHRpdGxlPSJSZW1vdmUgQXR0YWNobWVudCIgIHN0eWxlPSJjdXJzb3I6IHBvaW50ZXIiIGNsYXNzPSJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZSByZW1vdmUtYXR0YWNobWVudCIgZGF0YS1maWVsZD0icmVtb3ZlQXR0YWNobWVudCIgZGF0YS1hdHRhY2htZW50SWQ9JyArIHJvdy5pZCArICc+PC9zcGFuPicKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAiYkxlbmd0aENoYW5nZSI6IGZhbHNlLAogICAgICAgICAgICAgICAgY29sdW1uRGVmczogW3sKICAgICAgICAgICAgICAgICAgICAidGFyZ2V0cyI6ICdfYWxsJywKICAgICAgICAgICAgICAgICAgICAicmVuZGVyIjogJC5mbi5kYXRhVGFibGUucmVuZGVyLnRleHQoKQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIHZhciBiaW5kR3JpZER5bmFtaWNGaWx0ZXJzID0gZnVuY3Rpb24gKGZpbHRlcnNEYXRhLCBwcmVmaXgsIGlkKSB7CiAgICAgICAgLy9BZGQgZmlsdGVycyB0byB0aGUgZGF0YSB0YWJsZS4KICAgICAgICB2YXIgZGF0YVRhYmxlc19sZW5ndGggPSAkKCcuZGF0YVRhYmxlc19sZW5ndGgnKTsKICAgICAgICBkYXRhVGFibGVzX2xlbmd0aC5hZGRDbGFzcygnY29sLXNtLTEyJyk7CiAgICAgICAgZGF0YVRhYmxlc19sZW5ndGgucGFyZW50KCkucmVtb3ZlQ2xhc3MoImNvbC14cy0yIik7CiAgICAgICAgYXBwbGljYXRpb25OYW1lID09IEFMRVJUX0NPTkZJR19UWVBFLkFESE9DX0FMRVJUID8gZGF0YVRhYmxlc19sZW5ndGgucGFyZW50KCI6bm90KCcuZGF0YVRhYmxlc193cmFwcGVyJykiKS5hZGRDbGFzcygiY29sLXhzLTkiKSA6IGRhdGFUYWJsZXNfbGVuZ3RoLnBhcmVudCgiOm5vdCgnLmRhdGFUYWJsZXNfd3JhcHBlcicpIikuYWRkQ2xhc3MoImNvbC14cy0xMCIpOwogICAgICAgIGRhdGFUYWJsZXNfbGVuZ3RoLnBhcmVudCgiOm5vdCgnLmRhdGFUYWJsZXNfd3JhcHBlcicpIikubmV4dCgpLnJlbW92ZUNsYXNzKCJjb2wteHMtMTAiKTsKICAgICAgICBhcHBsaWNhdGlvbk5hbWUgPT0gQUxFUlRfQ09ORklHX1RZUEUuQURIT0NfQUxFUlQgPyBkYXRhVGFibGVzX2xlbmd0aC5wYXJlbnQoIjpub3QoJy5kYXRhVGFibGVzX3dyYXBwZXInKSIpLm5leHQoKS5hZGRDbGFzcygiY29sLXhzLTMiKSA6IGRhdGFUYWJsZXNfbGVuZ3RoLnBhcmVudCgiOm5vdCgnLmRhdGFUYWJsZXNfd3JhcHBlcicpIikubmV4dCgpLmFkZENsYXNzKCJjb2wteHMtMiIpOwogICAgICAgIGRhdGFUYWJsZXNfbGVuZ3RoLmZpbmQoImxhYmVsIikuYWRkQ2xhc3MoJ2NvbC14cy0yJyk7CiAgICAgICAgZGF0YVRhYmxlc19sZW5ndGguZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBkdEJ1dHRvbnMgPSAnPGRpdiBjbGFzcz0iZGF0YVRhYmxlLXRvcC1kaXNwb3NpdGlvbiBjb2wteHMtMTAiPic7CiAgICAgICAgICAgICQuZWFjaChmaWx0ZXJzRGF0YSwgZnVuY3Rpb24gKGluZGV4LCBvYmopIHsKICAgICAgICAgICAgICAgIGlmIChvYmouY2xvc2VkIHx8IG9iai5pc0Nsb3NlZCkgewogICAgICAgICAgICAgICAgICAgIGR0QnV0dG9ucyArPSAnPGRpdiBjbGFzcz0iY2hlY2tib3ggY2hlY2tib3gtcHJpbWFyeSBjaGVja2JveC1pbmxpbmUgbS1sLTMgY2hlY2tib3gtcG9zLWFicyI+JzsKICAgICAgICAgICAgICAgICAgICBkdEJ1dHRvbnMgKz0gJzxpbnB1dCBpZD0iZmlsdGVyJyArIGluZGV4ICsgJyIgdHlwZT0iY2hlY2tib3giIGNsYXNzPSJkeW5hbWljLWZpbHRlcnMiIG5hbWU9InJlbGF0ZWRSZXN1bHRzIiBkYXRhLWNsb3NlZD0iJyArIG9iai5pc0Nsb3NlZCArICciIHZhbHVlPSInICsgb2JqLnZhbHVlICsgJyIgLz4gPGxhYmVsIGNsYXNzPSJtLXItMzAiICBmb3I9ImZpbHRlcicgKyBpbmRleCArICciPicgKyBvYmoudmFsdWUgKyAnPC9sYWJlbD48L2Rpdj4nCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGR0QnV0dG9ucyArPSAnPGRpdiBjbGFzcz0iY2hlY2tib3ggY2hlY2tib3gtcHJpbWFyeSBjaGVja2JveC1pbmxpbmUgbS1sLTMgY2hlY2tib3gtcG9zLWFicyI+JzsKICAgICAgICAgICAgICAgICAgICBkdEJ1dHRvbnMgKz0gJzxpbnB1dCBpZD0iZmlsdGVyJyArIGluZGV4ICsgJyIgdHlwZT0iY2hlY2tib3giIGNsYXNzPSJkeW5hbWljLWZpbHRlcnMiIG5hbWU9InJlbGF0ZWRSZXN1bHRzIiBkYXRhLWNsb3NlZD0iJyArIG9iai5pc0Nsb3NlZCArICciIGNoZWNrZWQ9ImNoZWNrZWQiIHZhbHVlPSInICsgb2JqLnZhbHVlICsgJyIgLz4gPGxhYmVsIGNsYXNzPSJtLXItMzAiIGZvcj0iZmlsdGVyJyArIGluZGV4ICsgJyI+JyArIG9iai52YWx1ZSArICc8L2xhYmVsPjwvZGl2PicKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGR0QnV0dG9ucyArPSAnPC9kaXY+JzsKICAgICAgICAgICAgZHRCdXR0b25zID0gZHRCdXR0b25zICsgJzwvZGl2Pic7CiAgICAgICAgICAgIGlmICh0aGlzLmlkICE9PSAnYXJjaGl2ZWRBbGVydHNUYWJsZV9sZW5ndGgnICYmIHRoaXMuaWQgIT09ICdhY3Rpdml0aWVzVGFibGVfbGVuZ3RoJykKICAgICAgICAgICAgICAgICQodGhpcykuYXBwZW5kKGR0QnV0dG9ucyk7CiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZHluYW1pYy1maWx0ZXJzJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGFsZXJ0RGV0YWlsc1RhYmxlOwogICAgICAgICAgICAgICAgdmFyIGZyZXFTZWxlY3RlZCA9ICIiOwogICAgICAgICAgICAgICAgaWYgKCQoIiNmcmVxdWVuY3lOYW1lcyIpKSB7CiAgICAgICAgICAgICAgICAgICAgZnJlcVNlbGVjdGVkID0gJCgiI2ZyZXF1ZW5jeU5hbWVzIikudmFsKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgZmlsdGVyQXJyYXkgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJWYWx1ZXMgPSBbXTsKICAgICAgICAgICAgICAgICQoJy5keW5hbWljLWZpbHRlcnMnKS5lYWNoKGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmlzKCc6Y2hlY2tlZCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclZhbHVlcy5wdXNoKCQodGhpcykudmFsKCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnJheS5wdXNoKCQodGhpcykuaXMoJzpjaGVja2VkJykpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHByZWZpeCArICJmaWx0ZXJzX3N0b3JlIiwgSlNPTi5zdHJpbmdpZnkoZmlsdGVyQXJyYXkpKTsKICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0ocHJlZml4ICsgImZpbHRlcnNfdmFsdWUiLCBKU09OLnN0cmluZ2lmeShmaWx0ZXJWYWx1ZXMpKTsKICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0ocHJlZml4ICsgImlkIiwgaWQpOwogICAgICAgICAgICAgICAgdmFyIHVybDsKICAgICAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbk5hbWUgPT0gJ0xpdGVyYXR1cmUgU2VhcmNoIEFsZXJ0JykgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0RGV0YWlsc1RhYmxlID0gJCgnI2FsZXJ0c0RldGFpbHNUYWJsZScpLkRhdGFUYWJsZSgpOwogICAgICAgICAgICAgICAgICAgIHVybCA9IGxpc3RDb25maWdVcmwgKyAiP2ZpbHRlcnM9IiArIGZpbHRlclZhbHVlcy5qb2luKCIsIikKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnREZXRhaWxzVGFibGUgPSAkKCcjYWxlcnRzRGV0YWlsc1RhYmxlJykuRGF0YVRhYmxlKCk7CiAgICAgICAgICAgICAgICAgICAgdXJsID0gbGlzdENvbmZpZ1VybCArICImZnJlcXVlbmN5PSIgKyBmcmVxU2VsZWN0ZWQgKyAiJmlzRmlsdGVyUmVxdWVzdD10cnVlJmZpbHRlcnM9IiArIGVuY29kZVVSSShKU09OLnN0cmluZ2lmeShmaWx0ZXJWYWx1ZXMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGFsZXJ0RGV0YWlsc1RhYmxlLmFqYXgudXJsKHVybCkubG9hZCgpCiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgIH07CgogICAgdmFyIGlzQWxlcnRQZXJzaXN0ZWRJblNlc3Npb25TdG9yYWdlID0gZnVuY3Rpb24gKHByZWZpeCkgewogICAgICAgIHZhciBjID0gc2lnbmFsLnV0aWxzLmdldFF1ZXJ5U3RyaW5nKCJjb25maWdJZCIpOwogICAgICAgIHJldHVybiBjID8gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShwcmVmaXggKyAiaWQiKSA9PSBjIDogZmFsc2UKICAgIH07CgogICAgdmFyIHJlbW92ZUZpbHRlcnNGcm9tU2Vzc2lvblN0b3JhZ2UgPSBmdW5jdGlvbiAocHJlZml4KSB7CiAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShwcmVmaXggKyAiZmlsdGVyc19zdG9yZSIpOwogICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0ocHJlZml4ICsgImZpbHRlcnNfdmFsdWUiKTsKICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKHByZWZpeCArICJpZCIpOwogICAgfTsKCiAgICB2YXIgb3BlblNhdmVWaWV3TW9kYWwgPSBmdW5jdGlvbiAoZmlsdGVySW5kZXgsIGFwcGxpY2F0aW9uTmFtZSwgdmlld0lkKSB7CiAgICAgICAgdmFyIHN5c3RlbURlZmF1bHQgPSBbIlN5c3RlbSBWaWV3Il07CiAgICAgICAgdmFyIHZpZXdJbmZvOwoKICAgICAgICAvL3NhdmluZyBuZXcgdmlldwogICAgICAgICQoIi5zYXZlVmlldyIpLnVuYmluZCgnY2xpY2snKTsKICAgICAgICAkKCcuc2F2ZVZpZXcnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdTaGFyZWRXaXRoJykuZW1wdHkoKTsKCiAgICAgICAgICAgICQoIiNzYXZlLXZpZXctbW9kYWwgICNzYXZlRGl2Iikuc2hvdygpOwogICAgICAgICAgICAkKCIjc2F2ZS12aWV3LW1vZGFsICAjZWRpdERpdiIpLmhpZGUoKTsKICAgICAgICAgICAgdmlld0luZm8gPSBnZW5lcmF0ZVZpZXdJbmZvKGZpbHRlckluZGV4KTsKCiAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfZmlsdGVycycpLnZhbChKU09OLnN0cmluZ2lmeSh2aWV3SW5mby5maWx0ZXJNYXApKTsKICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCAjdmlld19jb2x1bW5MaXN0JykudmFsKHZpZXdJbmZvLm5vdFZpc2libGVDb2x1bW4pOwogICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsICN2aWV3X2FsZXJ0VHlwZScpLnZhbChhcHBsaWNhdGlvbk5hbWUpOwogICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsICN2aWV3X3NvcnRpbmcnKS52YWwoSlNPTi5zdHJpbmdpZnkodmlld0luZm8uc29ydGVkQ29sdW1uKSk7CiAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfYWR2YW5jZWRfZmlsdGVyJykudmFsKHZpZXdJbmZvLmFkdmFuY2VkRmlsdGVyKTsKICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCAjY3VycmVudF92aWV3X2lkJykudmFsKHZpZXdJZCk7CiAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgLnNhdmVfYnV0dG9ucycpLnNob3coKTsKICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCcpLm1vZGFsKCdzaG93Jyk7CiAgICAgICAgfSkKCiAgICAgICAgLy91cGRhdGluZyBleGlzdGluZyB2aWV3CiAgICAgICAgJCgiLnVwZGF0ZVZpZXciKS51bmJpbmQoJ2NsaWNrJyk7CiAgICAgICAgJCgnLnVwZGF0ZVZpZXcnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZpZXdJbmZvID0gZ2VuZXJhdGVWaWV3SW5mbyhmaWx0ZXJJbmRleCk7CiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoJCgnLnZpZXdTZWxlY3QgOnNlbGVjdGVkJykudGV4dCgpLnJlcGxhY2UoIihkZWZhdWx0KSIsICIiKS50cmltKCksIHN5c3RlbURlZmF1bHQpICE9IC0xKSB7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsICN2aWV3X2ZpbHRlcnMnKS52YWwoSlNPTi5zdHJpbmdpZnkodmlld0luZm8uZmlsdGVyTWFwKSk7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsICN2aWV3X2NvbHVtbkxpc3QnKS52YWwodmlld0luZm8ubm90VmlzaWJsZUNvbHVtbik7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsICN2aWV3X2FsZXJ0VHlwZScpLnZhbChhcHBsaWNhdGlvbk5hbWUpOwogICAgICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCAjdmlld19zb3J0aW5nJykudmFsKEpTT04uc3RyaW5naWZ5KHZpZXdJbmZvLnNvcnRlZENvbHVtbikpOwogICAgICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCAjdmlld19hZHZhbmNlZF9maWx0ZXInKS52YWwodmlld0luZm8uYWR2YW5jZWRGaWx0ZXIpOwogICAgICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCAjY3VycmVudF92aWV3X2lkJykudmFsKHZpZXdJZCk7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsIC5zYXZlX2J1dHRvbnMnKS5zaG93KCk7CiAgICAgICAgICAgICAgICAkKCIjc2F2ZS12aWV3LW1vZGFsICAjc2F2ZURpdiIpLnNob3coKTsKICAgICAgICAgICAgICAgICQoIiNzYXZlLXZpZXctbW9kYWwgICNlZGl0RGl2IikuaGlkZSgpOwogICAgICAgICAgICAgICAgJCgnI3NhdmUtdmlldy1tb2RhbCcpLm1vZGFsKCdzaG93Jyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoaXNWaWV3VXBkYXRlQWxsb3dlZCA9PSAndHJ1ZScpIHsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVFeGlzdGluZ1ZpZXcodmlld0luZm8pCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJvb3Rib3guY29uZmlybSh7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICQuaTE4bi5fKCdkZWZhdWx0Vmlld1VwZGF0ZU9ubHknKSwKICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQ29udGludWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2J0bi1zdWNjZXNzJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQ2FuY2VsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdidG4tZGFuZ2VyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRXhpc3RpbmdWaWV3KHZpZXdJbmZvKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy9zZWxlY3RpbmcgYW5vdGhlciB2aWV3CiAgICAgICAgJCgnLnZpZXdTZWxlY3QnKS51bmJpbmQoJ2NsaWNrJyk7CiAgICAgICAgJCgnLnZpZXdTZWxlY3QnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcGFnZVVSTCA9ICQobG9jYXRpb24pLmF0dHIoImhyZWYiKTsKICAgICAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9ICQoJy52aWV3U2VsZWN0JykudmFsKCk7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2lzVmlld0NhbGwnLCAndHJ1ZScpOwogICAgICAgICAgICBpZiAocGFnZVVSTC5pbmRleE9mKCJ2aWV3SWQiKSAhPSAtMSkgewogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBwYWdlVVJMLnNsaWNlKDAsIHBhZ2VVUkwuaW5kZXhPZigidmlld0lkIikgKyA3KSArIHNlbGVjdGVkVmlldwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHBhZ2VVUkwuaW5kZXhPZigiIyIpICE9IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgcGFnZVVSTCA9IHBhZ2VVUkwuc2xpY2UoMCwgcGFnZVVSTC5pbmRleE9mKCIjIikpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHBhZ2VVUkwgKyAiJnZpZXdJZD0iICsgc2VsZWN0ZWRWaWV3CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy9kZWxldGluZyBvciBlZGl0aW5nIHNlbGVjdGVkIHZpZXcKICAgICAgICAkKCcuZWRpdFZpZXcnKS51bmJpbmQoJ2NsaWNrJyk7CiAgICAgICAgJCgnLmVkaXRWaWV3Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewoKICAgICAgICAgICAgJCgiI3NhdmUtdmlldy1tb2RhbCAgI3NhdmVEaXYiKS5oaWRlKCk7CiAgICAgICAgICAgICQoIiNzYXZlLXZpZXctbW9kYWwgICNlZGl0RGl2Iikuc2hvdygpOwogICAgICAgICAgICB2aWV3SW5mbyA9IGdlbmVyYXRlVmlld0luZm8oZmlsdGVySW5kZXgpOwoKICAgICAgICAgICAgaWYgKCQuaW5BcnJheSgkKCcudmlld1NlbGVjdCA6c2VsZWN0ZWQnKS50ZXh0KCkucmVwbGFjZSgiKGRlZmF1bHQpIiwgIiIpLnRyaW0oKSwgc3lzdGVtRGVmYXVsdCkgPT0gLTEpIHsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfbmFtZScpLnZhbCgkKCcudmlld1NlbGVjdCA6c2VsZWN0ZWQnKS50ZXh0KCkucmVwbGFjZSgiKGRlZmF1bHQpIiwgIiIpKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfbmFtZScpLnZhbCgkKCcudmlld1NlbGVjdCA6c2VsZWN0ZWQnKS50ZXh0KCkucmVwbGFjZSgiKFMpIiwgIiIpKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfZGVmYXVsdCcpLnByb3AoJ2NoZWNrZWQnLCAoJCgnLnZpZXdTZWxlY3QgOnNlbGVjdGVkJykudGV4dCgpLmluZGV4T2YoIihkZWZhdWx0KSIpICE9IC0xKSk7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsICN2aWV3X2lkJykudmFsKCQoJy52aWV3U2VsZWN0IDpzZWxlY3RlZCcpLnZhbCgpKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfZmlsdGVycycpLnZhbChKU09OLnN0cmluZ2lmeSh2aWV3SW5mby5maWx0ZXJNYXApKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfY29sdW1uTGlzdCcpLnZhbCh2aWV3SW5mby5ub3RWaXNpYmxlQ29sdW1uKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfc29ydGluZycpLnZhbChKU09OLnN0cmluZ2lmeSh2aWV3SW5mby5zb3J0ZWRDb2x1bW4pKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfYWR2YW5jZWRfZmlsdGVyJykudmFsKHZpZXdJbmZvLmFkdmFuY2VkRmlsdGVyKTsKICAgICAgICAgICAgICAgICQoJyNzYXZlLXZpZXctbW9kYWwgI3ZpZXdfYWxlcnRUeXBlJykudmFsKGFwcGxpY2F0aW9uTmFtZSk7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsIC5lZGl0X2J1dHRvbnMnKS5zaG93KCk7CiAgICAgICAgICAgICAgICAkKCcjc2F2ZS12aWV3LW1vZGFsJykubW9kYWwoJ3Nob3cnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICQoJyNhbGVydC12aWV3LW1vZGFsJykubW9kYWwoJ3Nob3cnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICB9OwoKICAgIHZhciBnZW5lcmF0ZVZpZXdJbmZvID0gZnVuY3Rpb24gKGZpbHRlckluZGV4KSB7CiAgICAgICAgdmFyIG9UYWJsZSA9ICQoJyNhbGVydHNEZXRhaWxzVGFibGUnKS5EYXRhVGFibGUoKTsKCiAgICAgICAgLy9nZW5lcmF0ZSBmaWx0ZXIgdmFsdWUgbWFwCiAgICAgICAgdmFyIGZpbHRlck1hcCA9IG5ldyBPYmplY3QoKTsKICAgICAgICAkLmVhY2goZmlsdGVySW5kZXgsIGZ1bmN0aW9uIChpZHgsIG9iaikgewogICAgICAgICAgICB2YXIgZmlsdGVyVmFsID0geWFkY2YuZXhHZXRDb2x1bW5GaWx0ZXJWYWwob1RhYmxlLCBvYmopOwogICAgICAgICAgICBpZiAoZmlsdGVyVmFsKSB7CiAgICAgICAgICAgICAgICBmaWx0ZXJNYXBbb2JqXSA9IGZpbHRlclZhbAogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vZ2VuZXJhdGUgY29sdW1ucyB2aXNpYmxlIGxpc3QKICAgICAgICB2YXIgbm90VmlzaWJsZUNvbHVtbiA9ICQoJyNjb2x1bW5JbmRleCcpLnZhbCgpOwoKICAgICAgICAvL2dlbmVyYXRlIHNvcnRpbmcgY29sdW1uIGluZm8KICAgICAgICB2YXIgc29ydGVkQ29sdW1uID0gbmV3IE9iamVjdCgpOwogICAgICAgIGlmICgkKCcjYWxlcnRzRGV0YWlsc1RhYmxlJykuZGF0YVRhYmxlKCkuZm5TZXR0aW5ncygpLmFhU29ydGluZ1swXSkgewogICAgICAgICAgICB2YXIgc29ydGVkQ29sID0gJCgnI2FsZXJ0c0RldGFpbHNUYWJsZScpLmRhdGFUYWJsZSgpLmZuU2V0dGluZ3MoKS5hYVNvcnRpbmdbMF1bMF07CiAgICAgICAgICAgIHZhciBjb2x1bW5OYW1lID0gJCgnI2FsZXJ0c0RldGFpbHNUYWJsZScpLmZpbmQoInRoIikuZXEoc29ydGVkQ29sKS5hdHRyKCJkYXRhLWZpZWxkIik7CiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7CiAgICAgICAgICAgIGNvbHVtblNlcS5ldmVyeShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgc2VxTmFtZSA9IGNvbHVtblNlcVtpbmRleF0ubmFtZTsKICAgICAgICAgICAgICAgIGlmIChjb2x1bW5OYW1lID09IHNlcU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICBzb3J0ZWRDb2wgPSBjb2x1bW5TZXFbaW5kZXhdLnNlcTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpbmRleCsrOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgc29ydGVkRGlyID0gJCgnI2FsZXJ0c0RldGFpbHNUYWJsZScpLmRhdGFUYWJsZSgpLmZuU2V0dGluZ3MoKS5hYVNvcnRpbmdbMF1bMV07CiAgICAgICAgICAgIHNvcnRlZENvbHVtbltzb3J0ZWRDb2xdID0gc29ydGVkRGlyOwogICAgICAgIH0KCiAgICAgICAgLy9nZW5lcmF0ZSBhZHZhbmNlZCBmaWx0ZXIgaW5mbwogICAgICAgIHZhciBhZHZhbmNlZEZpdGVySWQgPSAkKCcuYWR2YW5jZWQtZmlsdGVyLWRyb3Bkb3duJykudmFsKCk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgJ2ZpbHRlck1hcCc6IGZpbHRlck1hcCwKICAgICAgICAgICAgJ25vdFZpc2libGVDb2x1bW4nOiBub3RWaXNpYmxlQ29sdW1uLAogICAgICAgICAgICAnc29ydGVkQ29sdW1uJzogc29ydGVkQ29sdW1uLAogICAgICAgICAgICAnYWR2YW5jZWRGaWx0ZXInOiBhZHZhbmNlZEZpdGVySWQKICAgICAgICB9CiAgICB9OwoKICAgIHZhciBjcmVhdGVTb3J0aW5nTWFwID0gZnVuY3Rpb24gKGluZm9LZXksIHZpZXdOYW1lKSB7CiAgICAgICAgdmFyIHNvcnRpbmdNYXAgPSBbXTsKICAgICAgICB2YXIgc29ydGluZyA9IHt9OwogICAgICAgIHZhciBzZXNzaW9uU3RvcmVkVmFsOwogICAgICAgIGlmIChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHZpZXdOYW1lKSA9PSAkKCcudmlld1NlbGVjdCA6c2VsZWN0ZWQnKS50ZXh0KCkucmVwbGFjZSgiKGRlZmF1bHQpIiwgIiIpLnRyaW0oKSkgewogICAgICAgICAgICBzZXNzaW9uU3RvcmVkVmFsID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShpbmZvS2V5KTsKICAgICAgICB9CiAgICAgICAgaWYgKHNlc3Npb25TdG9yZWRWYWwpIHsKICAgICAgICAgICAgc29ydGluZyA9ICQucGFyc2VKU09OKHNlc3Npb25TdG9yZWRWYWwpOwogICAgICAgIH0gZWxzZSBpZiAoJCgiI3NvcnRlZENvbHVtbiIpLnZhbCgpICE9ICIiICYmICQoIiNzb3J0ZWRDb2x1bW4iKS52YWwoKSAhPSAie30iICYmIGNhbGxpbmdTY3JlZW4gPT0gJ3JldmlldycpIHsKICAgICAgICAgICAgc29ydGluZyA9ICQucGFyc2VKU09OKCQoJyNzb3J0ZWRDb2x1bW4nKS52YWwoKSk7CiAgICAgICAgfQogICAgICAgICQuZWFjaChzb3J0aW5nLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICBzb3J0aW5nTWFwLnB1c2goW3BhcnNlSW50KGtleSksIHZhbHVlXSkKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gc29ydGluZ01hcAogICAgfTsKCiAgICB2YXIgY3JlYXRlRmlsdGVyTWFwID0gZnVuY3Rpb24gKGluZm9LZXksIHZpZXdOYW1lKSB7CiAgICAgICAgdmFyIGZpbHRlcnNWYWx1ZSA9IFtdOwogICAgICAgIHZhciBmaWx0ZXJNYXAgPSB7fTsKICAgICAgICB2YXIgc2Vzc2lvblN0b3JlZFZhbDsKICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh2aWV3TmFtZSkgPT0gJCgnLnZpZXdTZWxlY3QgOnNlbGVjdGVkJykudGV4dCgpLnJlcGxhY2UoIihkZWZhdWx0KSIsICIiKS50cmltKCkpIHsKICAgICAgICAgICAgc2Vzc2lvblN0b3JlZFZhbCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oaW5mb0tleSk7CiAgICAgICAgfQogICAgICAgIGlmIChzZXNzaW9uU3RvcmVkVmFsICYmIHNlc3Npb25TdG9yZWRWYWwgIT0ge30pIHsKICAgICAgICAgICAgZmlsdGVyTWFwID0gJC5wYXJzZUpTT04oc2Vzc2lvblN0b3JlZFZhbCk7CiAgICAgICAgfSBlbHNlIGlmICgkKCcjZmlsdGVyTWFwJykudmFsKCkgIT0gIiIgJiYgJCgnI2ZpbHRlck1hcCcpLnZhbCgpICE9ICJ7fSIpIHsKICAgICAgICAgICAgZmlsdGVyTWFwID0gJC5wYXJzZUpTT04oJCgnI2ZpbHRlck1hcCcpLnZhbCgpKTsKICAgICAgICB9CiAgICAgICAgJC5lYWNoKGZpbHRlck1hcCwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgdmFyIGZpbHRlckFyciA9IFtwYXJzZUludChrZXkpLCB2YWx1ZV07CiAgICAgICAgICAgIGZpbHRlcnNWYWx1ZS5wdXNoKGZpbHRlckFycikKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZmlsdGVyc1ZhbHVlCiAgICB9OwoKICAgIHZhciBjcmVhdGVMaXN0T2ZJbmRleCA9IGZ1bmN0aW9uIChpbmZvS2V5LCBpc0V2ZGFzLCB2aWV3TmFtZSkgewogICAgICAgIHZhciBsb2kgPSBbXTsKICAgICAgICB2YXIgY29sdW1uSW5kZXggPSBbXQogICAgICAgIHZhciBzZXNzaW9uU3RvcmVkVmFsOwogICAgICAgIGlmIChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHZpZXdOYW1lKSA9PSAkKCcudmlld1NlbGVjdCA6c2VsZWN0ZWQnKS50ZXh0KCkucmVwbGFjZSgiKGRlZmF1bHQpIiwgIiIpLnRyaW0oKSkgewogICAgICAgICAgICBzZXNzaW9uU3RvcmVkVmFsID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShpbmZvS2V5KTsKICAgICAgICB9CiAgICAgICAgaWYgKGNhbGxpbmdTY3JlZW4gPT0gJ3JldmlldycpIHsKICAgICAgICAgICAgaWYgKHNlc3Npb25TdG9yZWRWYWwpIHsKICAgICAgICAgICAgICAgIGNvbHVtbkluZGV4ID0gc2Vzc2lvblN0b3JlZFZhbC5zcGxpdCgnLCcpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCA9ICQoJyNjb2x1bW5JbmRleCcpLnZhbCgpLnNwbGl0KCcsJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJC5lYWNoKGNvbHVtbkluZGV4LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNFdmRhcykgewogICAgICAgICAgICAgICAgICAgIGxvaS5wdXNoKHBhcnNlSW50KHRoaXMpKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsb2kucHVzaChwYXJzZUludCh0aGlzKSArIDEpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbG9pCiAgICB9OwoKICAgIHZhciBzZXRTb3J0T3JkZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgJCgiI2FsZXJ0c0RldGFpbHNUYWJsZVJvdyIpLm9uKCdtb3VzZWRvd24nLCAndGgnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGluZGV4ID0gJCh0aGlzKS5hdHRyKCJkYXRhLWNvbHVtbi1pbmRleCIpOwogICAgICAgICAgICBkaXIgPSAnYXNjJzsKICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ3NvcnRpbmdfYXNjJykpIHsKICAgICAgICAgICAgICAgIGRpciA9ICdkZXNjJwogICAgICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ3NvcnRpbmdfZGVzYycpKSB7CiAgICAgICAgICAgICAgICBkaXIgPSAnYXNjJwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlzVmlld0luc3RhbmNlID0gMDsKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIG9wZW5BbGVydFRhZ01vZGFsID0gZnVuY3Rpb24gKCkgewogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuZWRpdEFsZXJ0VGFncycsIGZ1bmN0aW9uIChldnQpIHsKICAgICAgICAgICAgdmFyIHBhcmVudF9yb3cgPSAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgndHInKTsKICAgICAgICAgICAgdmFyIGluZGV4ID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmluZGV4KCk7CiAgICAgICAgICAgIHZhciByb3dPYmplY3QgPSB0YWJsZS5yb3dzKGluZGV4KS5kYXRhKClbMF07CiAgICAgICAgICAgIHZhciBhbGVydElkID0gcm93T2JqZWN0LmlkOwogICAgICAgICAgICB2YXIgZXhlY0NvbmZpZ0lkID0gcGFyZW50X3Jvdy5maW5kKCcuZXhlY0NvbmZpZ0lkJykuYXR0cigidmFsdWUiKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDogZmV0Y2hUYWdzVXJsLAogICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgIGFsZXJ0SWQ6IGFsZXJ0SWQKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFsZXJ0VGFnTW9kYWxPYmogPSAkKCcjYWxlcnRUYWdNb2RhbCcpOwogICAgICAgICAgICAgICAgICAgIGFsZXJ0VGFnTW9kYWxPYmouZmluZCgnI3NpbmdsZUFsZXJ0VGFncycpLnNlbGVjdDIoewogICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogIkFkZCBDYXRlZ29yaWVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgbXVsdGlwbGU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdC50YWdMaXN0CgogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGFsZXJ0VGFnTW9kYWxPYmoubW9kYWwoJ3Nob3cnKTsKICAgICAgICAgICAgICAgICAgICBhbGVydFRhZ01vZGFsT2JqLmZpbmQoJyNzaW5nbGVBbGVydFRhZ3MnKS52YWwocmVzdWx0LmFsZXJ0VGFnTGlzdCk7CiAgICAgICAgICAgICAgICAgICAgYWxlcnRUYWdNb2RhbE9iai5maW5kKCcjc2luZ2xlQWxlcnRUYWdzJykudHJpZ2dlcignY2hhbmdlJyk7CiAgICAgICAgICAgICAgICAgICAgYWxlcnRUYWdNb2RhbE9iai5maW5kKCIuYWRkVGFncyIpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc2F2ZVRhZ1VybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydFRhZ3M6IEpTT04uc3RyaW5naWZ5KGFsZXJ0VGFnTW9kYWxPYmouZmluZCgnI3NpbmdsZUFsZXJ0VGFncycpLnZhbCgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydElkOiBhbGVydElkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWNDb25maWdJZDogZXhlY0NvbmZpZ0lkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5hamF4LnJlbG9hZCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIG9wZW5TaW5nbGVBbGVydFRhZ01vZGFsID0gZnVuY3Rpb24gKHRhYmxlT2JqLCB0YWdzT2JqKSB7CiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5lZGl0QWxlcnRUYWdzJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIHZhciBwYXJlbnRfcm93ID0gJChldmVudC50YXJnZXQpLmNsb3Nlc3QoJ3RyJyk7CiAgICAgICAgICAgIHZhciBpbmRleCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5pbmRleCgpOwogICAgICAgICAgICBpZiAoaXNBYnN0cmFjdFZpZXdPckNhc2VWaWV3KGluZGV4KSkgewogICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleCAvIDIKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgcm93T2JqZWN0ID0gdGFibGVPYmoucm93cyhpbmRleCkuZGF0YSgpWzBdOwogICAgICAgICAgICB2YXIgYWxlcnRJZCA9IHJvd09iamVjdC5pZDsKICAgICAgICAgICAgdmFyIGV4ZWNDb25maWdJZCA9IHBhcmVudF9yb3cuZmluZCgnLmV4ZWNDb25maWdJZCcpLmF0dHIoInZhbHVlIik7CiAgICAgICAgICAgIHZhciBhbGVydFRhZ01vZGFsT2JqID0gJCgnI2FsZXJ0VGFnTW9kYWwnKTsKICAgICAgICAgICAgdmFyICRzaW5nbGVDYXNlQWxlcnRUYWdzID0gYWxlcnRUYWdNb2RhbE9iai5maW5kKCcjc2luZ2xlQWxlcnRUYWdzJyk7CiAgICAgICAgICAgIHZhciAkZ2xvYmFsVGFncyA9IGFsZXJ0VGFnTW9kYWxPYmouZmluZCgnI2dsb2JhbFRhZ3MnKTsKICAgICAgICAgICAgYXBwbHlTZWxlY3QyRm9yVGFncygkc2luZ2xlQ2FzZUFsZXJ0VGFncywgZmV0Y2hUYWdzVXJsLCAnQ2FzZSBTZXJpZXMgQ2F0ZWdvcmllcycsIHRydWUpOwogICAgICAgICAgICBhcHBseVNlbGVjdDJGb3JUYWdzKCRnbG9iYWxUYWdzLCBmZXRjaFRhZ3NVcmwsICdHbG9iYWwgQ2F0ZWdvcmllcycsIGZhbHNlKTsKICAgICAgICAgICAgJHNpbmdsZUNhc2VBbGVydFRhZ3MuZmluZCgnb3B0aW9uJykucmVtb3ZlKCkKICAgICAgICAgICAgJGdsb2JhbFRhZ3MuZmluZCgnb3B0aW9uJykucmVtb3ZlKCkKICAgICAgICAgICAgJHNpbmdsZUNhc2VBbGVydFRhZ3MudmFsKG51bGwpLnRyaWdnZXIoImNoYW5nZSIpOwogICAgICAgICAgICAkZ2xvYmFsVGFncy52YWwobnVsbCkudHJpZ2dlcigiY2hhbmdlIik7CiAgICAgICAgICAgICQuZWFjaChyb3dPYmplY3QuY2FzZVNlcmllc1RhZ3MsIGZ1bmN0aW9uIChpbmRleCwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSBuZXcgT3B0aW9uKHZhbHVlLCB2YWx1ZSwgdHJ1ZSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAkc2luZ2xlQ2FzZUFsZXJ0VGFncy5hcHBlbmQob3B0aW9uKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQuZWFjaChyb3dPYmplY3QuZ2xvYmFsVGFncywgZnVuY3Rpb24gKGluZGV4LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IG5ldyBPcHRpb24odmFsdWUsIHZhbHVlLCB0cnVlLCB0cnVlKTsKICAgICAgICAgICAgICAgICRnbG9iYWxUYWdzLmFwcGVuZChvcHRpb24pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYWxlcnRUYWdNb2RhbE9iai5maW5kKCcjc2luZ2xlQWxlcnRUYWdzJykudHJpZ2dlcignY2hhbmdlJyk7CiAgICAgICAgICAgIGFsZXJ0VGFnTW9kYWxPYmouZmluZCgnI2dsb2JhbFRhZ3MnKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICAgICAgdmFyIGVuYWJsZUNhc2VTZXJpZXNUYWdzID0gcm93T2JqZWN0LmlzQ2FzZVNlcmllc0dlbmVyYXRlZDsKICAgICAgICAgICAgaWYgKCFlbmFibGVDYXNlU2VyaWVzVGFncykgewogICAgICAgICAgICAgICAgYWxlcnRUYWdNb2RhbE9iai5maW5kKCcjc2luZ2xlQWxlcnRUYWdzJykuYXR0cignZGlzYWJsZWQnLCAnJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWxlcnRUYWdNb2RhbE9iai5tb2RhbCgnc2hvdycpOwogICAgICAgICAgICBhbGVydFRhZ01vZGFsT2JqLmZpbmQoIi5hZGRUYWdzIikudW5iaW5kKCkuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICB1cmw6IHNhdmVUYWdVcmwsCiAgICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydFRhZ3M6IEpTT04uc3RyaW5naWZ5KGFsZXJ0VGFnTW9kYWxPYmouZmluZCgnI3NpbmdsZUFsZXJ0VGFncycpLnZhbCgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsVGFnczogSlNPTi5zdHJpbmdpZnkoYWxlcnRUYWdNb2RhbE9iai5maW5kKCcjZ2xvYmFsVGFncycpLnZhbCgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlZENhc2VTZXJpZXNUYWdzOiBKU09OLnN0cmluZ2lmeSh0YWdzT2JqLmRlbGV0ZWRDYXNlU2VyaWVzVGFncyksCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZWRHbG9iYWxUYWdzOiBKU09OLnN0cmluZ2lmeSh0YWdzT2JqLmRlbGV0ZWRHbG9iYWxUYWdzKSwKICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWRDYXNlU2VyaWVzVGFnczogSlNPTi5zdHJpbmdpZnkodGFnc09iai5hZGRlZENhc2VTZXJpZXNUYWdzKSwKICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWRHbG9iYWxUYWdzOiBKU09OLnN0cmluZ2lmeSh0YWdzT2JqLmFkZGVkR2xvYmFsVGFncyksCiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0SWQ6IGFsZXJ0SWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWNDb25maWdJZDogZXhlY0NvbmZpZ0lkCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChwYXlsb2FkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLnN0YXR1cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVPYmouYWpheC5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuTm90aWZpY2F0aW9uLm5vdGlmeSgnc3VjY2VzcycsICd0b3AgcmlnaHQnLCAiU3VjY2VzcyIsIHBheWxvYWQubWVzc2FnZSwge2F1dG9IaWRlRGVsYXk6IDIwMDB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuTm90aWZpY2F0aW9uLm5vdGlmeSgnZXJyb3InLCAndG9wIHJpZ2h0JywgIkVycm9yIiwgcGF5bG9hZC5tZXNzYWdlLCB7YXV0b0hpZGVEZWxheTogMjAwMH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNzaW5nbGUtY2FzZS1hbGVydC1zcGlubmVyJykuYWRkQ2xhc3MoJ2hpZGRlbicpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgJCgnI3NpbmdsZS1jYXNlLWFsZXJ0LXNwaW5uZXInKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgcG9wdWxhdGVBZHZhbmNlZEZpbHRlclNlbGVjdCA9IGZ1bmN0aW9uIChhbGVydFR5cGUpIHsKCiAgICAgICAgJCgiLmFkdmFuY2VkLWZpbHRlci1kcm9wZG93biIpLnNlbGVjdDIoewogICAgICAgICAgICBwbGFjZWhvbGRlcjogJC5pMThuLl8oJ3NlbGVjdE9uZScpLAogICAgICAgICAgICBhbGxvd0NsZWFyOiB0cnVlLAogICAgICAgICAgICBhamF4OiB7CiAgICAgICAgICAgICAgICB1cmw6IGZldGNoQWR2RmlsdGVyVXJsLAogICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAgICAgcXVpZXRNaWxsaXM6IDUwLAogICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24gKHBhcmFtcykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0VHlwZTogYWxlcnRUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXJtOiBwYXJhbXMudGVybSB8fCAnJywKICAgICAgICAgICAgICAgICAgICAgICAgcGFnZTogcGFyYW1zLnBhZ2UgfHwgMSwKICAgICAgICAgICAgICAgICAgICAgICAgbWF4OiBwYXJhbXMubWF4IHx8IDMwLAogICAgICAgICAgICAgICAgICAgICAgICBjYWxsaW5nU2NyZWVuOiBjYWxsaW5nU2NyZWVuCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBwcm9jZXNzUmVzdWx0czogZnVuY3Rpb24gKGRhdGEsIHBhcmFtcykgewogICAgICAgICAgICAgICAgICAgIHBhcmFtcy5wYWdlID0gcGFyYW1zLnBhZ2UgfHwgMTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzOiAkLm1hcChkYXRhLmxpc3QsIGZ1bmN0aW9uIChmaWx0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZmlsdGVyLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGZpbHRlci5pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9yZTogKHBhcmFtcy5wYWdlICogMzApIDwgZGF0YS50b3RhbENvdW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vc2VsZWN0IGFkdmFuY2VkIGZpbHRlciBiYXNlZCBvbiBjdXJyZW50IHZpZXcKICAgICAgICBpZiAoJCgnI2FkdmFuY2VkRmlsdGVyVmlldycpLnZhbCgpKSB7CiAgICAgICAgICAgIHZhciBhZHZhbmNlZEZpbHRlclZpZXcgPSAkLnBhcnNlSlNPTigkKCcjYWR2YW5jZWRGaWx0ZXJWaWV3JykudmFsKCkpOwogICAgICAgICAgICB2YXIgb3B0aW9uID0gbmV3IE9wdGlvbihhZHZhbmNlZEZpbHRlclZpZXcubmFtZSwgYWR2YW5jZWRGaWx0ZXJWaWV3LmlkLCB0cnVlLCB0cnVlKTsKICAgICAgICAgICAgJCgiLmFkdmFuY2VkLWZpbHRlci1kcm9wZG93biIpLmFwcGVuZChvcHRpb24pLnRyaWdnZXIoJ2NoYW5nZScpOwogICAgICAgIH0KCiAgICAgICAgJCgnI2FkZEFkdmFuY2VkRmlsdGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzaWduYWwuYWR2YW5jZWRGaWx0ZXIuaW5pdGlhbGl6ZUFkdmFuY2VkRmlsdGVycygkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCcpKTsKICAgICAgICAgICAgJCgnI2NyZWF0ZUFkdmFuY2VkRmlsdGVyTW9kYWwgI3NlbGVjdE9wZXJhdG9yJykuZW1wdHkoKS5hcHBlbmQoJzxvcHRpb24gc2VsZWN0ZWQ9InNlbGVjdGVkIiB2YWx1ZT0iIj5TZWxlY3QgT3BlcmF0b3I8L29wdGlvbj4nKTsKICAgICAgICAgICAgJCgnI2NyZWF0ZUFkdmFuY2VkRmlsdGVyTW9kYWwgI25hbWUnKS52YWwoJycpLmF0dHIoImRpc2FibGVkIiwgZmFsc2UpOwogICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjZGVzY3JpcHRpb24nKS52YWwoJycpOwogICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjcXVlcnlKU09OJykudmFsKCcnKTsKICAgICAgICAgICAgJCgnI2NyZWF0ZUFkdmFuY2VkRmlsdGVyTW9kYWwgI2FsZXJ0VHlwZScpLnZhbCgnJyk7CiAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsICNhZHZhbmNlZEZpbHRlclNoYXJlZFdpdGgnKS5lbXB0eSgpOwogICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjYnVpbGRlckFsbCcpLmZpbmQoJy5leHByZXNzaW9uJykucmVtb3ZlKCk7CiAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5kZWxldGVBZHZGaWx0ZXInKS5hZGRDbGFzcygnaGlkZScpOwogICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAuZGVsZXRlQWR2RmlsdGVyJykuYXR0cigiZGlzYWJsZWQiLCBmYWxzZSk7CiAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsICNhZGRFeHByZXNzaW9uJykuYXR0cigiZGlzYWJsZWQiLCBmYWxzZSk7CiAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5maWx0ZXJzV2l0aG91dFNhdmluZycpLnJlbW92ZUNsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5zYXZlQWR2YW5jZWRGaWx0ZXJzJykuYXR0cigiZGlzYWJsZWQiLCBmYWxzZSk7CiAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsJykubW9kYWwoJ3Nob3cnKTsKCiAgICAgICAgfSk7CgogICAgICAgICQoJyNlZGl0QWR2YW5jZWRGaWx0ZXInKS51bmJpbmQoKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBhZHZhbmNlZEZpbHRlcklkID0gJCgnLmFkdmFuY2VkLWZpbHRlci1kcm9wZG93bicpLnZhbCgpOwogICAgICAgICAgICBpZiAoYWR2YW5jZWRGaWx0ZXJJZCkgewogICAgICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgICAgICB1cmw6IGZldGNoQWR2YW5jZWRGaWx0ZXJJbmZvVXJsLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IHsnYWR2YW5jZWRGaWx0ZXIuaWQnOiBhZHZhbmNlZEZpbHRlcklkfSwKICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzRGlzYWJsZWQgPSAocmVzdWx0LmlzRmlsdGVyVXBkYXRlQWxsb3dlZCA9PSB0cnVlKSA/IGZhbHNlIDogdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjc2VsZWN0T3BlcmF0b3InKS5lbXB0eSgpLmFwcGVuZCgnPG9wdGlvbiBzZWxlY3RlZD0ic2VsZWN0ZWQiIHZhbHVlPSIiPlNlbGVjdCBPcGVyYXRvcjwvb3B0aW9uPicpOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjbmFtZScpLnZhbChyZXN1bHQubmFtZSkuYXR0cigiZGlzYWJsZWQiLCBpc0Rpc2FibGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2NyZWF0ZUFkdmFuY2VkRmlsdGVyTW9kYWwgI25hbWUnKS52YWwocmVzdWx0Lm5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjZGVzY3JpcHRpb24nKS52YWwocmVzdWx0LmRlc2NyaXB0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2NyZWF0ZUFkdmFuY2VkRmlsdGVyTW9kYWwgI3F1ZXJ5SlNPTicpLnZhbChyZXN1bHQuSlNPTlF1ZXJ5KTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2NyZWF0ZUFkdmFuY2VkRmlsdGVyTW9kYWwgI2FsZXJ0VHlwZScpLnZhbChhbGVydFR5cGUpOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjZmlsdGVySWQnKS52YWwoYWR2YW5jZWRGaWx0ZXJJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsICNzaGFyZUFkdkZpbHRlcklkJykuaHRtbChyZXN1bHQuc2hhcmVXaXRoRWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5maWx0ZXJzV2l0aG91dFNhdmluZycpLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5kZWxldGVBZHZGaWx0ZXInKS5yZW1vdmVDbGFzcygnaGlkZScpOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAjYWRkRXhwcmVzc2lvbicpLmF0dHIoImRpc2FibGVkIiwgaXNEaXNhYmxlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5kZWxldGVBZHZGaWx0ZXInKS5hdHRyKCJkaXNhYmxlZCIsIGlzRGlzYWJsZWQpOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjY3JlYXRlQWR2YW5jZWRGaWx0ZXJNb2RhbCAuc2F2ZUFkdmFuY2VkRmlsdGVycycpLmF0dHIoImRpc2FibGVkIiwgaXNEaXNhYmxlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsIC5tb2RhbC10aXRsZScpLmh0bWwoIkVkaXQgRmlsdGVyIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbC5hZHZhbmNlZEZpbHRlci5pbml0aWFsaXplQWR2YW5jZWRGaWx0ZXJzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNjcmVhdGVBZHZhbmNlZEZpbHRlck1vZGFsJykubW9kYWwoJ3Nob3cnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAkKCIuYWR2YW5jZWQtZmlsdGVyLWRyb3Bkb3duIikub24oImNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHRhYmxlLmFqYXgucmVsb2FkKCkKICAgICAgICB9KTsKICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgICBvcGVuQWxlcnRDb21tZW50TW9kYWw6IG9wZW5BbGVydENvbW1lbnRNb2RhbCwKICAgICAgICBvcGVuQ2FzZUhpc3RvcnlNb2RhbDogb3BlbkNhc2VIaXN0b3J5TW9kYWwsCiAgICAgICAgcmVzdGFydFJldmlldzogcmVzdGFydFJldmlldywKICAgICAgICBvcGVuU2ltaWxhckNhc2VzTW9kYWw6IG9wZW5TaW1pbGFyQ2FzZXNNb2RhbCwKICAgICAgICBhcHBseUJ1c2luZXNzUnVsZXM6IGFwcGx5QnVzaW5lc3NSdWxlcywKICAgICAgICBzaG93QXR0YWNobWVudE1vZGFsOiBvcGVuQXR0YWNobWVudE1vZGFsLAogICAgICAgIGJpbmRHcmlkRHluYW1pY0ZpbHRlcnM6IGJpbmRHcmlkRHluYW1pY0ZpbHRlcnMsCiAgICAgICAgZW5hYmxlTWVudVRvb2x0aXBzOiBlbmFibGVNZW51VG9vbHRpcHMsCiAgICAgICAgZGlzYWJsZVRvb2x0aXBzOiBkaXNhYmxlVG9vbHRpcHMsCiAgICAgICAgc29ydEljb25IYW5kbGVyOiBzb3J0SWNvbkhhbmRsZXIsCiAgICAgICAgaXNBbGVydFBlcnNpc3RlZEluU2Vzc2lvblN0b3JhZ2U6IGlzQWxlcnRQZXJzaXN0ZWRJblNlc3Npb25TdG9yYWdlLAogICAgICAgIHJlbW92ZUZpbHRlcnNGcm9tU2Vzc2lvblN0b3JhZ2U6IHJlbW92ZUZpbHRlcnNGcm9tU2Vzc2lvblN0b3JhZ2UsCiAgICAgICAgb3BlblNhdmVWaWV3TW9kYWw6IG9wZW5TYXZlVmlld01vZGFsLAogICAgICAgIGNyZWF0ZVNvcnRpbmdNYXA6IGNyZWF0ZVNvcnRpbmdNYXAsCiAgICAgICAgY3JlYXRlRmlsdGVyTWFwOiBjcmVhdGVGaWx0ZXJNYXAsCiAgICAgICAgY3JlYXRlTGlzdE9mSW5kZXg6IGNyZWF0ZUxpc3RPZkluZGV4LAogICAgICAgIG9wZW5BbGVydFRhZ01vZGFsOiBvcGVuQWxlcnRUYWdNb2RhbCwKICAgICAgICBzZXRTb3J0T3JkZXI6IHNldFNvcnRPcmRlciwKICAgICAgICBvcGVuU2luZ2xlQWxlcnRUYWdNb2RhbDogb3BlblNpbmdsZUFsZXJ0VGFnTW9kYWwsCiAgICAgICAgZ2VuZXJhdGVWaWV3SW5mbzogZ2VuZXJhdGVWaWV3SW5mbywKICAgICAgICBwb3B1bGF0ZUFkdmFuY2VkRmlsdGVyU2VsZWN0OiBwb3B1bGF0ZUFkdmFuY2VkRmlsdGVyU2VsZWN0CiAgICB9Cgp9KSgpOwoKZnVuY3Rpb24gc2hvd0Vycm9yTWVzc2FnZUluTW9kYWwoJG1vZGFsLCB0ZXh0KSB7CiAgICBjbGVhcl9lcnJvcnMoKTsKICAgIGlmICh0ZXh0KSB7CiAgICAgICAgdGV4dCA9IHRleHQ7CiAgICB9IGVsc2UgewogICAgICAgIHRleHQgPSAnUGxlYXNlIGZpbGwgIHRoZSByZXF1aXJlZCBGaWVsZHMnOwogICAgfQogICAgdmFyIGFsZXJ0SHRtbCA9IGdldEVycm9yTWVzc2FnZUh0bWwodGV4dCk7CiAgICAkbW9kYWwuZmluZCgnLm1vZGFsLWJvZHknKS5wcmVwZW5kKGFsZXJ0SHRtbCk7Cn0KCmZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZUh0bWwobXNnKSB7CiAgICB2YXIgYWxlcnRIdG1sID0gJzxkaXYgY2xhc3M9ImFsZXJ0IGFsZXJ0LWRhbmdlciBhbGVydC1kaXNtaXNzaWJsZSIgcm9sZT0iYWxlcnQiPiAnICsKICAgICAgICAnPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJjbG9zZSIgZGF0YS1kaXNtaXNzPSJhbGVydCI+ICcgKwogICAgICAgICc8c3BhbiBhcmlhLWhpZGRlbj0idHJ1ZSI+JnRpbWVzOzwvc3Bhbj4gJyArCiAgICAgICAgJzxzcGFuIGNsYXNzPSJzci1vbmx5Ij48ZzptZXNzYWdlIGNvZGU9ImRlZmF1bHQuYnV0dG9uLmNsb3NlLmxhYmVsIiAvPjwvc3Bhbj4gJyArCiAgICAgICAgJzwvYnV0dG9uPiAnICsgbXNnOwogICAgJzwvZGl2Pic7CiAgICByZXR1cm4gYWxlcnRIdG1sOwp9Cgp2YXIgY2xlYXJfZXJyb3JzID0gZnVuY3Rpb24gKCkgewogICAgJCgnLm1vZGFsIC5tb2RhbC1ib2R5IC5hbGVydCcpLnJlbW92ZSgpOwp9OwoKZnVuY3Rpb24gc2VhcmNoKG5hbWVLZXksIG15QXJyYXkpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbXlBcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChteUFycmF5W2ldLm5hbWUgPT09IG5hbWVLZXkpIHsKICAgICAgICAgICAgcmV0dXJuIG15QXJyYXlbaV07CiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBwb3B1bGF0ZVRvcGljRGV0YWlsKCRtb2RhbCwgdG9waWNPYmopIHsKICAgICRtb2RhbC5maW5kKCcjc3RhcnREYXRlJykudmFsKHRvcGljT2JqLnN0YXJ0RGF0ZSk7CiAgICAkbW9kYWwuZmluZCgnI2VuZERhdGUnKS52YWwodG9waWNPYmouZW5kRGF0ZSk7CiAgICAkbW9kYWwuZmluZCgnLnByb2R1Y3Qtc3BhbicpLnRleHQoZ2V0UHJvZHVjdE5hbWVMaXN0KEpTT04ucGFyc2UodG9waWNPYmoucHJvZHVjdHMpKSk7CiAgICAkbW9kYWwuZmluZCgnI3N0YXJ0RGF0ZScpLmF0dHIoImRpc2FibGVkIiwgIiIpOwogICAgJG1vZGFsLmZpbmQoJyNlbmREYXRlJykuYXR0cigiZGlzYWJsZWQiLCAiIik7CiAgICBpZiAodG9waWNPYmoucHJvZHVjdHMpIHsKICAgICAgICAkbW9kYWwuZmluZCgnI3Byb2R1Y3QnKS5hdHRyKCJkaXNhYmxlZCIsICIiKTsKICAgIH0KfQoKZnVuY3Rpb24gZGVwb3B1bGF0ZVRvcGljRGV0YWlsKCRtb2RhbCkgewogICAgdmFyIHByb2R1Y3RKc29uID0gJG1vZGFsLmZpbmQoJy5wcm9kdWN0LWpzb24tY29udGFpbmVyJykudmFsKCk7CiAgICAkbW9kYWwuZmluZCgnI3N0YXJ0RGF0ZScpLnZhbCgiIik7CiAgICAkbW9kYWwuZmluZCgnI2VuZERhdGUnKS52YWwoIiIpOwogICAgJG1vZGFsLmZpbmQoJyNwcm9kdWN0JykudmFsKCIiKTsKICAgICRtb2RhbC5maW5kKCcucHJvZHVjdC1zcGFuJykudGV4dChnZXRQcm9kdWN0TmFtZUxpc3QoSlNPTi5wYXJzZShwcm9kdWN0SnNvbikpKTsKICAgICRtb2RhbC5maW5kKCcjc3RhcnREYXRlJykucmVtb3ZlQXR0cigiZGlzYWJsZWQiKTsKICAgICRtb2RhbC5maW5kKCcjZW5kRGF0ZScpLnJlbW92ZUF0dHIoImRpc2FibGVkIik7CiAgICAkbW9kYWwuZmluZCgnI3Byb2R1Y3QnKS5yZW1vdmVBdHRyKCJkaXNhYmxlZCIpOwp9CgpmdW5jdGlvbiBnZW5lcmF0ZVByb2R1Y3RKc29uKHByb2R1Y3RJZCwgcHJvZHVjdE5hbWUsIGxldmVsKSB7CiAgICB2YXIgdG9waWNQcm9kdWN0VmFsdWVzID0geyIxIjogW10sICIyIjogW10sICIzIjogW10sICI0IjogW10sICI1IjogW119OwogICAgdG9waWNQcm9kdWN0VmFsdWVzW2xldmVsXS5wdXNoKHtuYW1lOiBwcm9kdWN0TmFtZSwgaWQ6IHByb2R1Y3RJZH0pOwogICAgcmV0dXJuIHRvcGljUHJvZHVjdFZhbHVlczsKfQoKZnVuY3Rpb24gZ2V0UHJvZHVjdE5hbWVMaXN0KG9iaikgewogICAgdmFyIHByb2R1Y3RBcnJheSA9IFtdOwogICAgdmFyIG9iakFycmF5ID0gb2JqWyczJ107CiAgICAkLmVhY2gob2JqQXJyYXksIGZ1bmN0aW9uIChpbmRleCwgdmFsdWUpIHsKICAgICAgICBwcm9kdWN0QXJyYXkucHVzaCh2YWx1ZS5uYW1lKTsKICAgIH0pOwogICAgcmV0dXJuIHByb2R1Y3RBcnJheS5qb2luKCcsJyk7Cn0KCmZ1bmN0aW9uIGdldFByb2R1Y3RKc29uKGFwcGxpY2F0aW9uTmFtZSwgcm93KSB7CiAgICB2YXIgcHJvZHVjdEpzb247CiAgICBpZiAoYXBwbGljYXRpb25OYW1lID09ICJBZC1Ib2MgQWxlcnQiKSB7CiAgICAgICAgaWYgKHJvdy5maW5kKCcucm93LXByb2R1Y3QtanNvbi1jb250YWluZXInKS52YWwoKSkKICAgICAgICAgICAgcHJvZHVjdEpzb24gPSBKU09OLnBhcnNlKHJvdy5maW5kKCcucm93LXByb2R1Y3QtanNvbi1jb250YWluZXInKS52YWwoKSk7CiAgICB9IGVsc2UgewogICAgICAgIHZhciBwcm9kdWN0TmFtZSA9IHJvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9InByb2R1Y3ROYW1lIl0nKS5hdHRyKCJkYXRhLWlkIik7CiAgICAgICAgdmFyIHByb2R1Y3RJZCA9IHJvdy5maW5kKCcucm93LXByb2R1Y3QtaWQnKS52YWwoKTsKICAgICAgICB2YXIgbGV2ZWwgPSByb3cuZmluZCgnLnJvdy1sZXZlbC1pZCcpLnZhbCgpOwogICAgICAgIGlmICghbGV2ZWwpIHsKICAgICAgICAgICAgbGV2ZWwgPSAzOwogICAgICAgIH0KICAgICAgICBwcm9kdWN0SnNvbiA9IGdlbmVyYXRlUHJvZHVjdEpzb24ocHJvZHVjdElkLCBwcm9kdWN0TmFtZSwgbGV2ZWwpOwogICAgfQogICAgcmV0dXJuIHByb2R1Y3RKc29uOwp9CgpmdW5jdGlvbiBhcHBseVNlbGVjdDJGb3JUYWdzKCRzZWxlY3RvciwgdXJsLCBwbGFjZUhvbGRlclRleHQsIGlzQ2FzZVNlcmllc1RhZykgewogICAgJHNlbGVjdG9yLnNlbGVjdDIoewogICAgICAgIG1pbmltdW1JbnB1dExlbmd0aDogMCwKICAgICAgICBtdWx0aXBsZTogdHJ1ZSwKICAgICAgICB0YWdzOiB0cnVlLAogICAgICAgIHBsYWNlaG9sZGVyOiBwbGFjZUhvbGRlclRleHQsCiAgICAgICAgYWxsb3dDbGVhcjogdHJ1ZSwKICAgICAgICB3aWR0aDogIjEwMCUiLAogICAgICAgIGNyZWF0ZVRhZzogZnVuY3Rpb24gKHRhZykgewoKICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIG9wdGlvbiBpcyBhbHJlYWR5IHRoZXJlCiAgICAgICAgICAgIGZvdW5kID0gZmFsc2U7CiAgICAgICAgICAgICRzZWxlY3Rvci5maW5kKCJvcHRpb24iKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGlmICgkLnRyaW0odGFnLnRlcm0pLnRvVXBwZXJDYXNlKCkgPT09ICQudHJpbSgkKHRoaXMpLnRleHQoKSkudG9VcHBlckNhc2UoKSkgewogICAgICAgICAgICAgICAgICAgIHByZXZUYWcgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBpZiBpdCdzIG5vdCB0aGVyZSwgdGhlbiBzaG93IHRoZSBzdWdnZXN0aW9uCiAgICAgICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaWQ6ICQudHJpbSh0YWcudGVybSksCiAgICAgICAgICAgICAgICAgICAgdGV4dDogJC50cmltKHRhZy50ZXJtKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaWQ6ICQudHJpbShwcmV2VGFnLnRleHQoKSksCiAgICAgICAgICAgICAgICAgICAgdGV4dDogJC50cmltKHByZXZUYWcudGV4dCgpKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgYWpheDogewogICAgICAgICAgICBxdWlldE1pbGxpczogMjUwLAogICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24gKHBhcmFtcykgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICB0ZXJtOiBwYXJhbXMudGVybSwKICAgICAgICAgICAgICAgICAgICBwYWdlOiBwYXJhbXMucGFnZSB8fCAxLAogICAgICAgICAgICAgICAgICAgIG1heDogMzAsCiAgICAgICAgICAgICAgICAgICAgbGFuZzogdXNlckxvY2FsZSwKICAgICAgICAgICAgICAgICAgICBpc0Nhc2VTZXJpZXNUYWc6IGlzQ2FzZVNlcmllc1RhZwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJvY2Vzc1Jlc3VsdHM6IGZ1bmN0aW9uIChkYXRhLCBwYXJhbXMpIHsKICAgICAgICAgICAgICAgIHBhcmFtcy5wYWdlID0gcGFyYW1zLnBhZ2UgfHwgMTsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0czogZGF0YS5saXN0LAogICAgICAgICAgICAgICAgICAgIHBhZ2luYXRpb246IHsKICAgICAgICAgICAgICAgICAgICAgICAgbW9yZTogKHBhcmFtcy5wYWdlICogMzApIDwgZGF0YS50b3RhbENvdW50CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwp9CgpmdW5jdGlvbiBzaG93Q29tbWVudEljb24oY3VycmVudFJvdykgewogICAgdmFyICRidG5Hcm91cCA9ICQoY3VycmVudFJvdykuY2xvc2VzdCgndHInKS5maW5kKCd0ZC5kcm9wRG93biAuYnRuLWdyb3VwJyk7CiAgICBpZiAoJCgkYnRuR3JvdXApLmZpbmQoJy5jb21tZW50JykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgJCgkYnRuR3JvdXApLmZpbmQoJy5kcm9wZG93bi10b2dnbGUnKS5hZnRlcignPGkgY2xhc3M9Im1kaSBtZGktY2hhdCBibHVlLTIgZm9udC0xMyBwb3MtYWIgY29tbWVudCIgdGl0bGU9IicgKyAkLmkxOG4uXygnY29tbWVudEF2YWlsYWJsZScpICsgJyI+PC9pPicpOwogICAgfQp9CgpmdW5jdGlvbiByZW1vdmVDb21tZW50SWNvbihjdXJyZW50Um93KSB7CiAgICB2YXIgJGJ0bkdyb3VwID0gJChjdXJyZW50Um93KS5jbG9zZXN0KCd0cicpLmZpbmQoJ3RkLmRyb3BEb3duIC5idG4tZ3JvdXAnKTsKICAgICQoJGJ0bkdyb3VwKS5maW5kKCcuZHJvcGRvd24tdG9nZ2xlJykubmV4dCgnaScpLnJlbW92ZSgpOwp9CgpmdW5jdGlvbiByZW1vdmVBdHRhY2htZW50SWNvbihjdXJyZW50Um93KSB7CiAgICB2YXIgJGJ0bkdyb3VwID0gJChjdXJyZW50Um93KS5jbG9zZXN0KCd0cicpLmZpbmQoJ3RkLmRyb3BEb3duIC5idG4tZ3JvdXAnKTsKICAgIGlmICgkKCRidG5Hcm91cCkuZmluZCgnLmNvbW1lbnQnKS5sZW5ndGggPT09IDApIHsKICAgICAgICAkKCRidG5Hcm91cCkuZmluZCgnLmRyb3Bkb3duLXRvZ2dsZScpLm5leHQoJ2knKS5yZW1vdmUoKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJCgkYnRuR3JvdXApLmZpbmQoJy5jb21tZW50JykubmV4dCgnaScpLnJlbW92ZSgpOwogICAgfQp9CgpmdW5jdGlvbiBzaG93QXR0YWNobWVudEljb24odHJSb3cpIHsKICAgIHZhciAkYnRuR3JvdXAgPSAkKHRyUm93KS5maW5kKCd0ZC5kcm9wRG93biAuYnRuLWdyb3VwJyk7CiAgICBpZiAoJCgkYnRuR3JvdXApLmZpbmQoJy5hdHRhY2gnKS5sZW5ndGggPT09IDApIHsKICAgICAgICBpZiAoJCgkYnRuR3JvdXApLmZpbmQoJy5jb21tZW50JykubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICQoJGJ0bkdyb3VwKS5maW5kKCcuZHJvcGRvd24tdG9nZ2xlJykuYWZ0ZXIoJyA8aSBjbGFzcz0ibWRpIG1kaS1hdHRhY2htZW50IGJsdWUtMSBmb250LTEzIHBvcy1hYiBhdHRhY2giIHRpdGxlPSInICsgJC5pMThuLl8oJ2F0dGFjaG1lbnRBdmFpbGFibGUnKSArICciPjwvaT4gJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJCgkYnRuR3JvdXApLmZpbmQoJy5jb21tZW50JykuYWZ0ZXIoJyA8aSBjbGFzcz0ibWRpIG1kaS1hdHRhY2htZW50IGJsdWUtMSBmb250LTEzIHBvcy1hYiBhdHRhY2giIHRpdGxlPSInICsgJC5pMThuLl8oJ2F0dGFjaG1lbnRBdmFpbGFibGUnKSArICciPjwvaT4gJyk7CiAgICAgICAgfQogICAgfQp9Cgp2YXIgaXNTYWZldHlMZWFkQWxsb3dlZCA9IGZ1bmN0aW9uIChsaXN0UHJvZHVjdElkcywgc2VsZWN0ZWRQcm9kdWN0SWQpIHsKICAgIHJldHVybiBsaXN0UHJvZHVjdElkcy5pbmRleE9mKHNlbGVjdGVkUHJvZHVjdElkKSAhPT0gLTEKfTsKCnZhciBzZXRDb2x1bW5TZXEgPSBmdW5jdGlvbiAobWFwU2VxKSB7CiAgICBjb2x1bW5TZXEgPSBtYXBTZXEKfQoKdmFyIHVwZGF0ZUV4aXN0aW5nVmlldyA9IGZ1bmN0aW9uKHZpZXdJbmZvKXsKICAgIHZhciByZXF1ZXN0ID0gbmV3IE9iamVjdCgpCiAgICB2YXIgc2hhcmVkV2l0aERhdGEgPSAkKCcjdmlld1NoYXJlZFdpdGhFZGl0JykudmFsKCkgPyBKU09OLnN0cmluZ2lmeSgkKCcjdmlld1NoYXJlZFdpdGhFZGl0JykudmFsKCkpIDogbnVsbDsKICAgIHJlcXVlc3RbJ25hbWUnXSA9ICQoJy52aWV3U2VsZWN0IDpzZWxlY3RlZCcpLnRleHQoKS5yZXBsYWNlKCIoZGVmYXVsdCkiLCAiIikudHJpbSgpOwogICAgcmVxdWVzdFsnZmlsdGVyTWFwJ10gPSBKU09OLnN0cmluZ2lmeSh2aWV3SW5mby5maWx0ZXJNYXApOwogICAgcmVxdWVzdFsnY29sdW1uTGlzdCddID0gdmlld0luZm8ubm90VmlzaWJsZUNvbHVtbi50b1N0cmluZygpOwogICAgcmVxdWVzdFsnYWxlcnRUeXBlJ10gPSBhcHBsaWNhdGlvbk5hbWU7CiAgICByZXF1ZXN0WydpZCddID0gJCgnLnZpZXdTZWxlY3QnKS52YWwoKTsKICAgIHJlcXVlc3RbJ3NvcnRpbmcnXSA9IEpTT04uc3RyaW5naWZ5KHZpZXdJbmZvLnNvcnRlZENvbHVtbik7CiAgICByZXF1ZXN0WydhZHZhbmNlZEZpbHRlciddID0gdmlld0luZm8uYWR2YW5jZWRGaWx0ZXI7CiAgICByZXF1ZXN0Wyd2aWV3U2hhcmVkV2l0aCddID0gc2hhcmVkV2l0aERhdGE7CiAgICByZXF1ZXN0WydkZWZhdWx0VmlldyddID0gKCQoJy52aWV3U2VsZWN0IDpzZWxlY3RlZCcpLnRleHQoKS5pbmRleE9mKCIoZGVmYXVsdCkiKSAhPSAtMSkKICAgICQuYWpheCh7CiAgICAgICAgdXJsOiB1cGRhdGVWaWV3VXJsLAogICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICBkYXRhOiByZXF1ZXN0LAogICAgICAgIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgdmFyIHBhZ2VVUkwgPSAkKGxvY2F0aW9uKS5hdHRyKCJocmVmIik7CiAgICAgICAgICAgIGlmIChwYWdlVVJMLmluZGV4T2YoInZpZXdJZCIpICE9IC0xKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBwYWdlVVJMLnNsaWNlKDAsIHBhZ2VVUkwuaW5kZXhPZigidmlld0lkIikgKyA3KSArIGRhdGEudmlld0lkCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAocGFnZVVSTC5pbmRleE9mKCIjIikgIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBwYWdlVVJMID0gcGFnZVVSTC5zbGljZSgwLCBwYWdlVVJMLmluZGV4T2YoIiMiKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHBhZ2VVUkwgKyAiJnZpZXdJZD0iICsgZGF0YS52aWV3SWQKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihkYXRhLmVycm9yTWVzc2FnZSAhPSAnJyl7CiAgICAgICAgICAgICAgICBzaG93RXJyb3JOb3RpZmljYXRpb24oZGF0YS5lcnJvck1lc3NhZ2UsIDEwMDAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pCn0KCnZhciBzaWduYWwgPSBzaWduYWwgfHwge307CgpzaWduYWwuYXJjaGl2ZWRfdXRpbHMgPSAoZnVuY3Rpb24gKCkgewogICAgdmFyIGFyY2hpdmVkX3RhYmxlOwogICAgdmFyIHNvcnRpbmdDb3VudCA9IDE7CgogICAgdmFyIGluaXRfYXJjaGl2ZWRfdGFibGUgPSBmdW5jdGlvbiAodGFibGUsIHVybCwgYXBwVHlwZSwgYWxlcnREZXRhaWxVcmwpIHsKICAgICAgICBpZiAoISQuZm4uZGF0YVRhYmxlLmlzRGF0YVRhYmxlKHRhYmxlKSkgewogICAgICAgICAgICBhcmNoaXZlZF90YWJsZSA9ICQodGFibGUpLkRhdGFUYWJsZSh7CiAgICAgICAgICAgICAgICAic1BhZ2luYXRpb25UeXBlIjogImJvb3RzdHJhcCIsCgogICAgICAgICAgICAgICAgImxhbmd1YWdlIjogewogICAgICAgICAgICAgICAgICAgICJ1cmwiOiAiLi4vYXNzZXRzL2kxOG4vZGF0YVRhYmxlc18iICsgdXNlckxvY2FsZSArICIuanNvbiIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBmbkRyYXdDYWxsYmFjazogZnVuY3Rpb24gKCl7CiAgICAgICAgICAgICAgICAgICAgY29sRWxsaXBzaXMoKTsKICAgICAgICAgICAgICAgICAgICB3ZWJVaVBvcEluaXQoKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAiYWpheCI6IHsKICAgICAgICAgICAgICAgICAgICAidXJsIjogdXJsLAogICAgICAgICAgICAgICAgICAgICJkYXRhU3JjIjogIiIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAiYWFTb3J0aW5nIjogW1tzb3J0aW5nQ291bnQsICJkZXNjIl1dLAogICAgICAgICAgICAgICAgImJMZW5ndGhDaGFuZ2UiOiB0cnVlLAogICAgICAgICAgICAgICAgImlEaXNwbGF5TGVuZ3RoIjogMTAsCiAgICAgICAgICAgICAgICAiYkF1dG9XaWR0aCI6IGZhbHNlLAogICAgICAgICAgICAgICAgImFvQ29sdW1ucyI6IGNyZWF0ZV9hcmNoaXZlZF9jb2x1bW5fZGF0YShhcHBUeXBlLCBhbGVydERldGFpbFVybCksCiAgICAgICAgICAgICAgICAic2Nyb2xsWCI6IHRydWUsCiAgICAgICAgICAgICAgICAic2Nyb2xsWSI6ImNhbGMoMTAwdmggLSAyOTZweCkiLAogICAgICAgICAgICAgICAgImF1dG9XaWR0aCI6IHRydWUsCiAgICAgICAgICAgICAgICBjb2x1bW5EZWZzOiBbewogICAgICAgICAgICAgICAgICAgICJ0YXJnZXRzIjogJ19hbGwnLAogICAgICAgICAgICAgICAgICAgICJyZW5kZXIiOiAkLmZuLmRhdGFUYWJsZS5yZW5kZXIudGV4dCgpCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGFyY2hpdmVkX3RhYmxlOwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGdlbkFsZXJ0TmFtZUxpbmsgPSBmdW5jdGlvbiAodmFsdWUsIGlkLCBhbGVydERldGFpbFVybCkgewogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iJyArIChhbGVydERldGFpbFVybCArICc/JyArICdjYWxsaW5nU2NyZWVuPXJldmlldyZhcmNoaXZlZD10cnVlJicgKwogICAgICAgICAgICAgICAgc2lnbmFsLnV0aWxzLmNvbXBvc2VQYXJhbXMoe2NvbmZpZ0lkOiBpZH0pKSArICciICsgdGFyZ2V0PSJfYmxhbmsiPicgKyB2YWx1ZSArICc8L2E+JwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGNyZWF0ZV9hcmNoaXZlZF9jb2x1bW5fZGF0YSA9IGZ1bmN0aW9uIChhcHBUeXBlLCBhbGVydERldGFpbFVybCkgewoKICAgICAgICB2YXIgYW9Db2x1bW5zOwogICAgICAgIGlmKGFwcFR5cGUgPT0gQUxFUlRfQ09ORklHX1RZUEUuTElURVJBVFVSRV9TRUFSQ0hfQUxFUlQpIHsKICAgICAgICAgICAgYW9Db2x1bW5zID0gWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJhbGVydE5hbWUiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2VuQWxlcnROYW1lTGluayhlc2NhcGVIVE1MKHJvdy5hbGVydE5hbWUpLCByb3cuZXhDb25maWdJZCwgYWxlcnREZXRhaWxVcmwpCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAidmVyc2lvbiIsCiAgICAgICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgZnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTEwMCcKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAiZGF0ZVJhbmdlIiwKICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCBmdWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICAgICAgfSwgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJzZWxlY3RlZERhdGFzb3VyY2UiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICdjb2wtbWluLTE1MCBjZWxsLWJyZWFrJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJsYXN0TW9kaWZpZWQiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xNTAnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYW9Db2x1bW5zID0gWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJhbGVydE5hbWUiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2VuQWxlcnROYW1lTGluayhlc2NhcGVIVE1MKHJvdy5hbGVydE5hbWUpLCByb3cuZXhDb25maWdJZCwgYWxlcnREZXRhaWxVcmwpCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1taW4tMTUwJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAidmVyc2lvbiIsCiAgICAgICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgZnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTEwMCcKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInByb2R1Y3QiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sRWxlbWVudCA9ICc8ZGl2IGNsYXNzPSJjb2wtY29udGFpbmVyIj48ZGl2IGNsYXNzPSJjb2wtaGVpZ2h0Ij4nOwogICAgICAgICAgICAgICAgICAgICAgICBjb2xFbGVtZW50ICs9IHJvdy5wcm9kdWN0OwogICAgICAgICAgICAgICAgICAgICAgICBjb2xFbGVtZW50ICs9ICc8YSB0YWJpbmRleD0iMCIgdGl0bGU9IicgKyAkLmkxOG4uXygnYXBwTGFiZWwudmlld0FsbCcpICsgJyIgY2xhc3M9Imljby1kb3RzIHZpZXctYWxsIiBtb3JlLWRhdGE9IicgKyByb3cucHJvZHVjdCArICciPjxpIGNsYXNzPSJtZGkgbWRpLWRvdHMtaG9yaXpvbnRhbCBmb250LTIwIGJsdWUtMSI+IDwvaT48L2E+JzsKICAgICAgICAgICAgICAgICAgICAgICAgY29sRWxlbWVudCArPSAnPC9kaXY+PC9kaXY+JzsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbEVsZW1lbnQKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAnY29sLW1pbi0xNTAgY2VsbC1icmVhaycKICAgICAgICAgICAgICAgIH0sewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJkZXNjcmlwdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgZnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWRkRWxsaXBzaXMoZGF0YSkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xNTAnCiAgICAgICAgICAgICAgICB9LCAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjYXNlQ291bnQiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xMDAnCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInJldmlld2VkQ2FzZXMiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xMDAnCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJkYXRlUmFuZ2UiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xNTAnCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJsYXN0TW9kaWZpZWQiLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIGZ1bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0xNTAnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF07CiAgICAgICAgfQogICAgICAgIHJldHVybiBhb0NvbHVtbnMKICAgIH07CgogICAgdmFyIHJlbG9hZF9hcmNoaXZlZF90YWJsZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodHlwZW9mIGFyY2hpdmVkX3RhYmxlICE9ICJ1bmRlZmluZWQiICYmIGFyY2hpdmVkX3RhYmxlICE9IG51bGwpIHsKICAgICAgICAgICAgYXJjaGl2ZWRfdGFibGUuYWpheC5yZWxvYWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHJlbG9hZCB0aGUgYXJjaGl2ZWQgdGFibGUuIFBsZWFzZSByZWZyZXNoIHRoZSBwYWdlLiIpOwogICAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgICBpbml0X2FyY2hpdmVkX3RhYmxlOiBpbml0X2FyY2hpdmVkX3RhYmxlLAogICAgICAgIHJlbG9hZF9hcmNoaXZlZF90YWJsZTogcmVsb2FkX2FyY2hpdmVkX3RhYmxlCiAgICB9Cn0pKCk7CnZhciBzaWduYWwgPSBzaWduYWwgfHwge307CnZhciBleGlzdGluZ1Jvd3MgPSBbXTsKCnNpZ25hbC5jb21tb25UYWcgPSAoZnVuY3Rpb24gKCkgewogICAgdmFyIG9wZW5Db21tb25BbGVydFRhZ01vZGFsID0gZnVuY3Rpb24gKG1vZHVsZSwgZG9tYWluLCB0YWdzKSB7CiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5lZGl0QWxlcnRUYWdzJywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgICAgICB2YXIgcGFyZW50X3JvdyA9ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCd0cicpOwogICAgICAgICAgICB2YXIgaW5kZXggPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuaW5kZXgoKTsKICAgICAgICAgICAgdmFyIHJvd09iamVjdCA9IHRhYmxlLnJvd3MoaW5kZXgpLmRhdGEoKVswXTsKICAgICAgICAgICAgdmFyIGFsZXJ0SWQgPSByb3dPYmplY3QuaWQ7CiAgICAgICAgICAgIHZhciBjb21tb25UYWdNb2RhbE9iaiA9ICQoJyNjb21tb25UYWdNb2RhbCcpOwogICAgICAgICAgICBmaWxsQWxlcnRUYWdzKGNvbW1vblRhZ01vZGFsT2JqLCBmaWxsQ29tbW9uVGFnVXJsLCBtb2R1bGUsIGRvbWFpbiwgdGFncywgYWxlcnRJZCk7CiAgICAgICAgICAgIGNvbW1vblRhZ01vZGFsT2JqLm1vZGFsKCdzaG93Jyk7CiAgICAgICAgfSk7CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgICBvcGVuQ29tbW9uQWxlcnRUYWdNb2RhbDogb3BlbkNvbW1vbkFsZXJ0VGFnTW9kYWwKICAgIH0KfSkoKTsKCnZhciBmaWxsQWxlcnRUYWdzID0gZnVuY3Rpb24gKHRhZ01vZGFsLCBmaWxsQ29tbW9uVGFnVXJsLCBtb2R1bGUsIGRvbWFpbiwgdGFncywgYWxlcnRJZCkgewogICAgdmFyIGRhdGFVcmwgPSBmaWxsQ29tbW9uVGFnVXJsICsgIi8iK21vZHVsZSsiP2RvbWFpbj0iK2RvbWFpbiArICImYWxlcnRJZD0iK2FsZXJ0SWQgKyAnJmlzQXJjaGl2ZWQ9JyArIGlzQXJjaGl2ZWQ7CiAgICBjYXRlZ29yeU1vZGFsVGFibGUgPSAkKCIjY2F0ZWdvcnlNb2RhbFRhYmxlIikuRGF0YVRhYmxlKHsKICAgICAgICAibGFuZ3VhZ2UiOiB7CiAgICAgICAgICAgICJ1cmwiOiAiLi4vYXNzZXRzL2kxOG4vZGF0YVRhYmxlc18iICsgdXNlckxvY2FsZSArICIuanNvbiIKICAgICAgICB9LAogICAgICAgICJjcmVhdGVkUm93IjogZnVuY3Rpb24gKCByb3csIGRhdGEsIGluZGV4ICkgewogICAgICAgICAgICB2YXIgdGFnc0VuYWJsZWQgPSBub25Db25maWd1cmVkRW5hYmxlZCAhPSAidHJ1ZSIgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgICAgIHZhciBjYXRlZ29yaWVzID0gW107CiAgICAgICAgICAgIHRhZ3MuZm9yRWFjaChmdW5jdGlvbiAobWFwKSB7CiAgICAgICAgICAgICAgICBpZihtYXAucGFyZW50SWQgPT0wIHx8IG1hcC5wYXJlbnRJZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5wdXNoKHtpZDogbWFwLmlkLCB0ZXh0OiBtYXAudGV4dH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJCgnc2VsZWN0Jywgcm93KS5lcSgwKS5zZWxlY3QyKHsKICAgICAgICAgICAgICAgIHRhZ3M6IHRhZ3NFbmFibGVkLAogICAgICAgICAgICAgICAgZGF0YTogY2F0ZWdvcmllcywKICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAiU2VsZWN0IENhdGVnb3J5IgogICAgICAgICAgICB9KS5vbignY2hhbmdlJywgZnVuY3Rpb24ob2JqKSB7CgogICAgICAgICAgICAgICAgdmFyIHN1YnRhZ3NFbmFibGVkID0gbm9uQ29uZmlndXJlZEVuYWJsZWQgIT0gInRydWUiID8gZmFsc2UgOiB0cnVlOwogICAgICAgICAgICAgICAgdmFyIHN1YmNhdGVnb3JpZXMgPSBbXTsKICAgICAgICAgICAgICAgIHRhZ3MuZm9yRWFjaChmdW5jdGlvbiAobWFwKSB7CiAgICAgICAgICAgICAgICAgICAgaWYobWFwLnBhcmVudElkID09IG9iai5jdXJyZW50VGFyZ2V0LnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmNhdGVnb3JpZXMucHVzaCh7aWQ6IG1hcC5pZCwgdGV4dDogbWFwLnRleHR9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZihkYXRhLmFjdGlvbiA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnc2VsZWN0Jywgcm93KS5lcSgxKS5lbXB0eSgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIGlmIG5vIHN1YmNhdGVnb3J5IGNvbmZpZ3VyZSB0aGVuIGNhbiBub3QgYWRkIG9uIGZseSBzdWJjYXRlZ29yeQogICAgICAgICAgICAgICAgaWYoc3ViY2F0ZWdvcmllcy5sZW5ndGggPD0gMCl7CiAgICAgICAgICAgICAgICAgICAgc3VidGFnc0VuYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHN1YnRhZ3NFbmFibGVkID0gKHN1YnRhZ3NFbmFibGVkICYmIHRydWUpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICQoJ3NlbGVjdCcsIHJvdykuZXEoMSkuc2VsZWN0Mih7CiAgICAgICAgICAgICAgICAgICAgdGFnczogc3VidGFnc0VuYWJsZWQsCiAgICAgICAgICAgICAgICAgICAgZGF0YTogc3ViY2F0ZWdvcmllcywKICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogIlNlbGVjdCBTdWIgQ2F0ZWdvcnkiCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkudHJpZ2dlcignY2hhbmdlJyk7CiAgICAgICAgICAgICQoJ3NlbGVjdCcsIHJvdykuZXEoMSkub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBzZXRTZWxlY3RXaWR0aCgkKHRoaXMpKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZihkYXRhLmFjdGlvbiAhPSAxKSB7CiAgICAgICAgICAgICAgICAkKCdpbnB1dCcsIHJvdykuY2xvc2VzdCgndHInKS5maW5kKCI6aW5wdXQiKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpOwogICAgICAgICAgICAgICAgaWYoZGF0YS5zdWJjYXRlZ29yeS5sZW5ndGggPD0gMCkKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dCcsIHJvdykuY2xvc2VzdCgndHInKS5maW5kKCI6aW5wdXRbY2xhc3M9c2VsZWN0Mi1zZWFyY2hfX2ZpZWxkXSIpLmF0dHIoInBsYWNlaG9sZGVyIiwgIiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkKCIuZWRpdC1yb3ciLCByb3cpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICB2YXIgaXNEaXNhYmxlZCA9ICQodGhpcykuY2xvc2VzdCgndHInKS5maW5kKCI6aW5wdXQ6bm90KDpmaXJzdCkiKS5hdHRyKCdkaXNhYmxlZCcpOwogICAgICAgICAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmZpbmQoIjppbnB1dDpub3QoOmZpcnN0KSIpLmF0dHIoJ2Rpc2FibGVkJywgIWlzRGlzYWJsZWQpOwogICAgICAgICAgICAgICAgaWYoaXNEaXNhYmxlZCAmJiBkYXRhLnN1YmNhdGVnb3J5Lmxlbmd0aCA8PSAwKQogICAgICAgICAgICAgICAgICAgICQodGhpcykuY2xvc2VzdCgndHInKS5maW5kKCI6aW5wdXRbY2xhc3M9c2VsZWN0Mi1zZWFyY2hfX2ZpZWxkXSIpLmF0dHIoInBsYWNlaG9sZGVyIiwgIlNlbGVjdCBTdWIgQ2F0ZWdvcnkiKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYoaXNEaXNhYmxlZCAmJiBkYXRhLnN1YmNhdGVnb3J5Lmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmZpbmQoIjppbnB1dFtjbGFzcz1zZWxlY3QyLXNlYXJjaF9fZmllbGRdIikuYXR0cigicGxhY2Vob2xkZXIiLCAiIik7CiAgICAgICAgICAgICAgICBlbHNlIGlmKCFpc0Rpc2FibGVkICYmIGRhdGEuc3ViY2F0ZWdvcnkubGVuZ3RoIDw9IDApCiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCd0cicpLmZpbmQoIjppbnB1dFtjbGFzcz1zZWxlY3QyLXNlYXJjaF9fZmllbGRdIikuYXR0cigicGxhY2Vob2xkZXIiLCAiIik7CgogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICQoIi5kZWxldGUtcm93Iiwgcm93KS51bmJpbmQoKS5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgY2F0ZWdvcnlNb2RhbFRhYmxlCiAgICAgICAgICAgICAgICAgICAgLnJvdyggJCh0aGlzKS5wYXJlbnRzKCd0cicpICkKICAgICAgICAgICAgICAgICAgICAucmVtb3ZlKCkKICAgICAgICAgICAgICAgICAgICAuZHJhdygpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICQoIi51cC1yb3ciLCByb3cpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICBjb25zdCAkcm93ID0gJCh0aGlzKS5wYXJlbnRzKCd0cicpOwogICAgICAgICAgICAgICAgaWYgKCRyb3cuaW5kZXgoKSA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRyb3cucHJldigpLmJlZm9yZSgkcm93LmdldCgwKSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgJCgiLmRvd24tcm93Iiwgcm93KS51bmJpbmQoKS5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgY29uc3QgJHJvdyA9ICQodGhpcykucGFyZW50cygndHInKTsKICAgICAgICAgICAgICAgICRyb3cubmV4dCgpLmFmdGVyKCRyb3cuZ2V0KDApKTsKICAgICAgICAgICAgfSk7CgogICAgICAgIH0sCiAgICAgICAgZHJhd0NhbGxiYWNrOiBmdW5jdGlvbiAoc2V0dGluZ3MpIHsKICAgICAgICAgICAgc2V0U2VsZWN0V2lkdGgoJCgiLmR5bmFtaWNTZWxlY3RGaWVsZFN1YkNhdGVnb3J5IikpOwogICAgICAgIH0sCiAgICAgICAgcm93Q2FsbGJhY2s6IGZ1bmN0aW9uKCByb3csIGRhdGEsIGluZGV4ICkgewogICAgICAgICAgICBpZiAoZGF0YVsncHJpdmF0ZSddID09IHRydWUgJiYgZGF0YVsncHJpdmF0ZUFjY2VzcyddICE9IHRydWUpIHsKICAgICAgICAgICAgICAgICQocm93KS5oaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGluaXRDb21wbGV0ZTogZnVuY3Rpb24oc2V0dGluZ3MsIGpzb24pewogICAgICAgICAgICBleGlzdGluZ1Jvd3MgPSBbXTsKICAgICAgICAgICAgY2F0ZWdvcnlNb2RhbFRhYmxlLnJvd3MoKS5ldmVyeShmdW5jdGlvbihpbmRleCwgZWxlbWVudCl7CiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmRhdGEoKTsKICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Um93ID0ge2NhdGVnb3J5OiB2YWx1ZS5jYXRlZ29yeSwgc3ViY2F0ZWdvcnk6IHZhbHVlLnN1YmNhdGVnb3J5LCBhbGVydDogdmFsdWUuYWxlcnQsIHByaXZhdGU6IHZhbHVlLnByaXZhdGUsCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEJ5OiB2YWx1ZS5jcmVhdGVkQnksIGNyZWF0ZWREYXRlOiB2YWx1ZS5jcmVhdGVkRGF0ZSwgcHJpb3JpdHk6IHZhbHVlLnByaW9yaXR5LCB1cGRhdGVkRGF0ZUluaXQ6IHZhbHVlLnVwZGF0ZWREYXRlSW5pdCwKICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQnlJbml0OiB2YWx1ZS51cGRhdGVkQnlJbml0LCBjcmVhdGVkRGF0ZUluaXQ6IHZhbHVlLmNyZWF0ZWREYXRlSW5pdCwKICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQnlJbml0OiB2YWx1ZS5jcmVhdGVkQnlJbml0fTsKICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRSb3cuY2F0ZWdvcnkuaWQgIT0gMCkKICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1Jvd3MucHVzaChjdXJyZW50Um93KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICAiYWpheCI6IHsKICAgICAgICAgICAgInVybCI6IGRhdGFVcmwsCiAgICAgICAgICAgICJkYXRhU3JjIjogIiIKICAgICAgICB9LAogICAgICAgIHNlYXJjaGluZzogdHJ1ZSwKICAgICAgICAiYkxlbmd0aENoYW5nZSI6IHRydWUsCiAgICAgICAgInBhZ2luZyI6ICAgZmFsc2UsCiAgICAgICAgIm9yZGVyaW5nIjogZmFsc2UsCiAgICAgICAgInNlYXJjaGluZyI6IGZhbHNlLAogICAgICAgICJpbmZvIjogZmFsc2UsCiAgICAgICAgImJEZXN0cm95IjogdHJ1ZSwKICAgICAgICBzdGF0ZVNhdmU6IHRydWUsCiAgICAgICAgInNjcm9sbFkiOiAgICAgICAgIjM1MHB4IiwKICAgICAgICAic2Nyb2xsQ29sbGFwc2UiOiB0cnVlLAogICAgICAgICJhb0NvbHVtbnMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjYXRlZ29yeSIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAiMjUlIiwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnZHQtY2VudGVyJywKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxzZWxlY3QgbmFtZT0ic2VsZWN0RmllbGQiIGlkPSJkeW5hbWljU2VsZWN0RmllbGRDYXRlZ29yeSIgY2xhc3M9ImR5bmFtaWNTZWxlY3RGaWVsZENhdGVnb3J5IGZvcm0tY29udHJvbCI+JzsKICAgICAgICAgICAgICAgICAgICBpZihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxvcHRpb24gc2VsZWN0ZWQ9InNlbGVjdGVkIiB2YWx1ZT0iJyArIGRhdGEuaWQgKyAnIj4nICsgZGF0YS5uYW1lICsgJzwvb3B0aW9uPic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvc2VsZWN0Pic7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGh0bWw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJzdWJjYXRlZ29yeSIsCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2R0LWNlbnRlcicsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAiMzUlIiwKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewoKICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICc8c2VsZWN0IG5hbWU9InNlbGVjdEZpZWxkIiBpZD0iZHluYW1pY1NlbGVjdEZpZWxkU3ViQ2F0ZWdvcnkiIG11bHRpcGxlPSJtdWx0aXBsZSIgY2xhc3M9ImR5bmFtaWNTZWxlY3RGaWVsZFN1YkNhdGVnb3J5IGZvcm0tY29udHJvbCI+JzsKICAgICAgICAgICAgICAgICAgICByb3cuc3ViY2F0ZWdvcnkuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxvcHRpb24gc2VsZWN0ZWQ9InNlbGVjdGVkIiB2YWx1ZT0iJytvYmouaWQrJyI+JytvYmoubmFtZSsnPC9vcHRpb24+JzsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8L3NlbGVjdD4nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBodG1sCgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiYWxlcnQiLAogICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICJqdXN0aWZpY2F0aW9uLWNlbGwgZGF0YVRhYmxlQ29sdW1uQ2VudGVyIHRleHQtY2VudGVyIiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICIxNSUiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSByb3cuYWxlcnQgPT0gdHJ1ZSA/ICJjaGVja2VkIjogIiI7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8aW5wdXQgdHlwZT0iY2hlY2tib3giIGNsYXNzPSJhbGVydC1jaGVjay1ib3giICcgKyBjaGVja2VkICsnIGRhdGEtaWQ9JyArIHJvdy5hbGVydCArICcgLz4nOwoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogInByaXZhdGUiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIjEyJSIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tlZCA9IHJvdy5wcml2YXRlID09IHRydWUgPyAiY2hlY2tlZCI6ICIiOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGlucHV0IHR5cGU9ImNoZWNrYm94IiBjbGFzcz0icHJpdmF0ZS1jaGVjay1ib3giICcgKyBjaGVja2VkICArJyBkYXRhLWlkPScgKyByb3cucHJpdmF0ZSArICcgLz4nOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnZHQtY2VudGVyIGRhdGFUYWJsZUNvbHVtbkNlbnRlciB0ZXh0LWNlbnRlcicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogImFjdGlvbiIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAiMTMlIiwKICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAidGQtYWN0aW9uIiwKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIGlmKGRhdGEgPT09IDEpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxpIGNsYXNzPSJmYSBmYS10cmFzaC1vIGRlbGV0ZS1yb3cgdGFnLWFjdGlvbiBibHVlLTEiPjwvaT4nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXRhaWxzID0gJzxiPkNyZWF0ZWQgQnk6PC9iPiAnK3Jvdy5jcmVhdGVkQnkgKyc8aHIvPiA8Yj5DcmVhdGVkIERhdGU6PC9iPiAnK3Jvdy5jcmVhdGVkRGF0ZSArJzxoci8+IDxiPkxhc3QgTW9kaWZpZWQgQnk6PC9iPiAnK3Jvdy51cGRhdGVkQnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsnPGhyLz4gPGI+TGFzdCBNb2RpZmllZCBEYXRlOjwvYj4gJytyb3cudXBkYXRlZERhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGkgaWQ9InRhZy1wb3B1cCIgY2xhc3M9ImZhIGZhLWluZm8gcG9wb3Zlck1lc3NhZ2UgdGFnLWFjdGlvbiBibHVlLTEiIHRpdGxlPSJEZXRhaWxzIiBkYXRhLWNvbnRlbnQ9IicgKyBkZXRhaWxzICsgJyI+PC9pPicgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJyAgPGkgY2xhc3M9ImZhIGZhLXBlbmNpbCBlZGl0LXJvdyB0YWctYWN0aW9uIGJsdWUtMSIgPjwvaT4nICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgIDxpIGNsYXNzPSJmYSBmYS10cmFzaC1vIGRlbGV0ZS1yb3cgdGFnLWFjdGlvbiBibHVlLTEiPjwvaT4nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgY29sdW1uRGVmczogW3sKICAgICAgICAgICAgInRhcmdldHMiOiAnX2FsbCcsCiAgICAgICAgICAgICJyZW5kZXIiOiAkLmZuLmRhdGFUYWJsZS5yZW5kZXIudGV4dCgpCiAgICAgICAgfV0KICAgIH0pOwogICAgJCggIiNjYXRlZ29yeU1vZGFsVGFibGUiICkuc29ydGFibGUoewogICAgICAgIGl0ZW1zOiAndHI6bm90KDpmaXJzdCknLAogICAgICAgIG9wYWNpdHk6IDAuNiwKICAgICAgICBzY3JvbGxTcGVlZDogNDAsCiAgICAgICAgY2FuY2VsOiAidGhlYWQiLAogICAgICAgIGNvbnRhaW5tZW50IDogInBhcmVudCIKICAgIH0pOwoKICAgIGlmKHByaXZhdGVFbmFibGVkICE9ICJ0cnVlIikgewogICAgICAgIGNhdGVnb3J5TW9kYWxUYWJsZS5jb2x1bW4oMykudmlzaWJsZShmYWxzZSk7CiAgICB9ZWxzZXsKICAgICAgICBjYXRlZ29yeU1vZGFsVGFibGUuY29sdW1uKDMpLnZpc2libGUodHJ1ZSk7CiAgICB9CiAgICAkKCcjY2F0ZWdvcnlNb2RhbFRhYmxlJykub24oJ21vdXNlb3ZlcicsICd0cicsIGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcucG9wb3Zlck1lc3NhZ2UnKS5wb3BvdmVyKHsKICAgICAgICAgICAgcGxhY2VtZW50OiAnbGVmdCcsCiAgICAgICAgICAgIHRyaWdnZXI6ICdob3ZlciBmb2N1cycsCiAgICAgICAgICAgIHZpZXdwb3J0OiAnYm9keScsCiAgICAgICAgICAgIGh0bWw6IHRydWUKICAgICAgICB9KTsKICAgIH0pOwoKICAgICQoIiNhZGQtcm93IikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBsYXN0Um93ID0gY2F0ZWdvcnlNb2RhbFRhYmxlLnJvdygnOmxhc3QnKS5kYXRhKCk7CiAgICAgICAgdmFyIGxhc3RSb3dDYXRlZ29yeSA9ICQoJyNjYXRlZ29yeU1vZGFsVGFibGVCb2R5IHRyOmxhc3QnKS5maW5kKCJ0ZCBzZWxlY3QuZHluYW1pY1NlbGVjdEZpZWxkQ2F0ZWdvcnkiKS52YWwoKTsKICAgICAgICBpZihsYXN0Um93Q2F0ZWdvcnkgIT0gMCkgewogICAgICAgICAgICBjYXRlZ29yeU1vZGFsVGFibGUucm93LmFkZCh7CiAgICAgICAgICAgICAgICAiY2F0ZWdvcnkiOiB7aWQ6IDAsIG5hbWU6ICJTZWxlY3QgQ2F0ZWdvcnkifSwKICAgICAgICAgICAgICAgICJzdWJjYXRlZ29yeSI6IFtdLAogICAgICAgICAgICAgICAgImFsZXJ0IjogZmFsc2UsCiAgICAgICAgICAgICAgICAicHJpdmF0ZSI6IGZhbHNlLAogICAgICAgICAgICAgICAgImFjdGlvbiI6IDEsCiAgICAgICAgICAgICAgICAicHJpb3JpdHkiOiA5OTk5LAogICAgICAgICAgICAgICAgIm5ldyI6IHRydWUKICAgICAgICAgICAgfSkuZHJhdyhmYWxzZSk7CiAgICAgICAgICAgIHZhciAkc2Nyb2xsQm9keSA9ICQoY2F0ZWdvcnlNb2RhbFRhYmxlLnRhYmxlKCkubm9kZSgpKS5wYXJlbnQoKTsKICAgICAgICAgICAgJHNjcm9sbEJvZHkuc2Nyb2xsVG9wKCRzY3JvbGxCb2R5LmdldCgwKS5zY3JvbGxIZWlnaHQpOwogICAgICAgIH0KICAgICAgICAkKCcjY2F0ZWdvcnlNb2RhbFRhYmxlQm9keSB0cjpsYXN0IHNlbGVjdCcpLmVxKDApLmZvY3VzKCk7CiAgICB9KTsKCiAgICAkKCIuYWRkVGFncyIpLnVuYmluZCgpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbmV3Um93cyA9IFtdOwogICAgICAgIHZhciBjb3VudCA9IDE7CiAgICAgICAgJCgnI2NhdGVnb3J5TW9kYWxUYWJsZUJvZHkgdHInKS5lYWNoKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciB0aCA9ICQodGhpcyk7CiAgICAgICAgICAgIHZhciBjYXRlZ29yeUlkID0gJCh0aCkuZmluZCgidGQgc2VsZWN0LmR5bmFtaWNTZWxlY3RGaWVsZENhdGVnb3J5IikudmFsKCk7CiAgICAgICAgICAgIHZhciBjYXRlZ29yeVRleHQgPSAkKHRoKS5maW5kKCJ0ZCBzZWxlY3QuZHluYW1pY1NlbGVjdEZpZWxkQ2F0ZWdvcnkgb3B0aW9uOnNlbGVjdGVkIikudGV4dCgpOwogICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSB7aWQ6IGNhdGVnb3J5SWQsIG5hbWU6IGNhdGVnb3J5VGV4dH07CiAgICAgICAgICAgIHZhciBzdWJjYXRlZ29yaWVzID0gW107CiAgICAgICAgICAgICQodGgpLmZpbmQoInRkIHNlbGVjdC5keW5hbWljU2VsZWN0RmllbGRTdWJDYXRlZ29yeSBvcHRpb246c2VsZWN0ZWQiKS5lYWNoKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICBzdWJjYXRlZ29yaWVzLnB1c2goe2lkOiAkKHRoaXMpLnZhbCgpLCBuYW1lOiQodGhpcykudGV4dCgpfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgYWxlcnQgPSAkKHRoKS5maW5kKCJ0ZCBpbnB1dC5hbGVydC1jaGVjay1ib3giKS5pcygiOmNoZWNrZWQiKTsKICAgICAgICAgICAgdmFyIHByaXZhdGUgPSAkKHRoKS5maW5kKCJ0ZCBpbnB1dC5wcml2YXRlLWNoZWNrLWJveCIpLmlzKCI6Y2hlY2tlZCIpOwogICAgICAgICAgICB2YXIgY3VycmVudFJvdyA9IHtjYXRlZ29yeTogY2F0ZWdvcnksIHN1YmNhdGVnb3J5OiBzdWJjYXRlZ29yaWVzLCBhbGVydDogYWxlcnQsIHByaXZhdGU6IHByaXZhdGUsIHByaW9yaXR5OiBjb3VudH07CiAgICAgICAgICAgIGlmKGN1cnJlbnRSb3cuY2F0ZWdvcnkubmFtZSAhPSAnU2VsZWN0IENhdGVnb3J5JyAmJiBjdXJyZW50Um93LmNhdGVnb3J5Lm5hbWUgIT0gJycpIHsKICAgICAgICAgICAgICAgIG5ld1Jvd3MucHVzaChjdXJyZW50Um93KTsKICAgICAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHZhciBkYXRhID0gewogICAgICAgICAgICBuZXdSb3dzOiBKU09OLnN0cmluZ2lmeShuZXdSb3dzKSwKICAgICAgICAgICAgZXhpc3RpbmdSb3dzOiBKU09OLnN0cmluZ2lmeShleGlzdGluZ1Jvd3MpLAogICAgICAgICAgICBhbGVydElkOiBhbGVydElkLAogICAgICAgICAgICB0eXBlOiBkb21haW4sCiAgICAgICAgICAgIGlzQXJjaGl2ZWQ6IGlzQXJjaGl2ZWQKICAgICAgICB9OwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybDogc2F2ZUNvbW1vblRhZ3NVcmwsCiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGRhdGEpLAogICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLAogICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdGFibGUuYWpheC5yZWxvYWQoKQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiBjYXRlZ29yeU1vZGFsVGFibGUKfTsKCgoKCi8vPSByZXF1aXJlIHZlbmRvclVpL2hpZ2hjaGFydHMvaGlnaGNoYXJ0cwovLz0gcmVxdWlyZSB2ZW5kb3JVaS9oaWdoY2hhcnRzL2hpZ2hjaGFydHMtM2QKLy89IHJlcXVpcmUgdmVuZG9yVWkvaGlnaGNoYXJ0cy9oaWdoY2hhcnRzLW1vcmUKLy89IHJlcXVpcmUgdmVuZG9yVWkvaGlnaGNoYXJ0cy90aGVtZXMvZ3JpZC1yeAovLz0gcmVxdWlyZSBhcHAvcHZzL2NvbW1vbi9yeF9jb21tb24uanMKLy89IHJlcXVpcmUgYXBwL3B2cy9jb21tb24vcnhfYWxlcnRfdXRpbHMuanMKLy89IHJlcXVpcmUgYXBwL3B2cy9jb21tb24vcnhfbGlzdF91dGlscy5qcwovLz0gcmVxdWlyZSBhcHAvcHZzL2FjdGl2aXR5L2FjdGl2aXRpZXMuanMKLy89IHJlcXVpcmUgYXBwL3B2cy9hY3Rpb25zL2FjdGlvbnMuanMKLy89IHJlcXVpcmUgYXBwL3B2cy91c2Vycy91c2Vycy5qcwovLz0gcmVxdWlyZSBhcHAvcHZzL2NvbW1vbi9yeF9oYW5kbGViYXJfZXh0LmpzCi8vPSByZXF1aXJlIGFwcC9wdnMvY2FzZURyaWxsRG93bi9jYXNlRHJpbGxEb3duLmpzCi8vPSByZXF1aXJlIGFwcC9wdnMvYWxlcnRDb21tZW50cy9hbGVydENvbW1lbnRzLmpzCi8vPSByZXF1aXJlIGFwcC9wdnMvYWxlcnRzX3Jldmlldy9hbGVydF9yZXZpZXcKLy89IHJlcXVpcmUgYXBwL3B2cy9hbGVydHNfcmV2aWV3L2FyY2hpdmVkQWxlcnRzLmpzCi8vPSByZXF1aXJlIGFwcC9wdnMvY29tbW9uX3RhZy5qcwoKdmFyIGFwcGxpY2F0aW9uTmFtZSA9ICJBZ2dyZWdhdGUgQ2FzZSBBbGVydCI7CnZhciBhcHBsaWNhdGlvbk5hbWVGYWVycyA9ICJBZ2dyZWdhdGUgQ2FzZSBBbGVydCAtIEZBRVJTIjsKdmFyIGFwcGxpY2F0aW9uTmFtZVNtcSA9ICJBZ2dyZWdhdGUgQ2FzZSBBbGVydCAtIFNNUSI7CnZhciBhcHBsaWNhdGlvbkxhYmVsID0gIlF1YW50aXRhdGl2ZSBBbGVydCI7CnZhciB0YWJsZTsKdmFyIGRpciA9ICcnOwp2YXIgaW5kZXggPSAtMTsKdmFyIGV4ZWN1dGVkSWRMaXN0ID0gW107CnZhciBpc0R5bmFtaWNGaWx0ZXJBcHBsaWVkID0gZmFsc2U7CnZhciBwcm9kdWN0TmFtZXM9W107CnZhciBzdWJHcm91cHNNYXAgPSBbXTsKdmFyIGlzQWdlRW5hYmxlZDsKdmFyIGlzR2VuZGVyRW5hYmxlZDsKdmFyIHRhZ3MgPSBbXTsKCiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHsKCiAgICAkKCdhW2hyZWY9IiNkZXRhaWxzIl0nKS5vbigic2hvd24uYnMudGFiIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAkKCcjYWxlcnRzRGV0YWlsc1RhYmxlJykuRGF0YVRhYmxlKCkuY29sdW1ucy5hZGp1c3QoKTsKICAgICAgICBhZGRHcmlkU2hvcnRjdXRzKCcjYWxlcnRzRGV0YWlsc1RhYmxlJyk7CiAgICAgICAgcmVtb3ZlR3JpZFNob3J0Y3V0cygnI2FjdGl2aXRpZXNUYWJsZScpOwogICAgICAgIHJlbW92ZUdyaWRTaG9ydGN1dHMoJyNhcmNoaXZlZEFsZXJ0c1RhYmxlJyk7CiAgICB9KTsKICAgICQoJ2FbaHJlZj0iI2FyY2hpdmVkQWxlcnRzIl0nKS5vbigic2hvd24uYnMudGFiIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAkKCcjYXJjaGl2ZWRBbGVydHNUYWJsZScpLkRhdGFUYWJsZSgpLmNvbHVtbnMuYWRqdXN0KCk7CiAgICAgICAgYWRkR3JpZFNob3J0Y3V0cygnI2FyY2hpdmVkQWxlcnRzVGFibGUnKTsKICAgICAgICByZW1vdmVHcmlkU2hvcnRjdXRzKCcjYWN0aXZpdGllc1RhYmxlJyk7CiAgICAgICAgcmVtb3ZlR3JpZFNob3J0Y3V0cygnI2FsZXJ0c0RldGFpbHNUYWJsZScpOwogICAgfSk7CgogICAgdmFyIGFjdGl2aXRpZXNfdGFibGU7CiAgICAkKCcjYWN0aXZpdHlfdGFiJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChhY3Rpdml0aWVzX3RhYmxlID09IG51bGwgfHwgYWN0aXZpdGllc190YWJsZSA9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaWYgKGNhbGxpbmdTY3JlZW4gPT0gQ0FMTElOR19TQ1JFRU4uUkVWSUVXKSB7CiAgICAgICAgICAgICAgICBhY3Rpdml0aWVzX3RhYmxlID0gc2lnbmFsLmFjdGl2aXRpZXNfdXRpbHMuaW5pdF9hY3Rpdml0aWVzX3RhYmxlKCQoIiNhY3Rpdml0aWVzVGFibGUiKSwKICAgICAgICAgICAgICAgICAgICAnL3NpZ25hbC9hY3Rpdml0eS9saXN0QnlFeGVDb25maWc/JyArICdleGVjdXRlZElkTGlzdD0nICsgZXhlY3V0ZWRJZExpc3QgKyAiJmFwcFR5cGU9IiArIGFwcGxpY2F0aW9uTmFtZSwgYXBwbGljYXRpb25OYW1lKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFjdGl2aXRpZXNfdGFibGUgPSBzaWduYWwuYWN0aXZpdGllc191dGlscy5pbml0X2FjdGl2aXRpZXNfdGFibGUoJCgiI2FjdGl2aXRpZXNUYWJsZSIpLAogICAgICAgICAgICAgICAgICAgICcvc2lnbmFsL2FjdGl2aXR5L2xpc3RBY3Rpdml0aWVzPycgKyAnYXBwVHlwZT0nICsgYXBwbGljYXRpb25OYW1lLCBhcHBsaWNhdGlvbk5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7CgogICAgZmV0Y2hTdWJHcm91cHNNYXAoKTsKICAgIGZldGNoVGFncygpOwoKICAgICQoJ2FbaHJlZj0iI2FyY2hpdmVkQWxlcnRzIl0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKGNhbGxpbmdTY3JlZW4gPT0gQ0FMTElOR19TQ1JFRU4uUkVWSUVXKSB7CiAgICAgICAgICAgIGFyY2hpdmVkX3RhYmxlID0gc2lnbmFsLmFyY2hpdmVkX3V0aWxzLmluaXRfYXJjaGl2ZWRfdGFibGUoIiNhcmNoaXZlZEFsZXJ0c1RhYmxlIiwgYXJjaGl2ZWRBbGVydFVybCwgYXBwbGljYXRpb25OYW1lLCBhZ2dyZWdhdGVEZXRhaWxzVXJsKTsKICAgICAgICB9CiAgICB9KTsKCgogICAgaWYgKGNhbGxpbmdTY3JlZW4gPT0gQ0FMTElOR19TQ1JFRU4uUkVWSUVXIHx8IGNhbGxpbmdTY3JlZW4gPT0gQ0FMTElOR19TQ1JFRU4uREFTSEJPQVJEKSB7CiAgICAgICAgJCh3aW5kb3cpLm9uKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vZGlzY2FyZCB0aGUgdGVtcG9yYXJ5IGNoYW5nZXMgaW4gdGhlIHZpZXcKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDogZGlzY2FyZFRlbXBDaGFuZ2VzVXJsLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJwogICAgICAgICAgICB9KQogICAgICAgIH0pOwogICAgfQoKCiAgICAvL2JhY2sgYnV0dG9uIHRhZyBzY3JlZW4KICAgIGlmIChjYWxsaW5nU2NyZWVuICE9IENBTExJTkdfU0NSRUVOLlRBR1MpIHsKICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJiYWNrX3VybCIsIHdpbmRvdy5sb2NhdGlvbi5ocmVmKQogICAgfQogICAgJCgnLnRhZy1zY3JlZW4tYmFjay1idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdiYWNrX3VybCcpCiAgICB9KTsKCiAgICB2YXIgZnJlcVNlbGVjdGVkID0gIiI7CgogICAgdmFyIGRhdGVSYW5nZVN0cmluZyA9ICQoJyNsaXN0RGF0ZVJhbmdlJykudmFsKCkuc2xpY2UoMSwgLTEpOwogICAgdmFyIGRhdGVSYW5nZUFycmF5ID0gW107CiAgICBpZiAoZGF0ZVJhbmdlU3RyaW5nICE9ICIiKSB7CiAgICAgICAgZGF0ZVJhbmdlQXJyYXkgPSBkYXRlUmFuZ2VTdHJpbmcuc3BsaXQoJywgJyk7CiAgICB9CiAgICB2YXIgbGlzdE9mSW5kZXggPSBbXTsKICAgIHZhciBmaWx0ZXJJbmRleCA9IFtdOwoKICAgICQod2luZG93KS5iaW5kKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2lzVmlld0NhbGwnKSA9PSAndHJ1ZScgfHwgJCgnLnZpZXdTZWxlY3QgOnNlbGVjdGVkJykudGV4dCgpLnJlcGxhY2UoIihkZWZhdWx0KSIsICIiKS50cmltKCkgIT0gJ1N5c3RlbSBWaWV3JykgewogICAgICAgICAgICB2YXIgYmFja1VybCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2JhY2tfdXJsJyk7CiAgICAgICAgICAgIHZhciBvbGRQcm9kdWN0TmFtZUxpc3QgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFBST0RVQ1RfTElTVCk7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2JhY2tfdXJsJywgYmFja1VybCk7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oUFJPRFVDVF9MSVNULCBvbGRQcm9kdWN0TmFtZUxpc3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciB2aWV3SW5mbyA9IHNpZ25hbC5hbGVydFJldmlldy5nZW5lcmF0ZVZpZXdJbmZvKGZpbHRlckluZGV4KTsKICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnYWNhX2ZpbHRlck1hcF8nICsgZXhlY3V0ZWRDb25maWdJZCwgSlNPTi5zdHJpbmdpZnkodmlld0luZm8uZmlsdGVyTWFwKSk7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2FjYV9zb3J0ZWRDb2x1bW5fJyArIGV4ZWN1dGVkQ29uZmlnSWQsIEpTT04uc3RyaW5naWZ5KHZpZXdJbmZvLnNvcnRlZENvbHVtbikpOwogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdhY2Ffbm90VmlzaWJsZUNvbHVtbl8nICsgZXhlY3V0ZWRDb25maWdJZCwgdmlld0luZm8ubm90VmlzaWJsZUNvbHVtbik7CiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2FjYV92aWV3TmFtZV8nICsgZXhlY3V0ZWRDb25maWdJZCwgJCgnLnZpZXdTZWxlY3QgOnNlbGVjdGVkJykudGV4dCgpLnJlcGxhY2UoIihkZWZhdWx0KSIsICIiKS50cmltKCkpCiAgICAgICAgfQogICAgfSk7CgogICAgZnVuY3Rpb24gc2hvd1BvcHVwKGRhdGEpIHsKICAgICAgICB2YXIgZXZkYXNEYXRhTG9nTW9kYWwgPSAkKCIjZG93bmxvYWRSZXBvcnRNb2RhbCIpOwogICAgICAgICQoZXZkYXNEYXRhTG9nTW9kYWwpLmZpbmQoIiNwcm9kdWN0TmFtZSIpLnZhbChkYXRhKTsKICAgICAgICBldmRhc0RhdGFMb2dNb2RhbC5tb2RhbCgic2hvdyIpOwogICAgfQoKICAgIHZhciBkZXRhaWxfdGFibGU7CiAgICB2YXIgYWN0aXZpdGllc190YWJsZTsKCiAgICB2YXIgY2hlY2tlZElkTGlzdCA9IFtdOwogICAgdmFyIGNoZWNrZWRSb3dMaXN0ID0gW107CgogICAgc2lnbmFsLmFjdGlvbnNfdXRpbHMuc2V0X2FjdGlvbl9saXN0X21vZGFsKCQoJyNhY3Rpb24tbW9kYWwnKSk7CiAgICBzaWduYWwuYWN0aW9uc191dGlscy5zZXRfYWN0aW9uX2NyZWF0ZV9tb2RhbCgkKCcjYWN0aW9uLWNyZWF0ZS1tb2RhbCcpKTsKICAgIHNpZ25hbC5saXN0X3V0aWxzLmZsYWdfaGFuZGxlcigiYWdncmVnYXRlQ2FzZUFsZXJ0IiwgInRvZ2dsZUZsYWciKTsKICAgIHNpZ25hbC5jb21tb25UYWcub3BlbkNvbW1vbkFsZXJ0VGFnTW9kYWwoIlBWUyIsIlF1YW50aXRhdGl2ZSIsIHRhZ3MpOwogICAgc2lnbmFsLmFsZXJ0UmV2aWV3Lm9wZW5BbGVydENvbW1lbnRNb2RhbCgiQWdncmVnYXRlIENhc2UgQWxlcnQiLCBhcHBsaWNhdGlvbk5hbWUsIGFwcGxpY2F0aW9uTGFiZWwsIGNoZWNrZWRJZExpc3QsIGNoZWNrZWRSb3dMaXN0KTsKICAgIHNpZ25hbC5hbGVydFJldmlldy5zaG93QXR0YWNobWVudE1vZGFsKCk7CiAgICBzaWduYWwuYWxlcnRSZXZpZXcucG9wdWxhdGVBZHZhbmNlZEZpbHRlclNlbGVjdChhcHBsaWNhdGlvbk5hbWUpOwogICAgc2lnbmFsLmFsZXJ0UmV2aWV3LnNldFNvcnRPcmRlcigpOwogICAgc2lnbmFsLmNhc2VEcmlsbERvd24uYmluZF9kcmlsbF9kb3duX3RhYmxlKGNhc2VEZXRhaWxVcmwpOwoKICAgIHZhciBmaWx0ZXJWYWx1ZSA9IHNpZ25hbC5hbGVydFJldmlldy5jcmVhdGVGaWx0ZXJNYXAoQUxFUlRfUFJFRklYX0ZJTFRFUi5BR0cgKyBleGVjdXRlZENvbmZpZ0lkLCBBTEVSVF9QUkVGSVhfVklFVy5BR0cgKyBleGVjdXRlZENvbmZpZ0lkKTsKCgogICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5wcm9kdWN0LWV2ZW50LWhpc3RvcnktaWNvbicsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdmFyIHBhcmVudF9yb3cgPSAkKGV2ZW50LnRhcmdldCkuY2xvc2VzdCgndHInKTsKICAgICAgICB2YXIgcHJvZHVjdE5hbWUgPWVuY29kZVRvSFRNTCggcGFyZW50X3Jvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9InByb2R1Y3ROYW1lIl0nKS5hdHRyKCJkYXRhLWlkIikpOwogICAgICAgIHZhciBldmVudE5hbWUgPSBlbmNvZGVUb0hUTUwocGFyZW50X3Jvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9ImV2ZW50TmFtZSJdJykuYXR0cigiZGF0YS1pZCIpKTsKICAgICAgICB2YXIgY29uZmlnSWQgPSAkKHRoaXMpLmRhdGEoImNvbmZpZ2lkIik7CiAgICAgICAgdmFyIHByb2R1Y3RFdmVudEhpc3RvcnlNb2RhbCA9ICQoJyNwcm9kdWN0RXZlbnRIaXN0b3J5TW9kYWwnKTsKICAgICAgICBwcm9kdWN0RXZlbnRIaXN0b3J5TW9kYWwubW9kYWwoJ3Nob3cnKTsKICAgICAgICBwcm9kdWN0RXZlbnRIaXN0b3J5TW9kYWwuZmluZCgiI3Byb2R1Y3ROYW1lIikuaHRtbChwcm9kdWN0TmFtZSk7CiAgICAgICAgcHJvZHVjdEV2ZW50SGlzdG9yeU1vZGFsLmZpbmQoIiNldmVudE5hbWUiKS5odG1sKGV2ZW50TmFtZSk7CiAgICAgICAgcHJvZHVjdEV2ZW50SGlzdG9yeU1vZGFsLmZpbmQoIiNjb25maWdJZCIpLmh0bWwoY29uZmlnSWQpOwoKICAgICAgICBzaWduYWwucHJvZHVjdEV2ZW50SGlzdG9yeVRhYmxlLmluaXRfY3VycmVudF9hbGVydF9oaXN0b3J5X3RhYmxlKHByb2R1Y3RFdmVudEhpc3RvcnlVcmwsIHByb2R1Y3ROYW1lLCBldmVudE5hbWUsIGNvbmZpZ0lkLCBleGVjdXRlZENvbmZpZ0lkKTsKICAgICAgICBzaWduYWwucHJvZHVjdEV2ZW50SGlzdG9yeVRhYmxlLmluaXRfb3RoZXJfYWxlcnRzX2hpc3RvcnlfdGFibGUocHJvZHVjdEV2ZW50SGlzdG9yeVVybCwgcHJvZHVjdE5hbWUsIGV2ZW50TmFtZSwgY29uZmlnSWQpOwogICAgfSk7CgogICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zaG93LXRyZW5kLWljb24nLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICB2YXIgYWxlcnRJZCA9ICQodGhpcykuYXR0cigiZGF0YS12YWx1ZSIpOwogICAgICAgIHZhciBpc0ZhZXJzID0gJCgnI2lzRmFlcnMnKS52YWwoKTsKICAgICAgICB2YXIgc2hvd1RyZW5kVGFibGVVcmwgPSBzaG93VHJlbmRVcmwgKyAiP2lkPSIgKyBhbGVydElkICsgIiZpc0ZhZXJzPSIgKyBpc0ZhZXJzOwogICAgICAgIHZhciB3aW4gPSB3aW5kb3cub3BlbihzaG93VHJlbmRUYWJsZVVybCwgJ19ibGFuaycpOwogICAgICAgIHdpbi5mb2N1cygpOwogICAgfSk7CgogICAgJCgiLmRvd25sb2FkTWVtb1JlcG9ydCIpLmNsaWNrKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIHNob3dQb3B1cCgkKGV2ZW50LnRhcmdldCkucGFyZW50KCkuZGF0YSgnaWQnKSk7CiAgICB9KTsKCiAgICAkKCIjc2hvd0FsbCIpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdXJsID0gbGlzdENvbmZpZ1VybCArICImc3BlY2lhbFBFPSIgKyBmYWxzZTsKICAgICAgICB0YWJsZS5hamF4LnVybCh1cmwpLmxvYWQoKTsKICAgIH0pOwoKICAgICQoIiNzaG93U3BlY2lhbFBFIikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHZhciB1cmwgPSBsaXN0Q29uZmlnVXJsICsgIiZzcGVjaWFsUEU9IiArIHRydWU7CiAgICAgICAgdGFibGUuYWpheC51cmwodXJsKS5sb2FkKCk7CiAgICB9KTsKCiAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAiLmdlbmVyYXRlLWNhc2Utc2VyaWVzIiwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZXRhSW5mbyA9ICQodGhpcykuYXR0cigiZGF0YS11cmwiKTsKICAgICAgICB2YXIgcGFyZW50X3JvdyA9ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCd0cicpOwogICAgICAgIHZhciBleGVjQ29uZmlnSWQgPSBwYXJlbnRfcm93LmZpbmQoIiNleGVjQ29uZmlnSWQiKS52YWwoKTsKICAgICAgICB2YXIgcHJvZHVjdE5hbWUgPSBwYXJlbnRfcm93LmZpbmQoJ3NwYW5bZGF0YS1maWVsZD0icHJvZHVjdE5hbWUiXScpLmF0dHIoImRhdGEtaWQiKTsKICAgICAgICB2YXIgZXZlbnROYW1lID0gcGFyZW50X3Jvdy5maW5kKCdzcGFuW2RhdGEtZmllbGQ9ImV2ZW50TmFtZSJdJykuYXR0cigiZGF0YS1pZCIpOwogICAgICAgIHZhciBjYXNlU2VyaWVzTW9kYWwgPSAkKCIjY2FzZS1zZXJpZXMtbW9kYWwiKTsKICAgICAgICBjYXNlU2VyaWVzTW9kYWwubW9kYWwoInNob3ciKTsKICAgICAgICBjYXNlU2VyaWVzTW9kYWwuZmluZCgiI2Nhc2Utc2VyaWVzLW5hbWUiKS52YWwocHJvZHVjdE5hbWUgKyAiXyIgKyBldmVudE5hbWUgKyAiXyIgKyBleGVjQ29uZmlnSWQpOwogICAgICAgIGNhc2VTZXJpZXNNb2RhbC5maW5kKCIuc2F2ZS1jYXNlLXNlcmllcyIpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHNlcmllc05hbWUgPSBjYXNlU2VyaWVzTW9kYWwuZmluZCgiI2Nhc2Utc2VyaWVzLW5hbWUiKS52YWwoKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDogZ2VuZXJhdGVDYXNlU2VyaWVzVXJsICsgIj9tZXRhSW5mbz0iICsgbWV0YUluZm8gKyAiJnNlcmllc05hbWU9IiArIHNlcmllc05hbWUgKyAiJmlzQXJjaGl2ZWQ9IiArIGlzQXJjaGl2ZWQsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZVNlcmllc01vZGFsLm1vZGFsKCJoaWRlIik7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQ2FzZSBTZXJpZXMgU2F2aW5nIEZhaWxlZC4iKTsKICAgICAgICAgICAgICAgICAgICBjYXNlU2VyaWVzTW9kYWwubW9kYWwoImhpZGUiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KQogICAgfSk7CgoKICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc3RyLWxpbmsnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICB2YXIgaWQgPSAkKHRoaXMpLmRhdGEoJ2lkJyk7CiAgICAgICAgdmFyIHByclR5cGUgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdHlwZScpOwoKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6IGZldGNoU3RyYXRpZmllZFNjb3Jlc1VybCArICImYWxlcnRJZD0iICsgaWQgKyAiJnByclR5cGU9IiArIHByclR5cGUsCiAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgY2FjaGU6IGZhbHNlCiAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbiAocGF5bG9hZCkgewogICAgICAgICAgICB2YXIgJG1vZGFsU3RyYWl0aWZpZWRTY29yZSA9ICQoJyNtb2RhbFN0cmF0aWZpZWRTY29yZScpOwogICAgICAgICAgICAkKCIjc3RyYXRpZmllZC1zY29yZS10YWJsZSB0cj50ZCIpLnJlbW92ZSgpOwogICAgICAgICAgICAkbW9kYWxTdHJhaXRpZmllZFNjb3JlLmZpbmQoIiNwYXJhbVZhbHVlIikuaHRtbChwcnJUeXBlKTsKICAgICAgICAgICAgaWYgKHBheWxvYWQuRXJyb3JNZXNzYWdlID09ICIiKSB7CiAgICAgICAgICAgICAgICAkbW9kYWxTdHJhaXRpZmllZFNjb3JlLmZpbmQoIiNlcnJvciIpLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAkbW9kYWxTdHJhaXRpZmllZFNjb3JlLmZpbmQoIiNzdHJhdGlmaWVkLXNjb3JlLXRhYmxlIikucmVtb3ZlQ2xhc3MoJ2hpZGUnKTsKICAgICAgICAgICAgICAgIGpRdWVyeS5lYWNoKHBheWxvYWQsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSAhPSAiRXJyb3JNZXNzYWdlIikgewogICAgICAgICAgICAgICAgICAgICAgICAkKCcjc3RyYXRpZmllZC1zY29yZS10YWJsZScpLmZpbmQoJ3Rib2R5JykuYXBwZW5kKCI8dHI+PHRkPiIgKyBrZXkgKyAiPC90ZD4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8dGQ+IiArIHZhbHVlICsgIjwvdGQ+PC90cj4iKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRtb2RhbFN0cmFpdGlmaWVkU2NvcmUuZmluZCgiI3N0cmF0aWZpZWQtc2NvcmUtdGFibGUiKS5hZGRDbGFzcygnaGlkZScpOwogICAgICAgICAgICAgICAgJG1vZGFsU3RyYWl0aWZpZWRTY29yZS5maW5kKCIjZXJyb3IiKS5odG1sKHBheWxvYWQuRXJyb3JNZXNzYWdlKTsKICAgICAgICAgICAgICAgICRtb2RhbFN0cmFpdGlmaWVkU2NvcmUuZmluZCgiI2Vycm9yIikucmVtb3ZlQ2xhc3MoJ2hpZGUnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkbW9kYWxTdHJhaXRpZmllZFNjb3JlLm1vZGFsKHt9KTsKICAgICAgICB9KTsKICAgIH0pOwoKICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuc2hvdy1jaGFydC1pY29uJywgZnVuY3Rpb24gKGV2ZW50KSB7CgogICAgICAgIHZhciBhbGVydElkID0gJCh0aGlzKS5hdHRyKCJkYXRhLXZhbHVlIik7CiAgICAgICAgdmFyIHNob3dFdmRhc0NoYXJ0ID0gJCgiI3Nob3ctZXZkYXMtY2hhcnQtbW9kYWwiKTsKICAgICAgICBzaG93RXZkYXNDaGFydC5tb2RhbCgic2hvdyIpOwoKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB1cmw6ICdzaG93Q2hhcnRzP2FsZXJ0SWQ9JyArIGFsZXJ0SWQgKyAnJmlzQXJjaGl2ZWQ9JyArIGlzQXJjaGl2ZWQsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXN1bHQpIHsKCiAgICAgICAgICAgICAgICBldmRhc19jaGFydCgiI2V2ZGFzLWNvdW50LWJ5LXN0YXR1cyIsIHJlc3VsdC54QXhpc1RpdGxlLAogICAgICAgICAgICAgICAgICAgIFt7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJTdHVkeSIsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdC5zdHVkeUNvdW50CiAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiU3BvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdC5zcG9uQ291bnQKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJTZXJpb3VzIiwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogcmVzdWx0LnNlcmlvdXNDb3VudAogICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogIkZhdGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogcmVzdWx0LmZhdGFsQ291bnQKICAgICAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgICAgICAiQ291bnRzIiwgJ0NvdW50cycKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB2YXIgcHJyVmFsdWU9Jyc7CiAgICAgICAgICAgICAgICB2YXIgcm9yVmFsdWU9Jyc7CiAgICAgICAgICAgICAgICB2YXIgZWJnbVZhbHVlPScnOwogICAgICAgICAgICAgICAgdmFyIHNlcmllc1ZhbHVlPVtdCiAgICAgICAgICAgICAgICBpZihyZXN1bHQucHJyVmFsdWUpewogICAgICAgICAgICAgICAgICAgIHByclZhbHVlPXJlc3VsdC5wcnJWYWx1ZQogICAgICAgICAgICAgICAgICAgIHNlcmllc1ZhbHVlLnB1c2goe25hbWU6ICJQUlIiLCBkYXRhOiByZXN1bHQucHJyVmFsdWV9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYocmVzdWx0LnJvclZhbHVlKXsKICAgICAgICAgICAgICAgICAgICByb3JWYWx1ZT1yZXN1bHQucm9yVmFsdWUKICAgICAgICAgICAgICAgICAgICBzZXJpZXNWYWx1ZS5wdXNoKHtuYW1lOiAiUk9SIiwgZGF0YTogcmVzdWx0LnJvclZhbHVlfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHJlc3VsdC5lYmdtVmFsdWUpewogICAgICAgICAgICAgICAgICAgIGViZ21WYWx1ZT1yZXN1bHQuZWJnbVZhbHVlCiAgICAgICAgICAgICAgICAgICAgc2VyaWVzVmFsdWUucHVzaCh7bmFtZTogIkVCR00iLCBkYXRhOiByZXN1bHQuZWJnbVZhbHVlfSkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBldmRhc19jaGFydCgiI2V2ZGFzLXNjb3Jlcy1ieS1zdGF0dXMiLCByZXN1bHQueEF4aXNUaXRsZSxzZXJpZXNWYWx1ZSwgIlNjb3JlcyIsICdTY29yZXMnKTsKCiAgICAgICAgICAgICAgICB2YXIgY291bnRUYWJsZSA9IFtdOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHJlc3VsdC54QXhpc1RpdGxlLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ4QXhpc1RpdGxlIjogcmVzdWx0LnhBeGlzVGl0bGVbaW5kZXhdLAogICAgICAgICAgICAgICAgICAgICAgICAic3R1ZHlDb3VudCI6IHJlc3VsdC5zdHVkeUNvdW50W2luZGV4XSwKICAgICAgICAgICAgICAgICAgICAgICAgInNwb25Db3VudCI6IHJlc3VsdC5zcG9uQ291bnRbaW5kZXhdLAogICAgICAgICAgICAgICAgICAgICAgICAic2VyaW91c0NvdW50IjogcmVzdWx0LnNlcmlvdXNDb3VudFtpbmRleF0sCiAgICAgICAgICAgICAgICAgICAgICAgICJmYXRhbENvdW50IjogcmVzdWx0LmZhdGFsQ291bnRbaW5kZXhdCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjb3VudFRhYmxlLnB1c2gob2JqKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciB0cmVuZF9kYXRhX2NvbnRlbnQgPSBzaWduYWwudXRpbHMucmVuZGVyKCdjb3VudFRhYmxlJywge3RyZW5kRGF0YTogY291bnRUYWJsZX0pOwogICAgICAgICAgICAgICAgJCgiI3RyZW5kLWRpdiIpLmh0bWwodHJlbmRfZGF0YV9jb250ZW50KTsKCiAgICAgICAgICAgICAgICB2YXIgc2NvcmVzVGFibGUgPSBbXTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCByZXN1bHQueEF4aXNUaXRsZS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gewogICAgICAgICAgICAgICAgICAgICAgICAieEF4aXNUaXRsZSI6IHJlc3VsdC54QXhpc1RpdGxlW2luZGV4XSwKICAgICAgICAgICAgICAgICAgICAgICAgInByclZhbHVlIjogcHJyVmFsdWVbaW5kZXhdLAogICAgICAgICAgICAgICAgICAgICAgICAicm9yVmFsdWUiOiByb3JWYWx1ZVtpbmRleF0sCiAgICAgICAgICAgICAgICAgICAgICAgICJlYmdtVmFsdWUiOiBlYmdtVmFsdWVbaW5kZXhdCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBzY29yZXNUYWJsZS5wdXNoKG9iaik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgc2NvcmVfZGF0YV9jb250ZW50ID0gc2lnbmFsLnV0aWxzLnJlbmRlcignc2NvcmVzVGFibGUnLCB7dHJlbmREYXRhOiBzY29yZXNUYWJsZX0pOwogICAgICAgICAgICAgICAgJCgiI3Njb3Jlcy1kaXYiKS5odG1sKHNjb3JlX2RhdGFfY29udGVudCk7CiAgICAgICAgICAgICAgICBpZighZWJnbVZhbHVlKXsKICAgICAgICAgICAgICAgICAgICAkKCIuZWJnbS12YWx1ZSIpLmhpZGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCFwcnJWYWx1ZSl7JCgiLnByci12YWx1ZSIpLmhpZGUoKTt9CiAgICAgICAgICAgICAgICBpZighcm9yVmFsdWUpeyQoIi5yb3ItdmFsdWUiKS5oaWRlKCk7fQogICAgICAgICAgICB9CgogICAgICAgIH0pCgogICAgfSk7CgogICAgLy9hcHBseSB0aGUgc29ydGluZyB0byBjb2x1bW4gYmFzZWQgb24gc2F2ZWQgdmlldwogICAgdmFyIHNvcnRpbmdNYXAgPSBzaWduYWwuYWxlcnRSZXZpZXcuY3JlYXRlU29ydGluZ01hcCgnYWNhX3NvcnRlZENvbHVtbl8nICsgZXhlY3V0ZWRDb25maWdJZCwgJ2FjYV92aWV3TmFtZV8nICsgZXhlY3V0ZWRDb25maWdJZCk7CiAgICBpZiAoc29ydGluZ01hcCAhPSAndW5kZWZpbmVkJyAmJiBzb3J0aW5nTWFwLmxlbmd0aCA+IDApIHsKICAgICAgICBpbmRleCA9IHNvcnRpbmdNYXBbMF1bMF07CiAgICAgICAgZGlyID0gc29ydGluZ01hcFswXVsxXQogICAgfQogICAgJCgnI2FsZXJ0LWxpc3QtZmlsdGVyLWFwcGx5LWJ0JykuY2xpY2soZnVuY3Rpb24gKGV2dCkgewogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHZhciBmaWx0ZXJQYXJhbXMgPSAkKCcjYWxlcnQtbGlzdC1maWx0ZXInKS5zZXJpYWxpemUoKTsKICAgICAgICB2YXIgdGhlRGF0YVRhYmxlID0gJCgnI2FsZXJ0c0RldGFpbHNUYWJsZScpLkRhdGFUYWJsZSgpOwogICAgICAgICQoJyNhbGVydC1saXN0LWZpbHRlcicpLmZpbmQoJyNmaWx0ZXJVc2VkJykudmFsKHRydWUpOwogICAgICAgIHZhciBuZXdVcmwgPSBsaXN0Q29uZmlnVXJsICsgIiYiICsgZmlsdGVyUGFyYW1zICsgIiZmaWx0ZXJBcHBsaWVkPSIgKyB0cnVlOwogICAgICAgIHRoZURhdGFUYWJsZS5hamF4LnVybChuZXdVcmwpLmxvYWQoKTsKICAgIH0pOwoKICAgICQoIiNkZXRhaWwtdGFicyBhW2hyZWY9JyNkZXRhaWxzJ10iKS5vbigiY2xpY2siLCBmdW5jdGlvbiAoZSkgewogICAgICAgICQoJyNhbGVydHNEZXRhaWxzVGFibGUnKS5EYXRhVGFibGUoKS5jb2x1bW5zLmFkanVzdCgpOwogICAgfSk7CgogICAgdmFyIGluaXQgPSBmdW5jdGlvbiAocmVzdWx0LCBncm91cEJ5U21xKSB7CiAgICAgICAgc2lnbmFsLmZpZWxkTWFuYWdlbWVudC5wb3B1bGF0ZUNvbHVtbkxpc3QoZ3JpZENvbHVtbnNWaWV3VXJsLCBncmlkQ29sdW1uc1ZpZXdVcGRhdGVVcmwpOwogICAgICAgIGRldGFpbF90YWJsZSA9IGluaXRfZGV0YWlsc190YWJsZShyZXN1bHQsIGdyb3VwQnlTbXEpOwoKICAgICAgICAkKCdpI2NvcHlTZWxlY3Rpb24nKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHNob3dBbGxTZWxlY3RlZENhc2VOdW1iZXJzKCk7CiAgICAgICAgfSk7CgogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdpbnB1dCNzZWxlY3QtYWxsJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAkKCIuY29weS1zZWxlY3QiKS5wcm9wKCdjaGVja2VkJywgdGhpcy5jaGVja2VkKTsKICAgICAgICB9KTsKCiAgICAgICAgYWN0aW9uQnV0dG9uKCIjYWxlcnRzRGV0YWlsc1RhYmxlIik7CiAgICB9OwoKICAgIHZhciBldmRhc19jaGFydCA9IGZ1bmN0aW9uIChjaGFydElkLCBjYXRlZ29yaWVzLCBzZXJpZXMsIHlBeGlzVGl0bGUsIGNoYXJ0VGl0bGUpIHsKICAgICAgICAkKGNoYXJ0SWQpLmhpZ2hjaGFydHMoewogICAgICAgICAgICBjaGFydDogewogICAgICAgICAgICAgICAgdHlwZTogJ2xpbmUnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHhBeGlzOiB7CiAgICAgICAgICAgICAgICBjYXRlZ29yaWVzOiBjYXRlZ29yaWVzCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHlBeGlzOiB7CiAgICAgICAgICAgICAgICBwbG90TGluZXM6IFt7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEsCiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjODA4MDgwJwogICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgICB0aXRsZTogewogICAgICAgICAgICAgICAgICAgIHRleHQ6IHlBeGlzVGl0bGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2VyaWVzOiBzZXJpZXMsCiAgICAgICAgICAgIGNyZWRpdHM6IHsKICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRpdGxlOiB7CiAgICAgICAgICAgICAgICB0ZXh0OiBjaGFydFRpdGxlCiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CgogICAgdmFyIHB0QmFkZ2UgPSBmdW5jdGlvbiAoaW1lLCBkbWUsIGVpLCBzbSkgewogICAgICAgIHZhciBiYWRnZVNwYW4gPSAiIjsKICAgICAgICBpZiAoZG1lID09ICJ0cnVlIikgewogICAgICAgICAgICBiYWRnZVNwYW4gKz0gJzxzcGFuIGNsYXNzPSJiYWRnZSBiYWRnZS1wdXJwbGUiPkRNRTwvc3Bhbj48YnIvPicKICAgICAgICB9CiAgICAgICAgaWYgKGVpID09ICJ0cnVlIikgewogICAgICAgICAgICBiYWRnZVNwYW4gKz0gJzxzcGFuIGNsYXNzPSJiYWRnZSBiYWRnZS1zdWNjZXNzIj5FSTwvc3Bhbj4nCiAgICAgICAgfQogICAgICAgIGlmIChpbWUgPT0gInRydWUiKSB7CiAgICAgICAgICAgIGJhZGdlU3BhbiArPSAnPHNwYW4gY2xhc3M9ImJhZGdlIGJhZGdlLWluZm8iPklNRTwvc3Bhbj4nCiAgICAgICAgfQogICAgICAgIGlmIChzbSA9PSAidHJ1ZSIpIHsKICAgICAgICAgICAgYmFkZ2VTcGFuICs9ICc8c3BhbiBjbGFzcz0iYmFkZ2UgYmFkZ2Utd2FybmluZyI+U008L3NwYW4+JwogICAgICAgIH0KICAgICAgICByZXR1cm4gYmFkZ2VTcGFuCiAgICB9OwoKICAgIHZhciBpbml0X2ZpbHRlciA9IGZ1bmN0aW9uIChkYXRhX3RhYmxlLCBwcnJWaXNpYmlsaXR5LCByb3JWaXNpYmlsaXR5LCBlYmdtVmlzaWJpbGl0eSwgZHNzVmlzaWJpbGl0eSwgZ3JvdXBCeVNtcSkgewogICAgICAgIHZhciBjdW11bGF0aXZlID0gJCgiI2N1bXVsYXRpdmUiKS52YWwoKTsKCiAgICAgICAgdmFyIGZpbHRlck9wdGlvbnMgPSBbXTsKICAgICAgICB2YXIgZmlsdGVySW5kZXhNYXAgPSB7fTsKICAgICAgICB2YXIgbGFzdFZhbHVlOwoKICAgICAgICBpZiAoY3VtdWxhdGl2ZSA9PSAidHJ1ZSIpIHsKICAgICAgICAgICAgZmlsdGVySW5kZXhNYXAgPSB7CiAgICAgICAgICAgICAgICA1IDonc2VsZWN0JywKICAgICAgICAgICAgICAgIDEwICA6ICd0ZXh0JywgLy9pbXAgZXZlbnRzCiAgICAgICAgICAgICAgICAxMSA6ICd0ZXh0JywgIC8vbGlzdGVkdmFyIGlzUHJpb3J0eUNoYW5nZUFsbG93ZWQgPSAoaXNQcm9kdWN0U2VjdXJpdHkgPT0gJ3RydWUnICYmIGFsbG93ZWRQcm9kdWN0c0FzU2FmZXR5TGVhZC5pbmNsdWRlcyhyb3cucHJvZHVjdE5hbWUpKQogICAgICAgICAgICAgICAgMTIgOiAnY291bnQnLCAvL25ldyBjb3VudAogICAgICAgICAgICAgICAgMTMgOiAnY291bnQnLCAgLy9uZXcgc3BvbiBjb3VudAogICAgICAgICAgICAgICAgMTQgOiAnY291bnQnLCAvL3NlcmlvdXMgY291bnQKICAgICAgICAgICAgICAgIDE1IDogJ2NvdW50JywgLy9mYXRhbCBjb3VudAogICAgICAgICAgICAgICAgMTYgOiAnY291bnQnLCAvL3N0dWR5IGNvdW50CiAgICAgICAgICAgICAgICAxOCA6ICd0ZXh0JyAvL3RyZW5kIHR5cGUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZmlsdGVySW5kZXggPSBbNSwxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMThdOwogICAgICAgIH0gZWxzZSBpZiAoZ3JvdXBCeVNtcSA9PSAidHJ1ZSIpIHsKICAgICAgICAgICAgZmlsdGVySW5kZXhNYXAgPSB7CiAgICAgICAgICAgICAgICA1IDonc2VsZWN0JywKICAgICAgICAgICAgICAgIDggOiAndGV4dCcsIC8vaW1wIGV2ZW50cwogICAgICAgICAgICAgICAgOSA6ICdjb3VudCcsIC8vbmV3IGNvdW50CiAgICAgICAgICAgICAgICAxMDogJ2NvdW50JywgIC8vbmV3IHNwb24gY291bnQKICAgICAgICAgICAgICAgIDExOiAnY291bnQnLCAvL3NlcmlvdXMgY291bnQKICAgICAgICAgICAgICAgIDEyOiAnY291bnQnLCAvL2ZhdGFsIGNvdW50CiAgICAgICAgICAgICAgICAxMzogJ2NvdW50JywgLy9zdHVkeSBjb3VudAogICAgICAgICAgICAgICAgMTU6ICd0ZXh0JyAvL3RyZW5kIHR5cGUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZmlsdGVySW5kZXggPSBbNSw4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTVdOwogICAgICAgIH0gZWxzZSBpZihjYWxsaW5nU2NyZWVuID09IENBTExJTkdfU0NSRUVOLkRBU0hCT0FSRCl7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwID0gewogICAgICAgICAgICAgICAgNiAgOiAnc2VsZWN0JywKICAgICAgICAgICAgICAgIDEwIDogJ3RleHQnLCAvL2ltcCBldmVudHMKICAgICAgICAgICAgICAgIDExIDogJ3RleHQnLCAgLy9saXN0ZWQKICAgICAgICAgICAgICAgIDEyIDogJ2NvdW50JywgLy9uZXcgY291bnQKICAgICAgICAgICAgICAgIDEzIDogJ2NvdW50JywgIC8vbmV3IHNwb24gY291bnQKICAgICAgICAgICAgICAgIDE0IDogJ2NvdW50JywgLy9zZXJpb3VzIGNvdW50CiAgICAgICAgICAgICAgICAxNSA6ICdjb3VudCcsIC8vZmF0YWwgY291bnQKICAgICAgICAgICAgICAgIDE2IDogJ2NvdW50JywgLy9zdHVkeSBjb3VudAogICAgICAgICAgICAgICAgMTggOiAndGV4dCcgLy90cmVuZCB0eXBlCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGZpbHRlckluZGV4ID0gWzYsMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE4XTsKICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwID0gewogICAgICAgICAgICAgICAgNSAgOiAnc2VsZWN0JywKICAgICAgICAgICAgICAgIDkgIDogJ3RleHQnLCAvL2ltcCBldmVudHMKICAgICAgICAgICAgICAgIDEwIDogJ3RleHQnLCAgLy9saXN0ZWQKICAgICAgICAgICAgICAgIDExIDogJ2NvdW50JywgLy9uZXcgY291bnQKICAgICAgICAgICAgICAgIDEyIDogJ2NvdW50JywgIC8vbmV3IHNwb24gY291bnQKICAgICAgICAgICAgICAgIDEzIDogJ2NvdW50JywgLy9zZXJpb3VzIGNvdW50CiAgICAgICAgICAgICAgICAxNCA6ICdjb3VudCcsIC8vZmF0YWwgY291bnQKICAgICAgICAgICAgICAgIDE1IDogJ2NvdW50JywgLy9zdHVkeSBjb3VudAogICAgICAgICAgICAgICAgMTcgOiAndGV4dCcgLy90cmVuZCB0eXBlCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGZpbHRlckluZGV4ID0gWzUsOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTddCiAgICAgICAgfQoKICAgICAgICBpZiAocHJyVmlzaWJpbGl0eSkgewogICAgICAgICAgICBsYXN0VmFsdWUgPSBwYXJzZUludChPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcClbT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApLmxlbmd0aCAtIDFdKTsKICAgICAgICAgICAgZmlsdGVySW5kZXhNYXBbbGFzdFZhbHVlICsgMV0gPSAnY291bnQnOwogICAgICAgICAgICBmaWx0ZXJJbmRleC5wdXNoKGxhc3RWYWx1ZSArIDEpCiAgICAgICAgfQogICAgICAgIGlmIChyb3JWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgIGxhc3RWYWx1ZSA9IHBhcnNlSW50KE9iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKVtPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcCkubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyAxXSA9ICdjb3VudCc7CiAgICAgICAgICAgIGZpbHRlckluZGV4LnB1c2gobGFzdFZhbHVlICsgMSkKICAgICAgICB9CiAgICAgICAgaWYgKHByclZpc2liaWxpdHkgJiYgcm9yVmlzaWJpbGl0eSkgewogICAgICAgICAgICAvL2NoaS1zcXVhcmUKICAgICAgICAgICAgbGFzdFZhbHVlID0gcGFyc2VJbnQoT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApW09iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKS5sZW5ndGggLSAxXSk7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwW2xhc3RWYWx1ZSArIDFdID0gJ2NvdW50JzsKICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKQogICAgICAgIH0KICAgICAgICBpZiAoZWJnbVZpc2liaWxpdHkpIHsKICAgICAgICAgICAgbGFzdFZhbHVlID0gcGFyc2VJbnQoT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApW09iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKS5sZW5ndGggLSAxXSk7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwW2xhc3RWYWx1ZSArIDFdID0gJ2NvdW50JzsKICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKQogICAgICAgIH0KICAgICAgICBsYXN0VmFsdWUgPSBwYXJzZUludChPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcClbT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApLmxlbmd0aCAtIDFdKTsKICAgICAgICBsaXN0T2ZJbmRleC5wdXNoKGxhc3RWYWx1ZSArIDcpOwogICAgICAgIGlmIChncm91cEJ5U21xID09ICJ0cnVlIiB8fCBjdW11bGF0aXZlID09ICJ0cnVlIikgewogICAgICAgICAgICAvL3NpZ25hbHNBbmRUb3BpY3MKICAgICAgICAgICAgLy9DdXJyZW50IERpc3Bvc2l0aW9uCiAgICAgICAgICAgIC8vRGlzcG9zaXRpb24KICAgICAgICAgICAgLy9Bc3NpZ25lZCBUbwogICAgICAgICAgICAvL2R1ZURhdGUKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCA2OyBpKyspIHsKICAgICAgICAgICAgICAgIC8vc2tpcGluZyBkaXNwb3NpdGlvbiBhbmQgYXNzaWduZWRUbyBpbmRleAogICAgICAgICAgICAgICAgaWYgKGkgIT0gMyAmJiBpICE9IDQpIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyBpXSA9ICd0ZXh0JzsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJbmRleC5wdXNoKGxhc3RWYWx1ZSArIGkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL3NpZ25hbHNBbmRUb3BpY3MKICAgICAgICAgICAgLy9DdXJyZW50IERpc3Bvc2l0aW9uCiAgICAgICAgICAgIC8vZGlzcG9zaXRpb24KICAgICAgICAgICAgLy9hc3NpZ25lZFRvCiAgICAgICAgICAgIC8vZHVlRGF0ZQogICAgICAgICAgICAvL3Bvc2l0aXZlUmVjaGFsbGVuZ2UKICAgICAgICAgICAgLy9wb3NpdGl2ZURlY2hhbGxlbmdlCiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCA4OyBpKyspIHsKICAgICAgICAgICAgICAgIC8vU2tpcHBpbmcgZGlzcG9zaXRpb24gYW5kIEFzc2lnbmVkVG8gaW5kaWNlcwogICAgICAgICAgICAgICAgaWYgKGkgIT0gMyAmJiBpICE9IDQpIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyBpXSA9ICd0ZXh0JzsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJbmRleC5wdXNoKGxhc3RWYWx1ZSArIGkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHByclZpc2liaWxpdHkpIHsKICAgICAgICAgICAgbGFzdFZhbHVlID0gcGFyc2VJbnQoT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApW09iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKS5sZW5ndGggLSAxXSk7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwW2xhc3RWYWx1ZSArIDFdID0gJ2NvdW50JzsKICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKTsKICAgICAgICAgICAgbGlzdE9mSW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJvclZpc2liaWxpdHkpIHsKICAgICAgICAgICAgbGFzdFZhbHVlID0gcGFyc2VJbnQoT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApW09iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKS5sZW5ndGggLSAxXSk7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwW2xhc3RWYWx1ZSArIDFdID0gJ2NvdW50JzsKICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKTsKICAgICAgICAgICAgbGlzdE9mSW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKTsKICAgICAgICB9CiAgICAgICAgaWYgKGViZ21WaXNpYmlsaXR5KSB7CiAgICAgICAgICAgIGxhc3RWYWx1ZSA9IHBhcnNlSW50KE9iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKVtPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcCkubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyAxXSA9ICdjb3VudCc7CiAgICAgICAgICAgIGZpbHRlckluZGV4LnB1c2gobGFzdFZhbHVlICsgMSk7CiAgICAgICAgICAgIGxpc3RPZkluZGV4LnB1c2gobGFzdFZhbHVlICsgMSk7CiAgICAgICAgfQogICAgICAgIGlmIChkc3NWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgIGxhc3RWYWx1ZSA9IHBhcnNlSW50KE9iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKVtPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcCkubGVuZ3RoIC0gMV0pOwogICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyAxXSA9ICdjb3VudCc7CiAgICAgICAgICAgIGZpbHRlckluZGV4LnB1c2gobGFzdFZhbHVlICsgMSk7CiAgICAgICAgICAgIGxpc3RPZkluZGV4LnB1c2gobGFzdFZhbHVlICsgMSk7CiAgICAgICAgICAgIGZpbHRlckluZGV4TWFwW2xhc3RWYWx1ZSArIDJdID0gJ2NvdW50JzsKICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyAyKTsKICAgICAgICAgICAgbGlzdE9mSW5kZXgucHVzaChsYXN0VmFsdWUgKyAyKTsKICAgICAgICB9CiAgICAgICAgbGFzdFZhbHVlID0gcGFyc2VJbnQoT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApW09iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKS5sZW5ndGggLSAxXSk7CiAgICAgICAgaWYgKGdyb3VwQnlTbXEgIT0gInRydWUiKSB7CiAgICAgICAgICAgIC8vcmVsYXRlZAogICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyAxXSA9ICd0ZXh0JzsKICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKTsKICAgICAgICAgICAgbGlzdE9mSW5kZXgucHVzaChsYXN0VmFsdWUgKyAxKTsKICAgICAgICAgICAgLy9wcmVnbmFuY3kKICAgICAgICAgICAgZmlsdGVySW5kZXhNYXBbbGFzdFZhbHVlICsgMl0gPSAndGV4dCc7CiAgICAgICAgICAgIGZpbHRlckluZGV4LnB1c2gobGFzdFZhbHVlICsgMik7CiAgICAgICAgICAgIGxpc3RPZkluZGV4LnB1c2gobGFzdFZhbHVlICsgMik7CiAgICAgICAgfQoKICAgICAgICBsYXN0VmFsdWUgPSBwYXJzZUludChPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcClbT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApLmxlbmd0aCAtIDFdKTsKICAgICAgICAvL25ldyBwZWFkCiAgICAgICAgLy9uZXcgaW50ZXJhY3RpbmcKICAgICAgICBmb3IgKGkgPSAxOyBpIDw9IDI7IGkrKykgewogICAgICAgICAgICBmaWx0ZXJJbmRleE1hcFtsYXN0VmFsdWUgKyBpXSA9ICdjb3VudCc7CiAgICAgICAgICAgIGZpbHRlckluZGV4LnB1c2gobGFzdFZhbHVlICsgaSk7CiAgICAgICAgICAgIGxpc3RPZkluZGV4LnB1c2gobGFzdFZhbHVlICsgaSk7CiAgICAgICAgfQoKCiAgICAgICAgJC5lYWNoKGRhdGVSYW5nZUFycmF5LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBsYXN0SW5kZXggPSBsaXN0T2ZJbmRleFtsaXN0T2ZJbmRleC5sZW5ndGggLSAxXTsKICAgICAgICAgICAgZm9yIChqID0gbGFzdEluZGV4ICsgMTsgaiA8IGxhc3RJbmRleCArIDExOyBqKyspIHsKICAgICAgICAgICAgICAgIGxpc3RPZkluZGV4LnB1c2goaik7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBsYXN0VmFsdWUgPSBwYXJzZUludChPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcClbT2JqZWN0LmtleXMoZmlsdGVySW5kZXhNYXApLmxlbmd0aCAtIDFdKTsKICAgICAgICAvL3N1Ykdyb3VwIGFnZSBjb2x1bW5zIEFkZGVkIGZvciBFQjk1LEVCMDUsRUJHTQogICAgICAgIGlmIChpc0FnZUVuYWJsZWQpIHsKICAgICAgICAgICAgdmFyIGNvdW50ID0gMTsKICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8PSAzOyBpKyspIHsKICAgICAgICAgICAgICAgICQuZWFjaChzdWJHcm91cHNNYXAuQUdFX0dST1VQLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGZpbHRlckluZGV4TWFwW2xhc3RWYWx1ZSArIGNvdW50XSA9ICdjb3VudCc7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVySW5kZXgucHVzaChsYXN0VmFsdWUgKyBjb3VudCk7CiAgICAgICAgICAgICAgICAgICAgbGlzdE9mSW5kZXgucHVzaChsYXN0VmFsdWUgKyBjb3VudCk7CiAgICAgICAgICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxhc3RWYWx1ZSA9IHBhcnNlSW50KE9iamVjdC5rZXlzKGZpbHRlckluZGV4TWFwKVtPYmplY3Qua2V5cyhmaWx0ZXJJbmRleE1hcCkubGVuZ3RoIC0gMV0pOwogICAgICAgIC8vc3ViR3JvdXAgR2VuZGVyIGNvbHVtbnMgQWRkZWQgZm9yIEVCOTUsRUIwNSxFQkdNCiAgICAgICAgaWYgKGlzR2VuZGVyRW5hYmxlZCkgewogICAgICAgICAgICB2YXIgY291bnQgPSAxOwogICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDw9IDM7IGkrKykgewogICAgICAgICAgICAgICAgJC5lYWNoKHN1Ykdyb3Vwc01hcC5HRU5ERVIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVySW5kZXhNYXBbbGFzdFZhbHVlICsgY291bnRdID0gJ2NvdW50JzsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJJbmRleC5wdXNoKGxhc3RWYWx1ZSArIGNvdW50KTsKICAgICAgICAgICAgICAgICAgICBsaXN0T2ZJbmRleC5wdXNoKGxhc3RWYWx1ZSArIGNvdW50KTsKICAgICAgICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJC5lYWNoKGZpbHRlckluZGV4TWFwLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICBpZiAodmFsdWUgPT0gJ3RleHQnKSB7CiAgICAgICAgICAgICAgICBmaWx0ZXJPcHRpb25zLnB1c2goewogICAgICAgICAgICAgICAgICAgIGNvbHVtbl9udW1iZXI6IGtleSwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJfdHlwZTogJ3RleHQnLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcl9yZXNldF9idXR0b25fdGV4dDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyX2RlbGF5OiA2MDAsCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyX2RlZmF1bHRfbGFiZWw6ICcnLAogICAgICAgICAgICAgICAgICAgIHN0eWxlX2NsYXNzOiAndGV4dEZpbHRlcicKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHZhbHVlID09ICdzZWxlY3QnKSB7CiAgICAgICAgICAgICAgICBmaWx0ZXJPcHRpb25zLnB1c2goewogICAgICAgICAgICAgICAgICAgIGNvbHVtbl9udW1iZXI6IGtleSwKICAgICAgICAgICAgICAgICAgICBzZWxlY3RfdHlwZTogJ3NlbGVjdCcsCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyX2RlZmF1bHRfbGFiZWw6IEFMTCwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJfcmVzZXRfYnV0dG9uX3RleHQ6IGZhbHNlLAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfWVsc2UgewogICAgICAgICAgICAgICAgZmlsdGVyT3B0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBjb2x1bW5fbnVtYmVyOiBrZXksCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyX3R5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJfcmVzZXRfYnV0dG9uX3RleHQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcl9kZWxheTogNjAwLAogICAgICAgICAgICAgICAgICAgIGZpbHRlcl9kZWZhdWx0X2xhYmVsOiAnJywKICAgICAgICAgICAgICAgICAgICBzdHlsZV9jbGFzczogJ2NvdW50RmlsdGVyJwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHlhZGNmLmluaXQoZGF0YV90YWJsZSwgZmlsdGVyT3B0aW9ucyk7CiAgICAgICAgaWYoZmlsdGVyVmFsdWUubGVuZ3RoID4gMCl7CiAgICAgICAgICAgIHlhZGNmLmV4RmlsdGVyQ29sdW1uKGRhdGFfdGFibGUsIGZpbHRlclZhbHVlLHRydWUpOwogICAgICAgIH1lbHNlewogICAgICAgICAgICAkKCcueWFkY2YtZmlsdGVyLXdyYXBwZXInKS5oaWRlKCkKICAgICAgICB9CiAgICAgICAgdmFyIGNvbHVtbk5vcyA9IGZpeGVkQ29sdW1uTm9zKGNhbGxpbmdTY3JlZW4pOwogICAgICAgIG5ldyAkLmZuLmRhdGFUYWJsZS5GaXhlZENvbHVtbnModGFibGUsIHsKICAgICAgICAgICAgbGVmdENvbHVtbnM6IGNvbHVtbk5vcywKICAgICAgICAgICAgcmlnaHRDb2x1bW5zOiAwLAogICAgICAgICAgICBoZWlnaHRNYXRjaDogJ2F1dG8nCiAgICAgICAgfSk7CiAgICAgICAgc2lnbmFsLmZpZWxkTWFuYWdlbWVudC5pbml0KCQoJyNhbGVydHNEZXRhaWxzVGFibGUnKS5EYXRhVGFibGUoKSwgJyNhbGVydHNEZXRhaWxzVGFibGUnLCBjb2x1bW5Ob3MpOwogICAgICAgICQoIiN0b2dnbGUtY29sdW1uLWZpbHRlcnMiKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGluaXRfcHJvZHVjdF9saXN0KCkKICAgICAgICAgICAgdmFyIGVsZSA9ICQoJy55YWRjZi1maWx0ZXItd3JhcHBlcicpOwogICAgICAgICAgICB2YXIgaW5wdXRFbGUgPSAkKCcueWFkY2YtZmlsdGVyJyk7CiAgICAgICAgICAgIGlmIChlbGUuaXMoJzp2aXNpYmxlJykpIHsKICAgICAgICAgICAgICAgIGVsZS5oaWRlKCk7CiAgICAgICAgICAgICAgICBpbnB1dEVsZS52YWwoJycpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZWxlLnNob3coKTsKICAgICAgICAgICAgICAgIGlucHV0RWxlLmZpcnN0KCkuZm9jdXMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkYXRhX3RhYmxlLmNvbHVtbnMuYWRqdXN0KCkuZml4ZWRDb2x1bW5zKCkucmVsYXlvdXQoKQogICAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgaW5pdF9wcm9kdWN0X2xpc3QgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGNvbEluZGV4ID0gcHJvZHVjdENvbEluZGV4KCkKICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImFjYV9maWx0ZXJNYXBfIitleGVjdXRlZENvbmZpZ0lkKSk7CiAgICAgICAgdmFyIHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ5YWRjZi1maWx0ZXItLWFsZXJ0c0RldGFpbHNUYWJsZS0iICsgY29sSW5kZXgpOwogICAgICAgIHNlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDA7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9kdWN0TmFtZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGkgPT0gMCkgewogICAgICAgICAgICAgICAgc2VsZWN0Lm9wdGlvbnNbc2VsZWN0Lm9wdGlvbnMubGVuZ3RoXSA9IG5ldyBPcHRpb24oQUxMLCAnJywgZmFsc2UsIGZhbHNlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBpc1NlbGVjdGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyVmFsdWUgIT0gbnVsbCAmJiBmaWx0ZXJWYWx1ZVtjb2xJbmRleF0gIT0gdW5kZWZpbmVkICYmIGZpbHRlclZhbHVlW2NvbEluZGV4XSE9IiIgJiYgZmlsdGVyVmFsdWVbY29sSW5kZXhdIT1udWxsICYmIHByb2R1Y3ROYW1lc1tpXSA9PSBmaWx0ZXJWYWx1ZVtjb2xJbmRleF0pIHsKICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGVjdC5vcHRpb25zW3NlbGVjdC5vcHRpb25zLmxlbmd0aF0gPSBuZXcgT3B0aW9uKHByb2R1Y3ROYW1lc1tpXSwgcHJvZHVjdE5hbWVzW2ldLCBpc1NlbGVjdGVkLCBpc1NlbGVjdGVkKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICB2YXIgcHJvZHVjdENvbEluZGV4ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjb2xJbmRleAogICAgICAgIGlmIChjYWxsaW5nU2NyZWVuID09IENBTExJTkdfU0NSRUVOLkRBU0hCT0FSRCkgewogICAgICAgICAgICBjb2xJbmRleCA9IDYKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb2xJbmRleCA9IDUKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbEluZGV4CiAgICB9CgogICAgdmFyIGluaXRfZGV0YWlsc190YWJsZSA9IGZ1bmN0aW9uIChyZXN1bHQsIGdyb3VwQnlTbXEpIHsKICAgICAgICB2YXIgaXNGaWx0ZXJSZXF1ZXN0ID0gdHJ1ZTsKICAgICAgICB2YXIgZmlsdGVyVmFsdWVzID0gW107CiAgICAgICAgdmFyIHByZWZpeCA9ICJhZ2dfIjsKICAgICAgICBpZiAod2luZG93LnNlc3Npb25TdG9yYWdlKSB7CiAgICAgICAgICAgIGlmIChzaWduYWwuYWxlcnRSZXZpZXcuaXNBbGVydFBlcnNpc3RlZEluU2Vzc2lvblN0b3JhZ2UocHJlZml4KSkgewogICAgICAgICAgICAgICAgZmlsdGVyVmFsdWVzID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHByZWZpeCArICJmaWx0ZXJzX3ZhbHVlIikpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2lnbmFsLmFsZXJ0UmV2aWV3LnJlbW92ZUZpbHRlcnNGcm9tU2Vzc2lvblN0b3JhZ2UocHJlZml4KTsKICAgICAgICAgICAgICAgIGlzRmlsdGVyUmVxdWVzdCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoY2FsbGluZ1NjcmVlbiA9PSBDQUxMSU5HX1NDUkVFTi5UUklHR0VSRURfQUxFUlRTKSB7CiAgICAgICAgICAgIGxpc3RPZkluZGV4ID0gWzEwXTsKICAgICAgICB9IGVsc2UgaWYgKGdyb3VwQnlTbXEgPT0gInRydWUiKSB7CiAgICAgICAgICAgIGxpc3RPZkluZGV4ID0gWzksIDE0XTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaXN0T2ZJbmRleCA9IFs5LCAxNV0KICAgICAgICB9CiAgICAgICAgdmFyIHByclZpc2liaWxpdHkgPSBKU09OLnBhcnNlKCQoIiNzaG93UHJyIikudmFsKCkpOwogICAgICAgIHZhciByb3JWaXNpYmlsaXR5ID0gSlNPTi5wYXJzZSgkKCIjc2hvd1JvciIpLnZhbCgpKTsKICAgICAgICB2YXIgZWJnbVZpc2liaWxpdHkgPSBKU09OLnBhcnNlKCQoIiNzaG93RWJnbSIpLnZhbCgpKTsKICAgICAgICB2YXIgZHNzVmlzaWJpbGl0eSA9IEpTT04ucGFyc2UoJCgiI3Nob3dEc3MiKS52YWwoKSk7CiAgICAgICAgdmFyIGNvbHVtbnMgPSBjcmVhdGVfYWdnX3RhYmxlX2NvbHVtbnMoY2FsbGluZ1NjcmVlbiwgcHJyVmlzaWJpbGl0eSwgcm9yVmlzaWJpbGl0eSwgZWJnbVZpc2liaWxpdHksIGRzc1Zpc2liaWxpdHksIHJlc3VsdCwgZ3JvdXBCeVNtcSk7CiAgICAgICAgdGFibGUgPSAkKCcjYWxlcnRzRGV0YWlsc1RhYmxlJykuRGF0YVRhYmxlKHsKICAgICAgICAgICAgInNQYWdpbmF0aW9uVHlwZSI6ICJib290c3RyYXAiLAogICAgICAgICAgICAibGFuZ3VhZ2UiOiB7CiAgICAgICAgICAgICAgICAidXJsIjogIi4uL2Fzc2V0cy9pMThuL2RhdGFUYWJsZXNfIiArIHVzZXJMb2NhbGUgKyAiLmpzb24iCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJyb3dDYWxsYmFjayI6IGZ1bmN0aW9uIChyb3csIGRhdGEsIGluZGV4KSB7CiAgICAgICAgICAgICAgICBzaWduYWwuYWxlcnRSZXZpZXcuYXBwbHlCdXNpbmVzc1J1bGVzKHJvdywgZGF0YSk7CiAgICAgICAgICAgICAgICAvL0JpbmQgQXNzaWduZWRUbyBTZWxlY3QgQm94CiAgICAgICAgICAgICAgICBzaWduYWwudXNlcl9ncm91cF91dGlscy5iaW5kX2Fzc2lnblRvX3RvX2dyaWRfcm93KCQocm93KSwgc2VhcmNoVXNlckdyb3VwTGlzdFVybCwgewogICAgICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEuYXNzaWduZWRUby5mdWxsTmFtZSwKICAgICAgICAgICAgICAgICAgICBpZDogZGF0YS5hc3NpZ25lZFRvLmlkCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZHJhd0NhbGxiYWNrOiBmdW5jdGlvbiAoc2V0dGluZ3MpIHsKICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBzZXR0aW5ncy5qc29uICE9ICJ1bmRlZmluZWQiICYmICFpc0R5bmFtaWNGaWx0ZXJBcHBsaWVkKXsKICAgICAgICAgICAgICAgICAgICBpc0R5bmFtaWNGaWx0ZXJBcHBsaWVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBzaWduYWwuYWxlcnRSZXZpZXcuYmluZEdyaWREeW5hbWljRmlsdGVycyhzZXR0aW5ncy5qc29uLmZpbHRlcnMsIHByZWZpeCwgc2V0dGluZ3MuanNvbi5jb25maWdJZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0YWdFbGxpcHNpcygpOwogICAgICAgICAgICAgICAgY29sRWxsaXBzaXMoKTsKICAgICAgICAgICAgICAgIHdlYlVpUG9wSW5pdCgpOwogICAgICAgICAgICAgICAgZW50ZXJLZXlBbGVydERldGFpbCgpOwogICAgICAgICAgICAgICAgY2xvc2VQb3B1cE9uU2Nyb2xsKCk7CiAgICAgICAgICAgICAgICAkKCdbZGF0YS10b2dnbGU9InRvb2x0aXAiXScpLnRvb2x0aXAoeyB0cmlnZ2VyOiAiaG92ZXIiIH0pOwogICAgICAgICAgICAgICAgc2lnbmFsLmFsZXJ0UmV2aWV3LnNvcnRJY29uSGFuZGxlcigpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJhamF4IjogewogICAgICAgICAgICAgICAgInVybCI6IGxpc3RDb25maWdVcmwgKyAnJmlzRmlsdGVyUmVxdWVzdD0nICsgaXNGaWx0ZXJSZXF1ZXN0ICsgJyZmaWx0ZXJzPScgKyBlbmNvZGVVUkkoSlNPTi5zdHJpbmdpZnkoZmlsdGVyVmFsdWVzKSkgKyAiJmZyZXF1ZW5jeT0iICsgZnJlcVNlbGVjdGVkLAogICAgICAgICAgICAgICAgInR5cGUiOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAiZGF0YVNyYyI6ICJhYURhdGEiLAogICAgICAgICAgICAgICAgImRhdGEiOiBmdW5jdGlvbiAoZCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjb2xJbmRleCA9IHByb2R1Y3RDb2xJbmRleCgpOwogICAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXJNYXAgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImFjYV9maWx0ZXJNYXBfIitleGVjdXRlZENvbmZpZ0lkKSkgIT0gbnVsbCA/IEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiYWNhX2ZpbHRlck1hcF8iK2V4ZWN1dGVkQ29uZmlnSWQpKSA6IG5ldyBNYXAoKTsKICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoVmFsdWUgPSBkLmNvbHVtbnNbY29sSW5kZXhdLnNlYXJjaC52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBpZihmaWx0ZXJNYXApewogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJNYXBbY29sSW5kZXhdID0gc2VhcmNoVmFsdWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnYWNhX2ZpbHRlck1hcF8nICsgZXhlY3V0ZWRDb25maWdJZCwgSlNPTi5zdHJpbmdpZnkoZmlsdGVyTWFwKSk7CgogICAgICAgICAgICAgICAgICAgIGlmKGluZGV4ICE9IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQub3JkZXJbMF0uY29sdW1uID0gaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgIGQub3JkZXJbMF0uZGlyID0gZGlyOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoJCgnI2FkdmFuY2VkLWZpbHRlcicpLnZhbCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQuYWR2YW5jZWRGaWx0ZXJJZCA9ICQoJyNhZHZhbmNlZC1maWx0ZXInKS52YWwoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoJCgnI3F1ZXJ5SlNPTicpLnZhbCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQucXVlcnlKU09OID0gJCgnI3F1ZXJ5SlNPTicpLnZhbCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBmbkluaXRDb21wbGV0ZTogZnVuY3Rpb24gKHNldHRpbmdzLCBqc29uKSB7CiAgICAgICAgICAgICAgICBpZihmaWx0ZXJWYWx1ZS5sZW5ndGggPT09IDAgJiYgIWlzRHluYW1pY0ZpbHRlckFwcGxpZWQpewogICAgICAgICAgICAgICAgICAgIGlzRHluYW1pY0ZpbHRlckFwcGxpZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHNpZ25hbC5hbGVydFJldmlldy5iaW5kR3JpZER5bmFtaWNGaWx0ZXJzKGpzb24uZmlsdGVycywgcHJlZml4LCBqc29uLmNvbmZpZ0lkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHByZWZpeCArICJmaWx0ZXJzX3N0b3JlIikpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlsdGVyc0FycmF5ID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHByZWZpeCArICJmaWx0ZXJzX3N0b3JlIikpOwogICAgICAgICAgICAgICAgICAgICQuZWFjaChmaWx0ZXJzQXJyYXksIGZ1bmN0aW9uIChpbmRleCwgb2JqKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNmaWx0ZXInICsgaW5kZXgpLnByb3AoImNoZWNrZWQiLCBvYmogPT0gdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzaWduYWwuYWxlcnRSZXZpZXcuZW5hYmxlTWVudVRvb2x0aXBzKCk7CiAgICAgICAgICAgICAgICBzaWduYWwuYWxlcnRSZXZpZXcuZGlzYWJsZVRvb2x0aXBzKCk7CiAgICAgICAgICAgICAgICBhZGRHcmlkU2hvcnRjdXRzKCcjYWxlcnRzRGV0YWlsc1RhYmxlJyk7CiAgICAgICAgICAgICAgICB2YXIgc2Vzc2lvblByb2R1Y3QgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oUFJPRFVDVF9MSVNUKSkKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YganNvbiAhPSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lcyA9IFtBTExdCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uLnByb2R1Y3ROYW1lTGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0TmFtZXMucHVzaChqc29uLnByb2R1Y3ROYW1lTGlzdFtpXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oUFJPRFVDVF9MSVNULCBKU09OLnN0cmluZ2lmeShwcm9kdWN0TmFtZXMpKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZihzZXNzaW9uUHJvZHVjdCkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlc3Npb25Qcm9kdWN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0TmFtZXMucHVzaChzZXNzaW9uUHJvZHVjdFtpXSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgImJMZW5ndGhDaGFuZ2UiOiB0cnVlLAogICAgICAgICAgICAiYlByb2Nlc3NpbmciOiB0cnVlLAogICAgICAgICAgICAiYlNlcnZlclNpZGUiOiB0cnVlLAogICAgICAgICAgICAiY29sUmVvcmRlciI6IHsKICAgICAgICAgICAgICAgICJyZWFsdGltZSI6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJvTGFuZ3VhZ2UiOiB7CiAgICAgICAgICAgICAgICAic1Byb2Nlc3NpbmciOiAnPGRpdiBjbGFzcz0iZ3JpZC1sb2FkaW5nIj48aW1nIHNyYz0iL3NpZ25hbC9hc3NldHMvc3Bpbm5lci5naWYiIHdpZHRoPSIzMCIgYWxpZ249Im1pZGRsZSIgLz48L2Rpdj4nLAogICAgICAgICAgICAgICAgInNaZXJvUmVjb3JkcyI6ICJObyBkYXRhIGF2YWlsYWJsZSBpbiB0YWJsZSIsICJzRW1wdHlUYWJsZSI6ICJObyBkYXRhIGF2YWlsYWJsZSBpbiB0YWJsZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImFMZW5ndGhNZW51IjogW1s1MCwgMTAwLCAyMDAsIDUwMF0sIFs1MCwgMTAwLCAyMDAsIDUwMF1dLAogICAgICAgICAgICAicGFnaW5hdGlvbiI6IHRydWUsCiAgICAgICAgICAgICJpVG90YWxEaXNwbGF5UmVjb3JkcyI6ICI1MCIsCiAgICAgICAgICAgICJkZWZlckxvYWRpbmciOmZpbHRlclZhbHVlLmxlbmd0aCA+IDAgPyAwOiBudWxsLAogICAgICAgICAgICAiYW9Db2x1bW5zIjogY29sdW1ucywKICAgICAgICAgICAgInJlc3BvbnNpdmUiOiB0cnVlLAogICAgICAgICAgICBzY3JvbGxYOiB0cnVlLAogICAgICAgICAgICBjb2x1bW5EZWZzOiBbewogICAgICAgICAgICAgICAgInRhcmdldHMiOiAnX2FsbCcsCiAgICAgICAgICAgICAgICAicmVuZGVyIjogJC5mbi5kYXRhVGFibGUucmVuZGVyLnRleHQoKQogICAgICAgICAgICB9XQogICAgICAgIH0pOwogICAgICAgIHNpZ25hbC51c2VyX2dyb3VwX3V0aWxzLmJpbmRfYXNzaWduVG9fc2VsZWN0aW9uKGFzc2lnblRvR3JvdXBVcmwsIHRhYmxlKTsKICAgICAgICBpbml0X2ZpbHRlcih0YWJsZSwgcHJyVmlzaWJpbGl0eSwgcm9yVmlzaWJpbGl0eSwgZWJnbVZpc2liaWxpdHksIGRzc1Zpc2liaWxpdHksIGdyb3VwQnlTbXEpOwogICAgICAgIGluaXRfcHJvZHVjdF9saXN0KCk7CiAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgfTsKCiAgICB2YXIgZml4ZWRDb2x1bW5Ob3MgPSBmdW5jdGlvbiAoY2FsbGluZ1NjcmVlbikgewogICAgICAgIGlmIChjYWxsaW5nU2NyZWVuID09IENBTExJTkdfU0NSRUVOLlRSSUdHRVJFRF9BTEVSVFMgfHwgY2FsbGluZ1NjcmVlbiA9PSBDQUxMSU5HX1NDUkVFTi5EQVNIQk9BUkQpIHsKICAgICAgICAgICAgcmV0dXJuIDk7CiAgICAgICAgfSBlbHNlIGlmIChncm91cEJ5U21xID09ICJ0cnVlIikgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIHJldHVybiA4OwogICAgICAgIH0KICAgIH07CgogICAgdmFyIGNyZWF0ZV9hZ2dfdGFibGVfY29sdW1ucyA9IGZ1bmN0aW9uIChjYWxsaW5nU2NyZWVuLCBwcnJWaXNpYmlsaXR5LCByb3JWaXNpYmlsaXR5LCBlYmdtVmlzaWJpbGl0eSwgZHNzVmlzaWJpbGl0eSwgcmVzdWx0LCBncm91cEJ5U21xKSB7CiAgICAgICAgdmFyIGFvQ29sdW1ucyA9IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogInNlbGVjdGVkIiwKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkocm93LmV4ZWNDb25maWdJZCwgZXhlY3V0ZWRJZExpc3QpID09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGVkSWRMaXN0LnB1c2gocm93LmV4ZWNDb25maWdJZCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8aW5wdXQgY2xhc3M9ImV4ZWNDb25maWdJZCIgaWQ9ImV4ZWNDb25maWdJZCIgdHlwZT0iaGlkZGVuIiB2YWx1ZT0iJyArIHJvdy5leGVjQ29uZmlnSWQgKyAnIiAvPicgKwogICAgICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGNsYXNzPSJhbGVydENvbmZpZ0lkIiBpZD0iYWxlcnRDb25maWdJZCIgdHlwZT0iaGlkZGVuIiB2YWx1ZT0iJyArIHJvdy5hbGVydENvbmZpZ0lkICsgJyIgLz4nICsKICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJncmlkLXJvdy1jaGVjayI+PGlucHV0IGRhdGEtdG9nZ2xlPSJ0b29sdGlwIiB0aXRsZT0icm93IGNoZWNrIiBkYXRhLXRpdGxlPSJkYXRhIGNoZWNrIiB0eXBlPSJjaGVja2JveCIgY2xhc3M9ImFsZXJ0LWNoZWNrLWJveCBlZGl0b3ItYWN0aXZlIGNvcHktc2VsZWN0IiBkYXRhLWlkPScgKyByb3cuaWQgKyAnIC8+PC9zcGFuPic7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICcnLAogICAgICAgICAgICAgICAgIm9yZGVyYWJsZSI6IGZhbHNlCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJkcm9wZG93biIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uQnV0dG9uID0gJzxkaXYgc3R5bGU9ImRpc3BsYXk6IGJsb2NrOyIgY2xhc3M9ImJ0bi1ncm91cCBkcm9wZG93biBkYXRhVGFibGVIaWRlQ2VsbENvbnRlbnQiIGFsaWduPSJjZW50ZXIiPiBcCiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJkcm9wZG93bi10b2dnbGUiIGRhdGEtdG9nZ2xlPSJkcm9wZG93biIgdGFiaW5kZXg9IjAiIHJvbGU9ImJ1dHRvbiI+IFwKICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImN1cnNvcjogcG9pbnRlcjtmb250LXNpemU6IDEyNSU7IiBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi1vcHRpb24tdmVydGljYWwiPjwvc3Bhbj48c3BhbiBjbGFzcz0ic3Itb25seSI+VG9nZ2xlIERyb3Bkb3duPC9zcGFuPiBcCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4gJzsKCiAgICAgICAgICAgICAgICAgICAgaWYocm93LmNvbW1lbnQpewogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b24gKz0gICc8aSBjbGFzcz0ibWRpIG1kaS1jaGF0IGJsdWUtMiBmb250LTEzIHBvcy1hYiBjb21tZW50IiB0aXRsZT0iJyArICQuaTE4bi5fKCdjb21tZW50QXZhaWxhYmxlJykgKyAnIj48L2k+JzsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKHJvdy5pc0F0dGFjaG1lbnQgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b24gKz0gJyA8aSBjbGFzcz0ibWRpIG1kaS1hdHRhY2htZW50IGJsdWUtMSBmb250LTEzIHBvcy1hYiBhdHRhY2giIHRpdGxlPSInICsgJC5pMThuLl8oJ2F0dGFjaG1lbnRBdmFpbGFibGUnKSArICciPjwvaT4nOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9uICs9ICc8dWwgY2xhc3M9ImRyb3Bkb3duLW1lbnUgbWVudS1jb3N5IiByb2xlPSJtZW51Ij48bGkgcm9sZT0icHJlc2VudGF0aW9uIj48YSB0YWJpbmRleD0iMCIgY2xhc3M9InJldmlldy1yb3ctaWNvbiAgcHJvZHVjdC1ldmVudC1oaXN0b3J5LWljb24iIGRhdGEtZGF0YXNyYz0iJyArIHJvdy5kYXRhU291cmNlICsgJyIgZGF0YS1jb25maWdpZD0iJyArIHJvdy5jb25maWdJZCArICciPjxzcGFuIGNsYXNzPSIgZmEgZmEtbGlzdCBtLXItMTAiPjwvc3Bhbj5IaXN0b3J5PC8+PC9saT4nOwogICAgICAgICAgICAgICAgICAgIGFjdGlvbkJ1dHRvbiArPSAnPGxpIHJvbGU9InByZXNlbnRhdGlvbiI+PGEgdGFiaW5kZXg9IjAiIGNsYXNzPSJyZXZpZXctcm93LWljb24gY29tbWVudC1pY29uIiBkYXRhLWluZm89InJvdyI+PHNwYW4gY2xhc3M9ImZhIGZhLWNvbW1lbnQgbS1yLTEwIiA+PC9zcGFuPkNvbW1lbnRzPC9hPjwvbGk+JzsKICAgICAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b24gKz0gJzxsaSByb2xlPSJwcmVzZW50YXRpb24iPjxhIHRhYmluZGV4PSIwIiBjbGFzcz0icmV2aWV3LXJvdy1pY29uIHNob3ctY2hhcnQtaWNvbiIgZGF0YS12YWx1ZT0iJyArIHJvdy5pZCArICciPjxzcGFuIGNsYXNzPSJmYSBmYS1saW5lLWNoYXJ0IG0tci0xMCI+PC9zcGFuPkNoYXJ0czwvYT48L2xpPic7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9uICs9ICc8bGkgcm9sZT0icHJlc2VudGF0aW9uIj48YSB0YWJpbmRleD0iMCIgY2xhc3M9InJldmlldy1yb3ctaWNvbiBzaG93LWF0dGFjaG1lbnQtaWNvbiIgZGF0YS1maWVsZD0iYXR0YWNobWVudCIgZGF0YS1pZD0iJyArIHJvdy5pZCArICciIGRhdGEtY29udHJvbGxlcj0iYWdncmVnYXRlQ2FzZUFsZXJ0Ij48c3BhbiBjbGFzcz0iZmEgZmEtZmlsZSBtLXItMTAiPjwvc3Bhbj5BdHRhY2htZW50PC8+PC9saT4nOwogICAgICAgICAgICAgICAgICAgIGFjdGlvbkJ1dHRvbiArPSAnPC91bD48L2Rpdj4nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25CdXR0b247CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIm9yZGVyYWJsZSI6IGZhbHNlLAogICAgICAgICAgICAgICAgInZpc2libGUiOiB0cnVlLAogICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ImRyb3BEb3duIgogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiZmxhZ3MiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZsYWdFbGVtZW50ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZsYWcgPSByb3cuZmxhZ3Muc3BsaXQoJywnKTsKICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmxhZywgZnVuY3Rpb24gKGlkeCwgdmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gIkF1dG8gRmxhZ2dlZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdFbGVtZW50ICs9ICc8aSBjbGFzcz0iZ2x5cGhpY29uIGdseXBoaWNvbi10YWcgbS1yLTUiIHN0eWxlPSJjb2xvcjogZ3JlZW4iPjwvaT4nCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsID09ICJBdXRvIEZsYWdnZWQgJiBQcmV2aW91c2x5IFJldmlld2VkIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ0VsZW1lbnQgKz0gJzxpIGNsYXNzPSJnbHlwaGljb24gZ2x5cGhpY29uLXRhZyBtLXItNSIgc3R5bGU9ImNvbG9yOiBwdXJwbGUiPjwvaT4nCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsID09ICJOZXciKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnRWxlbWVudCArPSAnPGkgY2xhc3M9ImdseXBoaWNvbiBnbHlwaGljb24tdGFnIG0tci01IiBzdHlsZT0iY29sb3I6IG9yYW5nZSI+PC9pPicKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWwgPT0gIlByZXZpb3VzbHkgUmV2aWV3ZWQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnRWxlbWVudCArPSAnPGkgY2xhc3M9ImdseXBoaWNvbiBnbHlwaGljb24tdGFnIG0tci01IiBzdHlsZT0iY29sb3I6IGRhcmtibHVlIj48L2k+JwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZsYWdFbGVtZW50CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICcnLAogICAgICAgICAgICAgICAgInZpc2libGUiOiB0cnVlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJwcmlvcml0eSIsCiAgICAgICAgICAgICAgICAiYVRhcmdldHMiOiBbInByaW9yaXR5Il0sCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaXNGYWVycyA9ICQoIiNpc0ZhZXJzIikudmFsKCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzUHJpb3J0eUNoYW5nZUFsbG93ZWQgPSAoaXNQcm9kdWN0U2VjdXJpdHkgPT0gJ3RydWUnICYmIGFsbG93ZWRQcm9kdWN0c0FzU2FmZXR5TGVhZC5pbmRleE9mKHJvdy5wcm9kdWN0TmFtZSkpIHx8IGlzUHJvZHVjdFNlY3VyaXR5ID09ICdmYWxzZScgfHwgaXNGYWVycyA9PSAndHJ1ZSc7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC51dGlscy5yZW5kZXIoJ3ByaW9yaXR5JywgewogICAgICAgICAgICAgICAgICAgICAgICBwcmlvcml0eVZhbHVlOiByb3cucHJpb3JpdHkudmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW9yaXR5Q2xhc3M6IHJvdy5wcmlvcml0eS5pY29uQ2xhc3MsCiAgICAgICAgICAgICAgICAgICAgICAgIGlzUHJpb3JpdHlDaGFuZ2VBbGxvd2VkOiBpc1ByaW9ydHlDaGFuZ2VBbGxvd2VkCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0zMCB0ZXh0LWNlbnRlciBwcmlvcml0eVBhcmVudCcsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogImFjdGlvbnMiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC5hY3Rpb25zX3V0aWxzLmJ1aWxkX2FjdGlvbl9yZW5kZXIocm93KQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICdjbGFzc05hbWUnOiAnY29sLW1pbi0zMCB0ZXh0LWNlbnRlciBhY3Rpb24tY29sJywKICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogdHJ1ZQogICAgICAgICAgICB9XTsKICAgICAgICBpZiAoY2FsbGluZ1NjcmVlbiA9PSBDQUxMSU5HX1NDUkVFTi5EQVNIQk9BUkQpIHsKICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbewogICAgICAgICAgICAgICAgIm1EYXRhIjogImFsZXJ0TmFtZSIsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJ2NvbC1taW4tMTUwIGNvbC1tYXgtMzAwIGNlbGwtYnJlYWsnLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbEVsZW1lbnQgPSAnPGRpdiBjbGFzcz0iY29sLWNvbnRhaW5lciI+PGRpdiBjbGFzcz0iY29sLWhlaWdodCI+JzsKICAgICAgICAgICAgICAgICAgICBjb2xFbGVtZW50ICs9IGVuY29kZVRvSFRNTChyb3cuYWxlcnROYW1lKTsKICAgICAgICAgICAgICAgICAgICBjb2xFbGVtZW50ICs9ICc8YSB0YWJpbmRleD0iMCIgdGl0bGU9IicgKyAkLmkxOG4uXygnYXBwTGFiZWwudmlld0FsbCcpICsgJyIgY2xhc3M9Imljby1kb3RzIHZpZXctYWxsIiBtb3JlLWRhdGE9IicgKyBlbmNvZGVUb0hUTUwocm93LmFsZXJ0TmFtZSkgKyAnIj48aSBjbGFzcz0ibWRpIG1kaS1kb3RzLWhvcml6b250YWwgZm9udC0yMCBibHVlLTEiPiA8L2k+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgY29sRWxlbWVudCArPSAnPC9kaXY+PC9kaXY+JzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sRWxlbWVudAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogdHJ1ZQogICAgICAgICAgICB9XSk7CiAgICAgICAgfQogICAgICAgIGFvQ29sdW1ucy5wdXNoLmFwcGx5KGFvQ29sdW1ucywgWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAicHJvZHVjdE5hbWUiLAogICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTE1MCBjb2wtbWF4LTMwMCBjZWxsLWJyZWFrJywKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAiPGlucHV0IHR5cGU9J2hpZGRlbicgdmFsdWU9JyIgKyByb3cucHJvZHVjdElkICsgIicgY2xhc3M9J3Jvdy1wcm9kdWN0LWlkJy8+IiArICI8aW5wdXQgdHlwZT0naGlkZGVuJyB2YWx1ZT0nIiArIHJvdy5wdENvZGUgKyAiJyBjbGFzcz0ncm93LXB0LWNvZGUnLz4iCiAgICAgICAgICAgICAgICAgICAgIjxpbnB1dCB0eXBlPSdoaWRkZW4nIHZhbHVlPSciICsgcm93LmxldmVsICsgIicgY2xhc3M9J3Jvdy1sZXZlbC1pZCcvPiI7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdy5pc1NwZWNpYWxQRSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gIjxzcGFuIHN0eWxlPSdjb2xvcjpyZWQnICBkYXRhLWZpZWxkID0ncHJvZHVjdE5hbWUnIGRhdGEtaWQ9JyIgKyByb3cucHJvZHVjdE5hbWUgKyAiJz4iICsgcm93LnByb2R1Y3ROYW1lICsgIjwvc3Bhbj4iCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICI8c3BhbiBkYXRhLWZpZWxkID0ncHJvZHVjdE5hbWUnIGRhdGEtaWQ9JyIgKyByb3cucHJvZHVjdE5hbWUgKyAiJz4iICsgcm93LnByb2R1Y3ROYW1lICsgIjwvc3Bhbj4iCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgInZpc2libGUiOiB0cnVlCiAgICAgICAgICAgIH1dKTsKICAgICAgICBpZiAoZ3JvdXBCeVNtcSAhPSAidHJ1ZSIpIHsKICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbewogICAgICAgICAgICAgICAgIm1EYXRhIjogInNvYyIsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJ2NvbC1taW4tMjUnLAogICAgICAgICAgICAgICAgInZpc2libGUiOiB0cnVlCiAgICAgICAgICAgIH1dKTsKICAgICAgICB9CiAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJwdCIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdXJsV2l0aFBhcmFtcyA9IGV2ZW50RGV0YWlsc1VybCArICc/YWxlcnRJZD0nICsgcm93LmlkICsgJyZ0eXBlPScgKyBhcHBsaWNhdGlvbk5hbWUgKyAnJmlzQXJjaGl2ZWQ9JyArIGlzQXJjaGl2ZWQ7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICc8YSBocmVmPSInICsgdXJsV2l0aFBhcmFtcyArICciIHRhcmdldD0iX2JsYW5rIj4nICsgKHJvdy5wcmVmZXJyZWRUZXJtKSArICc8L2E+JzsKICAgICAgICAgICAgICAgICAgICBpZiAocm93LmlzU3BlY2lhbFBFKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiPHNwYW4gc3R5bGU9J2NvbG9yOnJlZCcgZGF0YS1maWVsZCA9J2V2ZW50TmFtZScgZGF0YS1pZD0nIiArIHJvdy5wcmVmZXJyZWRUZXJtICsgIic+IiArIHJlc3VsdCArICI8L3NwYW4+IgogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiPHNwYW4gZGF0YS1maWVsZCA9J2V2ZW50TmFtZScgZGF0YS1pZD0nIiArIHJvdy5wcmVmZXJyZWRUZXJtICsgIic+IiArIHJlc3VsdCArICI8L3NwYW4+IgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAibURhdGEiOiAiYWxlcnRUYWdzIiwKICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICB2YXIgdGFnc0VsZW1lbnQgPSBzaWduYWwuYWxlcnRzX3V0aWxzLmdldF90YWdzX2VsZW1lbnQocm93LmFsZXJ0VGFncyk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGFnc0VsZW1lbnQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImNsYXNzTmFtZSI6ICdjb2wtbWF4LTMwMCBwb3MtcmVsJywKICAgICAgICAgICAgIm9yZGVyYWJsZSI6IGZhbHNlLAogICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2FsZXJ0VGFncycpCiAgICAgICAgfSwgewogICAgICAgICAgICAibURhdGEiOiAiaW1wRXZlbnRzIiwKICAgICAgICAgICAgImNsYXNzTmFtZSI6ICdjb2wtbWluLTc1JywKICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcHRCYWRnZShyb3cuaW1lLCByb3cuZG1lLCByb3cuZWksIHJvdy5pc1NtKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdpbXBFdmVudHMnKQogICAgICAgIH1dKTsKICAgICAgICBpZiAoZ3JvdXBCeVNtcSAhPSAidHJ1ZSIpIHsKICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbewogICAgICAgICAgICAgICAgIm1EYXRhIjogImxpc3RlZCIsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyByb3cubGlzdGVkICsgJzwvc3Bhbj4nCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdsaXN0ZWQnKQogICAgICAgICAgICB9XSkKICAgICAgICB9CiAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJuZXdDb3VudCIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2lnbmFsLnV0aWxzLnN0YWNrZWQoCiAgICAgICAgICAgICAgICAgICAgICAgIGNudF9kcmlsbF9kb3duKHJvdy5uZXdDb3VudCwgQ09VTlRTLk5FVywgRkxBR1MuQ1VNTV9GTEFHLCByb3cuZXhlY0NvbmZpZ0lkLCByb3cuaWQsIHJvdy5wcm9kdWN0SWQsIHJvdy5wdENvZGUsIEJVU0lORVNTX1JVTEVfRk9STUFUX0NMQVNTLk5FV19DT1VOVF9BR0cpLAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cuY3VtbUNvdW50LCBDT1VOVFMuQ1VNTSwgRkxBR1MuQ1VNTV9GTEFHLCByb3cuZXhlY0NvbmZpZ0lkLCByb3cuaWQsIHJvdy5wcm9kdWN0SWQsIHJvdy5wdENvZGUsIEJVU0lORVNTX1JVTEVfRk9STUFUX0NMQVNTLkNVTU1fQ09VTlRfQUdHKSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICcnLAogICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCduZXdDb3VudCcpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJuZXdTcG9uQ291bnQiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC51dGlscy5zdGFja2VkKAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cubmV3U3BvbkNvdW50LCAnTkVXJywgJ1NQT05UX0ZMQUcnLCByb3cuZXhlY0NvbmZpZ0lkLCByb3cuaWQsIHJvdy5wcm9kdWN0SWQsIHJvdy5wdENvZGUsICdORVdfU1BPTicpLAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cuY3VtU3BvbkNvdW50LCAnQ1VNTScsICdTUE9OVF9GTEFHJywgcm93LmV4ZWNDb25maWdJZCwgcm93LmlkLCByb3cucHJvZHVjdElkLCByb3cucHRDb2RlLCAnQ1VNTV9TUE9OJykpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnJywKICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnbmV3U3BvbkNvdW50JykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogIm5ld1NlcmlvdXNDb3VudCIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2lnbmFsLnV0aWxzLnN0YWNrZWQoCiAgICAgICAgICAgICAgICAgICAgICAgIGNudF9kcmlsbF9kb3duKHJvdy5uZXdTZXJpb3VzQ291bnQsICdORVcnLCAnU0VSSU9VU19GTEFHJywgcm93LmV4ZWNDb25maWdJZCwgcm93LmlkLCByb3cucHJvZHVjdElkLCByb3cucHRDb2RlLCAnTkVXX1NFUicpLAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cuY3VtU2VyaW91c0NvdW50LCAnQ1VNTScsICdTRVJJT1VTX0ZMQUcnLCByb3cuZXhlY0NvbmZpZ0lkLCByb3cuaWQsIHJvdy5wcm9kdWN0SWQsIHJvdy5wdENvZGUsICdDVU1NX1NFUicpKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJycsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ25ld1NlcmlvdXNDb3VudCcpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJtRGF0YSI6ICJuZXdGYXRhbENvdW50IiwKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzaWduYWwudXRpbHMuc3RhY2tlZCgKICAgICAgICAgICAgICAgICAgICAgICAgY250X2RyaWxsX2Rvd24ocm93Lm5ld0ZhdGFsQ291bnQsICdORVcnLCAnRkFUQUxfRkxBRycsIHJvdy5leGVjQ29uZmlnSWQsIHJvdy5pZCwgcm93LnByb2R1Y3RJZCwgcm93LnB0Q29kZSwgJ05FV19GQVRBTCcpLAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cuY3VtRmF0YWxDb3VudCwgJ0NVTU0nLCAnRkFUQUxfRkxBRycsIHJvdy5leGVjQ29uZmlnSWQsIHJvdy5pZCwgcm93LnByb2R1Y3RJZCwgcm93LnB0Q29kZSwgJ0NVTU1fRkFUQUwnKSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICcnLAogICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCduZXdGYXRhbENvdW50JykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogIm5ld1N0dWR5Q291bnQiLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC51dGlscy5zdGFja2VkKAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cubmV3U3R1ZHlDb3VudCwgJ05FVycsICdTVFVEWV9GTEFHJywgcm93LmV4ZWNDb25maWdJZCwgcm93LmlkLCByb3cucHJvZHVjdElkLCByb3cucHRDb2RlLCAnTkVXX1NUVURZJyksCiAgICAgICAgICAgICAgICAgICAgICAgIGNudF9kcmlsbF9kb3duKHJvdy5jdW1TdHVkeUNvdW50LCAnQ1VNTScsICdTVFVEWV9GTEFHJywgcm93LmV4ZWNDb25maWdJZCwgcm93LmlkLCByb3cucHJvZHVjdElkLCByb3cucHRDb2RlLCAnQ1VNTV9TVFVEWScpKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJycsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ25ld1N0dWR5Q291bnQnKQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiZnJlcVByaW9yaXR5IiwKICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAnY29sLW1pbi0xMDAnLAogICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdmcmVxUHJpb3JpdHknKQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAidHJlbmRUeXBlIiwKICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAnY29sLW1pbi03NScsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ3RyZW5kVHlwZScpCiAgICAgICAgICAgIH1dKTsKICAgICAgICAgICAgIGlmIChwcnJWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFt7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInByclZhbHVlIiwKICAgICAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iIyIgY2xhc3M9InN0ci1saW5rIiBkYXRhLWlkPSInICsgcm93LmlkICsgJyIgZGF0YS10eXBlPSInK1NUUkFUSUZJQ0FUSU9OX0ZJRUxEUy5QUlIrJyI+PHNwYW4gY2xhc3M9IlBSUiI+JyArIHJvdy5wcnJWYWx1ZSArICc8L3NwYW4+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ3ByclZhbHVlJykKICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyb3JWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFt7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInJvclZhbHVlIiwKICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICcnLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGhyZWY9IiMiIGNsYXNzPSJzdHItbGluayIgZGF0YS1pZD0iJyArIHJvdy5pZCArICciIGRhdGEtdHlwZT0iJytTVFJBVElGSUNBVElPTl9GSUVMRFMuUk9SKyciPjxzcGFuIGNsYXNzPSJST1IiPicgKyByb3cucm9yVmFsdWUgKyAnPC9zcGFuPjwvYT4nOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdyb3JWYWx1ZScpCiAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZWJnbVZpc2liaWxpdHkpIHsKICAgICAgICAgICAgICAgIGFvQ29sdW1ucy5wdXNoLmFwcGx5KGFvQ29sdW1ucywgWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImViMDUiLAogICAgICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaWduYWwudXRpbHMuc3RhY2tlZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9IkVCMDUiPicgKyByb3cuZWIwNSArICc8L3NwYW4+JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9IkVCOTUiPicgKyByb3cuZWI5NSArICc8L3NwYW4+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdlYjA1JykKICAgICAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHJyVmlzaWJpbGl0eSAmJiByb3JWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJjaGlTcXVhcmUiLAogICAgICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByb3cuY2hpU3F1YXJlOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnY2hpU3F1YXJlJykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICB9CgogICAgICAgIGFvQ29sdW1ucy5wdXNoLmFwcGx5KGFvQ29sdW1ucywgWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAnc2lnbmFsc0FuZFRvcGljcycsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgc2lnbmFsQW5kVG9waWNzID0gJyc7CiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHJvdy5zaWduYWxzQW5kVG9waWNzLCBmdW5jdGlvbiAoaSwgb2JqKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBzaWduYWxEZXRhaWxVcmwgKyAnP2lkPScgKyBvYmpbJ3NpZ25hbElkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCQoJyNoYXNTaWduYWxNYW5hZ2VtZW50QWNjZXNzJykudmFsKCkgPT0gJ3RydWUnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbEFuZFRvcGljcyA9IHNpZ25hbEFuZFRvcGljcyArICc8c3BhbiBjbGFzcz0iY2xpY2siPjxhICBjbGFzcz0iY2VsbC1icmVhayIgIG9uY2xpY2s9InZhbGlkYXRlQWNjZXNzKGV2ZW50LCcgKyBvYmpbJ3NpZ25hbElkJ10gKyAnKSIgaHJlZj0iJyArIHVybCArICciPicgKyBlc2NhcGVIVE1MKG9ialsnbmFtZSddKSArICc8L2E+PC9zcGFuPiZuYnNwOycKICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmFsQW5kVG9waWNzID0gc2lnbmFsQW5kVG9waWNzICsgJzxzcGFuIGNsYXNzPSJjbGljayBzaWduYWxTdW1tYXJ5QXV0aCI+PGEgIGNsYXNzPSJjZWxsLWJyZWFrIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiPicgKyBlc2NhcGVIVE1MKG9ialsnbmFtZSddKSArICc8L2E+PC9zcGFuPiZuYnNwOycKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzaWduYWxBbmRUb3BpY3MgPSBzaWduYWxBbmRUb3BpY3MgKyAiLCIKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBpZiAoc2lnbmFsQW5kVG9waWNzLmxlbmd0aCA+IDEpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdj4nICsgc2lnbmFsQW5kVG9waWNzLnN1YnN0cmluZygwLCBzaWduYWxBbmRUb3BpY3MubGVuZ3RoIC0gMSkgKyAnPC9kaXY+JzsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnLSc7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdjb2wtbWluLTE1MCBjb2wtbWF4LTIwMCBzaWduYWxJbmZvcm1hdGlvbicsCiAgICAgICAgICAgICAgICAib3JkZXJhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ3NpZ25hbHNBbmRUb3BpY3MnKQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiZGlzcG9zaXRpb24iLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvdy5kaXNwb3NpdGlvbjsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAnY2xhc3NOYW1lJzogJ2NvbC1tYXgtMjUwIGN1cnJlbnREaXNwb3NpdGlvbicsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2Rpc3Bvc2l0aW9uJykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogImN1cnJlbnREaXNwb3NpdGlvbiIsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2lnbmFsLnV0aWxzLnJlbmRlcignZGlzcG9zaXRpb24nLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWREaXNwb3NpdGlvbjogZGlzcG9zaXRpb25JbmNvbWluZ091dGdvaW5nTWFwW3Jvdy5kaXNwb3NpdGlvbl0sCiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnREaXNwb3NpdGlvbjogcm93LmRpc3Bvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICBmb3JjZUp1c3RpZmljYXRpb246IGZvcmNlSnVzdGlmaWNhdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgaXNSZXZpZXdlZDpyb3cuaXNSZXZpZXdlZCwKICAgICAgICAgICAgICAgICAgICAgICAgaXNWYWxpZGF0aW9uU3RhdGVBY2hpZXZlZDogcm93LmlzVmFsaWRhdGlvblN0YXRlQWNoaWV2ZWQKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2N1cnJlbnREaXNwb3NpdGlvbicpLAogICAgICAgICAgICAgICAgImNsYXNzIjogJ2NvbC1tYXgtMjUwIGRpc3Bvc2l0aW9uQWN0aW9uJwogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiYXNzaWduZWRUbyIsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJ2NvbC1taW4tMTAwIGNvbC1tYXgtMTUwIGFzc2lnbmVkVG8nLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC5saXN0X3V0aWxzLmFzc2lnbmVkX3RvX2NvbXAocm93LmlkLCByb3cuYXNzaWduZWRUbykKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAib3JkZXJhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2Fzc2lnbmVkVG8nKQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAiZHVlRGF0ZSIsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJ2NvbC1taW4tMjUgZHVlSW4nLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC5saXN0X3V0aWxzLmR1ZV9pbl9jb21wKHJvdy5kdWVJbikKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2R1ZURhdGUnKQogICAgICAgICAgICB9XSk7CgogICAgICAgIGlmIChncm91cEJ5U21xICE9ICJ0cnVlIikgewogICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFt7CiAgICAgICAgICAgICAgICAibURhdGEiOiAicG9zaXRpdmVSZWNoYWxsZW5nZSIsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyByb3cucG9zaXRpdmVSZWNoYWxsZW5nZSArICc8L3NwYW4+JwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygncG9zaXRpdmVSZWNoYWxsZW5nZScpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogInBvc2l0aXZlRGVjaGFsbGVuZ2UiLAogICAgICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAnJywKICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8c3Bhbj4nICsgcm93LnBvc2l0aXZlRGVjaGFsbGVuZ2UgKyAnPC9zcGFuPicKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygncG9zaXRpdmVEZWNoYWxsZW5nZScpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0pOwogICAgICAgIH0KCiAgICAgICAgICAgIGlmIChwcnJWaXNpYmlsaXR5KSB7CiAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJwcnIwNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC51dGlscy5zdGFja2VkKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBocmVmPSIjIiBjbGFzcz0ic3RyLWxpbmsiIGRhdGEtaWQ9IicgKyByb3cuaWQgKyAnIiBkYXRhLXR5cGU9IicrU1RSQVRJRklDQVRJT05fRklFTERTLlBSUjA1KyciPjxzcGFuIGNsYXNzPSJQUlIwNSI+JyArIHJvdy5wcnIwNSArICc8L3NwYW4+PC9hPicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9IiMiIGNsYXNzPSJzdHItbGluayIgZGF0YS1pZD0iJyArIHJvdy5pZCArICciIGRhdGEtdHlwZT0iJytTVFJBVElGSUNBVElPTl9GSUVMRFMuUFJSOTUrJyI+PHNwYW4gY2xhc3M9IlBSUjk1Ij4nICsgcm93LnBycjk1ICsgJzwvc3Bhbj48L2E+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ3BycjA1JykKICAgICAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocm9yVmlzaWJpbGl0eSkgewogICAgICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAicm9yMDUiLAogICAgICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaWduYWwudXRpbHMuc3RhY2tlZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGEgaHJlZj0iIyIgY2xhc3M9InN0ci1saW5rIiBkYXRhLWlkPSInICsgcm93LmlkICsgJyIgZGF0YS10eXBlPSInK1NUUkFUSUZJQ0FUSU9OX0ZJRUxEUy5ST1IwNSsnIj48c3BhbiBjbGFzcz0iUk9SMDUiPicgKyByb3cucm9yMDUgKyAnPC9zcGFuPjwvYT4nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBocmVmPSIjIiBjbGFzcz0ic3RyLWxpbmsiIGRhdGEtaWQ9IicgKyByb3cuaWQgKyAnIiBkYXRhLXR5cGU9IicrU1RSQVRJRklDQVRJT05fRklFTERTLlJPUjk1KyciPjxzcGFuIGNsYXNzPSJST1I5NSI+JyArIHJvdy5yb3I5NSArICc8L3NwYW4+PC9hPicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdyb3IwNScpCiAgICAgICAgICAgICAgICAgICAgfV0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGViZ21WaXNpYmlsaXR5KSB7CiAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFt7CiAgICAgICAgICAgICAgICAgICAgIm1EYXRhIjogImViZ20iLAogICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJycsCiAgICAgICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4gY2xhc3M9IkVCR00iPicgKyByb3cuZWJnbSArICc8L3NwYW4+JzsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnZWJnbScpCiAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZHNzVmlzaWJpbGl0eSkgewogICAgICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBbewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJwZWNJbXBIaWdoIiwKICAgICAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRzc1VybCA9ICQoIiNkc3NVcmwiKS52YWwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8YSBocmVmPSciICsgZHNzVXJsICsgIicgdGFyZ2V0PSdfYmxhbmsnIGNsYXNzPSdwZWNJbXBvcnRhbmNlLXZpZXcnPjxzcGFuIGNsYXNzPSdwZWNJbXBvcnRhbmNlJz4iICsgcm93LmhpZ2hQZWNJbXAgKyAiPC9zcGFuPjwvYT4iCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNpZ25hbC51dGlscy5zdGFja2VkKHJvdy5oaWdoUGVjSW1wLCByb3cubG93UGVjSW1wKSArIjwvc3Bhbj48L2E+IgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJwZWNJbXBMb3ciLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHNzVXJsID0gJCgiI2Rzc1VybCIpLnZhbCgpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIjxhIGhyZWY9JyIgKyBkc3NVcmwgKyAiJyB0YXJnZXQ9J19ibGFuaycgY2xhc3M9J3BlY0ltcG9ydGFuY2Utdmlldyc+PHNwYW4gY2xhc3M9J3BlY0ltcG9ydGFuY2UnPiIgKyByb3cubG93UGVjSW1wICsgIjwvc3Bhbj48L2E+IgogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaWduYWwudXRpbHMuc3RhY2tlZChyb3cuaGlnaFBlY0ltcCwgcm93Lmxvd1BlY0ltcCkgKwoKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJycKICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICB9CiAgICAgICAgaWYgKGdyb3VwQnlTbXEgIT0gInRydWUiKSB7CiAgICAgICAgICAgIGFvQ29sdW1ucy5wdXNoLmFwcGx5KGFvQ29sdW1ucywgWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtRGF0YSI6ICJyZWxhdGVkIiwKICAgICAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4+JyArIHJvdy5yZWxhdGVkICsgJzwvc3Bhbj4nCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ3JlbGF0ZWQnKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibURhdGEiOiAicHJlZ2VuZW5jeSIsCiAgICAgICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICcnLAogICAgICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyByb3cucHJlZ2VuZW5jeSArICc8L3NwYW4+JwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdwcmVnZW5lbmN5JykKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogIm5ld1BlZGlhdHJpY0NvdW50IiwKICAgICAgICAgICAgICAgICJjbGFzc05hbWUiOiAnJywKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzaWduYWwudXRpbHMuc3RhY2tlZCgKICAgICAgICAgICAgICAgICAgICAgICAgY250X2RyaWxsX2Rvd24ocm93Lm5ld1BlZGlhdHJpY0NvdW50LCBDT1VOVFMuTkVXLCBGTEFHUy5QRURJX0ZMQUcsIHJvdy5leGVjQ29uZmlnSWQsIHJvdy5pZCwgcm93LnByb2R1Y3RJZCwgcm93LnB0Q29kZSwgJycpLAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cuY3VtbVBlZGlhdHJpY0NvdW50LCBDT1VOVFMuQ1VNTSwgRkxBR1MuUEVESV9GTEFHLCByb3cuZXhlY0NvbmZpZ0lkLCByb3cuaWQsIHJvdy5wcm9kdWN0SWQsIHJvdy5wdENvZGUsICcnKSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ25ld1BlZGlhdHJpY0NvdW50JykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogIm5ld0ludGVyYWN0aW5nQ291bnQiLAogICAgICAgICAgICAgICAgImNsYXNzTmFtZSI6ICcnLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25hbC51dGlscy5zdGFja2VkKAogICAgICAgICAgICAgICAgICAgICAgICBjbnRfZHJpbGxfZG93bihyb3cubmV3SW50ZXJhY3RpbmdDb3VudCwgQ09VTlRTLk5FVywgRkxBR1MuSU5URVJBQ1RJTkdfRkxBRywgcm93LmV4ZWNDb25maWdJZCwgcm93LmlkLCByb3cucHJvZHVjdElkLCByb3cucHRDb2RlLCAnJyksCiAgICAgICAgICAgICAgICAgICAgICAgIGNudF9kcmlsbF9kb3duKHJvdy5jdW1tSW50ZXJhY3RpbmdDb3VudCwgQ09VTlRTLkNVTU0sIEZMQUdTLklOVEVSQUNUSU5HX0ZMQUcsIHJvdy5leGVjQ29uZmlnSWQsIHJvdy5pZCwgcm93LnByb2R1Y3RJZCwgcm93LnB0Q29kZSwgJycpKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnbmV3SW50ZXJhY3RpbmdDb3VudCcpCiAgICAgICAgICAgIH1dKTsKICAgICAgICAgaWYoaXNBZ2VFbmFibGVkKSB7CiAgICAgICAgICAgICAkLmVhY2goc3ViR3JvdXBzTWFwLkFHRV9HUk9VUCwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIG1ha2VTdWJHcm91cENvbHVtbnMoImViZ20iLCB2YWx1ZSwgImViZ21BZ2UiKSk7CiAgICAgICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBtYWtlU3ViR3JvdXBDb2x1bW5zKCJlYjA1IiwgdmFsdWUsICJlYjA1QWdlIikpOwogICAgICAgICAgICAgICAgIGFvQ29sdW1ucy5wdXNoLmFwcGx5KGFvQ29sdW1ucywgbWFrZVN1Ykdyb3VwQ29sdW1ucygiZWI5NSIsIHZhbHVlLCAiZWI5NUFnZSIpKTsKICAgICAgICAgICAgIH0pOwogICAgICAgICB9CiAgICAgICAgIGlmKGlzR2VuZGVyRW5hYmxlZCkgewogICAgICAgICAgICAgJC5lYWNoKHN1Ykdyb3Vwc01hcC5HRU5ERVIsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBtYWtlU3ViR3JvdXBDb2x1bW5zKCJlYmdtIiwgdmFsdWUsICJlYmdtR2VuZGVyIikpOwogICAgICAgICAgICAgICAgIGFvQ29sdW1ucy5wdXNoLmFwcGx5KGFvQ29sdW1ucywgbWFrZVN1Ykdyb3VwQ29sdW1ucygiZWIwNSIsIHZhbHVlLCAiZWIwNUdlbmRlciIpKTsKICAgICAgICAgICAgICAgICBhb0NvbHVtbnMucHVzaC5hcHBseShhb0NvbHVtbnMsIG1ha2VTdWJHcm91cENvbHVtbnMoImViOTUiLCB2YWx1ZSwgImViOTVHZW5kZXIiKSk7CiAgICAgICAgICAgICB9KTsKICAgICAgICAgfQoKICAgICAgICBpZiAoY2FsbGluZ1NjcmVlbiA9PSBDQUxMSU5HX1NDUkVFTi5UUklHR0VSRURfQUxFUlRTKSB7CiAgICAgICAgICAgIGFvQ29sdW1ucy5zcGxpY2UoMiwgMCwgewogICAgICAgICAgICAgICAgIm1EYXRhIjogIm5hbWUiLAogICAgICAgICAgICAgICAgJ2NsYXNzTmFtZSc6ICdkdC1sZWZ0JywKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4+JyArIHJvdy5hbGVydE5hbWUgKyAnPC9zcGFuPicKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQuZWFjaChyZXN1bHQsIGZ1bmN0aW9uIChpbmRleCwgZGF0YSkgewogICAgICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBtYWtlQW9Db2x1bW5zKHBhcnNlSW50KGluZGV4LnNsaWNlKC0xKSksIHByclZpc2liaWxpdHksIHJvclZpc2liaWxpdHksIGViZ21WaXNpYmlsaXR5LCBkc3NWaXNpYmlsaXR5KSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIGlmIChjYWxsaW5nU2NyZWVuID09IENBTExJTkdfU0NSRUVOLlJFVklFVykgewogICAgICAgICAgICBmb3IgKHZhciBwcmV2Q29sdW1uID0gMDsgcHJldkNvbHVtbiA8IHBhcnNlSW50KHByZXZDb2xDb3VudCk7IHByZXZDb2x1bW4rKykgewogICAgICAgICAgICAgICAgYW9Db2x1bW5zLnB1c2guYXBwbHkoYW9Db2x1bW5zLCBtYWtlQW9Db2x1bW5zKHByZXZDb2x1bW4sIHByclZpc2liaWxpdHksIHJvclZpc2liaWxpdHksIGViZ21WaXNpYmlsaXR5LCBkc3NWaXNpYmlsaXR5KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFvQ29sdW1ucwogICAgfTsKCiAgICB2YXIgY250X2RyaWxsX2Rvd24gPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUsIHR5cGVGbGFnLCBleGVjdXRlZENvbmZpZ0lkLCBhbGVydElkLCBwcm9kdWN0SWQsIHB0Q29kZSwgY2xhc3NOYW1lKSB7CgogICAgICAgIHZhciBzaW5nbGVDYXNlRGV0YWlsc1VybCA9ICcvc2lnbmFsL3NpbmdsZUNhc2VBbGVydC9jYXNlU2VyaWVzRGV0YWlscz9hZ2dFeGVjdXRpb25JZD0nICsgZXhlY3V0ZWRDb25maWdJZCArICcmYWdnQWxlcnRJZD0nICsgYWxlcnRJZCArICcmYWdnQ291bnRUeXBlPScgKyBjbGFzc05hbWUgKyAnJnByb2R1Y3RJZD0nICsgcHJvZHVjdElkICsgJyZwdENvZGU9JyArIHB0Q29kZSArICcmdHlwZT0nICsgdHlwZSArICImdHlwZUZsYWc9IiArIHR5cGVGbGFnICsgIiZpc0FyY2hpdmVkPSIgKyBpc0FyY2hpdmVkOwoKICAgICAgICB2YXIgc2VyaWVzRGF0YSA9ICJpZDoiICsgYWxlcnRJZCArICIsdHlwZUZsYWc6IiArIHR5cGVGbGFnICsgIix0eXBlOiIgKyB0eXBlICsgIixleGVjdXRlZENvbmZpZ0lkOiIgKwogICAgICAgICAgICBleGVjdXRlZENvbmZpZ0lkICsgIixwcm9kdWN0SWQ6IiArIHByb2R1Y3RJZCArICIscHRDb2RlOiIgKyBwdENvZGU7CgogICAgICAgIGlmICh2YWx1ZSA9PT0gMCkgewogICAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJibHVlLTEiPicgKyB2YWx1ZSArICc8L3NwYW4+JwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHB2ckludGVncmF0ZSAhPSAidW5kZWZpbmVkIiAmJiBKU09OLnBhcnNlKHB2ckludGVncmF0ZSkpIHsKICAgICAgICAgICAgdmFyIGFjdGlvbkJ1dHRvbiA9ICc8ZGl2IHN0eWxlPSJkaXNwbGF5OiBibG9jayIgY2xhc3M9ImJ0bi1ncm91cCBkcm9wZG93biI+IFwKICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0iZHJvcGRvd24tdG9nZ2xlICcgKyBjbGFzc05hbWUgKyAnIiBkYXRhLXRvZ2dsZT0iZHJvcGRvd24iIGhyZWY9IiMiPicgKyB2YWx1ZSArICc8L2E+IFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx1bCBjbGFzcz0iZHJvcGRvd24tbWVudSBkcm9wZG93bi1tZW51LXJpZ2h0IiByb2xlPSJtZW51IiBzdHlsZT0ibWluLXdpZHRoOiA4MHB4ICFpbXBvcnRhbnQ7IGZvbnQtc2l6ZTogMTJweDsiPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkKCIjaXNDYXNlU2VyaWVzQWNjZXNzIikudmFsKCk9PSJmYWxzZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9uID0gYWN0aW9uQnV0dG9uICsgJzxsaSByb2xlPSJwcmVzZW50YXRpb24iIGNsYXNzPSJjYXNlU2VyaWVzTm90QWNjZXNzIj48YSA+JyArICdDYXNlIFNlcmllcycgKyAnPC9hPjwvbGk+JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25CdXR0b24gPSBhY3Rpb25CdXR0b24gKyAgJzxsaSByb2xlPSJwcmVzZW50YXRpb24iPjxhIGhyZWY9JyArIHNpbmdsZUNhc2VEZXRhaWxzVXJsICsgJyB0YXJnZXQ9Il9ibGFuayIgZGF0YS11cmw9JyArIHNpbmdsZUNhc2VEZXRhaWxzVXJsICsgJyBjbGFzcz0iIj4nICsgJ0Nhc2UgU2VyaWVzJyArICc8L2E+PC9saT4nOwogICAgICAgICAgICBpZiggJCgiI2lzRmFlcnMiKS52YWwoKSA9PSAiZmFsc2UiKQogICAgICAgICAgICBhY3Rpb25CdXR0b24gPSBhY3Rpb25CdXR0b24gKyAnPGxpIHJvbGU9InByZXNlbnRhdGlvbiI+PGEgaHJlZj0iJyArIHRlbXBsYXRlX2xpc3RfdXJsICsgJz8nICsKICAgICAgICAgICAgICAgIHNpZ25hbC51dGlscy5jb21wb3NlUGFyYW1zKHsKICAgICAgICAgICAgICAgICAgICBjb25maWdJZDogZXhlY3V0ZWRDb25maWdJZCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgICAgICAgICAgIGFsZXJ0SWQ6IGFsZXJ0SWQsCiAgICAgICAgICAgICAgICAgICAgdHlwZUZsYWc6IHR5cGVGbGFnCiAgICAgICAgICAgICAgICB9KSArCiAgICAgICAgICAgICAgICAnICI+JyArICQuaTE4bi5fKCdSZXBvcnQnKSArICc8L2E+IFw8L2xpPicKCiAgICAgICAgICAgIGlmKCQoIiNpc0Nhc2VTZXJpZXNBY2Nlc3MiKS52YWwoKT09ImZhbHNlIikKICAgICAgICAgICAgICAgIGFjdGlvbkJ1dHRvbj1hY3Rpb25CdXR0b24gKyAnPGxpIHJvbGU9InByZXNlbnRhdGlvbiI+PGEgY2xhc3M9ImNhc2VTZXJpZXNOb3RBY2Nlc3MiID4nICsgJ1NhdmUgQ2FzZSBTZXJpZXMnICsgJzwvYT48L2xpPic7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgYWN0aW9uQnV0dG9uID0gYWN0aW9uQnV0dG9uICsgJzxsaSByb2xlPSJwcmVzZW50YXRpb24iPjxhIGNsYXNzPSJnZW5lcmF0ZS1jYXNlLXNlcmllcyIgZGF0YS11cmw9IicgKyBzZXJpZXNEYXRhICsgJyIgJyArCiAgICAgICAgICAgICAgICAgICAgJ3JvbGU9Im1lbnVpdGVtIiBocmVmPSIjIiA+JyArICdTYXZlIENhc2UgU2VyaWVzJyArICc8L2E+PC9saT4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFjdGlvbkJ1dHRvbj1hY3Rpb25CdXR0b24gKyAnPC91bD4gXAogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4nOwogICAgICAgICAgICByZXR1cm4gYWN0aW9uQnV0dG9uOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0nICsgc2luZ2xlQ2FzZURldGFpbHNVcmwgKyAnIHRhcmdldD0iX2JsYW5rIiBjbGFzcz0iIj4nICsgdmFsdWUgKyAnPC9hPicKICAgICAgICB9CiAgICB9OwoKICAgIHZhciBzaG93QWxsU2VsZWN0ZWRDYXNlTnVtYmVycyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjY29weUNhc2VOdW1iZXJNb2RlbCcpLm1vZGFsKHsKICAgICAgICAgICAgc2hvdzogdHJ1ZQogICAgICAgIH0pOwoKICAgICAgICB2YXIgbnVtYmVycyA9IF8ubWFwKCQoJ2lucHV0LmNvcHktc2VsZWN0OmNoZWNrZWQnKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCd0ZDpudGgtY2hpbGQoNSknKSwgZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICAgIHJldHVybiAkKGl0KS50ZXh0KCkKICAgICAgICB9KTsKICAgICAgICAkKCIjY2FzZU51bWJlcnMiKS50ZXh0KG51bWJlcnMpOwogICAgfTsKCiAgICAkKCcjZXhwb3J0VHlwZXMgYVtocmVmXScpLmNsaWNrKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIGNsaWNrZWRVUkwgPSBlLmN1cnJlbnRUYXJnZXQuaHJlZjsKICAgICAgICB2YXIgdXBkYXRlZEV4cG9ydFVybCA9IGNsaWNrZWRVUkw7CiAgICAgICAgdmFyIGlkcyA9IFtdOwogICAgICAgICQoJy5hbGVydC1jaGVjay1ib3gnKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKCQodGhpcylbMF1bJ2NoZWNrZWQnXSkgewogICAgICAgICAgICAgICAgaWRzLnB1c2goJCh0aGlzKS5hdHRyKCdkYXRhLWlkJykpCiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgdmFyIGNoZWNrZWRDb2x1bW5zID0ge307CiAgICAgICAgJCgnI3RhYmxlQ29sdW1ucyB0ciAnKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGZpZWxkTmFtZSA9ICQodGhpcykuY2hpbGRyZW4oKS5jaGlsZHJlbigpLmF0dHIoJ2RhdGEtZmllbGQnKTsKICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSkgewogICAgICAgICAgICAgICAgY2hlY2tlZENvbHVtbnNbZmllbGROYW1lXSA9ICQodGhpcykuY2hpbGRyZW4oKVsxXS5maXJzdENoaWxkLmNoZWNrZWQKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB2YXIgaXNGaWx0ZXJSZXF1ZXN0ID0gdHJ1ZTsKICAgICAgICB2YXIgZmlsdGVyVmFsdWVzID0gW107CiAgICAgICAgdmFyIHByZWZpeCA9ICJhZ2dfIjsKICAgICAgICBpZiAod2luZG93LnNlc3Npb25TdG9yYWdlKSB7CiAgICAgICAgICAgIGlmIChzaWduYWwuYWxlcnRSZXZpZXcuaXNBbGVydFBlcnNpc3RlZEluU2Vzc2lvblN0b3JhZ2UocHJlZml4KSkgewogICAgICAgICAgICAgICAgZmlsdGVyVmFsdWVzID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHByZWZpeCArICJmaWx0ZXJzX3ZhbHVlIikpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2lnbmFsLmFsZXJ0UmV2aWV3LnJlbW92ZUZpbHRlcnNGcm9tU2Vzc2lvblN0b3JhZ2UocHJlZml4KTsKICAgICAgICAgICAgICAgIGlzRmlsdGVyUmVxdWVzdCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoaWRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdXBkYXRlZEV4cG9ydFVybCA9IGNsaWNrZWRVUkwgKyAnJmlzRmlsdGVyUmVxdWVzdD0nICsgaXNGaWx0ZXJSZXF1ZXN0ICsgJyZmaWx0ZXJzPScgKyBlbmNvZGVVUkkoSlNPTi5zdHJpbmdpZnkoZmlsdGVyVmFsdWVzKSkgKyAiJnNlbGVjdGVkQ2FzZXM9IiArIGlkcyArICImdmlld0lkPSIgKyB2aWV3SWQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIGZpbHRlckxpc3QgPSB7fTsKICAgICAgICAgICAgJCgiLnlhZGNmLWZpbHRlci13cmFwcGVyIikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZmlsdGVyVmFsID0gJCh0aGlzKS5jaGlsZHJlbigpLnZhbCgpOwogICAgICAgICAgICAgICAgaWYgKGZpbHRlclZhbCkgewogICAgICAgICAgICAgICAgICAgIGZpbHRlckxpc3RbJCh0aGlzKS5wcmV2KCkuYXR0cignZGF0YS1maWVsZCcpXSA9IGZpbHRlclZhbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIGZpbHRlckxpc3RKc29uID0gSlNPTi5zdHJpbmdpZnkoZmlsdGVyTGlzdCk7CiAgICAgICAgICAgIHVwZGF0ZWRFeHBvcnRVcmwgPSBjbGlja2VkVVJMICsgJyZpc0ZpbHRlclJlcXVlc3Q9JyArIGlzRmlsdGVyUmVxdWVzdCArICcmZmlsdGVycz0nICsgSlNPTi5zdHJpbmdpZnkoZmlsdGVyVmFsdWVzKSArICImZnJlcXVlbmN5PSIgKyBmcmVxU2VsZWN0ZWQgKyAiJnZpZXdJZD0iICsgdmlld0lkICsgIiZmaWx0ZXJMaXN0PSIgKyBlbmNvZGVVUkkoZmlsdGVyTGlzdEpzb24pICsgIiZpc0ZhZXJzPSIgKyAkKCcjaXNGYWVycycpLnZhbCgpOwogICAgICAgICAgICBpZiAoJCgnI2FkdmFuY2VkLWZpbHRlcicpLnZhbCgpKSB7CiAgICAgICAgICAgICAgICB1cGRhdGVkRXhwb3J0VXJsICs9ICImYWR2YW5jZWRGaWx0ZXJJZD0iICsgJCgnI2FkdmFuY2VkLWZpbHRlcicpLnZhbCgpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cGRhdGVkRXhwb3J0VXJsOwogICAgICAgIHJldHVybiBmYWxzZQogICAgfSk7CgogICAgdmFyIGxvYWRUYWJsZSA9IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICB2YXIgZ3JvdXBCeVNtcSA9ICQoJyNncm91cEJ5U21xJykudmFsKCk7CiAgICAgICAgaW5pdChyZXN1bHQsIGdyb3VwQnlTbXEpOwogICAgICAgICQoIiNhbGVydHNEZXRhaWxzVGFibGVfZmlsdGVyIikuaGlkZSgpOwogICAgICAgIGlmIChjYWxsaW5nU2NyZWVuID09IENBTExJTkdfU0NSRUVOLlRSSUdHRVJFRF9BTEVSVFMpIHsKICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8PSAkKCIuZXh0cmFDb2x1bW5zIikubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGxpc3RPZkluZGV4LnB1c2goMjUgKyBpKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoY2FsbGluZ1NjcmVlbiA9PSBDQUxMSU5HX1NDUkVFTi5SRVZJRVcpIHsKICAgICAgICAgICAgLy9zYXZpbmcgbmV3IFZpZXdJbnN0YW5jZSBtb2RhbAogICAgICAgICAgICBpZiAoZ3JvdXBCeVNtcSA9PSAidHJ1ZSIpIHsKICAgICAgICAgICAgICAgIHNpZ25hbC5hbGVydFJldmlldy5vcGVuU2F2ZVZpZXdNb2RhbChmaWx0ZXJJbmRleCwgYXBwbGljYXRpb25OYW1lU21xLCB2aWV3SWQpCiAgICAgICAgICAgIH0gZWxzZSBpZigkKCIjaXNGYWVycyIpLnZhbCgpID09ICJ0cnVlIil7CiAgICAgICAgICAgICAgICBzaWduYWwuYWxlcnRSZXZpZXcub3BlblNhdmVWaWV3TW9kYWwoZmlsdGVySW5kZXgsIGFwcGxpY2F0aW9uTmFtZUZhZXJzLCB2aWV3SWQpCiAgICAgICAgICAgIH0gZWxzZXsKICAgICAgICAgICAgICAgIHNpZ25hbC5hbGVydFJldmlldy5vcGVuU2F2ZVZpZXdNb2RhbChmaWx0ZXJJbmRleCwgYXBwbGljYXRpb25OYW1lLCB2aWV3SWQpCiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZSBpZihjYWxsaW5nU2NyZWVuID09IENBTExJTkdfU0NSRUVOLkRBU0hCT0FSRCl7CiAgICAgICAgICAgIHNpZ25hbC5hbGVydFJldmlldy5vcGVuU2F2ZVZpZXdNb2RhbChmaWx0ZXJJbmRleCwgQUxFUlRfQ09ORklHX1RZUEUuQUdHUkVHQVRFX0NBU0VfQUxFUlRfREFTSEJPQVJELCB2aWV3SWQpCiAgICAgICAgfQogICAgICAgIC8vbGlzdCBvZiBoaWRkZW4gY29sdW1ucyBiYXNlZCBvbiBzYXZlZCB2aWV3CiAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2FjYV9ub3RWaXNpYmxlQ29sdW1uXycgKyBleGVjdXRlZENvbmZpZ0lkKSB8fCAkKCcjY29sdW1uSW5kZXgnKS52YWwoKSAhPSAiIikgewogICAgICAgICAgICBsaXN0T2ZJbmRleCA9IHNpZ25hbC5hbGVydFJldmlldy5jcmVhdGVMaXN0T2ZJbmRleCgnYWNhX25vdFZpc2libGVDb2x1bW5fJyArIGV4ZWN1dGVkQ29uZmlnSWQsIGZhbHNlLCAnYWNhX3ZpZXdOYW1lXycgKyBleGVjdXRlZENvbmZpZ0lkKTsKCiAgICAgICAgfQogICAgfQogICAgaWYgKGNhbGxpbmdTY3JlZW4gPT0gQ0FMTElOR19TQ1JFRU4uVFJJR0dFUkVEX0FMRVJUUykgewogICAgICAgIHZhciBnZXREYXRlUmFuZ2UgPSBmdW5jdGlvbiAoZnJlcXVlbmN5KSB7CiAgICAgICAgICAgICQoIi5leHRyYUNvbHVtbnMiKS5yZW1vdmUoKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgIHVybDogZGF0ZVJhbmdlTGlzdFVybCArICI/ZnJlcXVlbmN5PSIgKyBmcmVxdWVuY3ksCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHByclZpc2liaWxpdHkgPSBKU09OLnBhcnNlKCQoIiNzaG93UHJyIikudmFsKCkpOwogICAgICAgICAgICAgICAgICAgIHZhciByb3JWaXNpYmlsaXR5ID0gSlNPTi5wYXJzZSgkKCIjc2hvd1JvciIpLnZhbCgpKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZWJnbVZpc2liaWxpdHkgPSBKU09OLnBhcnNlKCQoIiNzaG93RWJnbSIpLnZhbCgpKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZHNzVmlzaWJpbGl0eSA9IEpTT04ucGFyc2UoJCgiI3Nob3dEc3MiKS52YWwoKSk7CiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHJlc3VsdCwgZnVuY3Rpb24gKGluZGV4LCBkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlcmFuZ2UgPSBkYXRhLnN0YXJ0RGF0ZS5yZXBsYWNlKC9cLS9nLCAiLyIpICsgJy0nICsgZGF0YS5lbmREYXRlLnJlcGxhY2UoL1wtL2csICIvIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSAiZXhlUmVjZW50IikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiPGRpdiBjbGFzcz0nZXh0cmFDb2x1bW5zJz4iICsgZGF0ZXJhbmdlICsgIjwvZGl2PiIpLmFwcGVuZFRvKCcjYWxlcnRzRGV0YWlsc1RhYmxlIC5kYXRlUmFuZ2UnKQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBpbmRleC5zbGljZSgtMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIjx0aCBjbGFzcz0nZXh0cmFDb2x1bW5zJz48ZGl2IGNsYXNzPSd0aC1sYWJlbCcgZGF0YS1maWVsZD0nZXhlIiArIGkgKyAibmV3U3BvbkNvdW50Jz48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+TiBTcG9uPC9kaXY+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPkMgU3BvbjwvZGl2PjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz4iICsgZGF0ZXJhbmdlICsgIjwvZGl2PjwvZGl2PjwvdGg+IikuYXBwZW5kVG8oIiNhbGVydHNEZXRhaWxzVGFibGVSb3ciKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIjx0aCBjbGFzcz0nZXh0cmFDb2x1bW5zJz48ZGl2IGNsYXNzPSd0aC1sYWJlbCcgZGF0YS1maWVsZD0nZXhlIiArIGkgKyAibmV3U2VyaW91c0NvdW50Jz48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+TiBTZXI8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+QyBTZXI8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+IiArIGRhdGVyYW5nZSArICI8L2Rpdj48L2Rpdj48L3RoPiIpLmFwcGVuZFRvKCIjYWxlcnRzRGV0YWlsc1RhYmxlUm93Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCI8dGggY2xhc3M9J2V4dHJhQ29sdW1ucyc+PGRpdiBjbGFzcz0ndGgtbGFiZWwnIGRhdGEtZmllbGQ9J2V4ZSIgKyBpICsgIm5ld0ZhdGFsQ291bnQnPjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz5OIEZhdGFsPC9kaXY+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPkMgRmF0YWw8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+IiArIGRhdGVyYW5nZSArICI8L2Rpdj48L2Rpdj48L3RoPiIpLmFwcGVuZFRvKCIjYWxlcnRzRGV0YWlsc1RhYmxlUm93Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCI8dGggY2xhc3M9J2V4dHJhQ29sdW1ucyc+PGRpdiBjbGFzcz0ndGgtbGFiZWwnIGRhdGEtZmllbGQ9J2V4ZSIgKyBpICsgIm5ld1N0dWR5Q291bnQnPjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz5OIFN0dWR5PC9kaXY+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPkMgU3R1ZHk8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+IiArIGRhdGVyYW5nZSArICI8L2Rpdj48L2Rpdj48L3RoPiIpLmFwcGVuZFRvKCIjYWxlcnRzRGV0YWlsc1RhYmxlUm93Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJyVmlzaWJpbGl0eSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIjx0aCBjbGFzcz0nZXh0cmFDb2x1bW5zJz4gPGRpdiBjbGFzcz0ndGgtbGFiZWwnIGRhdGEtZmllbGQ9J2V4ZSIgKyBpICsgInByclZhbHVlJz48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+UFJSPC9kaXY+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPiIgKyBkYXRlcmFuZ2UgKyAiPC9kaXY+PC9kaXY+PC90aD4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjx0aCBjbGFzcz0nZXh0cmFDb2x1bW5zJz48ZGl2IGNsYXNzPSd0aC1sYWJlbCcgZGF0YS1maWVsZD0nZXhlIiArIGkgKyAicHJyMDUnPjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz5QUlIwNTwvZGl2PjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz5QUlIgOTU8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+IiArIGRhdGVyYW5nZSArICI8L2Rpdj48L2Rpdj4gPC90aD4iKS5hcHBlbmRUbygiI2FsZXJ0c0RldGFpbHNUYWJsZVJvdyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvclZpc2liaWxpdHkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCI8dGggY2xhc3M9J2V4dHJhQ29sdW1ucyc+IDxkaXYgY2xhc3M9J3RoLWxhYmVsJyBkYXRhLWZpZWxkPSdleGUiICsgaSArICJyb3JWYWx1ZSc+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPlJPUjwvZGl2PjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz4iICsgZGF0ZXJhbmdlICsgIjwvZGl2PjwvZGl2PjwvdGg+IiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8dGggY2xhc3M9J2V4dHJhQ29sdW1ucyc+PGRpdiBjbGFzcz0ndGgtbGFiZWwnIGRhdGEtZmllbGQ9J2V4ZSIgKyBpICsgInJvcjA1Jz48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+UjBSMDU8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+Uk9SIDk1PC9kaXY+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPiIgKyBkYXRlcmFuZ2UgKyAiPC9kaXY+PC9kaXY+IDwvdGg+IikuYXBwZW5kVG8oIiNhbGVydHNEZXRhaWxzVGFibGVSb3ciKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlYmdtVmlzaWJpbGl0eSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIjx0aCBjbGFzcz0nZXh0cmFDb2x1bW5zJz4gPGRpdiBjbGFzcz0ndGgtbGFiZWwnIGRhdGEtZmllbGQ9J2V4ZSIgKyBpICsgImViZ20nPjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz5FQkdNPC9kaXY+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPiIgKyBkYXRlcmFuZ2UgKyAiPC9kaXY+PC9kaXY+PC90aD4iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjx0aCBjbGFzcz0nZXh0cmFDb2x1bW5zJz48ZGl2IGNsYXNzPSd0aC1sYWJlbCcgZGF0YS1maWVsZD0nZXhlIiArIGkgKyAiZWIwNSc+PGRpdiBjbGFzcz0nc3RhY2tlZC1jZWxsLWNlbnRlci10b3AnPkVCMDU8L2Rpdj48ZGl2IGNsYXNzPSdzdGFja2VkLWNlbGwtY2VudGVyLXRvcCc+RUI5NTwvZGl2PjxkaXYgY2xhc3M9J3N0YWNrZWQtY2VsbC1jZW50ZXItdG9wJz4iICsgZGF0ZXJhbmdlICsgIjwvZGl2PjwvZGl2PiA8L3RoPiIpLmFwcGVuZFRvKCIjYWxlcnRzRGV0YWlsc1RhYmxlUm93Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgcmVzdWx0WyJleGVSZWNlbnQiXTsKICAgICAgICAgICAgICAgICAgICBsb2FkVGFibGUocmVzdWx0KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgICQoIiNmcmVxdWVuY3lOYW1lcyIpLmNoYW5nZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGZyZXFTZWxlY3RlZCA9ICQoIiNmcmVxdWVuY3lOYW1lcyIpLnZhbCgpOwogICAgICAgICAgICBpZiAod2luZG93LnNlc3Npb25TdG9yYWdlKSB7CiAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJmcmVxdWVuY3kiLCBmcmVxU2VsZWN0ZWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgIH0pOwogICAgICAgIGlmICh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UpIHsKICAgICAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImZyZXF1ZW5jeSIpKSB7CiAgICAgICAgICAgICAgICAkKCIjZnJlcXVlbmN5TmFtZXMiKS52YWwoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiZnJlcXVlbmN5IikpOwogICAgICAgICAgICAgICAgZnJlcVNlbGVjdGVkID0gJCgiI2ZyZXF1ZW5jeU5hbWVzIikudmFsKCk7CiAgICAgICAgICAgICAgICBnZXREYXRlUmFuZ2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiZnJlcXVlbmN5IikpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAkKCIjZnJlcXVlbmN5TmFtZXMiKS52YWwoJCgiI2ZyZXF1ZW5jeU5hbWVzIG9wdGlvbjpmaXJzdCIpLnZhbCgpKTsKICAgICAgICAgICAgICAgICQoIiNmcmVxdWVuY3lOYW1lcyIpLnRyaWdnZXIoJ2NoYW5nZScpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGxvYWRUYWJsZSgiIikKICAgIH0KCiAgICAkKCIuZXhwb3J0QWxlcnRIaXN0b3JpZXMiKS5jbGljayhmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBwcm9kdWN0RXZlbnRIaXN0b3J5TW9kYWwgPSAkKCcjcHJvZHVjdEV2ZW50SGlzdG9yeU1vZGFsJyk7CiAgICAgICAgdmFyIHByb2R1Y3ROYW1lID0gZW5jb2RlVG9IVE1MKHByb2R1Y3RFdmVudEhpc3RvcnlNb2RhbC5maW5kKCIjcHJvZHVjdE5hbWUiKS5odG1sKCkpOwogICAgICAgIHZhciBldmVudE5hbWUgPSBlbmNvZGVUb0hUTUwocHJvZHVjdEV2ZW50SGlzdG9yeU1vZGFsLmZpbmQoIiNldmVudE5hbWUiKS5odG1sKCkpOwogICAgICAgIHZhciBjb25maWdJZCA9IHByb2R1Y3RFdmVudEhpc3RvcnlNb2RhbC5maW5kKCIjY29uZmlnSWQiKS50ZXh0KCk7CiAgICAgICAgdmFyIHNlbGVjdGVkQ2FzZSA9IGUuY3VycmVudFRhcmdldC5ocmVmICsgIiZwcm9kdWN0TmFtZT0iICsgcHJvZHVjdE5hbWUgKyAiJmV2ZW50TmFtZT0iICsgZXZlbnROYW1lICsgIiZjb25maWdJZD0iICsgY29uZmlnSWQ7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBzZWxlY3RlZENhc2U7CiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICB9KTsKCn0pOwoKZnVuY3Rpb24gbWFrZUFvQ29sdW1ucyhpLCBwcnJWaXNpYmlsaXR5LCByb3JWaXNpYmlsaXR5LCBlYmdtVmlzaWJpbGl0eSwgZHNzVmlzaWJpbHR5KSB7CiAgICB2YXIgYWRkQ29sdW1ucyA9IFsKICAgICAgICB7CiAgICAgICAgICAgICJtRGF0YSI6ICdleGUnICsgaSArICduZXdTcG9uQ291bnQnLAogICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgcmV0dXJuICc8ZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0ubmV3U3BvbkNvdW50ICsgJzwvZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0uY3VtU3BvbkNvdW50ICsgJzwvZGl2PjwvZGl2PicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdleGUnICsgaSArICduZXdTcG9uQ291bnQnKQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm1EYXRhIjogJ2V4ZScgKyBpICsgJ25ld1NlcmlvdXNDb3VudCcsCiAgICAgICAgICAgICJjbGFzc05hbWUiOiAnJywKICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXY+PGRpdiBjbGFzcz0ic3RhY2tlZC1jZWxsLWNlbnRlci10b3AiPicgKyByb3dbJ2V4ZScgKyBpXS5uZXdTZXJpb3VzQ291bnQgKyAnPC9kaXY+PGRpdiBjbGFzcz0ic3RhY2tlZC1jZWxsLWNlbnRlci10b3AiPicgKyByb3dbJ2V4ZScgKyBpXS5jdW1TZXJpb3VzQ291bnQgKyAnPC9kaXY+PC9kaXY+JwogICAgICAgICAgICB9LAogICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2V4ZScgKyBpICsgJ25ld1NlcmlvdXNDb3VudCcpCiAgICAgICAgfSwgewogICAgICAgICAgICAibURhdGEiOiAnZXhlJyArIGkgKyAnbmV3RmF0YWxDb3VudCcsCiAgICAgICAgICAgICJjbGFzc05hbWUiOiAnJywKICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXY+PGRpdiBjbGFzcz0ic3RhY2tlZC1jZWxsLWNlbnRlci10b3AiPicgKyByb3dbJ2V4ZScgKyBpXS5uZXdGYXRhbENvdW50ICsgJzwvZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0uY3VtRmF0YWxDb3VudCArICc8L2Rpdj48L2Rpdj4nCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnZXhlJyArIGkgKyAnbmV3RmF0YWxDb3VudCcpCiAgICAgICAgfSwgewogICAgICAgICAgICAibURhdGEiOiAnZXhlJyArIGkgKyAnbmV3U3R1ZHlDb3VudCcsCiAgICAgICAgICAgICJjbGFzc05hbWUiOiAnJywKICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXY+PGRpdiBjbGFzcz0ic3RhY2tlZC1jZWxsLWNlbnRlci10b3AiPicgKyByb3dbJ2V4ZScgKyBpXS5uZXdTdHVkeUNvdW50ICsgJzwvZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0uY3VtU3R1ZHlDb3VudCArICc8L2Rpdj48L2Rpdj4nCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnZXhlJyArIGkgKyAnbmV3U3R1ZHlDb3VudCcpCiAgICAgICAgfV07CiAgICBpZiAocHJyVmlzaWJpbGl0eSkgewogICAgICAgIGFkZENvbHVtbnMucHVzaC5hcHBseShhZGRDb2x1bW5zLCBbewogICAgICAgICAgICAibURhdGEiOiAnZXhlJyArIGkgKyAncHJyVmFsdWUnLAogICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgcmV0dXJuICc8c3Bhbj4nICsgcm93WydleGUnICsgaV0ucHJyVmFsdWUgKyAnPC9zcGFuPicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdleGUnICsgaSArICdwcnJWYWx1ZScpCiAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1EYXRhIjogJ2V4ZScgKyBpICsgJ3BycjA1JywKICAgICAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdj48ZGl2IGNsYXNzPSJzdGFja2VkLWNlbGwtY2VudGVyLXRvcCI+JyArIHJvd1snZXhlJyArIGldLnBycjA1ICsgJzwvZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0ucHJyOTUgKyAnPC9kaXY+PC9kaXY+JwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJ2aXNpYmxlIjogc2lnbmFsLmZpZWxkTWFuYWdlbWVudC52aXNpYmxlQ29sdW1ucygnZXhlJyArIGkgKyAncHJyMDUnKQogICAgICAgICAgICB9XSkKICAgIH0KICAgIGlmIChyb3JWaXNpYmlsaXR5KSB7CiAgICAgICAgYWRkQ29sdW1ucy5wdXNoLmFwcGx5KGFkZENvbHVtbnMsIFt7CiAgICAgICAgICAgICJtRGF0YSI6ICdleGUnICsgaSArICdyb3JWYWx1ZScsCiAgICAgICAgICAgICJjbGFzc05hbWUiOiAnJywKICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJzxzcGFuPicgKyByb3dbJ2V4ZScgKyBpXS5yb3JWYWx1ZSArICc8L3NwYW4+JwogICAgICAgICAgICB9LAogICAgICAgICAgICAidmlzaWJsZSI6IHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoJ2V4ZScgKyBpICsgJ3JvclZhbHVlJykKICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAnZXhlJyArIGkgKyAncm9yMDUnLAogICAgICAgICAgICAgICAgIm1SZW5kZXIiOiBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgcm93KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8ZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0ucm9yMDUgKyAnPC9kaXY+PGRpdiBjbGFzcz0ic3RhY2tlZC1jZWxsLWNlbnRlci10b3AiPicgKyByb3dbJ2V4ZScgKyBpXS5yb3I5NSArICc8L2Rpdj48L2Rpdj4nCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdleGUnICsgaSArICdyb3IwNScpCiAgICAgICAgICAgIH1dKQogICAgfQogICAgaWYgKGViZ21WaXNpYmlsaXR5KSB7CiAgICAgICAgYWRkQ29sdW1ucy5wdXNoLmFwcGx5KGFkZENvbHVtbnMsIFt7CiAgICAgICAgICAgICJtRGF0YSI6ICdleGUnICsgaSArICdlYmdtJywKICAgICAgICAgICAgImNsYXNzTmFtZSI6ICcnLAogICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4+JyArIHJvd1snZXhlJyArIGldLmViZ20gKyAnPC9zcGFuPicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdleGUnICsgaSArICdlYmdtJykKICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibURhdGEiOiAnZXhlJyArIGkgKyAnZWIwNScsCiAgICAgICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICAgICAibVJlbmRlciI6IGZ1bmN0aW9uIChkYXRhLCB0eXBlLCByb3cpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXY+PGRpdiBjbGFzcz0ic3RhY2tlZC1jZWxsLWNlbnRlci10b3AiPicgKyByb3dbJ2V4ZScgKyBpXS5lYjA1ICsgJzwvZGl2PjxkaXYgY2xhc3M9InN0YWNrZWQtY2VsbC1jZW50ZXItdG9wIj4nICsgcm93WydleGUnICsgaV0uZWI5NSArICc8L2Rpdj48L2Rpdj4nCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgInZpc2libGUiOiBzaWduYWwuZmllbGRNYW5hZ2VtZW50LnZpc2libGVDb2x1bW5zKCdleGUnICsgaSArICdlYjA1JykKICAgICAgICAgICAgfV0pCiAgICB9CiAgICBpZihpc0FnZUVuYWJsZWQpIHsKICAgICAgICAkLmVhY2goc3ViR3JvdXBzTWFwLkFHRV9HUk9VUCwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgYWRkQ29sdW1ucy5wdXNoLmFwcGx5KGFkZENvbHVtbnMsIG1ha2VTdWJHcm91cENvbHVtbnNQcmV2KHZhbHVlLCAiZWJnbSIsICdleGUnICsgaSwgImViZ21BZ2UiKSk7CiAgICAgICAgICAgIGFkZENvbHVtbnMucHVzaC5hcHBseShhZGRDb2x1bW5zLCBtYWtlU3ViR3JvdXBDb2x1bW5zUHJldih2YWx1ZSwgImViMDUiLCAnZXhlJyArIGksICJlYjA1QWdlIikpOwogICAgICAgICAgICBhZGRDb2x1bW5zLnB1c2guYXBwbHkoYWRkQ29sdW1ucywgbWFrZVN1Ykdyb3VwQ29sdW1uc1ByZXYodmFsdWUsICJlYjk1IiwgJ2V4ZScgKyBpLCAiZWI5NUFnZSIpKTsKICAgICAgICB9KTsKICAgIH0KICAgIGlmKGlzR2VuZGVyRW5hYmxlZCkgewogICAgICAgICQuZWFjaChzdWJHcm91cHNNYXAuR0VOREVSLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICBhZGRDb2x1bW5zLnB1c2guYXBwbHkoYWRkQ29sdW1ucywgbWFrZVN1Ykdyb3VwQ29sdW1uc1ByZXYodmFsdWUsICJlYmdtIiwgJ2V4ZScgKyBpLCAiZWJnbUdlbmRlciIpKTsKICAgICAgICAgICAgYWRkQ29sdW1ucy5wdXNoLmFwcGx5KGFkZENvbHVtbnMsIG1ha2VTdWJHcm91cENvbHVtbnNQcmV2KHZhbHVlLCAiZWIwNSIsICdleGUnICsgaSwgImViMDVHZW5kZXIiKSk7CiAgICAgICAgICAgIGFkZENvbHVtbnMucHVzaC5hcHBseShhZGRDb2x1bW5zLCBtYWtlU3ViR3JvdXBDb2x1bW5zUHJldih2YWx1ZSwgImViOTUiLCAnZXhlJyArIGksICJlYjk1R2VuZGVyIikpOwogICAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIGFkZENvbHVtbnMKfQoKZnVuY3Rpb24ganNVY2ZpcnN0KHN0cmluZykgewogICAgcmV0dXJuIHN0cmluZy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTsKfQoKJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5jYXNlU2VyaWVzTm90QWNjZXNzJywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgICQuTm90aWZpY2F0aW9uLm5vdGlmeSgnZXJyb3InLCd0b3AgcmlnaHQnLCAiRXJyb3IiLCAiWW91IGRvbnQgaGF2ZSBhY2Nlc3MgdG8gY2hvb3NlIHRoaXMgb3B0aW9uIiwge2F1dG9IaWRlRGVsYXk6IDIwMDB9KTsKfSk7CgokKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNpZ25hbFN1bW1hcnlBdXRoJywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgICQuTm90aWZpY2F0aW9uLm5vdGlmeSgnd2FybmluZycsJ3RvcCByaWdodCcsICJXYXJuaW5nIiwgIllvdSBkb24ndCBoYXZlIGFjY2VzcyB0byB2aWV3IHNpZ25hbCBzdW1tYXJ5Iiwge2F1dG9IaWRlRGVsYXk6IDIwMDB9KTsKfSk7Cgp2YXIgZmV0Y2hTdWJHcm91cHNNYXAgPSBmdW5jdGlvbigpIHsKICAgIHZhciBkYXRhU291cmNlID0gJCgiI2lzRmFlcnMiKS52YWwoKSA9PSAidHJ1ZSIgPyAiZmFlcnMiIDogInB2YSI7CiAgICAkLmFqYXgoewogICAgICAgIHVybDogIi9zaWduYWwvYWdncmVnYXRlQ2FzZUFsZXJ0L2ZldGNoU3ViR3JvdXBzTWFwIiwKICAgICAgICBkYXRhOiB7ZGF0YVNvdXJjZSA6IGRhdGFTb3VyY2V9LAogICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIHN1Ykdyb3Vwc01hcCA9IGRhdGEuc3ViR3JvdXBzTWFwOwogICAgICAgICAgICBpc0FnZUVuYWJsZWQgPSBkYXRhLmlzQWdlRW5hYmxlZDsKICAgICAgICAgICAgaXNHZW5kZXJFbmFibGVkID0gZGF0YS5pc0dlbmRlckVuYWJsZWQ7CiAgICAgICAgfQogICAgfSk7Cn07CgpmdW5jdGlvbiBtYWtlU3ViR3JvdXBDb2x1bW5zKGdyb3VwTmFtZSAsIGNhdGVnb3J5ICwgc3ViR3JvdXAgKSB7CiAgICB2YXIgYWRkQ29sdW1ucyA9IFsKICAgICAgICB7CiAgICAgICAgICAgICJtRGF0YSI6IGdyb3VwTmFtZSArIGNhdGVnb3J5LAogICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgdmFyIHN0cmluZ01hcCA9IHJvd1tzdWJHcm91cF07CiAgICAgICAgICAgICAgICBpZiAoc3RyaW5nTWFwID09ICctJykKICAgICAgICAgICAgICAgICAgICBtYXAgPSBbXTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB2YXIgbWFwID0gY2xvYlRvTWFwKHN0cmluZ01hcCkKICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9ICIiOwogICAgICAgICAgICAgICAgaWYobWFwID09IG51bGwgfHwgbWFwW2NhdGVnb3J5XSA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAiMCI7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBtYXBbY2F0ZWdvcnldOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJ2aXNpYmxlIjogIHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMoZ3JvdXBOYW1lICsgY2F0ZWdvcnkpCiAgICAgICAgfV07CiAgICByZXR1cm4gYWRkQ29sdW1ucwp9CgpmdW5jdGlvbiBtYWtlU3ViR3JvdXBDb2x1bW5zUHJldihjYXRlZ29yeSAsZ3JvdXBOYW1lLCBwcmV2VmFsdWUsc3ViR3JvdXAgKSB7CiAgICB2YXIgYWRkQ29sdW1ucyA9IFsKICAgICAgICB7CiAgICAgICAgICAgICJtRGF0YSI6IHByZXZWYWx1ZSArIGdyb3VwTmFtZSArIGNhdGVnb3J5LAogICAgICAgICAgICAiY2xhc3NOYW1lIjogJycsCiAgICAgICAgICAgICJtUmVuZGVyIjogZnVuY3Rpb24gKGRhdGEsIHR5cGUsIHJvdykgewogICAgICAgICAgICAgICAgdmFyIHN0cmluZ01hcCA9ICByb3dbcHJldlZhbHVlXVtzdWJHcm91cF0KICAgICAgICAgICAgICAgIGlmIChzdHJpbmdNYXAgPT0gJy0nKQogICAgICAgICAgICAgICAgICAgIG1hcCA9IFtdOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHZhciBtYXAgPSBjbG9iVG9NYXAoc3RyaW5nTWFwKQogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICBpZihtYXAgPT0gbnVsbCB8fCBtYXBbY2F0ZWdvcnldID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICIwIgogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gbWFwW2NhdGVnb3J5XTsKICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICAib3JkZXJhYmxlIjogZmFsc2UsCiAgICAgICAgICAgICJ2aXNpYmxlIjogIHNpZ25hbC5maWVsZE1hbmFnZW1lbnQudmlzaWJsZUNvbHVtbnMocHJldlZhbHVlICsgZ3JvdXBOYW1lICsgY2F0ZWdvcnkpCiAgICAgICAgfV07CiAgICByZXR1cm4gYWRkQ29sdW1ucwp9CgpmdW5jdGlvbiBjbG9iVG9NYXAoY2xvYikgewogICAgY2xvYiA9IGNsb2IucmVwbGFjZSgnIicsICcnKTsKICAgIGNsb2IgPSBjbG9iLnJlcGxhY2UoJyInLCAnJyk7IC8vVE9ETyA6IG5lZWQgdG8gaW52ZXN0aWdhdGUgYW5kIHJlbW92ZSB0aGlzCiAgICB2YXIgbGlzdCA9IGNsb2Iuc3BsaXQoIiwiKSA7CiAgICB2YXIgbWFwID0gW10gOwogICAgJC5lYWNoKGxpc3QgLCBmdW5jdGlvbihpbmQgLCB2YWx1ZSl7CiAgICAgICAgbWFwW3ZhbHVlLnNwbGl0KCI6IilbMF0udHJpbSgpXSA9IHZhbHVlLnNwbGl0KCI6IikubGVuZ3RoID4gMSA/IHZhbHVlLnNwbGl0KCI6IilbMV0gOiAiMCI7CiAgICB9KTsKICAgIHJldHVybiBtYXAKfQoKdmFyIGZldGNoVGFncyA9IGZ1bmN0aW9uICgpIHsKICAgICQuYWpheCh7CiAgICAgICAgdXJsOiBmZXRjaENvbW1vblRhZ3NVcmwsCiAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICByZXN1bHQuY29tbW9uVGFnTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKG1hcCl7CiAgICAgICAgICAgICAgICB0YWdzLnB1c2goewogICAgICAgICAgICAgICAgICAgIGlkOiBtYXAuaWQsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogbWFwLnRleHQsCiAgICAgICAgICAgICAgICAgICAgcGFyZW50SWQ6IG1hcC5wYXJlbnRJZAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0pOwp9OwoKCgoKCg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="773191343" offset="0" length="4096" />
        <PacketInfo time="773191359" offset="4096" length="16384" />
        <PacketInfo time="773191515" offset="20480" length="16384" />
        <PacketInfo time="773191531" offset="36864" length="16384" />
        <PacketInfo time="773191531" offset="53248" length="16384" />
        <PacketInfo time="773191531" offset="69632" length="16384" />
        <PacketInfo time="773191531" offset="86016" length="16384" />
        <PacketInfo time="773191546" offset="102400" length="16384" />
        <PacketInfo time="773191546" offset="118784" length="13510" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>